(()=>{(self.webpackChunk_automattic_jetpack_storybook=self.webpackChunk_automattic_jetpack_storybook||[]).push([[501],{"../../../node_modules/.pnpm/@wordpress+compose@7.5.0_react@18.3.1/node_modules/@wordpress/compose/build-module/hooks/use-focusable-iframe/index.js":(Gt,kt,$)=>{"use strict";$.d(kt,{Z:()=>ft});var it=$("../../../node_modules/.pnpm/@wordpress+compose@7.5.0_react@18.3.1/node_modules/@wordpress/compose/build-module/hooks/use-ref-effect/index.js");function ft(){return(0,it.Z)(rt=>{const{ownerDocument:x}=rt;if(!x)return;const{defaultView:I}=x;if(!I)return;function b(){x&&x.activeElement===rt&&rt.focus()}return I.addEventListener("blur",b),()=>{I.removeEventListener("blur",b)}},[])}},"../../../node_modules/.pnpm/@wordpress+sync@1.5.0/node_modules/@wordpress/sync/build-module/connect-indexdb.js":(Gt,kt,$)=>{"use strict";$.d(kt,{D:()=>Jt});var it=$("../../../node_modules/.pnpm/yjs@13.6.18/node_modules/yjs/dist/yjs.mjs"),ft=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/promise.js"),rt=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/error.js");const x=ct=>ft.Ue((et,at)=>{ct.onerror=_t=>at(new Error(_t.target.error)),ct.onsuccess=_t=>et(_t.target.result)}),I=(ct,et)=>ft.Ue((at,_t)=>{const vt=indexedDB.open(ct);vt.onupgradeneeded=Ot=>et(Ot.target.result),vt.onerror=Ot=>_t(rt.Ue(Ot.target.error)),vt.onsuccess=Ot=>{const Ht=Ot.target.result;Ht.onversionchange=()=>{Ht.close()},at(Ht)}}),b=ct=>x(indexedDB.deleteDatabase(ct)),g=(ct,et)=>et.forEach(at=>ct.createObjectStore.apply(ct,at)),O=(ct,et,at="readwrite")=>{const _t=ct.transaction(et,at);return et.map(vt=>Y(_t,vt))},L=(ct,et)=>x(ct.count(et)),h=(ct,et)=>x(ct.get(et)),y=(ct,et)=>x(ct.delete(et)),d=(ct,et,at)=>x(ct.put(et,at)),u=(ct,et,at)=>x(ct.add(et,at)),M=(ct,et)=>x(ct.add(et)),T=(ct,et,at)=>x(ct.getAll(et,at)),E=(ct,et,at)=>x(ct.getAllKeys(et,at)),B=(ct,et,at)=>{let _t=null;return R(ct,et,vt=>(_t=vt,!1),at).then(()=>_t)},a=(ct,et=null)=>B(ct,et,"prev"),v=(ct,et=null)=>B(ct,et,"next"),m=(ct,et,at)=>promise.all([E(ct,et,at),T(ct,et,at)]).then(([_t,vt])=>_t.map((Ot,Ht)=>({k:Ot,v:vt[Ht]}))),A=(ct,et)=>ft.Ue((at,_t)=>{ct.onerror=_t,ct.onsuccess=async vt=>{const Ot=vt.target.result;if(Ot===null||await et(Ot)===!1)return at();Ot.continue()}}),_=(ct,et,at,_t="next")=>A(ct.openCursor(et,_t),vt=>at(vt.value,vt.key)),R=(ct,et,at,_t="next")=>A(ct.openKeyCursor(et,_t),vt=>at(vt.key)),Y=(ct,et)=>ct.objectStore(et),U=(ct,et,at,_t)=>IDBKeyRange.bound(ct,et,at,_t),P=(ct,et)=>IDBKeyRange.upperBound(ct,et),Z=(ct,et)=>IDBKeyRange.lowerBound(ct,et);var lt=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/observable.js");const bt="custom",Ct="updates",Tt=500,It=(ct,et=()=>{},at=()=>{})=>{const[_t]=O(ct.db,[Ct]);return T(_t,Z(ct._dbref,!1)).then(vt=>{ct._destroyed||(et(_t),it.ay(ct.doc,()=>{vt.forEach(Ot=>it.NG(ct.doc,Ot))},ct,!1),at(_t))}).then(()=>a(_t).then(vt=>{ct._dbref=vt+1})).then(()=>L(_t).then(vt=>{ct._dbsize=vt})).then(()=>_t)},Lt=(ct,et=!0)=>It(ct).then(at=>{(et||ct._dbsize>=Tt)&&M(at,it.D$(ct.doc)).then(()=>y(at,P(ct._dbref,!0))).then(()=>L(at).then(_t=>{ct._dbsize=_t}))}),St=ct=>idb.deleteDB(ct);class ne extends lt.y{constructor(et,at){super(),this.doc=at,this.name=et,this._dbref=0,this._dbsize=0,this._destroyed=!1,this.db=null,this.synced=!1,this._db=I(et,_t=>g(_t,[["updates",{autoIncrement:!0}],["custom"]])),this.whenSynced=ft.Ue(_t=>this.on("synced",()=>_t(this))),this._db.then(_t=>{this.db=_t,It(this,Ht=>M(Ht,it.D$(at)),()=>{if(this._destroyed)return this;this.synced=!0,this.emit("synced",[this])})}),this._storeTimeout=1e3,this._storeTimeoutId=null,this._storeUpdate=(_t,vt)=>{if(this.db&&vt!==this){const[Ot]=O(this.db,[Ct]);M(Ot,_t),++this._dbsize>=Tt&&(this._storeTimeoutId!==null&&clearTimeout(this._storeTimeoutId),this._storeTimeoutId=setTimeout(()=>{Lt(this,!1),this._storeTimeoutId=null},this._storeTimeout))}},at.on("update",this._storeUpdate),this.destroy=this.destroy.bind(this),at.on("destroy",this.destroy)}destroy(){return this._storeTimeoutId&&clearTimeout(this._storeTimeoutId),this.doc.off("update",this._storeUpdate),this.doc.off("destroy",this.destroy),this._destroyed=!0,this._db.then(et=>{et.close()})}clearData(){return this.destroy().then(()=>{b(this.name)})}get(et){return this._db.then(at=>{const[_t]=O(at,[bt],"readonly");return h(_t,et)})}set(et,at){return this._db.then(_t=>{const[vt]=O(_t,[bt]);return d(vt,at,et)})}del(et){return this._db.then(at=>{const[_t]=O(at,[bt]);return y(_t,et)})}}function Jt(ct,et,at){const _t=`${et}-${ct}`,vt=new ne(_t,at);return new Promise(Ot=>{vt.on("synced",()=>{Ot(()=>vt.destroy())})})}},"../../../node_modules/.pnpm/@wordpress+sync@1.5.0/node_modules/@wordpress/sync/build-module/create-webrtc-connection.js":(Gt,kt,$)=>{"use strict";$.d(kt,{y:()=>Te});var it=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/observable.js"),ft=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/time.js"),rt=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/math.js");const x=1200,I=2500,b=3e4,g=N=>{if(N.shouldConnect&&N.ws===null){const H=new WebSocket(N.url),J=N.binaryType;let ot=null;J&&(H.binaryType=J),N.ws=H,N.connecting=!0,N.connected=!1,H.onmessage=dt=>{N.lastMessageReceived=ft.ZG();const At=dt.data,Ut=typeof At=="string"?JSON.parse(At):At;Ut&&Ut.type==="pong"&&(clearTimeout(ot),ot=setTimeout(Et,b/2)),N.emit("message",[Ut,N])};const st=dt=>{N.ws!==null&&(N.ws=null,N.connecting=!1,N.connected?(N.connected=!1,N.emit("disconnect",[{type:"disconnect",error:dt},N])):N.unsuccessfulReconnects++,setTimeout(g,rt.VV(rt.mv(N.unsuccessfulReconnects+1)*x,I),N)),clearTimeout(ot)},Et=()=>{N.ws===H&&N.send({type:"ping"})};H.onclose=()=>st(null),H.onerror=dt=>st(dt),H.onopen=()=>{N.lastMessageReceived=ft.ZG(),N.connecting=!1,N.connected=!0,N.unsuccessfulReconnects=0,N.emit("connect",[{type:"connect"},N]),ot=setTimeout(Et,b/2)}}};class O extends it.y{constructor(H,{binaryType:J}={}){super(),this.url=H,this.ws=null,this.binaryType=J||null,this.connected=!1,this.connecting=!1,this.unsuccessfulReconnects=0,this.lastMessageReceived=0,this.shouldConnect=!0,this._checkInterval=setInterval(()=>{this.connected&&b<ft.ZG()-this.lastMessageReceived&&this.ws.close()},b/2),g(this)}send(H){this.ws&&this.ws.send(JSON.stringify(H))}destroy(){clearInterval(this._checkInterval),this.disconnect(),super.destroy()}disconnect(){this.shouldConnect=!1,this.ws!==null&&this.ws.close()}connect(){this.shouldConnect=!0,!this.connected&&this.ws===null&&g(this)}}var L=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/map.js"),h=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/error.js"),y=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/random.js"),d=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/encoding.js"),u=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/decoding.js"),M=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/logging.js"),T=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/logging.common.js"),E=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/promise.js"),B=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/set.js"),a=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/buffer.js"),v=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/storage.js");const m=new Map;class A{constructor(H){this.room=H,this.onmessage=null,this._onChange=J=>J.key===H&&this.onmessage!==null&&this.onmessage({data:a.Gh(J.newValue||"")}),v.z2(this._onChange)}postMessage(H){v.XN.setItem(this.room,a.s3(a.eh(H)))}close(){v.F(this._onChange)}}const _=typeof BroadcastChannel=="undefined"?A:BroadcastChannel,R=N=>L.Yu(m,N,()=>{const H=B.Ue(),J=new _(N);return J.onmessage=ot=>H.forEach(st=>st(ot.data,"broadcastchannel")),{bc:J,subs:H}}),Y=(N,H)=>(R(N).subs.add(H),H),U=(N,H)=>{const J=R(N),ot=J.subs.delete(H);return ot&&J.subs.size===0&&(J.bc.close(),m.delete(N)),ot},P=(N,H,J=null)=>{const ot=R(N);ot.bc.postMessage(H),ot.subs.forEach(st=>st(H,J))},Z=()=>{let N=!0;return(H,J)=>{if(N){N=!1;try{H()}finally{N=!0}}else J!==void 0&&J()}};var lt=$("../../../node_modules/.pnpm/simple-peer@9.11.1/node_modules/simple-peer/simplepeer.min.js"),bt=$.n(lt),Ct=$("../../../node_modules/.pnpm/yjs@13.6.18/node_modules/yjs/dist/yjs.mjs");const Tt=0,It=1,Lt=2,St=(N,H)=>{d.uE(N,Tt);const J=Ct.gJ(H);d.mP(N,J)},ne=(N,H,J)=>{d.uE(N,It),d.mP(N,Ct.D$(H,J))},Jt=(N,H,J)=>ne(H,J,u.HN(N)),ct=(N,H,J)=>{try{Ct.NG(H,u.HN(N),J)}catch(ot){console.error("Caught error while handling a Yjs update",ot)}},et=(N,H)=>{d.uE(N,Lt),d.mP(N,H)},at=ct,_t=(N,H,J,ot)=>{const st=u.yg(N);switch(st){case Tt:Jt(N,H,J);break;case It:ct(N,J,ot);break;case Lt:at(N,J,ot);break;default:throw new Error("Unknown message type")}return st};var vt=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/function.js");const Ot=3e4;class Ht extends it.y{constructor(H){super(),this.doc=H,this.clientID=H.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{const J=ft.ZG();this.getLocalState()!==null&&Ot/2<=J-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const ot=[];this.meta.forEach((st,Et)=>{Et!==this.clientID&&Ot<=J-st.lastUpdated&&this.states.has(Et)&&ot.push(Et)}),ot.length>0&&te(this,ot,"timeout")},rt.GW(Ot/10)),H.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(H){const J=this.clientID,ot=this.meta.get(J),st=ot===void 0?0:ot.clock+1,Et=this.states.get(J);H===null?this.states.delete(J):this.states.set(J,H),this.meta.set(J,{clock:st,lastUpdated:ft.ZG()});const dt=[],At=[],Ut=[],Bt=[];H===null?Bt.push(J):Et==null?H!=null&&dt.push(J):(At.push(J),vt.Hi(Et,H)||Ut.push(J)),(dt.length>0||Ut.length>0||Bt.length>0)&&this.emit("change",[{added:dt,updated:Ut,removed:Bt},"local"]),this.emit("update",[{added:dt,updated:At,removed:Bt},"local"])}setLocalStateField(H,J){const ot=this.getLocalState();ot!==null&&this.setLocalState({...ot,[H]:J})}getStates(){return this.states}}const te=(N,H,J)=>{const ot=[];for(let st=0;st<H.length;st++){const Et=H[st];if(N.states.has(Et)){if(N.states.delete(Et),Et===N.clientID){const dt=N.meta.get(Et);N.meta.set(Et,{clock:dt.clock+1,lastUpdated:ft.ZG()})}ot.push(Et)}}ot.length>0&&(N.emit("change",[{added:[],updated:[],removed:ot},J]),N.emit("update",[{added:[],updated:[],removed:ot},J]))},Ft=(N,H,J=N.states)=>{const ot=H.length,st=d.Mf();d.uE(st,ot);for(let Et=0;Et<ot;Et++){const dt=H[Et],At=J.get(dt)||null,Ut=N.meta.get(dt).clock;d.uE(st,dt),d.uE(st,Ut),d.uw(st,JSON.stringify(At))}return d._f(st)},ie=(N,H)=>{const J=decoding.createDecoder(N),ot=encoding.createEncoder(),st=decoding.readVarUint(J);encoding.writeVarUint(ot,st);for(let Et=0;Et<st;Et++){const dt=decoding.readVarUint(J),At=decoding.readVarUint(J),Ut=JSON.parse(decoding.readVarString(J)),Bt=H(Ut);encoding.writeVarUint(ot,dt),encoding.writeVarUint(ot,At),encoding.writeVarString(ot,JSON.stringify(Bt))}return encoding.toUint8Array(ot)},G=(N,H,J)=>{const ot=u.l1(H),st=ft.ZG(),Et=[],dt=[],At=[],Ut=[],Bt=u.yg(ot);for(let Pt=0;Pt<Bt;Pt++){const Zt=u.yg(ot);let le=u.yg(ot);const ge=JSON.parse(u.kf(ot)),xe=N.meta.get(Zt),yn=N.states.get(Zt),he=xe===void 0?0:xe.clock;(he<le||he===le&&ge===null&&N.states.has(Zt))&&(ge===null?Zt===N.clientID&&N.getLocalState()!=null?le++:N.states.delete(Zt):N.states.set(Zt,ge),N.meta.set(Zt,{clock:le,lastUpdated:st}),xe===void 0&&ge!==null?Et.push(Zt):xe!==void 0&&ge===null?Ut.push(Zt):ge!==null&&(vt.Hi(ge,yn)||At.push(Zt),dt.push(Zt)))}(Et.length>0||At.length>0||Ut.length>0)&&N.emit("change",[{added:Et,updated:At,removed:Ut},J]),(Et.length>0||dt.length>0||Ut.length>0)&&N.emit("update",[{added:Et,updated:dt,removed:Ut},J])};var tt=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/string.js");const wt=(N,H)=>{const J=tt.lz(N).buffer,ot=tt.lz(H).buffer;return crypto.subtle.importKey("raw",J,"PBKDF2",!1,["deriveKey"]).then(st=>crypto.subtle.deriveKey({name:"PBKDF2",salt:ot,iterations:1e5,hash:"SHA-256"},st,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]))},V=(N,H)=>{if(!H)return E.DB(N);const J=crypto.getRandomValues(new Uint8Array(12));return crypto.subtle.encrypt({name:"AES-GCM",iv:J},H,N).then(ot=>{const st=d.Mf();return d.uw(st,"AES-GCM"),d.mP(st,J),d.mP(st,new Uint8Array(ot)),d._f(st)})},w=(N,H)=>{const J=d.Mf();return d.EM(J,N),V(d._f(J),H)},k=(N,H)=>{if(!H)return E.DB(N);const J=u.l1(N);u.kf(J)!=="AES-GCM"&&E.d1(h.Ue("Unknown encryption algorithm"));const st=u.HN(J),Et=u.HN(J);return crypto.subtle.decrypt({name:"AES-GCM",iv:st},H,Et).then(dt=>new Uint8Array(dt))},Q=(N,H)=>k(N,H).then(J=>u.v_(u.l1(new Uint8Array(J))));var pt=$("../../../node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js");const n=M.YX("y-webrtc"),s=0,c=3,C=1,z=4,K=new Map,ut=new Map,Rt=N=>{let H=!0;N.webrtcConns.forEach(J=>{J.synced||(H=!1)}),(!H&&N.synced||H&&!N.synced)&&(N.synced=H,N.provider.emit("synced",[{synced:H}]),n("synced ",T.Pl,N.name,T.YW," with all peers"))},Yt=(N,H,J)=>{const ot=u.l1(H),st=d.Mf(),Et=u.yg(ot);if(N===void 0)return null;const dt=N.awareness,At=N.doc;let Ut=!1;switch(Et){case s:{d.uE(st,s);const Bt=_t(ot,st,At,N);Bt===It&&!N.synced&&J(),Bt===Tt&&(Ut=!0);break}case c:d.uE(st,C),d.mP(st,Ft(dt,Array.from(dt.getStates().keys()))),Ut=!0;break;case C:G(dt,u.HN(ot),N);break;case z:{const Bt=u.kj(ot)===1,Pt=u.kf(ot);if(Pt!==N.peerId&&(N.bcConns.has(Pt)&&!Bt||!N.bcConns.has(Pt)&&Bt)){const Zt=[],le=[];Bt?(N.bcConns.add(Pt),le.push(Pt)):(N.bcConns.delete(Pt),Zt.push(Pt)),N.provider.emit("peers",[{added:le,removed:Zt,webrtcPeers:Array.from(N.webrtcConns.keys()),bcPeers:Array.from(N.bcConns)}]),gt(N)}break}default:return console.error("Unable to compute message"),st}return Ut?st:null},Nt=(N,H)=>{const J=N.room;return n("received message from ",T.Pl,N.remotePeerId,T.s7," (",J.name,")",T.YW,T.WO),Yt(J,H,()=>{N.synced=!0,n("synced ",T.Pl,J.name,T.YW," with ",T.Pl,N.remotePeerId),Rt(J)})},Mt=(N,H)=>{n("send message to ",T.Pl,N.remotePeerId,T.YW,T.s7," (",N.room.name,")",T.WO);try{N.peer.send(d._f(H))}catch(J){}},xt=(N,H)=>{n("broadcast message in ",T.Pl,N.name,T.YW),N.webrtcConns.forEach(J=>{try{J.peer.send(H)}catch(ot){}})};class re{constructor(H,J,ot,st){n("establishing connection to ",T.Pl,ot),this.room=st,this.remotePeerId=ot,this.glareToken=void 0,this.closed=!1,this.connected=!1,this.synced=!1,this.peer=new(bt())({initiator:J,...st.provider.peerOpts}),this.peer.on("signal",Et=>{this.glareToken===void 0&&(this.glareToken=Date.now()+Math.random()),ee(H,st,{to:ot,from:st.peerId,type:"signal",token:this.glareToken,signal:Et})}),this.peer.on("connect",()=>{n("connected to ",T.Pl,ot),this.connected=!0;const dt=st.provider.doc,At=st.awareness,Ut=d.Mf();d.uE(Ut,s),St(Ut,dt),Mt(this,Ut);const Bt=At.getStates();if(Bt.size>0){const Pt=d.Mf();d.uE(Pt,C),d.mP(Pt,Ft(At,Array.from(Bt.keys()))),Mt(this,Pt)}}),this.peer.on("close",()=>{this.connected=!1,this.closed=!0,st.webrtcConns.has(this.remotePeerId)&&(st.webrtcConns.delete(this.remotePeerId),st.provider.emit("peers",[{removed:[this.remotePeerId],added:[],webrtcPeers:Array.from(st.webrtcConns.keys()),bcPeers:Array.from(st.bcConns)}])),Rt(st),this.peer.destroy(),n("closed connection to ",T.Pl,ot),yt(st)}),this.peer.on("error",Et=>{n("Error in connection to ",T.Pl,ot,": ",Et),yt(st)}),this.peer.on("data",Et=>{const dt=Nt(this,Et);dt!==null&&Mt(this,dt)})}destroy(){this.peer.destroy()}}const X=(N,H)=>V(H,N.key).then(J=>N.mux(()=>P(N.name,J))),nt=(N,H)=>{N.bcconnected&&X(N,H),xt(N,H)},yt=N=>{K.forEach(H=>{H.connected&&(H.send({type:"subscribe",topics:[N.name]}),N.webrtcConns.size<N.provider.maxConns&&ee(H,N,{type:"announce",from:N.peerId}))})},gt=N=>{if(N.provider.filterBcConns){const H=d.Mf();d.uE(H,z),d.$F(H,1),d.uw(H,N.peerId),X(N,d._f(H))}};class Vt{constructor(H,J,ot,st){this.peerId=y.k$(),this.doc=H,this.awareness=J.awareness,this.provider=J,this.synced=!1,this.name=ot,this.key=st,this.webrtcConns=new Map,this.bcConns=new Set,this.mux=Z(),this.bcconnected=!1,this._bcSubscriber=Et=>k(new Uint8Array(Et),st).then(dt=>this.mux(()=>{const At=Yt(this,dt,()=>{});At&&X(this,d._f(At))})),this._docUpdateHandler=(Et,dt)=>{const At=d.Mf();d.uE(At,s),et(At,Et),nt(this,d._f(At))},this._awarenessUpdateHandler=({added:Et,updated:dt,removed:At},Ut)=>{const Bt=Et.concat(dt).concat(At),Pt=d.Mf();d.uE(Pt,C),d.mP(Pt,Ft(this.awareness,Bt)),nt(this,d._f(Pt))},this._beforeUnloadHandler=()=>{te(this.awareness,[H.clientID],"window unload"),ut.forEach(Et=>{Et.disconnect()})},typeof window!="undefined"?window.addEventListener("beforeunload",this._beforeUnloadHandler):typeof pt!="undefined"&&pt.on("exit",this._beforeUnloadHandler)}connect(){this.doc.on("update",this._docUpdateHandler),this.awareness.on("update",this._awarenessUpdateHandler),yt(this);const H=this.name;Y(H,this._bcSubscriber),this.bcconnected=!0,gt(this);const J=d.Mf();d.uE(J,s),St(J,this.doc),X(this,d._f(J));const ot=d.Mf();d.uE(ot,s),ne(ot,this.doc),X(this,d._f(ot));const st=d.Mf();d.uE(st,c),X(this,d._f(st));const Et=d.Mf();d.uE(Et,C),d.mP(Et,Ft(this.awareness,[this.doc.clientID])),X(this,d._f(Et))}disconnect(){K.forEach(J=>{J.connected&&J.send({type:"unsubscribe",topics:[this.name]})}),te(this.awareness,[this.doc.clientID],"disconnect");const H=d.Mf();d.uE(H,z),d.$F(H,0),d.uw(H,this.peerId),X(this,d._f(H)),U(this.name,this._bcSubscriber),this.bcconnected=!1,this.doc.off("update",this._docUpdateHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.webrtcConns.forEach(J=>J.destroy())}destroy(){this.disconnect(),typeof window!="undefined"?window.removeEventListener("beforeunload",this._beforeUnloadHandler):typeof pt!="undefined"&&pt.off("exit",this._beforeUnloadHandler)}}const Xt=(N,H,J,ot)=>{if(ut.has(J))throw h.Ue(`A Yjs Doc connected to room "${J}" already exists!`);const st=new Vt(N,H,J,ot);return ut.set(J,st),st},ee=(N,H,J)=>{H.key?w(J,H.key).then(ot=>{N.send({type:"publish",topic:H.name,data:a.s3(ot)})}):N.send({type:"publish",topic:H.name,data:J})};class Qt extends O{constructor(H){super(H),this.providers=new Set,this.on("connect",()=>{n(`connected (${H})`);const J=Array.from(ut.keys());this.send({type:"subscribe",topics:J}),ut.forEach(ot=>ee(this,ot,{type:"announce",from:ot.peerId}))}),this.on("message",J=>{switch(J.type){case"publish":{const ot=J.topic,st=ut.get(ot);if(st==null||typeof ot!="string")return;const Et=dt=>{const At=st.webrtcConns,Ut=st.peerId;if(dt==null||dt.from===Ut||dt.to!==void 0&&dt.to!==Ut||st.bcConns.has(dt.from))return;const Bt=At.has(dt.from)?()=>{}:()=>st.provider.emit("peers",[{removed:[],added:[dt.from],webrtcPeers:Array.from(st.webrtcConns.keys()),bcPeers:Array.from(st.bcConns)}]);switch(dt.type){case"announce":At.size<st.provider.maxConns&&(L.Yu(At,dt.from,()=>new re(this,!0,dt.from,st)),Bt());break;case"signal":if(dt.signal.type==="offer"){const Pt=At.get(dt.from);if(Pt){const Zt=dt.token,le=Pt.glareToken;if(le&&le>Zt){n("offer rejected: ",dt.from);return}Pt.glareToken=void 0}}if(dt.signal.type==="answer"){n("offer answered by: ",dt.from);const Pt=At.get(dt.from);Pt.glareToken=void 0}dt.to===Ut&&(L.Yu(At,dt.from,()=>new re(this,!1,dt.from,st)).peer.signal(dt.signal),Bt());break}};st.key?typeof J.data=="string"&&Q(a.Gh(J.data),st.key).then(Et):Et(J.data)}}}),this.on("disconnect",()=>n(`disconnect (${H})`))}}class Ee extends it.y{constructor(H,J,{signaling:ot=["wss://y-webrtc-eu.fly.dev"],password:st=null,awareness:Et=new Ht(J),maxConns:dt=20+rt.GW(y.TN()*15),filterBcConns:At=!0,peerOpts:Ut={}}={}){super(),this.roomName=H,this.doc=J,this.filterBcConns=At,this.awareness=Et,this.shouldConnect=!1,this.signalingUrls=ot,this.signalingConns=[],this.maxConns=dt,this.peerOpts=Ut,this.key=st?wt(st,H):E.DB(null),this.room=null,this.key.then(Bt=>{this.room=Xt(J,this,H,Bt),this.shouldConnect?this.room.connect():this.room.disconnect()}),this.connect(),this.destroy=this.destroy.bind(this),J.on("destroy",this.destroy)}get connected(){return this.room!==null&&this.shouldConnect}connect(){this.shouldConnect=!0,this.signalingUrls.forEach(H=>{const J=L.Yu(K,H,()=>new Qt(H));this.signalingConns.push(J),J.providers.add(this)}),this.room&&this.room.connect()}disconnect(){this.shouldConnect=!1,this.signalingConns.forEach(H=>{H.providers.delete(this),H.providers.size===0&&(H.destroy(),K.delete(H.url))}),this.room&&this.room.disconnect()}destroy(){this.doc.off("destroy",this.destroy),this.key.then(()=>{this.room.destroy(),ut.delete(this.roomName)}),super.destroy()}}var Me=$("../../../node_modules/.pnpm/@wordpress+url@4.5.0/node_modules/@wordpress/url/build-module/add-query-args.js");function Le(N,H){N.on("connect",()=>{n(`connected (${H})`);const J=Array.from(ut.keys());N.send({type:"subscribe",topics:J}),ut.forEach(ot=>ee(N,ot,{type:"announce",from:ot.peerId}))}),N.on("message",J=>{switch(J.type){case"publish":{const ot=J.topic,st=ut.get(ot);if(st===null||typeof ot!="string"||st===void 0)return;const Et=dt=>{const At=st.webrtcConns,Ut=st.peerId;if(dt===null||dt.from===Ut||dt.to!==void 0&&dt.to!==Ut||st.bcConns.has(dt.from))return;const Bt=At.has(dt.from)?()=>{}:()=>st.provider.emit("peers",[{removed:[],added:[dt.from],webrtcPeers:Array.from(st.webrtcConns.keys()),bcPeers:Array.from(st.bcConns)}]);switch(dt.type){case"announce":At.size<st.provider.maxConns&&(L.Yu(At,dt.from,()=>new re(N,!0,dt.from,st)),Bt());break;case"signal":if(dt.signal.type==="offer"){const Pt=At.get(dt.from);if(Pt){const Zt=dt.token,le=Pt.glareToken;if(le&&le>Zt){n("offer rejected: ",dt.from);return}Pt.glareToken=void 0}}if(dt.signal.type==="answer"){n("offer answered by: ",dt.from);const Pt=At.get(dt.from);Pt&&(Pt.glareToken=void 0)}dt.to===Ut&&(L.Yu(At,dt.from,()=>new re(N,!1,dt.from,st)).peer.signal(dt.signal),Bt());break}};st.key?typeof J.data=="string"&&Q(a.Gh(J.data),st.key).then(Et):Et(J.data)}}}),N.on("disconnect",()=>n(`disconnect (${H})`))}function tn(N){if(N.shouldConnect&&N.ws===null){const H=Math.floor(1e5+Math.random()*9e5),J=N.url,ot=new window.EventSource((0,Me.f)(J,{subscriber_id:H,action:"gutenberg_signaling_server"}));let st=null;ot.onmessage=Ut=>{N.lastMessageReceived=Date.now();const Bt=Ut.data;if(Bt){const Pt=JSON.parse(Bt);Array.isArray(Pt)&&Pt.forEach(Et)}},N.ws=ot,N.connecting=!0,N.connected=!1;const Et=Ut=>{Ut&&Ut.type==="pong"&&(clearTimeout(st),st=setTimeout(At,Ne/2)),N.emit("message",[Ut,N])},dt=Ut=>{N.ws!==null&&(N.ws.close(),N.ws=null,N.connecting=!1,N.connected?(N.connected=!1,N.emit("disconnect",[{type:"disconnect",error:Ut},N])):N.unsuccessfulReconnects++),clearTimeout(st)},At=()=>{N.ws&&N.ws.readyState===window.EventSource.OPEN&&N.send({type:"ping"})};N.ws&&(N.ws.onclose=()=>{dt(null)},N.ws.send=function(Bt){window.fetch(J,{body:new URLSearchParams({subscriber_id:H.toString(),action:"gutenberg_signaling_server",message:Bt}),method:"POST"}).catch(()=>{n("Error sending to server with message: "+Bt)})}),ot.onerror=()=>{},ot.onopen=()=>{N.connected||ot.readyState===window.EventSource.OPEN&&(N.lastMessageReceived=Date.now(),N.connecting=!1,N.connected=!0,N.unsuccessfulReconnects=0,N.emit("connect",[{type:"connect"},N]),st=setTimeout(At,Ne/2))}}}const Ne=3e4;class en extends it.y{constructor(H){super(),this.url=H,this.ws=null,this.binaryType=null,this.connected=!1,this.connecting=!1,this.unsuccessfulReconnects=0,this.lastMessageReceived=0,this.shouldConnect=!0,this._checkInterval=setInterval(()=>{this.connected&&Ne<Date.now()-this.lastMessageReceived&&this.ws&&this.ws.close()},Ne/2),tn(this),this.providers=new Set,Le(this,H)}send(H){this.ws&&this.ws.send(JSON.stringify(H))}destroy(){clearInterval(this._checkInterval),this.disconnect(),super.destroy()}disconnect(){this.shouldConnect=!1,this.ws!==null&&this.ws.close()}connect(){this.shouldConnect=!0,!this.connected&&this.ws===null&&tn(this)}}class nn extends Ee{connect(){this.shouldConnect=!0,this.signalingUrls.forEach(H=>{const J=L.Yu(K,H,H.startsWith("ws://")||H.startsWith("wss://")?()=>new Qt(H):()=>new en(H));this.signalingConns.push(J),J.providers.add(this)}),this.room&&this.room.connect()}}function Te({signaling:N,password:H}){return function(J,ot,st){const Et=`${ot}-${J}`;return new nn(Et,st,{signaling:N,password:H}),Promise.resolve(()=>!0)}}},"../../../node_modules/.pnpm/@wordpress+sync@1.5.0/node_modules/@wordpress/sync/build-module/provider.js":(Gt,kt,$)=>{"use strict";$.d(kt,{G:()=>ft});var it=$("../../../node_modules/.pnpm/yjs@13.6.18/node_modules/yjs/dist/yjs.mjs");const ft=(rt,x)=>{const I={},b={},g={};function O(d,u){I[d]=u}async function L(d,u,M){const T=new it.QW;g[d]=g[d]||{},g[d][u]=T;const E=()=>{const v=I[d].fromCRDTDoc(T);M(v)};T.on("update",E);const B=await rt(u,d,T);x&&await x(u,d,T);const a=I[d].fetch;a&&a(u).then(v=>{T.transact(()=>{I[d].applyChangesToDoc(T,v)})}),b[d]=b[d]||{},b[d][u]=()=>{B(),T.off("update",E)}}async function h(d,u,M){const T=g[d][u];if(!T)throw"Error doc "+d+" "+u+" not found";T.transact(()=>{I[d].applyChangesToDoc(T,M)})}async function y(d,u){var M;(M=b==null?void 0:b[d])!=null&&M[u]&&b[d][u]()}return{register:O,bootstrap:L,update:h,discard:y}}},"../../../node_modules/.pnpm/@wordpress+undo-manager@1.5.0/node_modules/@wordpress/undo-manager/build-module/index.js":(Gt,kt,$)=>{"use strict";$.d(kt,{U:()=>x});var it=$("../../../node_modules/.pnpm/@wordpress+is-shallow-equal@5.5.0/node_modules/@wordpress/is-shallow-equal/build-module/index.js");function ft(I,b){const g={...I};return Object.entries(b).forEach(([O,L])=>{g[O]?g[O]={...g[O],to:L.to}:g[O]=L}),g}const rt=(I,b)=>{const g=I==null?void 0:I.findIndex(({id:L})=>typeof L=="string"?L===b.id:(0,it.ZP)(L,b.id)),O=[...I];return g!==-1?O[g]={id:b.id,changes:ft(O[g].changes,b.changes)}:O.push(b),O};function x(){let I=[],b=[],g=0;const O=()=>{I=I.slice(0,g||void 0),g=0},L=()=>{var y;const d=I.length===0?0:I.length-1;let u=(y=I[d])!==null&&y!==void 0?y:[];b.forEach(M=>{u=rt(u,M)}),b=[],I[d]=u},h=y=>!y.filter(({changes:u})=>Object.values(u).some(({from:M,to:T})=>typeof M!="function"&&typeof T!="function"&&!(0,it.ZP)(M,T))).length;return{addRecord(y,d=!1){const u=!y||h(y);if(d){if(u)return;y.forEach(M=>{b=rt(b,M)})}else{if(O(),b.length&&L(),u)return;I.push(y)}},undo(){b.length&&(O(),L());const y=I[I.length-1+g];if(y)return g-=1,y},redo(){const y=I[I.length+g];if(y)return g+=1,y},hasUndo(){return!!I[I.length-1+g]},hasRedo(){return!!I[I.length+g]}}}},"../../../node_modules/.pnpm/capital-case@1.0.4/node_modules/capital-case/dist.es2015/index.js":(Gt,kt,$)=>{"use strict";$.d(kt,{I:()=>I});var it=$("../../../node_modules/.pnpm/tslib@2.5.0/node_modules/tslib/tslib.es6.js"),ft=$("../../../node_modules/.pnpm/no-case@3.0.4/node_modules/no-case/dist.es2015/index.js");function rt(b){return b.charAt(0).toUpperCase()+b.substr(1)}function x(b){return rt(b.toLowerCase())}function I(b,g){return g===void 0&&(g={}),(0,ft.B)(b,(0,it.pi)({delimiter:" ",transform:x},g))}},"../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/array.js":(Gt,kt,$)=>{"use strict";$.d(kt,{Dp:()=>I,Z$:()=>it,kJ:()=>d,s7:()=>x});const it=E=>E[E.length-1],ft=()=>[],rt=E=>E.slice(),x=(E,B)=>{for(let a=0;a<B.length;a++)E.push(B[a])},I=Array.from,b=(E,B)=>{for(let a=0;a<E.length;a++)if(!B(E[a],a,E))return!1;return!0},g=(E,B)=>{for(let a=0;a<E.length;a++)if(B(E[a],a,E))return!0;return!1},O=(E,B)=>E.length===B.length&&b(E,(a,v)=>a===B[v]),L=E=>y(E,[],(B,a)=>B.concat(a)),h=(E,B)=>{const a=new Array(E);for(let v=0;v<E;v++)a[v]=B(v,a);return a},y=(E,B,a)=>E.reduce(a,B),d=Array.isArray,u=E=>I(set.from(E)),M=(E,B)=>{const a=set.create(),v=[];for(let m=0;m<E.length;m++){const A=E[m],_=B(A);a.has(_)||(a.add(_),v.push(A))}return v},T=(E,B)=>{const a=Array(E.length);for(let v=0;v<E.length;v++)a[v]=B(E[v],v,E);return a}},"../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/binary.js":(Gt,kt,$)=>{"use strict";$.d(kt,{$2:()=>at,CY:()=>rt,Ko:()=>x,Qn:()=>ft,RP:()=>Nt,Tg:()=>Mt,Vw:()=>it,cq:()=>b,jS:()=>_t,kr:()=>et,rc:()=>g,x1:()=>O});const it=1,ft=2,rt=4,x=8,I=16,b=32,g=64,O=128,L=256,h=512,y=1024,d=2048,u=4096,M=8192,T=16384,E=32768,B=65536,a=1<<17,v=1<<18,m=1<<19,A=1<<20,_=1<<21,R=1<<22,Y=1<<23,U=1<<24,P=1<<25,Z=1<<26,lt=1<<27,bt=1<<28,Ct=1<<29,Tt=1<<30,It=null,Lt=0,St=1,ne=3,Jt=7,ct=15,et=31,at=63,_t=127,vt=255,Ot=511,Ht=1023,te=2047,Ft=4095,ie=8191,G=16383,tt=32767,wt=65535,V=a-1,w=v-1,k=m-1,Q=A-1,pt=_-1,n=R-1,s=Y-1,c=U-1,C=P-1,z=Z-1,K=lt-1,ut=bt-1,Rt=Ct-1,Yt=Tt-1,Nt=2147483647,Mt=4294967295},"../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/buffer.js":(Gt,kt,$)=>{"use strict";$.d(kt,{Gh:()=>y,eh:()=>I,f9:()=>E,s3:()=>h});var it=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/string.js"),ft=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/environment.js");const rt=m=>new Uint8Array(m),x=(m,A,_)=>new Uint8Array(m,A,_),I=m=>new Uint8Array(m),b=m=>{let A="";for(let _=0;_<m.byteLength;_++)A+=it.IK(m[_]);return btoa(A)},g=m=>Buffer.from(m.buffer,m.byteOffset,m.byteLength).toString("base64"),O=m=>{const A=atob(m),_=rt(A.length);for(let R=0;R<A.length;R++)_[R]=A.charCodeAt(R);return _},L=m=>{const A=Buffer.from(m,"base64");return x(A.buffer,A.byteOffset,A.byteLength)},h=ft.jU?b:g,y=ft.jU?O:L,d=m=>h(m).replaceAll("+","-").replaceAll("/","_").replaceAll("=",""),u=m=>y(m.replaceAll("-","+").replaceAll("_","/")),M=m=>array.map(m,A=>A.toString(16).padStart(2,"0")).join(""),T=m=>{const A=m.length,_=new Uint8Array(math.ceil(A/2));for(let R=0;R<A;R+=2)_[_.length-R/2-1]=Number.parseInt(m.slice(A-R-2,A-R),16);return _},E=m=>{const A=rt(m.byteLength);return A.set(m),A},B=m=>encoding.encode(A=>encoding.writeAny(A,m)),a=m=>decoding.readAny(decoding.createDecoder(m)),v=(m,A)=>{if(A===0)return m;m=new Uint8Array(m),m[0]<<=A;for(let _=1;_<m.length;_++)m[_-1]|=m[_]>>>8-A,m[_]<<=A;return m}},"../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/decoding.js":(Gt,kt,$)=>{"use strict";$.d(kt,{HN:()=>u,UF:()=>Ht,XW:()=>_t,dD:()=>Ft,kf:()=>bt,kj:()=>E,l1:()=>L,sO:()=>ie,v_:()=>at,yg:()=>R});var it=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/binary.js"),ft=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/math.js"),rt=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/number.js"),x=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/string.js"),I=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/error.js");const b=I.Ue("Unexpected end of array"),g=I.Ue("Integer out of Range");class O{constructor(tt){this.arr=tt,this.pos=0}}const L=G=>new O(G),h=G=>G.pos!==G.arr.length,y=(G,tt=G.pos)=>{const wt=L(G.arr);return wt.pos=tt,wt},d=(G,tt)=>{const wt=new Uint8Array(G.arr.buffer,G.pos+G.arr.byteOffset,tt);return G.pos+=tt,wt},u=G=>d(G,R(G)),M=G=>d(G,G.arr.length-G.pos),T=G=>G.pos++,E=G=>G.arr[G.pos++],B=G=>{const tt=G.arr[G.pos]+(G.arr[G.pos+1]<<8);return G.pos+=2,tt},a=G=>{const tt=G.arr[G.pos]+(G.arr[G.pos+1]<<8)+(G.arr[G.pos+2]<<16)+(G.arr[G.pos+3]<<24)>>>0;return G.pos+=4,tt},v=G=>{const tt=G.arr[G.pos+3]+(G.arr[G.pos+2]<<8)+(G.arr[G.pos+1]<<16)+(G.arr[G.pos]<<24)>>>0;return G.pos+=4,tt},m=G=>G.arr[G.pos],A=G=>G.arr[G.pos]+(G.arr[G.pos+1]<<8),_=G=>G.arr[G.pos]+(G.arr[G.pos+1]<<8)+(G.arr[G.pos+2]<<16)+(G.arr[G.pos+3]<<24)>>>0,R=G=>{let tt=0,wt=1;const V=G.arr.length;for(;G.pos<V;){const w=G.arr[G.pos++];if(tt=tt+(w&it.jS)*wt,wt*=128,w<it.x1)return tt;if(tt>rt.YM)throw g}throw b},Y=G=>{let tt=G.arr[G.pos++],wt=tt&it.$2,V=64;const w=(tt&it.rc)>0?-1:1;if(!(tt&it.x1))return w*wt;const k=G.arr.length;for(;G.pos<k;){if(tt=G.arr[G.pos++],wt=wt+(tt&it.jS)*V,V*=128,tt<it.x1)return w*wt;if(wt>rt.YM)throw g}throw b},U=G=>{const tt=G.pos,wt=R(G);return G.pos=tt,wt},P=G=>{const tt=G.pos,wt=Y(G);return G.pos=tt,wt},Z=G=>{let tt=R(G);if(tt===0)return"";{let wt=String.fromCodePoint(E(G));if(--tt<100)for(;tt--;)wt+=String.fromCodePoint(E(G));else for(;tt>0;){const V=tt<1e4?tt:1e4,w=G.arr.subarray(G.pos,G.pos+V);G.pos+=V,wt+=String.fromCodePoint.apply(null,w),tt-=V}return decodeURIComponent(escape(wt))}},lt=G=>x.CO.decode(u(G)),bt=x.CO?lt:Z,Ct=G=>{const tt=encoding.createEncoder();let wt;for(;;){if(wt=E(G),wt===0)return encoding.toUint8Array(tt);wt===1&&(wt=E(G)),encoding.write(tt,wt)}},Tt=G=>string.decodeUtf8(Ct(G)),It=G=>{const tt=G.pos,wt=bt(G);return G.pos=tt,wt},Lt=(G,tt)=>{const wt=new DataView(G.arr.buffer,G.arr.byteOffset+G.pos,tt);return G.pos+=tt,wt},St=G=>Lt(G,4).getFloat32(0,!1),ne=G=>Lt(G,8).getFloat64(0,!1),Jt=G=>Lt(G,8).getBigInt64(0,!1),ct=G=>Lt(G,8).getBigUint64(0,!1),et=[G=>{},G=>null,Y,St,ne,Jt,G=>!1,G=>!0,bt,G=>{const tt=R(G),wt={};for(let V=0;V<tt;V++){const w=bt(G);wt[w]=at(G)}return wt},G=>{const tt=R(G),wt=[];for(let V=0;V<tt;V++)wt.push(at(G));return wt},u],at=G=>et[127-E(G)](G);class _t extends O{constructor(tt,wt){super(tt),this.reader=wt,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),h(this)?this.count=R(this)+1:this.count=-1),this.count--,this.s}}class vt extends null{constructor(tt,wt){super(tt),this.s=wt}read(){return this.s+=Y(this),this.s}}class Ot extends null{constructor(tt,wt){super(tt),this.s=wt,this.count=0}read(){return this.count===0&&(this.s+=Y(this),h(this)?this.count=R(this)+1:this.count=-1),this.count--,this.s}}class Ht extends O{constructor(tt){super(tt),this.s=0,this.count=0}read(){if(this.count===0){this.s=Y(this);const tt=ft.GR(this.s);this.count=1,tt&&(this.s=-this.s,this.count=R(this)+2)}return this.count--,this.s}}class te extends null{constructor(tt){super(tt),this.s=0,this.count=0}read(){if(this.count===0){this.s=Y(this);const tt=math.isNegativeZero(this.s);this.count=1,tt&&(this.s=-this.s,this.count=R(this)+2)}return this.count--,this.s++}}class Ft extends O{constructor(tt){super(tt),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const tt=Y(this),wt=tt&1;this.diff=ft.GW(tt/2),this.count=1,wt&&(this.count=R(this)+2)}return this.s+=this.diff,this.count--,this.s}}class ie{constructor(tt){this.decoder=new Ht(tt),this.str=bt(this.decoder),this.spos=0}read(){const tt=this.spos+this.decoder.read(),wt=this.str.slice(this.spos,tt);return this.spos=tt,wt}}},"../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/encoding.js":(Gt,kt,$)=>{"use strict";$.d(kt,{$F:()=>T,EM:()=>vt,GF:()=>Ot,HE:()=>ie,HK:()=>It,Mf:()=>g,TS:()=>V,_f:()=>y,mP:()=>Lt,sX:()=>wt,uE:()=>_,uw:()=>lt});var it=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/math.js"),ft=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/number.js"),rt=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/binary.js"),x=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/string.js"),I=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/array.js");class b{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const g=()=>new b,O=w=>{const k=g();return w(k),y(k)},L=w=>{let k=w.cpos;for(let Q=0;Q<w.bufs.length;Q++)k+=w.bufs[Q].length;return k},h=w=>w.cpos>0||w.bufs.length>0,y=w=>{const k=new Uint8Array(L(w));let Q=0;for(let pt=0;pt<w.bufs.length;pt++){const n=w.bufs[pt];k.set(n,Q),Q+=n.length}return k.set(new Uint8Array(w.cbuf.buffer,0,w.cpos),Q),k},d=(w,k)=>{const Q=w.cbuf.length;Q-w.cpos<k&&(w.bufs.push(new Uint8Array(w.cbuf.buffer,0,w.cpos)),w.cbuf=new Uint8Array(it.Fp(Q,k)*2),w.cpos=0)},u=(w,k)=>{const Q=w.cbuf.length;w.cpos===Q&&(w.bufs.push(w.cbuf),w.cbuf=new Uint8Array(Q*2),w.cpos=0),w.cbuf[w.cpos++]=k},M=(w,k,Q)=>{let pt=null;for(let n=0;n<w.bufs.length&&pt===null;n++){const s=w.bufs[n];k<s.length?pt=s:k-=s.length}pt===null&&(pt=w.cbuf),pt[k]=Q},T=u,E=null,B=(w,k)=>{u(w,k&binary.BITS8),u(w,k>>>8&binary.BITS8)},a=(w,k,Q)=>{M(w,k,Q&binary.BITS8),M(w,k+1,Q>>>8&binary.BITS8)},v=(w,k)=>{for(let Q=0;Q<4;Q++)u(w,k&binary.BITS8),k>>>=8},m=(w,k)=>{for(let Q=3;Q>=0;Q--)u(w,k>>>8*Q&binary.BITS8)},A=(w,k,Q)=>{for(let pt=0;pt<4;pt++)M(w,k+pt,Q&binary.BITS8),Q>>>=8},_=(w,k)=>{for(;k>rt.jS;)u(w,rt.x1|rt.jS&k),k=it.GW(k/128);u(w,rt.jS&k)},R=(w,k)=>{const Q=it.GR(k);for(Q&&(k=-k),u(w,(k>rt.$2?rt.x1:0)|(Q?rt.rc:0)|rt.$2&k),k=it.GW(k/64);k>0;)u(w,(k>rt.jS?rt.x1:0)|rt.jS&k),k=it.GW(k/128)},Y=new Uint8Array(3e4),U=Y.length/3,P=(w,k)=>{if(k.length<U){const Q=x.YZ.encodeInto(k,Y).written||0;_(w,Q);for(let pt=0;pt<Q;pt++)u(w,Y[pt])}else Lt(w,x.lz(k))},Z=(w,k)=>{const Q=unescape(encodeURIComponent(k)),pt=Q.length;_(w,pt);for(let n=0;n<pt;n++)u(w,Q.codePointAt(n))},lt=x.YZ&&x.YZ.encodeInto?P:Z,bt=(w,k)=>Ct(w,string.encodeUtf8(k)),Ct=(w,k)=>{for(let Q=0;Q<k.length;Q++){const pt=k[Q];(pt===0||pt===1)&&u(w,1),u(w,k[Q])}u(w,0)},Tt=(w,k)=>It(w,y(k)),It=(w,k)=>{const Q=w.cbuf.length,pt=w.cpos,n=it.VV(Q-pt,k.length),s=k.length-n;w.cbuf.set(k.subarray(0,n),pt),w.cpos+=n,s>0&&(w.bufs.push(w.cbuf),w.cbuf=new Uint8Array(it.Fp(Q*2,s)),w.cbuf.set(k.subarray(n)),w.cpos=s)},Lt=(w,k)=>{_(w,k.byteLength),It(w,k)},St=(w,k)=>{d(w,k);const Q=new DataView(w.cbuf.buffer,w.cpos,k);return w.cpos+=k,Q},ne=(w,k)=>St(w,4).setFloat32(0,k,!1),Jt=(w,k)=>St(w,8).setFloat64(0,k,!1),ct=(w,k)=>St(w,8).setBigInt64(0,k,!1),et=(w,k)=>St(w,8).setBigUint64(0,k,!1),at=new DataView(new ArrayBuffer(4)),_t=w=>(at.setFloat32(0,w),at.getFloat32(0)===w),vt=(w,k)=>{switch(typeof k){case"string":u(w,119),lt(w,k);break;case"number":ft.U(k)&&it.Wn(k)<=rt.RP?(u(w,125),R(w,k)):_t(k)?(u(w,124),ne(w,k)):(u(w,123),Jt(w,k));break;case"bigint":u(w,122),ct(w,k);break;case"object":if(k===null)u(w,126);else if(I.kJ(k)){u(w,117),_(w,k.length);for(let Q=0;Q<k.length;Q++)vt(w,k[Q])}else if(k instanceof Uint8Array)u(w,116),Lt(w,k);else{u(w,118);const Q=Object.keys(k);_(w,Q.length);for(let pt=0;pt<Q.length;pt++){const n=Q[pt];lt(w,n),vt(w,k[n])}}break;case"boolean":u(w,k?120:121);break;default:u(w,127)}};class Ot extends b{constructor(k){super(),this.w=k,this.s=null,this.count=0}write(k){this.s===k?this.count++:(this.count>0&&_(this,this.count-1),this.count=1,this.w(this,k),this.s=k)}}class Ht extends null{constructor(k){super(),this.s=k}write(k){R(this,k-this.s),this.s=k}}class te extends null{constructor(k){super(),this.s=k,this.count=0}write(k){this.s===k&&this.count>0?this.count++:(this.count>0&&_(this,this.count-1),this.count=1,R(this,k-this.s),this.s=k)}}const Ft=w=>{w.count>0&&(R(w.encoder,w.count===1?w.s:-w.s),w.count>1&&_(w.encoder,w.count-2))};class ie{constructor(){this.encoder=new b,this.s=0,this.count=0}write(k){this.s===k?this.count++:(Ft(this),this.count=1,this.s=k)}toUint8Array(){return Ft(this),y(this.encoder)}}class G{constructor(){this.encoder=new b,this.s=0,this.count=0}write(k){this.s+this.count===k?this.count++:(Ft(this),this.count=1,this.s=k)}toUint8Array(){return Ft(this),y(this.encoder)}}const tt=w=>{if(w.count>0){const k=w.diff*2+(w.count===1?0:1);R(w.encoder,k),w.count>1&&_(w.encoder,w.count-2)}};class wt{constructor(){this.encoder=new b,this.s=0,this.count=0,this.diff=0}write(k){this.diff===k-this.s?(this.s=k,this.count++):(tt(this),this.count=1,this.diff=k-this.s,this.s=k)}toUint8Array(){return tt(this),y(this.encoder)}}class V{constructor(){this.sarr=[],this.s="",this.lensE=new ie}write(k){this.s+=k,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(k.length)}toUint8Array(){const k=new b;return this.sarr.push(this.s),this.s="",lt(k,this.sarr.join("")),It(k,this.lensE.toUint8Array()),y(k)}}},"../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/environment.js":(Gt,kt,$)=>{"use strict";$.d(kt,{E0:()=>T,jU:()=>O,hH:()=>A});var it=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/map.js"),ft=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/string.js");const rt=_=>_===void 0?null:_;var x=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/storage.js"),I=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/function.js"),b=$("../../../node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js");const g=typeof b!="undefined"&&b.release&&/node|io\.js/.test(b.release.name)&&Object.prototype.toString.call(typeof b!="undefined"?b:0)==="[object process]",O=typeof window!="undefined"&&typeof document!="undefined"&&!g,L=typeof navigator!="undefined"?/Mac/.test(navigator.platform):!1;let h;const y=[],d=()=>{if(h===void 0)if(g){h=it.Ue();const _=b.argv;let R=null;for(let Y=0;Y<_.length;Y++){const U=_[Y];U[0]==="-"?(R!==null&&h.set(R,""),R=U):R!==null?(h.set(R,U),R=null):y.push(U)}R!==null&&h.set(R,"")}else typeof location=="object"?(h=it.Ue(),(location.search||"?").slice(1).split("&").forEach(_=>{if(_.length!==0){const[R,Y]=_.split("=");h.set(`--${ft.NF(R,"-")}`,Y),h.set(`-${ft.NF(R,"-")}`,Y)}})):h=it.Ue();return h},u=_=>d().has(_),M=(_,R)=>d().get(_)||R,T=_=>rt(g?b.env[_.toUpperCase().replaceAll("-","_")]:x.XN.getItem(_)),E=_=>d().get("--"+_)||T(_),B=_=>{const R=E(_);if(R==null)throw new Error(`Expected configuration "${_.toUpperCase().replaceAll("-","_")}"`);return R},a=_=>u("--"+_)||T(_)!==null,v=a("production"),A=g&&I.gB(b.env.FORCE_COLOR,["true","1","2"])||!u("--no-colors")&&!a("no-color")&&(!g||b.stdout.isTTY)&&(!g||u("--color")||T("COLORTERM")!==null||(T("TERM")||"").includes("color"))},"../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/error.js":(Gt,kt,$)=>{"use strict";$.d(kt,{Nw:()=>ft,Ue:()=>it,zR:()=>rt});const it=x=>new Error(x),ft=()=>{throw it("Method unimplemented")},rt=()=>{throw it("Unexpected case")}},"../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/function.js":(Gt,kt,$)=>{"use strict";$.d(kt,{Hi:()=>L,PP:()=>rt,WY:()=>x,gB:()=>h,id:()=>b});var it=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/array.js"),ft=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/object.js");const rt=(E,B,a=0)=>{try{for(;a<E.length;a++)E[a](...B)}finally{a<E.length&&rt(E,B,a+1)}},x=()=>{},I=E=>E(),b=E=>E,g=(E,B)=>E===B,O=(E,B)=>E===B||E!=null&&B!=null&&E.constructor===B.constructor&&(array.isArray(E)&&array.equalFlat(E,B)||typeof E=="object"&&object.equalFlat(E,B)),L=(E,B)=>{if(E==null||B==null)return g(E,B);if(E.constructor!==B.constructor)return!1;if(E===B)return!0;switch(E.constructor){case ArrayBuffer:E=new Uint8Array(E),B=new Uint8Array(B);case Uint8Array:{if(E.byteLength!==B.byteLength)return!1;for(let a=0;a<E.length;a++)if(E[a]!==B[a])return!1;break}case Set:{if(E.size!==B.size)return!1;for(const a of E)if(!B.has(a))return!1;break}case Map:{if(E.size!==B.size)return!1;for(const a of E.keys())if(!B.has(a)||!L(E.get(a),B.get(a)))return!1;break}case Object:if(ft.kE(E)!==ft.kE(B))return!1;for(const a in E)if(!ft.l$(E,a)||!L(E[a],B[a]))return!1;break;case Array:if(E.length!==B.length)return!1;for(let a=0;a<E.length;a++)if(!L(E[a],B[a]))return!1;break;default:return!1}return!0},h=(E,B)=>B.includes(E),y=it.kJ,d=E=>E&&E.constructor===String,u=E=>E!=null&&E.constructor===Number,M=(E,B)=>E&&E.constructor===B,T=E=>B=>B&&B.constructor===E},"../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/logging.common.js":(Gt,kt,$)=>{"use strict";$.d(kt,{Ej:()=>h,Pl:()=>O,ZA:()=>d,s7:()=>y,ud:()=>T,Wd:()=>M,hM:()=>u,YW:()=>L,WO:()=>E,_X:()=>B,YX:()=>A});const it=Symbol,ft=_=>typeof _=="symbol";var rt=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/time.js"),x=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/environment.js"),I=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/function.js");const b=JSON.stringify,g=JSON.parse,O=it(),L=it(),h=it(),y=it(),d=it(),u=it(),M=it(),T=it(),E=it(),B=_=>{var P;_.length===1&&((P=_[0])==null?void 0:P.constructor)===Function&&(_=_[0]());const R=[],Y=[];let U=0;for(;U<_.length;U++){const Z=_[U];if(Z===void 0)break;if(Z.constructor===String||Z.constructor===Number)R.push(Z);else if(Z.constructor===Object)break}for(U>0&&Y.push(R.join(""));U<_.length;U++){const Z=_[U];Z instanceof Symbol||Y.push(Z)}return Y},a=[d,M,T,h];let v=0,m=rt.ZG();const A=(_,R)=>{const Y=a[v],U=x.E0("log"),P=U!==null&&(U==="*"||U==="true"||new RegExp(U,"gi").test(R));return v=(v+1)%a.length,R+=": ",P?(...Z)=>{var Ct;Z.length===1&&((Ct=Z[0])==null?void 0:Ct.constructor)===Function&&(Z=Z[0]());const lt=rt.ZG(),bt=lt-m;m=lt,_(Y,R,E,...Z.map(Tt=>{switch(Tt!=null&&Tt.constructor===Uint8Array&&(Tt=Array.from(Tt)),typeof Tt){case"string":case"symbol":return Tt;default:return b(Tt)}}),Y," +"+bt+"ms")}:I.WY}},"../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/logging.js":(Gt,kt,$)=>{"use strict";$.d(kt,{YX:()=>re,S0:()=>k});var it=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/environment.js"),ft=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/set.js");class rt{constructor(nt,yt){this.left=nt,this.right=yt}}const x=(X,nt)=>new rt(X,nt),I=(X,nt)=>new rt(nt,X),b=(X,nt)=>X.forEach(yt=>nt(yt.left,yt.right)),g=(X,nt)=>X.map(yt=>nt(yt.left,yt.right));var O=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/map.js");const L=typeof document!="undefined"?document:{},h=X=>L.createElement(X),y=()=>L.createDocumentFragment(),d=X=>L.createTextNode(X),u=typeof DOMParser!="undefined"?new DOMParser:null,M=(X,nt,yt)=>X.dispatchEvent(new CustomEvent(nt,yt)),T=(X,nt)=>(pair.forEach(nt,(yt,gt)=>{gt===!1?X.removeAttribute(yt):gt===!0?X.setAttribute(yt,""):X.setAttribute(yt,gt)}),X),E=(X,nt)=>(nt.forEach((yt,gt)=>{X.setAttribute(gt,yt)}),X),B=X=>{const nt=y();for(let yt=0;yt<X.length;yt++)et(nt,X[yt]);return nt},a=(X,nt)=>(et(X,B(nt)),X),v=X=>X.remove(),m=(X,nt,yt)=>X.addEventListener(nt,yt),A=(X,nt,yt)=>X.removeEventListener(nt,yt),_=(X,nt)=>(pair.forEach(nt,(yt,gt)=>m(X,yt,gt)),X),R=(X,nt)=>(pair.forEach(nt,(yt,gt)=>A(X,yt,gt)),X),Y=(X,nt=[],yt=[])=>a(T(h(X),nt),yt),U=(X,nt)=>{const yt=h("canvas");return yt.height=nt,yt.width=X,yt},P=null,Z=X=>`${X.left}:${X.right};`,lt=X=>X.map(Z).join(""),bt=X=>O.UI(X,(nt,yt)=>`${yt}:${nt};`).join(""),Ct=(X,nt)=>X.querySelector(nt),Tt=(X,nt)=>X.querySelectorAll(nt),It=X=>L.getElementById(X),Lt=X=>u.parseFromString(`<html><body>${X}</body></html>`,"text/html").body,St=X=>B(Lt(X).childNodes),ne=X=>Lt(X).firstElementChild,Jt=(X,nt)=>X.replaceWith(nt),ct=(X,nt,yt)=>X.insertBefore(nt,yt),et=(X,nt)=>X.appendChild(nt),at=L.ELEMENT_NODE,_t=L.TEXT_NODE,vt=L.CDATA_SECTION_NODE,Ot=L.COMMENT_NODE,Ht=L.DOCUMENT_NODE,te=L.DOCUMENT_TYPE_NODE,Ft=L.DOCUMENT_FRAGMENT_NODE,ie=(X,nt)=>X.nodeType===nt,G=(X,nt)=>{let yt=nt.parentNode;for(;yt&&yt!==X;)yt=yt.parentNode;return yt===X};var tt=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/logging.common.js");const wt={[tt.Pl]:x("font-weight","bold"),[tt.YW]:x("font-weight","normal"),[tt.Ej]:x("color","blue"),[tt.ZA]:x("color","green"),[tt.s7]:x("color","grey"),[tt.hM]:x("color","red"),[tt.Wd]:x("color","purple"),[tt.ud]:x("color","orange"),[tt.WO]:x("color","black")},V=X=>{var ee;X.length===1&&((ee=X[0])==null?void 0:ee.constructor)===Function&&(X=X[0]());const nt=[],yt=[],gt=O.Ue();let Vt=[],Xt=0;for(;Xt<X.length;Xt++){const Qt=X[Xt],Ee=wt[Qt];if(Ee!==void 0)gt.set(Ee.left,Ee.right);else{if(Qt===void 0)break;if(Qt.constructor===String||Qt.constructor===Number){const Me=bt(gt);Xt>0||Me.length>0?(nt.push("%c"+Qt),yt.push(Me)):nt.push(Qt)}else break}}for(Xt>0&&(Vt=yt,Vt.unshift(nt.join("")));Xt<X.length;Xt++){const Qt=X[Xt];Qt instanceof Symbol||Vt.push(Qt)}return Vt},w=it.hH?V:tt._X,k=(...X)=>{console.log(...w(X)),Rt.forEach(nt=>nt.print(X))},Q=(...X)=>{console.warn(...w(X)),X.unshift(common.ORANGE),Rt.forEach(nt=>nt.print(X))},pt=X=>{console.error(X),Rt.forEach(nt=>nt.printError(X))},n=(X,nt)=>{env.isBrowser&&console.log("%c                      ",`font-size: ${nt}px; background-size: contain; background-repeat: no-repeat; background-image: url(${X})`),Rt.forEach(yt=>yt.printImg(X,nt))},s=(X,nt)=>n(`data:image/gif;base64,${X}`,nt),c=(...X)=>{console.group(...w(X)),Rt.forEach(nt=>nt.group(X))},C=(...X)=>{console.groupCollapsed(...w(X)),Rt.forEach(nt=>nt.groupCollapsed(X))},z=()=>{console.groupEnd(),Rt.forEach(X=>X.groupEnd())},K=X=>Rt.forEach(nt=>nt.printDom(X())),ut=(X,nt)=>n(X.toDataURL(),nt),Rt=ft.Ue(),Yt=X=>{const nt=[],yt=new Map;let gt=0;for(;gt<X.length;gt++){let Vt=X[gt];const Xt=wt[Vt];if(Xt!==void 0)yt.set(Xt.left,Xt.right);else if(Vt===void 0&&(Vt="undefined "),Vt.constructor===String||Vt.constructor===Number){const ee=dom.element("span",[pair.create("style",dom.mapToStyleString(yt))],[dom.text(Vt.toString())]);ee.innerHTML===""&&(ee.innerHTML="&nbsp;"),nt.push(ee)}else break}for(;gt<X.length;gt++){let Vt=X[gt];Vt instanceof Symbol||(Vt.constructor!==String&&Vt.constructor!==Number&&(Vt=" "+json.stringify(Vt)+" "),nt.push(dom.element("span",[],[dom.text(Vt)])))}return nt},Nt="font-family:monospace;border-bottom:1px solid #e2e2e2;padding:2px;";class Mt{constructor(nt){this.dom=nt,this.ccontainer=this.dom,this.depth=0,Rt.add(this)}group(nt,yt=!1){eventloop.enqueue(()=>{const gt=dom.element("span",[pair.create("hidden",yt),pair.create("style","color:grey;font-size:120%;")],[dom.text("\u25BC")]),Vt=dom.element("span",[pair.create("hidden",!yt),pair.create("style","color:grey;font-size:125%;")],[dom.text("\u25B6")]),Xt=dom.element("div",[pair.create("style",`${Nt};padding-left:${this.depth*10}px`)],[gt,Vt,dom.text(" ")].concat(Yt(nt))),ee=dom.element("div",[pair.create("hidden",yt)]),Qt=dom.element("div",[],[Xt,ee]);dom.append(this.ccontainer,[Qt]),this.ccontainer=ee,this.depth++,dom.addEventListener(Xt,"click",Ee=>{ee.toggleAttribute("hidden"),gt.toggleAttribute("hidden"),Vt.toggleAttribute("hidden")})})}groupCollapsed(nt){this.group(nt,!0)}groupEnd(){eventloop.enqueue(()=>{this.depth>0&&(this.depth--,this.ccontainer=this.ccontainer.parentElement.parentElement)})}print(nt){eventloop.enqueue(()=>{dom.append(this.ccontainer,[dom.element("div",[pair.create("style",`${Nt};padding-left:${this.depth*10}px`)],Yt(nt))])})}printError(nt){this.print([common.RED,common.BOLD,nt.toString()])}printImg(nt,yt){eventloop.enqueue(()=>{dom.append(this.ccontainer,[dom.element("img",[pair.create("src",nt),pair.create("height",`${math.round(yt*1.5)}px`)])])})}printDom(nt){eventloop.enqueue(()=>{dom.append(this.ccontainer,[nt])})}destroy(){eventloop.enqueue(()=>{Rt.delete(this)})}}const xt=X=>new Mt(X),re=X=>tt.YX(k,X)},"../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/map.js":(Gt,kt,$)=>{"use strict";$.d(kt,{JG:()=>ft,UI:()=>x,Ue:()=>it,Yj:()=>I,Yu:()=>rt});const it=()=>new Map,ft=g=>{const O=it();return g.forEach((L,h)=>{O.set(h,L)}),O},rt=(g,O,L)=>{let h=g.get(O);return h===void 0&&g.set(O,h=L()),h},x=(g,O)=>{const L=[];for(const[h,y]of g)L.push(O(y,h));return L},I=(g,O)=>{for(const[L,h]of g)if(O(h,L))return!0;return!1},b=(g,O)=>{for(const[L,h]of g)if(!O(h,L))return!1;return!0}},"../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/math.js":(Gt,kt,$)=>{"use strict";$.d(kt,{Fp:()=>d,GR:()=>B,GW:()=>it,VV:()=>y,Wn:()=>rt,mv:()=>b});const it=Math.floor,ft=Math.ceil,rt=Math.abs,x=Math.imul,I=Math.round,b=Math.log10,g=Math.log2,O=Math.log,L=Math.sqrt,h=(a,v)=>a+v,y=(a,v)=>a<v?a:v,d=(a,v)=>a>v?a:v,u=Number.isNaN,M=Math.pow,T=a=>Math.pow(10,a),E=Math.sign,B=a=>a!==0?a<0:1/a<0},"../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/number.js":(Gt,kt,$)=>{"use strict";$.d(kt,{U:()=>O,YM:()=>rt});var it=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/math.js"),ft=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/binary.js");const rt=Number.MAX_SAFE_INTEGER,x=Number.MIN_SAFE_INTEGER,I=null,b=ft.RP,g=ft.Tg,O=Number.isInteger||(d=>typeof d=="number"&&isFinite(d)&&it.GW(d)===d),L=Number.isNaN,h=Number.parseInt,y=d=>{d&=binary.BITS32;let u=0;for(;d;)d&=d-1,u++;return u}},"../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/object.js":(Gt,kt,$)=>{"use strict";$.d(kt,{$m:()=>d,Ed:()=>x,f0:()=>ft,kE:()=>b,l$:()=>y,xb:()=>L});const it=()=>Object.create(null),ft=Object.assign,rt=Object.keys,x=(u,M)=>{for(const T in u)M(u[T],T)},I=(u,M)=>{const T=[];for(const E in u)T.push(M(u[E],E));return T},b=u=>rt(u).length,g=u=>rt(u).length,O=(u,M)=>{for(const T in u)if(M(u[T],T))return!0;return!1},L=u=>{for(const M in u)return!1;return!0},h=(u,M)=>{for(const T in u)if(!M(u[T],T))return!1;return!0},y=(u,M)=>Object.prototype.hasOwnProperty.call(u,M),d=(u,M)=>u===M||g(u)===g(M)&&h(u,(T,E)=>(T!==void 0||y(M,E))&&M[E]===T)},"../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/observable.js":(Gt,kt,$)=>{"use strict";$.d(kt,{g:()=>x,y:()=>I});var it=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/map.js"),ft=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/set.js"),rt=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/array.js");class x{constructor(){this._observers=it.Ue()}on(g,O){return it.Yu(this._observers,g,ft.Ue).add(O),O}once(g,O){const L=(...h)=>{this.off(g,L),O(...h)};this.on(g,L)}off(g,O){const L=this._observers.get(g);L!==void 0&&(L.delete(O),L.size===0&&this._observers.delete(g))}emit(g,O){return rt.Dp((this._observers.get(g)||it.Ue()).values()).forEach(L=>L(...O))}destroy(){this._observers=it.Ue()}}class I{constructor(){this._observers=it.Ue()}on(g,O){it.Yu(this._observers,g,ft.Ue).add(O)}once(g,O){const L=(...h)=>{this.off(g,L),O(...h)};this.on(g,L)}off(g,O){const L=this._observers.get(g);L!==void 0&&(L.delete(O),L.size===0&&this._observers.delete(g))}emit(g,O){return rt.Dp((this._observers.get(g)||it.Ue()).values()).forEach(L=>L(...O))}destroy(){this._observers=it.Ue()}}},"../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/promise.js":(Gt,kt,$)=>{"use strict";$.d(kt,{DB:()=>I,Ue:()=>it,d1:()=>x});const it=y=>new Promise(y),ft=y=>new Promise(y),rt=Promise.all.bind(Promise),x=y=>Promise.reject(y),I=y=>Promise.resolve(y),b=y=>Promise.resolve(y),g=(y,d,u=10)=>it((M,T)=>{const E=time.getUnixTime(),B=y>0,v=setInterval(()=>{d()?(clearInterval(v),M()):B&&time.getUnixTime()-E>y&&(clearInterval(v),T(new Error("Timeout")))},u)}),O=async(y,d=0,u=10)=>{const M=time.getUnixTime(),T=d<=0;for(;T||time.getUnixTime()-M<=d;){if(await y())return;await L(u)}throw new Error("Timeout")},L=y=>it((d,u)=>setTimeout(d,y)),h=y=>y instanceof Promise||y&&y.then&&y.catch&&y.finally},"../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/random.js":(Gt,kt,$)=>{"use strict";$.d(kt,{TN:()=>rt,U7:()=>x,k$:()=>O});const it=crypto.subtle,ft=crypto.getRandomValues.bind(crypto),rt=Math.random,x=()=>ft(new Uint32Array(1))[0],I=()=>{const L=getRandomValues(new Uint32Array(8));return(L[0]&binary.BITS21)*(binary.BITS32+1)+(L[1]>>>0)},b=L=>L[math.floor(rt()*L.length)],g=[1e7]+-1e3+-4e3+-8e3+-1e11,O=()=>g.replace(/[018]/g,L=>(L^x()&15>>L/4).toString(16))},"../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/set.js":(Gt,kt,$)=>{"use strict";$.d(kt,{Ue:()=>it});const it=()=>new Set,ft=I=>Array.from(I),rt=I=>{var b;return(b=I.values().next().value)!=null?b:void 0},x=I=>new Set(I)},"../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/storage.js":(Gt,kt,$)=>{"use strict";$.d(kt,{F:()=>b,XN:()=>x,z2:()=>I});class it{constructor(){this.map=new Map}setItem(O,L){this.map.set(O,L)}getItem(O){return this.map.get(O)}}let ft=new it,rt=!0;try{typeof localStorage!="undefined"&&localStorage&&(ft=localStorage,rt=!1)}catch(g){}const x=ft,I=g=>rt||addEventListener("storage",g),b=g=>rt||removeEventListener("storage",g)},"../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/string.js":(Gt,kt,$)=>{"use strict";$.d(kt,{CO:()=>T,IK:()=>it,NF:()=>O,YZ:()=>y,lz:()=>u});const it=String.fromCharCode,ft=String.fromCodePoint,rt=it(65535),x=m=>m.toLowerCase(),I=/^\s*/g,b=m=>m.replace(I,""),g=/([A-Z])/g,O=(m,A)=>b(m.replace(g,_=>`${A}${x(_)}`)),L=m=>unescape(encodeURIComponent(m)).length,h=m=>{const A=unescape(encodeURIComponent(m)),_=A.length,R=new Uint8Array(_);for(let Y=0;Y<_;Y++)R[Y]=A.codePointAt(Y);return R},y=typeof TextEncoder!="undefined"?new TextEncoder:null,u=y?m=>y.encode(m):h,M=m=>{let A=m.length,_="",R=0;for(;A>0;){const Y=A<1e4?A:1e4,U=m.subarray(R,R+Y);R+=Y,_+=String.fromCodePoint.apply(null,U),A-=Y}return decodeURIComponent(escape(_))};let T=typeof TextDecoder=="undefined"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});T&&T.decode(new Uint8Array).length===1&&(T=null);const E=m=>T.decode(m),B=null,a=(m,A,_,R="")=>m.slice(0,A)+R+m.slice(A+_),v=(m,A)=>array.unfold(A,()=>m).join("")},"../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/time.js":(Gt,kt,$)=>{"use strict";$.d(kt,{ZG:()=>ft});const it=()=>new Date,ft=Date.now,rt=x=>{if(x<6e4){const L=metric.prefix(x,-1);return math.round(L.n*100)/100+L.prefix+"s"}x=math.floor(x/1e3);const I=x%60,b=math.floor(x/60)%60,g=math.floor(x/3600)%24,O=math.floor(x/86400);return O>0?O+"d"+(g>0||b>30?" "+(b>30?g+1:g)+"h":""):g>0?g+"h"+(b>0||I>30?" "+(I>30?b+1:b)+"min":""):b+"min"+(I>0?" "+I+"s":"")}},"../../../node_modules/.pnpm/simple-peer@9.11.1/node_modules/simple-peer/simplepeer.min.js":(Gt,kt,$)=>{(function(it){if(!0)Gt.exports=it();else var ft})(function(){var it=Math.floor,ft=Math.abs,rt=Math.pow;return function(){function x(I,b,g){function O(y,d){if(!b[y]){if(!I[y]){var u=void 0;if(!d&&$("../../../node_modules/.pnpm/simple-peer@9.11.1/node_modules/simple-peer sync recursive"))return require(y,!0);if(L)return L(y,!0);var M=new Error("Cannot find module '"+y+"'");throw M.code="MODULE_NOT_FOUND",M}var T=b[y]={exports:{}};I[y][0].call(T.exports,function(E){var B=I[y][1][E];return O(B||E)},T,T.exports,x,I,b,g)}return b[y].exports}for(var L=void 0,h=0;h<g.length;h++)O(g[h]);return O}return x}()({1:[function(x,I,b){"use strict";function g(v){var m=v.length;if(0<m%4)throw new Error("Invalid string. Length must be a multiple of 4");var A=v.indexOf("=");A===-1&&(A=m);var _=A===m?0:4-A%4;return[A,_]}function O(v,m,A){return 3*(m+A)/4-A}function L(v){var m,A,_=g(v),R=_[0],Y=_[1],U=new T(O(v,R,Y)),P=0,Z=0<Y?R-4:R;for(A=0;A<Z;A+=4)m=M[v.charCodeAt(A)]<<18|M[v.charCodeAt(A+1)]<<12|M[v.charCodeAt(A+2)]<<6|M[v.charCodeAt(A+3)],U[P++]=255&m>>16,U[P++]=255&m>>8,U[P++]=255&m;return Y===2&&(m=M[v.charCodeAt(A)]<<2|M[v.charCodeAt(A+1)]>>4,U[P++]=255&m),Y===1&&(m=M[v.charCodeAt(A)]<<10|M[v.charCodeAt(A+1)]<<4|M[v.charCodeAt(A+2)]>>2,U[P++]=255&m>>8,U[P++]=255&m),U}function h(v){return u[63&v>>18]+u[63&v>>12]+u[63&v>>6]+u[63&v]}function y(v,m,A){for(var _,R=[],Y=m;Y<A;Y+=3)_=(16711680&v[Y]<<16)+(65280&v[Y+1]<<8)+(255&v[Y+2]),R.push(h(_));return R.join("")}function d(v){for(var m,A=v.length,_=A%3,R=[],Y=16383,U=0,P=A-_;U<P;U+=Y)R.push(y(v,U,U+Y>P?P:U+Y));return _===1?(m=v[A-1],R.push(u[m>>2]+u[63&m<<4]+"==")):_===2&&(m=(v[A-2]<<8)+v[A-1],R.push(u[m>>10]+u[63&m>>4]+u[63&m<<2]+"=")),R.join("")}b.byteLength=function(v){var m=g(v),A=m[0],_=m[1];return 3*(A+_)/4-_},b.toByteArray=L,b.fromByteArray=d;for(var u=[],M=[],T=typeof Uint8Array=="undefined"?Array:Uint8Array,E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",B=0,a=E.length;B<a;++B)u[B]=E[B],M[E.charCodeAt(B)]=B;M[45]=62,M[95]=63},{}],2:[function(){},{}],3:[function(x,I,b){(function(){(function(){/*!
* The buffer module from node.js, for the browser.
*
* @author   Feross Aboukhadijeh <https://feross.org>
* @license  MIT
*/"use strict";var g=String.fromCharCode,O=Math.min;function L(n){if(2147483647<n)throw new RangeError('The value "'+n+'" is invalid for option "size"');var s=new Uint8Array(n);return s.__proto__=h.prototype,s}function h(n,s,c){if(typeof n=="number"){if(typeof s=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return M(n)}return y(n,s,c)}function y(n,s,c){if(typeof n=="string")return T(n,s);if(ArrayBuffer.isView(n))return E(n);if(n==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof n);if(V(n,ArrayBuffer)||n&&V(n.buffer,ArrayBuffer))return B(n,s,c);if(typeof n=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var C=n.valueOf&&n.valueOf();if(C!=null&&C!==n)return h.from(C,s,c);var z=a(n);if(z)return z;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof n[Symbol.toPrimitive]=="function")return h.from(n[Symbol.toPrimitive]("string"),s,c);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof n)}function d(n){if(typeof n!="number")throw new TypeError('"size" argument must be of type number');if(0>n)throw new RangeError('The value "'+n+'" is invalid for option "size"')}function u(n,s,c){return d(n),0>=n||s===void 0?L(n):typeof c=="string"?L(n).fill(s,c):L(n).fill(s)}function M(n){return d(n),L(0>n?0:0|v(n))}function T(n,s){if((typeof s!="string"||s==="")&&(s="utf8"),!h.isEncoding(s))throw new TypeError("Unknown encoding: "+s);var c=0|m(n,s),C=L(c),z=C.write(n,s);return z!==c&&(C=C.slice(0,z)),C}function E(n){for(var s=0>n.length?0:0|v(n.length),c=L(s),C=0;C<s;C+=1)c[C]=255&n[C];return c}function B(n,s,c){if(0>s||n.byteLength<s)throw new RangeError('"offset" is outside of buffer bounds');if(n.byteLength<s+(c||0))throw new RangeError('"length" is outside of buffer bounds');var C;return C=s===void 0&&c===void 0?new Uint8Array(n):c===void 0?new Uint8Array(n,s):new Uint8Array(n,s,c),C.__proto__=h.prototype,C}function a(n){if(h.isBuffer(n)){var s=0|v(n.length),c=L(s);return c.length===0||n.copy(c,0,0,s),c}return n.length===void 0?n.type==="Buffer"&&Array.isArray(n.data)?E(n.data):void 0:typeof n.length!="number"||w(n.length)?L(0):E(n)}function v(n){if(n>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|n}function m(n,s){if(h.isBuffer(n))return n.length;if(ArrayBuffer.isView(n)||V(n,ArrayBuffer))return n.byteLength;if(typeof n!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof n);var c=n.length,C=2<arguments.length&&arguments[2]===!0;if(!C&&c===0)return 0;for(var z=!1;;)switch(s){case"ascii":case"latin1":case"binary":return c;case"utf8":case"utf-8":return Ft(n).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*c;case"hex":return c>>>1;case"base64":return tt(n).length;default:if(z)return C?-1:Ft(n).length;s=(""+s).toLowerCase(),z=!0}}function A(n,s,c){var C=!1;if((s===void 0||0>s)&&(s=0),s>this.length||((c===void 0||c>this.length)&&(c=this.length),0>=c)||(c>>>=0,s>>>=0,c<=s))return"";for(n||(n="utf8");;)switch(n){case"hex":return Jt(this,s,c);case"utf8":case"utf-8":return It(this,s,c);case"ascii":return St(this,s,c);case"latin1":case"binary":return ne(this,s,c);case"base64":return Tt(this,s,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ct(this,s,c);default:if(C)throw new TypeError("Unknown encoding: "+n);n=(n+"").toLowerCase(),C=!0}}function _(n,s,c){var C=n[s];n[s]=n[c],n[c]=C}function R(n,s,c,C,z){if(n.length===0)return-1;if(typeof c=="string"?(C=c,c=0):2147483647<c?c=2147483647:-2147483648>c&&(c=-2147483648),c=+c,w(c)&&(c=z?0:n.length-1),0>c&&(c=n.length+c),c>=n.length){if(z)return-1;c=n.length-1}else if(0>c)if(z)c=0;else return-1;if(typeof s=="string"&&(s=h.from(s,C)),h.isBuffer(s))return s.length===0?-1:Y(n,s,c,C,z);if(typeof s=="number")return s&=255,typeof Uint8Array.prototype.indexOf=="function"?z?Uint8Array.prototype.indexOf.call(n,s,c):Uint8Array.prototype.lastIndexOf.call(n,s,c):Y(n,[s],c,C,z);throw new TypeError("val must be string, number or Buffer")}function Y(n,s,c,C,z){function K(X,nt){return ut===1?X[nt]:X.readUInt16BE(nt*ut)}var ut=1,Rt=n.length,Yt=s.length;if(C!==void 0&&(C=(C+"").toLowerCase(),C==="ucs2"||C==="ucs-2"||C==="utf16le"||C==="utf-16le")){if(2>n.length||2>s.length)return-1;ut=2,Rt/=2,Yt/=2,c/=2}var Nt;if(z){var Mt=-1;for(Nt=c;Nt<Rt;Nt++)if(K(n,Nt)!==K(s,Mt===-1?0:Nt-Mt))Mt!==-1&&(Nt-=Nt-Mt),Mt=-1;else if(Mt===-1&&(Mt=Nt),Nt-Mt+1===Yt)return Mt*ut}else for(c+Yt>Rt&&(c=Rt-Yt),Nt=c;0<=Nt;Nt--){for(var xt=!0,re=0;re<Yt;re++)if(K(n,Nt+re)!==K(s,re)){xt=!1;break}if(xt)return Nt}return-1}function U(n,s,c,C){c=+c||0;var z=n.length-c;C?(C=+C,C>z&&(C=z)):C=z;var K=s.length;C>K/2&&(C=K/2);for(var ut,Rt=0;Rt<C;++Rt){if(ut=parseInt(s.substr(2*Rt,2),16),w(ut))return Rt;n[c+Rt]=ut}return Rt}function P(n,s,c,C){return wt(Ft(s,n.length-c),n,c,C)}function Z(n,s,c,C){return wt(ie(s),n,c,C)}function lt(n,s,c,C){return Z(n,s,c,C)}function bt(n,s,c,C){return wt(tt(s),n,c,C)}function Ct(n,s,c,C){return wt(G(s,n.length-c),n,c,C)}function Tt(n,s,c){return s===0&&c===n.length?k.fromByteArray(n):k.fromByteArray(n.slice(s,c))}function It(n,s,c){c=O(n.length,c);for(var C=[],z=s;z<c;){var K=n[z],ut=null,Rt=239<K?4:223<K?3:191<K?2:1;if(z+Rt<=c){var Yt,Nt,Mt,xt;Rt===1?128>K&&(ut=K):Rt===2?(Yt=n[z+1],(192&Yt)==128&&(xt=(31&K)<<6|63&Yt,127<xt&&(ut=xt))):Rt===3?(Yt=n[z+1],Nt=n[z+2],(192&Yt)==128&&(192&Nt)==128&&(xt=(15&K)<<12|(63&Yt)<<6|63&Nt,2047<xt&&(55296>xt||57343<xt)&&(ut=xt))):Rt===4&&(Yt=n[z+1],Nt=n[z+2],Mt=n[z+3],(192&Yt)==128&&(192&Nt)==128&&(192&Mt)==128&&(xt=(15&K)<<18|(63&Yt)<<12|(63&Nt)<<6|63&Mt,65535<xt&&1114112>xt&&(ut=xt)))}ut===null?(ut=65533,Rt=1):65535<ut&&(ut-=65536,C.push(55296|1023&ut>>>10),ut=56320|1023&ut),C.push(ut),z+=Rt}return Lt(C)}function Lt(n){var s=n.length;if(s<=4096)return g.apply(String,n);for(var c="",C=0;C<s;)c+=g.apply(String,n.slice(C,C+=4096));return c}function St(n,s,c){var C="";c=O(n.length,c);for(var z=s;z<c;++z)C+=g(127&n[z]);return C}function ne(n,s,c){var C="";c=O(n.length,c);for(var z=s;z<c;++z)C+=g(n[z]);return C}function Jt(n,s,c){var C=n.length;(!s||0>s)&&(s=0),(!c||0>c||c>C)&&(c=C);for(var z="",K=s;K<c;++K)z+=te(n[K]);return z}function ct(n,s,c){for(var C=n.slice(s,c),z="",K=0;K<C.length;K+=2)z+=g(C[K]+256*C[K+1]);return z}function et(n,s,c){if(n%1!=0||0>n)throw new RangeError("offset is not uint");if(n+s>c)throw new RangeError("Trying to access beyond buffer length")}function at(n,s,c,C,z,K){if(!h.isBuffer(n))throw new TypeError('"buffer" argument must be a Buffer instance');if(s>z||s<K)throw new RangeError('"value" argument is out of bounds');if(c+C>n.length)throw new RangeError("Index out of range")}function _t(n,s,c,C){if(c+C>n.length)throw new RangeError("Index out of range");if(0>c)throw new RangeError("Index out of range")}function vt(n,s,c,C,z){return s=+s,c>>>=0,z||_t(n,s,c,4,34028234663852886e22,-34028234663852886e22),Q.write(n,s,c,C,23,4),c+4}function Ot(n,s,c,C,z){return s=+s,c>>>=0,z||_t(n,s,c,8,17976931348623157e292,-17976931348623157e292),Q.write(n,s,c,C,52,8),c+8}function Ht(n){if(n=n.split("=")[0],n=n.trim().replace(pt,""),2>n.length)return"";for(;n.length%4!=0;)n+="=";return n}function te(n){return 16>n?"0"+n.toString(16):n.toString(16)}function Ft(n,s){s=s||1/0;for(var c,C=n.length,z=null,K=[],ut=0;ut<C;++ut){if(c=n.charCodeAt(ut),55295<c&&57344>c){if(!z){if(56319<c){-1<(s-=3)&&K.push(239,191,189);continue}else if(ut+1===C){-1<(s-=3)&&K.push(239,191,189);continue}z=c;continue}if(56320>c){-1<(s-=3)&&K.push(239,191,189),z=c;continue}c=(z-55296<<10|c-56320)+65536}else z&&-1<(s-=3)&&K.push(239,191,189);if(z=null,128>c){if(0>(s-=1))break;K.push(c)}else if(2048>c){if(0>(s-=2))break;K.push(192|c>>6,128|63&c)}else if(65536>c){if(0>(s-=3))break;K.push(224|c>>12,128|63&c>>6,128|63&c)}else if(1114112>c){if(0>(s-=4))break;K.push(240|c>>18,128|63&c>>12,128|63&c>>6,128|63&c)}else throw new Error("Invalid code point")}return K}function ie(n){for(var s=[],c=0;c<n.length;++c)s.push(255&n.charCodeAt(c));return s}function G(n,s){for(var c,C,z,K=[],ut=0;ut<n.length&&!(0>(s-=2));++ut)c=n.charCodeAt(ut),C=c>>8,z=c%256,K.push(z),K.push(C);return K}function tt(n){return k.toByteArray(Ht(n))}function wt(n,s,c,C){for(var z=0;z<C&&!(z+c>=s.length||z>=n.length);++z)s[z+c]=n[z];return z}function V(n,s){return n instanceof s||n!=null&&n.constructor!=null&&n.constructor.name!=null&&n.constructor.name===s.name}function w(n){return n!==n}var k=x("base64-js"),Q=x("ieee754");b.Buffer=h,b.SlowBuffer=function(n){return+n!=n&&(n=0),h.alloc(+n)},b.INSPECT_MAX_BYTES=50,b.kMaxLength=2147483647,h.TYPED_ARRAY_SUPPORT=function(){try{var n=new Uint8Array(1);return n.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},n.foo()===42}catch(s){return!1}}(),h.TYPED_ARRAY_SUPPORT||typeof console=="undefined"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(h.prototype,"parent",{enumerable:!0,get:function(){return h.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(h.prototype,"offset",{enumerable:!0,get:function(){return h.isBuffer(this)?this.byteOffset:void 0}}),typeof Symbol!="undefined"&&Symbol.species!=null&&h[Symbol.species]===h&&Object.defineProperty(h,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),h.poolSize=8192,h.from=function(n,s,c){return y(n,s,c)},h.prototype.__proto__=Uint8Array.prototype,h.__proto__=Uint8Array,h.alloc=function(n,s,c){return u(n,s,c)},h.allocUnsafe=function(n){return M(n)},h.allocUnsafeSlow=function(n){return M(n)},h.isBuffer=function(n){return n!=null&&n._isBuffer===!0&&n!==h.prototype},h.compare=function(n,s){if(V(n,Uint8Array)&&(n=h.from(n,n.offset,n.byteLength)),V(s,Uint8Array)&&(s=h.from(s,s.offset,s.byteLength)),!h.isBuffer(n)||!h.isBuffer(s))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(n===s)return 0;for(var c=n.length,C=s.length,z=0,K=O(c,C);z<K;++z)if(n[z]!==s[z]){c=n[z],C=s[z];break}return c<C?-1:C<c?1:0},h.isEncoding=function(n){switch((n+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(n,s){if(!Array.isArray(n))throw new TypeError('"list" argument must be an Array of Buffers');if(n.length===0)return h.alloc(0);var c;if(s===void 0)for(s=0,c=0;c<n.length;++c)s+=n[c].length;var C=h.allocUnsafe(s),z=0;for(c=0;c<n.length;++c){var K=n[c];if(V(K,Uint8Array)&&(K=h.from(K)),!h.isBuffer(K))throw new TypeError('"list" argument must be an Array of Buffers');K.copy(C,z),z+=K.length}return C},h.byteLength=m,h.prototype._isBuffer=!0,h.prototype.swap16=function(){var n=this.length;if(n%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var s=0;s<n;s+=2)_(this,s,s+1);return this},h.prototype.swap32=function(){var n=this.length;if(n%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var s=0;s<n;s+=4)_(this,s,s+3),_(this,s+1,s+2);return this},h.prototype.swap64=function(){var n=this.length;if(n%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var s=0;s<n;s+=8)_(this,s,s+7),_(this,s+1,s+6),_(this,s+2,s+5),_(this,s+3,s+4);return this},h.prototype.toString=function(){var n=this.length;return n===0?"":arguments.length===0?It(this,0,n):A.apply(this,arguments)},h.prototype.toLocaleString=h.prototype.toString,h.prototype.equals=function(n){if(!h.isBuffer(n))throw new TypeError("Argument must be a Buffer");return this===n||h.compare(this,n)===0},h.prototype.inspect=function(){var n="",s=b.INSPECT_MAX_BYTES;return n=this.toString("hex",0,s).replace(/(.{2})/g,"$1 ").trim(),this.length>s&&(n+=" ... "),"<Buffer "+n+">"},h.prototype.compare=function(n,s,c,C,z){if(V(n,Uint8Array)&&(n=h.from(n,n.offset,n.byteLength)),!h.isBuffer(n))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof n);if(s===void 0&&(s=0),c===void 0&&(c=n?n.length:0),C===void 0&&(C=0),z===void 0&&(z=this.length),0>s||c>n.length||0>C||z>this.length)throw new RangeError("out of range index");if(C>=z&&s>=c)return 0;if(C>=z)return-1;if(s>=c)return 1;if(s>>>=0,c>>>=0,C>>>=0,z>>>=0,this===n)return 0;for(var K=z-C,ut=c-s,Rt=O(K,ut),Yt=this.slice(C,z),Nt=n.slice(s,c),Mt=0;Mt<Rt;++Mt)if(Yt[Mt]!==Nt[Mt]){K=Yt[Mt],ut=Nt[Mt];break}return K<ut?-1:ut<K?1:0},h.prototype.includes=function(n,s,c){return this.indexOf(n,s,c)!==-1},h.prototype.indexOf=function(n,s,c){return R(this,n,s,c,!0)},h.prototype.lastIndexOf=function(n,s,c){return R(this,n,s,c,!1)},h.prototype.write=function(n,s,c,C){if(s===void 0)C="utf8",c=this.length,s=0;else if(c===void 0&&typeof s=="string")C=s,c=this.length,s=0;else if(isFinite(s))s>>>=0,isFinite(c)?(c>>>=0,C===void 0&&(C="utf8")):(C=c,c=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var z=this.length-s;if((c===void 0||c>z)&&(c=z),0<n.length&&(0>c||0>s)||s>this.length)throw new RangeError("Attempt to write outside buffer bounds");C||(C="utf8");for(var K=!1;;)switch(C){case"hex":return U(this,n,s,c);case"utf8":case"utf-8":return P(this,n,s,c);case"ascii":return Z(this,n,s,c);case"latin1":case"binary":return lt(this,n,s,c);case"base64":return bt(this,n,s,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ct(this,n,s,c);default:if(K)throw new TypeError("Unknown encoding: "+C);C=(""+C).toLowerCase(),K=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},h.prototype.slice=function(n,s){var c=this.length;n=~~n,s=s===void 0?c:~~s,0>n?(n+=c,0>n&&(n=0)):n>c&&(n=c),0>s?(s+=c,0>s&&(s=0)):s>c&&(s=c),s<n&&(s=n);var C=this.subarray(n,s);return C.__proto__=h.prototype,C},h.prototype.readUIntLE=function(n,s,c){n>>>=0,s>>>=0,c||et(n,s,this.length);for(var C=this[n],z=1,K=0;++K<s&&(z*=256);)C+=this[n+K]*z;return C},h.prototype.readUIntBE=function(n,s,c){n>>>=0,s>>>=0,c||et(n,s,this.length);for(var C=this[n+--s],z=1;0<s&&(z*=256);)C+=this[n+--s]*z;return C},h.prototype.readUInt8=function(n,s){return n>>>=0,s||et(n,1,this.length),this[n]},h.prototype.readUInt16LE=function(n,s){return n>>>=0,s||et(n,2,this.length),this[n]|this[n+1]<<8},h.prototype.readUInt16BE=function(n,s){return n>>>=0,s||et(n,2,this.length),this[n]<<8|this[n+1]},h.prototype.readUInt32LE=function(n,s){return n>>>=0,s||et(n,4,this.length),(this[n]|this[n+1]<<8|this[n+2]<<16)+16777216*this[n+3]},h.prototype.readUInt32BE=function(n,s){return n>>>=0,s||et(n,4,this.length),16777216*this[n]+(this[n+1]<<16|this[n+2]<<8|this[n+3])},h.prototype.readIntLE=function(n,s,c){n>>>=0,s>>>=0,c||et(n,s,this.length);for(var C=this[n],z=1,K=0;++K<s&&(z*=256);)C+=this[n+K]*z;return z*=128,C>=z&&(C-=rt(2,8*s)),C},h.prototype.readIntBE=function(n,s,c){n>>>=0,s>>>=0,c||et(n,s,this.length);for(var C=s,z=1,K=this[n+--C];0<C&&(z*=256);)K+=this[n+--C]*z;return z*=128,K>=z&&(K-=rt(2,8*s)),K},h.prototype.readInt8=function(n,s){return n>>>=0,s||et(n,1,this.length),128&this[n]?-1*(255-this[n]+1):this[n]},h.prototype.readInt16LE=function(n,s){n>>>=0,s||et(n,2,this.length);var c=this[n]|this[n+1]<<8;return 32768&c?4294901760|c:c},h.prototype.readInt16BE=function(n,s){n>>>=0,s||et(n,2,this.length);var c=this[n+1]|this[n]<<8;return 32768&c?4294901760|c:c},h.prototype.readInt32LE=function(n,s){return n>>>=0,s||et(n,4,this.length),this[n]|this[n+1]<<8|this[n+2]<<16|this[n+3]<<24},h.prototype.readInt32BE=function(n,s){return n>>>=0,s||et(n,4,this.length),this[n]<<24|this[n+1]<<16|this[n+2]<<8|this[n+3]},h.prototype.readFloatLE=function(n,s){return n>>>=0,s||et(n,4,this.length),Q.read(this,n,!0,23,4)},h.prototype.readFloatBE=function(n,s){return n>>>=0,s||et(n,4,this.length),Q.read(this,n,!1,23,4)},h.prototype.readDoubleLE=function(n,s){return n>>>=0,s||et(n,8,this.length),Q.read(this,n,!0,52,8)},h.prototype.readDoubleBE=function(n,s){return n>>>=0,s||et(n,8,this.length),Q.read(this,n,!1,52,8)},h.prototype.writeUIntLE=function(n,s,c,C){if(n=+n,s>>>=0,c>>>=0,!C){var z=rt(2,8*c)-1;at(this,n,s,c,z,0)}var K=1,ut=0;for(this[s]=255&n;++ut<c&&(K*=256);)this[s+ut]=255&n/K;return s+c},h.prototype.writeUIntBE=function(n,s,c,C){if(n=+n,s>>>=0,c>>>=0,!C){var z=rt(2,8*c)-1;at(this,n,s,c,z,0)}var K=c-1,ut=1;for(this[s+K]=255&n;0<=--K&&(ut*=256);)this[s+K]=255&n/ut;return s+c},h.prototype.writeUInt8=function(n,s,c){return n=+n,s>>>=0,c||at(this,n,s,1,255,0),this[s]=255&n,s+1},h.prototype.writeUInt16LE=function(n,s,c){return n=+n,s>>>=0,c||at(this,n,s,2,65535,0),this[s]=255&n,this[s+1]=n>>>8,s+2},h.prototype.writeUInt16BE=function(n,s,c){return n=+n,s>>>=0,c||at(this,n,s,2,65535,0),this[s]=n>>>8,this[s+1]=255&n,s+2},h.prototype.writeUInt32LE=function(n,s,c){return n=+n,s>>>=0,c||at(this,n,s,4,4294967295,0),this[s+3]=n>>>24,this[s+2]=n>>>16,this[s+1]=n>>>8,this[s]=255&n,s+4},h.prototype.writeUInt32BE=function(n,s,c){return n=+n,s>>>=0,c||at(this,n,s,4,4294967295,0),this[s]=n>>>24,this[s+1]=n>>>16,this[s+2]=n>>>8,this[s+3]=255&n,s+4},h.prototype.writeIntLE=function(n,s,c,C){if(n=+n,s>>>=0,!C){var z=rt(2,8*c-1);at(this,n,s,c,z-1,-z)}var K=0,ut=1,Rt=0;for(this[s]=255&n;++K<c&&(ut*=256);)0>n&&Rt===0&&this[s+K-1]!==0&&(Rt=1),this[s+K]=255&(n/ut>>0)-Rt;return s+c},h.prototype.writeIntBE=function(n,s,c,C){if(n=+n,s>>>=0,!C){var z=rt(2,8*c-1);at(this,n,s,c,z-1,-z)}var K=c-1,ut=1,Rt=0;for(this[s+K]=255&n;0<=--K&&(ut*=256);)0>n&&Rt===0&&this[s+K+1]!==0&&(Rt=1),this[s+K]=255&(n/ut>>0)-Rt;return s+c},h.prototype.writeInt8=function(n,s,c){return n=+n,s>>>=0,c||at(this,n,s,1,127,-128),0>n&&(n=255+n+1),this[s]=255&n,s+1},h.prototype.writeInt16LE=function(n,s,c){return n=+n,s>>>=0,c||at(this,n,s,2,32767,-32768),this[s]=255&n,this[s+1]=n>>>8,s+2},h.prototype.writeInt16BE=function(n,s,c){return n=+n,s>>>=0,c||at(this,n,s,2,32767,-32768),this[s]=n>>>8,this[s+1]=255&n,s+2},h.prototype.writeInt32LE=function(n,s,c){return n=+n,s>>>=0,c||at(this,n,s,4,2147483647,-2147483648),this[s]=255&n,this[s+1]=n>>>8,this[s+2]=n>>>16,this[s+3]=n>>>24,s+4},h.prototype.writeInt32BE=function(n,s,c){return n=+n,s>>>=0,c||at(this,n,s,4,2147483647,-2147483648),0>n&&(n=4294967295+n+1),this[s]=n>>>24,this[s+1]=n>>>16,this[s+2]=n>>>8,this[s+3]=255&n,s+4},h.prototype.writeFloatLE=function(n,s,c){return vt(this,n,s,!0,c)},h.prototype.writeFloatBE=function(n,s,c){return vt(this,n,s,!1,c)},h.prototype.writeDoubleLE=function(n,s,c){return Ot(this,n,s,!0,c)},h.prototype.writeDoubleBE=function(n,s,c){return Ot(this,n,s,!1,c)},h.prototype.copy=function(n,s,c,C){if(!h.isBuffer(n))throw new TypeError("argument should be a Buffer");if(c||(c=0),C||C===0||(C=this.length),s>=n.length&&(s=n.length),s||(s=0),0<C&&C<c&&(C=c),C===c||n.length===0||this.length===0)return 0;if(0>s)throw new RangeError("targetStart out of bounds");if(0>c||c>=this.length)throw new RangeError("Index out of range");if(0>C)throw new RangeError("sourceEnd out of bounds");C>this.length&&(C=this.length),n.length-s<C-c&&(C=n.length-s+c);var z=C-c;if(this===n&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(s,c,C);else if(this===n&&c<s&&s<C)for(var K=z-1;0<=K;--K)n[K+s]=this[K+c];else Uint8Array.prototype.set.call(n,this.subarray(c,C),s);return z},h.prototype.fill=function(n,s,c,C){if(typeof n=="string"){if(typeof s=="string"?(C=s,s=0,c=this.length):typeof c=="string"&&(C=c,c=this.length),C!==void 0&&typeof C!="string")throw new TypeError("encoding must be a string");if(typeof C=="string"&&!h.isEncoding(C))throw new TypeError("Unknown encoding: "+C);if(n.length===1){var z=n.charCodeAt(0);(C==="utf8"&&128>z||C==="latin1")&&(n=z)}}else typeof n=="number"&&(n&=255);if(0>s||this.length<s||this.length<c)throw new RangeError("Out of range index");if(c<=s)return this;s>>>=0,c=c===void 0?this.length:c>>>0,n||(n=0);var K;if(typeof n=="number")for(K=s;K<c;++K)this[K]=n;else{var ut=h.isBuffer(n)?n:h.from(n,C),Rt=ut.length;if(Rt===0)throw new TypeError('The value "'+n+'" is invalid for argument "value"');for(K=0;K<c-s;++K)this[K+s]=ut[K%Rt]}return this};var pt=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,x("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:9}],4:[function(x,I,b){(function(g){(function(){function O(){let h;try{h=b.storage.getItem("debug")}catch(y){}return!h&&typeof g!="undefined"&&"env"in g&&(h=g.env.DEBUG),h}b.formatArgs=function(h){if(h[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+h[0]+(this.useColors?"%c ":" ")+"+"+I.exports.humanize(this.diff),!this.useColors)return;const y="color: "+this.color;h.splice(1,0,y,"color: inherit");let d=0,u=0;h[0].replace(/%[a-zA-Z%]/g,M=>{M==="%%"||(d++,M==="%c"&&(u=d))}),h.splice(u,0,y)},b.save=function(h){try{h?b.storage.setItem("debug",h):b.storage.removeItem("debug")}catch(y){}},b.load=O,b.useColors=function(){return!!(typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))||!(typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},b.storage=function(){try{return localStorage}catch(h){}}(),b.destroy=(()=>{let h=!1;return()=>{h||(h=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),b.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],b.log=console.debug||console.log||(()=>{}),I.exports=x("./common")(b);const{formatters:L}=I.exports;L.j=function(h){try{return JSON.stringify(h)}catch(y){return"[UnexpectedJSONParseError]: "+y.message}}}).call(this)}).call(this,x("_process"))},{"./common":5,_process:12}],5:[function(x,I){I.exports=function(b){function g(h){function y(...M){if(!y.enabled)return;const T=y,E=+new Date,B=E-(d||E);T.diff=B,T.prev=d,T.curr=E,d=E,M[0]=g.coerce(M[0]),typeof M[0]!="string"&&M.unshift("%O");let a=0;M[0]=M[0].replace(/%([a-zA-Z%])/g,(m,A)=>{if(m==="%%")return"%";a++;const _=g.formatters[A];if(typeof _=="function"){const R=M[a];m=_.call(T,R),M.splice(a,1),a--}return m}),g.formatArgs.call(T,M),(T.log||g.log).apply(T,M)}let d,u=null;return y.namespace=h,y.useColors=g.useColors(),y.color=g.selectColor(h),y.extend=O,y.destroy=g.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:()=>u===null?g.enabled(h):u,set:M=>{u=M}}),typeof g.init=="function"&&g.init(y),y}function O(h,y){const d=g(this.namespace+(typeof y=="undefined"?":":y)+h);return d.log=this.log,d}function L(h){return h.toString().substring(2,h.toString().length-2).replace(/\.\*\?$/,"*")}return g.debug=g,g.default=g,g.coerce=function(h){return h instanceof Error?h.stack||h.message:h},g.disable=function(){const h=[...g.names.map(L),...g.skips.map(L).map(y=>"-"+y)].join(",");return g.enable(""),h},g.enable=function(h){g.save(h),g.names=[],g.skips=[];let y;const d=(typeof h=="string"?h:"").split(/[\s,]+/),u=d.length;for(y=0;y<u;y++)d[y]&&(h=d[y].replace(/\*/g,".*?"),h[0]==="-"?g.skips.push(new RegExp("^"+h.substr(1)+"$")):g.names.push(new RegExp("^"+h+"$")))},g.enabled=function(h){if(h[h.length-1]==="*")return!0;let y,d;for(y=0,d=g.skips.length;y<d;y++)if(g.skips[y].test(h))return!1;for(y=0,d=g.names.length;y<d;y++)if(g.names[y].test(h))return!0;return!1},g.humanize=x("ms"),g.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(b).forEach(h=>{g[h]=b[h]}),g.names=[],g.skips=[],g.formatters={},g.selectColor=function(h){let y=0;for(let d=0;d<h.length;d++)y=(y<<5)-y+h.charCodeAt(d),y|=0;return g.colors[ft(y)%g.colors.length]},g.enable(g.load()),g}},{ms:11}],6:[function(x,I){"use strict";function b(g,O){for(const L in O)Object.defineProperty(g,L,{value:O[L],enumerable:!0,configurable:!0});return g}I.exports=function(g,O,L){if(!g||typeof g=="string")throw new TypeError("Please pass an Error to err-code");L||(L={}),typeof O=="object"&&(L=O,O=""),O&&(L.code=O);try{return b(g,L)}catch(h){L.message=g.message,L.stack=g.stack;const y=function(){};return y.prototype=Object.create(Object.getPrototypeOf(g)),b(new y,L)}}},{}],7:[function(x,I){"use strict";function b(U){console&&console.warn&&console.warn(U)}function g(){g.init.call(this)}function O(U){if(typeof U!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof U)}function L(U){return U._maxListeners===void 0?g.defaultMaxListeners:U._maxListeners}function h(U,P,Z,lt){var bt,Ct,Tt;if(O(Z),Ct=U._events,Ct===void 0?(Ct=U._events=Object.create(null),U._eventsCount=0):(Ct.newListener!==void 0&&(U.emit("newListener",P,Z.listener?Z.listener:Z),Ct=U._events),Tt=Ct[P]),Tt===void 0)Tt=Ct[P]=Z,++U._eventsCount;else if(typeof Tt=="function"?Tt=Ct[P]=lt?[Z,Tt]:[Tt,Z]:lt?Tt.unshift(Z):Tt.push(Z),bt=L(U),0<bt&&Tt.length>bt&&!Tt.warned){Tt.warned=!0;var It=new Error("Possible EventEmitter memory leak detected. "+Tt.length+" "+(P+" listeners added. Use emitter.setMaxListeners() to increase limit"));It.name="MaxListenersExceededWarning",It.emitter=U,It.type=P,It.count=Tt.length,b(It)}return U}function y(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(U,P,Z){var lt={fired:!1,wrapFn:void 0,target:U,type:P,listener:Z},bt=y.bind(lt);return bt.listener=Z,lt.wrapFn=bt,bt}function u(U,P,Z){var lt=U._events;if(lt===void 0)return[];var bt=lt[P];return bt===void 0?[]:typeof bt=="function"?Z?[bt.listener||bt]:[bt]:Z?B(bt):T(bt,bt.length)}function M(U){var P=this._events;if(P!==void 0){var Z=P[U];if(typeof Z=="function")return 1;if(Z!==void 0)return Z.length}return 0}function T(U,P){for(var Z=Array(P),lt=0;lt<P;++lt)Z[lt]=U[lt];return Z}function E(U,P){for(;P+1<U.length;P++)U[P]=U[P+1];U.pop()}function B(U){for(var P=Array(U.length),Z=0;Z<P.length;++Z)P[Z]=U[Z].listener||U[Z];return P}function a(U,P,Z){typeof U.on=="function"&&v(U,"error",P,Z)}function v(U,P,Z,lt){if(typeof U.on=="function")lt.once?U.once(P,Z):U.on(P,Z);else if(typeof U.addEventListener=="function")U.addEventListener(P,function bt(Ct){lt.once&&U.removeEventListener(P,bt),Z(Ct)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof U)}var m,A=typeof Reflect=="object"?Reflect:null,_=A&&typeof A.apply=="function"?A.apply:function(U,P,Z){return Function.prototype.apply.call(U,P,Z)};m=A&&typeof A.ownKeys=="function"?A.ownKeys:Object.getOwnPropertySymbols?function(U){return Object.getOwnPropertyNames(U).concat(Object.getOwnPropertySymbols(U))}:function(U){return Object.getOwnPropertyNames(U)};var R=Number.isNaN||function(U){return U!==U};I.exports=g,I.exports.once=function(U,P){return new Promise(function(Z,lt){function bt(Tt){U.removeListener(P,Ct),lt(Tt)}function Ct(){typeof U.removeListener=="function"&&U.removeListener("error",bt),Z([].slice.call(arguments))}v(U,P,Ct,{once:!0}),P!=="error"&&a(U,bt,{once:!0})})},g.EventEmitter=g,g.prototype._events=void 0,g.prototype._eventsCount=0,g.prototype._maxListeners=void 0;var Y=10;Object.defineProperty(g,"defaultMaxListeners",{enumerable:!0,get:function(){return Y},set:function(U){if(typeof U!="number"||0>U||R(U))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+U+".");Y=U}}),g.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},g.prototype.setMaxListeners=function(U){if(typeof U!="number"||0>U||R(U))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+U+".");return this._maxListeners=U,this},g.prototype.getMaxListeners=function(){return L(this)},g.prototype.emit=function(U){for(var P=[],Z=1;Z<arguments.length;Z++)P.push(arguments[Z]);var lt=U==="error",bt=this._events;if(bt!==void 0)lt=lt&&bt.error===void 0;else if(!lt)return!1;if(lt){var Ct;if(0<P.length&&(Ct=P[0]),Ct instanceof Error)throw Ct;var Tt=new Error("Unhandled error."+(Ct?" ("+Ct.message+")":""));throw Tt.context=Ct,Tt}var It=bt[U];if(It===void 0)return!1;if(typeof It=="function")_(It,this,P);else for(var Lt=It.length,St=T(It,Lt),Z=0;Z<Lt;++Z)_(St[Z],this,P);return!0},g.prototype.addListener=function(U,P){return h(this,U,P,!1)},g.prototype.on=g.prototype.addListener,g.prototype.prependListener=function(U,P){return h(this,U,P,!0)},g.prototype.once=function(U,P){return O(P),this.on(U,d(this,U,P)),this},g.prototype.prependOnceListener=function(U,P){return O(P),this.prependListener(U,d(this,U,P)),this},g.prototype.removeListener=function(U,P){var Z,lt,bt,Ct,Tt;if(O(P),lt=this._events,lt===void 0)return this;if(Z=lt[U],Z===void 0)return this;if(Z===P||Z.listener===P)--this._eventsCount==0?this._events=Object.create(null):(delete lt[U],lt.removeListener&&this.emit("removeListener",U,Z.listener||P));else if(typeof Z!="function"){for(bt=-1,Ct=Z.length-1;0<=Ct;Ct--)if(Z[Ct]===P||Z[Ct].listener===P){Tt=Z[Ct].listener,bt=Ct;break}if(0>bt)return this;bt===0?Z.shift():E(Z,bt),Z.length===1&&(lt[U]=Z[0]),lt.removeListener!==void 0&&this.emit("removeListener",U,Tt||P)}return this},g.prototype.off=g.prototype.removeListener,g.prototype.removeAllListeners=function(U){var P,Z,lt;if(Z=this._events,Z===void 0)return this;if(Z.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):Z[U]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete Z[U]),this;if(arguments.length===0){var bt,Ct=Object.keys(Z);for(lt=0;lt<Ct.length;++lt)bt=Ct[lt],bt!=="removeListener"&&this.removeAllListeners(bt);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(P=Z[U],typeof P=="function")this.removeListener(U,P);else if(P!==void 0)for(lt=P.length-1;0<=lt;lt--)this.removeListener(U,P[lt]);return this},g.prototype.listeners=function(U){return u(this,U,!0)},g.prototype.rawListeners=function(U){return u(this,U,!1)},g.listenerCount=function(U,P){return typeof U.listenerCount=="function"?U.listenerCount(P):M.call(U,P)},g.prototype.listenerCount=M,g.prototype.eventNames=function(){return 0<this._eventsCount?m(this._events):[]}},{}],8:[function(x,I){I.exports=function(){if(typeof globalThis=="undefined")return null;var b={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return b.RTCPeerConnection?b:null}},{}],9:[function(x,I,b){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */b.read=function(g,O,L,h,y){var d,u,M=8*y-h-1,T=(1<<M)-1,E=T>>1,B=-7,a=L?y-1:0,v=L?-1:1,m=g[O+a];for(a+=v,d=m&(1<<-B)-1,m>>=-B,B+=M;0<B;d=256*d+g[O+a],a+=v,B-=8);for(u=d&(1<<-B)-1,d>>=-B,B+=h;0<B;u=256*u+g[O+a],a+=v,B-=8);if(d===0)d=1-E;else{if(d===T)return u?NaN:(m?-1:1)*(1/0);u+=rt(2,h),d-=E}return(m?-1:1)*u*rt(2,d-h)},b.write=function(g,O,L,h,y,d){var u,M,T,E=Math.LN2,B=Math.log,a=8*d-y-1,v=(1<<a)-1,m=v>>1,A=y===23?rt(2,-24)-rt(2,-77):0,_=h?0:d-1,R=h?1:-1,Y=0>O||O===0&&0>1/O?1:0;for(O=ft(O),isNaN(O)||O===1/0?(M=isNaN(O)?1:0,u=v):(u=it(B(O)/E),1>O*(T=rt(2,-u))&&(u--,T*=2),O+=1<=u+m?A/T:A*rt(2,1-m),2<=O*T&&(u++,T/=2),u+m>=v?(M=0,u=v):1<=u+m?(M=(O*T-1)*rt(2,y),u+=m):(M=O*rt(2,m-1)*rt(2,y),u=0));8<=y;g[L+_]=255&M,_+=R,M/=256,y-=8);for(u=u<<y|M,a+=y;0<a;g[L+_]=255&u,_+=R,u/=256,a-=8);g[L+_-R]|=128*Y}},{}],10:[function(x,I){I.exports=typeof Object.create=="function"?function(b,g){g&&(b.super_=g,b.prototype=Object.create(g.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}))}:function(b,g){if(g){b.super_=g;var O=function(){};O.prototype=g.prototype,b.prototype=new O,b.prototype.constructor=b}}},{}],11:[function(x,I){var b=Math.round;function g(d){if(d+="",!(100<d.length)){var u=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(d);if(u){var M=parseFloat(u[1]),T=(u[2]||"ms").toLowerCase();return T==="years"||T==="year"||T==="yrs"||T==="yr"||T==="y"?315576e5*M:T==="weeks"||T==="week"||T==="w"?6048e5*M:T==="days"||T==="day"||T==="d"?864e5*M:T==="hours"||T==="hour"||T==="hrs"||T==="hr"||T==="h"?36e5*M:T==="minutes"||T==="minute"||T==="mins"||T==="min"||T==="m"?6e4*M:T==="seconds"||T==="second"||T==="secs"||T==="sec"||T==="s"?1e3*M:T==="milliseconds"||T==="millisecond"||T==="msecs"||T==="msec"||T==="ms"?M:void 0}}}function O(d){var u=ft(d);return 864e5<=u?b(d/864e5)+"d":36e5<=u?b(d/36e5)+"h":6e4<=u?b(d/6e4)+"m":1e3<=u?b(d/1e3)+"s":d+"ms"}function L(d){var u=ft(d);return 864e5<=u?h(d,u,864e5,"day"):36e5<=u?h(d,u,36e5,"hour"):6e4<=u?h(d,u,6e4,"minute"):1e3<=u?h(d,u,1e3,"second"):d+" ms"}function h(d,u,M,T){return b(d/M)+" "+T+(u>=1.5*M?"s":"")}var y=24*(60*6e4);I.exports=function(d,u){u=u||{};var M=typeof d;if(M=="string"&&0<d.length)return g(d);if(M==="number"&&isFinite(d))return u.long?L(d):O(d);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(d))}},{}],12:[function(x,I){function b(){throw new Error("setTimeout has not been defined")}function g(){throw new Error("clearTimeout has not been defined")}function O(A){if(M===setTimeout)return setTimeout(A,0);if((M===b||!M)&&setTimeout)return M=setTimeout,setTimeout(A,0);try{return M(A,0)}catch(_){try{return M.call(null,A,0)}catch(R){return M.call(this,A,0)}}}function L(A){if(T===clearTimeout)return clearTimeout(A);if((T===g||!T)&&clearTimeout)return T=clearTimeout,clearTimeout(A);try{return T(A)}catch(_){try{return T.call(null,A)}catch(R){return T.call(this,A)}}}function h(){v&&B&&(v=!1,B.length?a=B.concat(a):m=-1,a.length&&y())}function y(){if(!v){var A=O(h);v=!0;for(var _=a.length;_;){for(B=a,a=[];++m<_;)B&&B[m].run();m=-1,_=a.length}B=null,v=!1,L(A)}}function d(A,_){this.fun=A,this.array=_}function u(){}var M,T,E=I.exports={};(function(){try{M=typeof setTimeout=="function"?setTimeout:b}catch(A){M=b}try{T=typeof clearTimeout=="function"?clearTimeout:g}catch(A){T=g}})();var B,a=[],v=!1,m=-1;E.nextTick=function(A){var _=Array(arguments.length-1);if(1<arguments.length)for(var R=1;R<arguments.length;R++)_[R-1]=arguments[R];a.push(new d(A,_)),a.length!==1||v||O(y)},d.prototype.run=function(){this.fun.apply(null,this.array)},E.title="browser",E.browser=!0,E.env={},E.argv=[],E.version="",E.versions={},E.on=u,E.addListener=u,E.once=u,E.off=u,E.removeListener=u,E.removeAllListeners=u,E.emit=u,E.prependListener=u,E.prependOnceListener=u,E.listeners=function(){return[]},E.binding=function(){throw new Error("process.binding is not supported")},E.cwd=function(){return"/"},E.chdir=function(){throw new Error("process.chdir is not supported")},E.umask=function(){return 0}},{}],13:[function(x,I){(function(b){(function(){/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let g;I.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window=="undefined"?b:window):O=>(g||(g=Promise.resolve())).then(O).catch(L=>setTimeout(()=>{throw L},0))}).call(this)}).call(this,typeof $.g=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:$.g)},{}],14:[function(x,I){(function(b,g){(function(){"use strict";var O=x("safe-buffer").Buffer,L=g.crypto||g.msCrypto;I.exports=L&&L.getRandomValues?function(h,y){if(h>4294967295)throw new RangeError("requested too many random bytes");var d=O.allocUnsafe(h);if(0<h)if(65536<h)for(var u=0;u<h;u+=65536)L.getRandomValues(d.slice(u,u+65536));else L.getRandomValues(d);return typeof y=="function"?b.nextTick(function(){y(null,d)}):d}:function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,x("_process"),typeof $.g=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:$.g)},{_process:12,"safe-buffer":30}],15:[function(x,I){"use strict";function b(u,M){u.prototype=Object.create(M.prototype),u.prototype.constructor=u,u.__proto__=M}function g(u,M,T){function E(a,v,m){return typeof M=="string"?M:M(a,v,m)}T||(T=Error);var B=function(a){function v(m,A,_){return a.call(this,E(m,A,_))||this}return b(v,a),v}(T);B.prototype.name=T.name,B.prototype.code=u,d[u]=B}function O(u,M){if(Array.isArray(u)){var T=u.length;return u=u.map(function(E){return E+""}),2<T?"one of ".concat(M," ").concat(u.slice(0,T-1).join(", "),", or ")+u[T-1]:T===2?"one of ".concat(M," ").concat(u[0]," or ").concat(u[1]):"of ".concat(M," ").concat(u[0])}return"of ".concat(M," ").concat(u+"")}function L(u,M,T){return u.substr(!T||0>T?0:+T,M.length)===M}function h(u,M,T){return(T===void 0||T>u.length)&&(T=u.length),u.substring(T-M.length,T)===M}function y(u,M,T){return typeof T!="number"&&(T=0),!(T+M.length>u.length)&&u.indexOf(M,T)!==-1}var d={};g("ERR_INVALID_OPT_VALUE",function(u,M){return'The value "'+M+'" is invalid for option "'+u+'"'},TypeError),g("ERR_INVALID_ARG_TYPE",function(u,M,T){var E;typeof M=="string"&&L(M,"not ")?(E="must not be",M=M.replace(/^not /,"")):E="must be";var B;if(h(u," argument"))B="The ".concat(u," ").concat(E," ").concat(O(M,"type"));else{var a=y(u,".")?"property":"argument";B='The "'.concat(u,'" ').concat(a," ").concat(E," ").concat(O(M,"type"))}return B+=". Received type ".concat(typeof T),B},TypeError),g("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),g("ERR_METHOD_NOT_IMPLEMENTED",function(u){return"The "+u+" method is not implemented"}),g("ERR_STREAM_PREMATURE_CLOSE","Premature close"),g("ERR_STREAM_DESTROYED",function(u){return"Cannot call "+u+" after a stream was destroyed"}),g("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),g("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),g("ERR_STREAM_WRITE_AFTER_END","write after end"),g("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),g("ERR_UNKNOWN_ENCODING",function(u){return"Unknown encoding: "+u},TypeError),g("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),I.exports.codes=d},{}],16:[function(x,I){(function(b){(function(){"use strict";function g(E){return this instanceof g?(y.call(this,E),d.call(this,E),this.allowHalfOpen=!0,void(E&&(E.readable===!1&&(this.readable=!1),E.writable===!1&&(this.writable=!1),E.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",O))))):new g(E)}function O(){this._writableState.ended||b.nextTick(L,this)}function L(E){E.end()}var h=Object.keys||function(E){var B=[];for(var a in E)B.push(a);return B};I.exports=g;var y=x("./_stream_readable"),d=x("./_stream_writable");x("inherits")(g,y);for(var u,M=h(d.prototype),T=0;T<M.length;T++)u=M[T],g.prototype[u]||(g.prototype[u]=d.prototype[u]);Object.defineProperty(g.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(g.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(g.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(g.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(E){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=E,this._writableState.destroyed=E)}})}).call(this)}).call(this,x("_process"))},{"./_stream_readable":18,"./_stream_writable":20,_process:12,inherits:10}],17:[function(x,I){"use strict";function b(O){return this instanceof b?void g.call(this,O):new b(O)}I.exports=b;var g=x("./_stream_transform");x("inherits")(b,g),b.prototype._transform=function(O,L,h){h(null,O)}},{"./_stream_transform":19,inherits:10}],18:[function(x,I){(function(b,g){(function(){"use strict";function O(n){return et.from(n)}function L(n){return et.isBuffer(n)||n instanceof at}function h(n,s,c){return typeof n.prependListener=="function"?n.prependListener(s,c):void(n._events&&n._events[s]?Array.isArray(n._events[s])?n._events[s].unshift(c):n._events[s]=[c,n._events[s]]:n.on(s,c))}function y(n,s,c){Lt=Lt||x("./_stream_duplex"),n=n||{},typeof c!="boolean"&&(c=s instanceof Lt),this.objectMode=!!n.objectMode,c&&(this.objectMode=this.objectMode||!!n.readableObjectMode),this.highWaterMark=G(this,n,"readableHighWaterMark",c),this.buffer=new te,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=n.emitClose!==!1,this.autoDestroy=!!n.autoDestroy,this.destroyed=!1,this.defaultEncoding=n.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,n.encoding&&(!vt&&(vt=x("string_decoder/").StringDecoder),this.decoder=new vt(n.encoding),this.encoding=n.encoding)}function d(n){if(Lt=Lt||x("./_stream_duplex"),!(this instanceof d))return new d(n);var s=this instanceof Lt;this._readableState=new y(n,this,s),this.readable=!0,n&&(typeof n.read=="function"&&(this._read=n.read),typeof n.destroy=="function"&&(this._destroy=n.destroy)),ct.call(this)}function u(n,s,c,C,z){St("readableAddChunk",s);var K=n._readableState;if(s===null)K.reading=!1,a(n,K);else{var ut;if(z||(ut=T(K,s)),ut)Q(n,ut);else if(!(K.objectMode||s&&0<s.length))C||(K.reading=!1,A(n,K));else if(typeof s=="string"||K.objectMode||Object.getPrototypeOf(s)===et.prototype||(s=O(s)),C)K.endEmitted?Q(n,new k):M(n,K,s,!0);else if(K.ended)Q(n,new V);else{if(K.destroyed)return!1;K.reading=!1,K.decoder&&!c?(s=K.decoder.write(s),K.objectMode||s.length!==0?M(n,K,s,!1):A(n,K)):M(n,K,s,!1)}}return!K.ended&&(K.length<K.highWaterMark||K.length===0)}function M(n,s,c,C){s.flowing&&s.length===0&&!s.sync?(s.awaitDrain=0,n.emit("data",c)):(s.length+=s.objectMode?1:c.length,C?s.buffer.unshift(c):s.buffer.push(c),s.needReadable&&v(n)),A(n,s)}function T(n,s){var c;return L(s)||typeof s=="string"||s===void 0||n.objectMode||(c=new wt("chunk",["string","Buffer","Uint8Array"],s)),c}function E(n){return 1073741824<=n?n=1073741824:(n--,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n++),n}function B(n,s){return 0>=n||s.length===0&&s.ended?0:s.objectMode?1:n===n?(n>s.highWaterMark&&(s.highWaterMark=E(n)),n<=s.length?n:s.ended?s.length:(s.needReadable=!0,0)):s.flowing&&s.length?s.buffer.head.data.length:s.length}function a(n,s){if(St("onEofChunk"),!s.ended){if(s.decoder){var c=s.decoder.end();c&&c.length&&(s.buffer.push(c),s.length+=s.objectMode?1:c.length)}s.ended=!0,s.sync?v(n):(s.needReadable=!1,!s.emittedReadable&&(s.emittedReadable=!0,m(n)))}}function v(n){var s=n._readableState;St("emitReadable",s.needReadable,s.emittedReadable),s.needReadable=!1,s.emittedReadable||(St("emitReadable",s.flowing),s.emittedReadable=!0,b.nextTick(m,n))}function m(n){var s=n._readableState;St("emitReadable_",s.destroyed,s.length,s.ended),!s.destroyed&&(s.length||s.ended)&&(n.emit("readable"),s.emittedReadable=!1),s.needReadable=!s.flowing&&!s.ended&&s.length<=s.highWaterMark,lt(n)}function A(n,s){s.readingMore||(s.readingMore=!0,b.nextTick(_,n,s))}function _(n,s){for(;!s.reading&&!s.ended&&(s.length<s.highWaterMark||s.flowing&&s.length===0);){var c=s.length;if(St("maybeReadMore read 0"),n.read(0),c===s.length)break}s.readingMore=!1}function R(n){return function(){var s=n._readableState;St("pipeOnDrain",s.awaitDrain),s.awaitDrain&&s.awaitDrain--,s.awaitDrain===0&&Jt(n,"data")&&(s.flowing=!0,lt(n))}}function Y(n){var s=n._readableState;s.readableListening=0<n.listenerCount("readable"),s.resumeScheduled&&!s.paused?s.flowing=!0:0<n.listenerCount("data")&&n.resume()}function U(n){St("readable nexttick read 0"),n.read(0)}function P(n,s){s.resumeScheduled||(s.resumeScheduled=!0,b.nextTick(Z,n,s))}function Z(n,s){St("resume",s.reading),s.reading||n.read(0),s.resumeScheduled=!1,n.emit("resume"),lt(n),s.flowing&&!s.reading&&n.read(0)}function lt(n){var s=n._readableState;for(St("flow",s.flowing);s.flowing&&n.read()!==null;);}function bt(n,s){if(s.length===0)return null;var c;return s.objectMode?c=s.buffer.shift():!n||n>=s.length?(c=s.decoder?s.buffer.join(""):s.buffer.length===1?s.buffer.first():s.buffer.concat(s.length),s.buffer.clear()):c=s.buffer.consume(n,s.decoder),c}function Ct(n){var s=n._readableState;St("endReadable",s.endEmitted),s.endEmitted||(s.ended=!0,b.nextTick(Tt,s,n))}function Tt(n,s){if(St("endReadableNT",n.endEmitted,n.length),!n.endEmitted&&n.length===0&&(n.endEmitted=!0,s.readable=!1,s.emit("end"),n.autoDestroy)){var c=s._writableState;(!c||c.autoDestroy&&c.finished)&&s.destroy()}}function It(n,s){for(var c=0,C=n.length;c<C;c++)if(n[c]===s)return c;return-1}I.exports=d;var Lt;d.ReadableState=y;var St,ne=x("events").EventEmitter,Jt=function(n,s){return n.listeners(s).length},ct=x("./internal/streams/stream"),et=x("buffer").Buffer,at=g.Uint8Array||function(){},_t=x("util");St=_t&&_t.debuglog?_t.debuglog("stream"):function(){};var vt,Ot,Ht,te=x("./internal/streams/buffer_list"),Ft=x("./internal/streams/destroy"),ie=x("./internal/streams/state"),G=ie.getHighWaterMark,tt=x("../errors").codes,wt=tt.ERR_INVALID_ARG_TYPE,V=tt.ERR_STREAM_PUSH_AFTER_EOF,w=tt.ERR_METHOD_NOT_IMPLEMENTED,k=tt.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;x("inherits")(d,ct);var Q=Ft.errorOrDestroy,pt=["error","close","destroy","pause","resume"];Object.defineProperty(d.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(n){this._readableState&&(this._readableState.destroyed=n)}}),d.prototype.destroy=Ft.destroy,d.prototype._undestroy=Ft.undestroy,d.prototype._destroy=function(n,s){s(n)},d.prototype.push=function(n,s){var c,C=this._readableState;return C.objectMode?c=!0:typeof n=="string"&&(s=s||C.defaultEncoding,s!==C.encoding&&(n=et.from(n,s),s=""),c=!0),u(this,n,s,!1,c)},d.prototype.unshift=function(n){return u(this,n,null,!0,!1)},d.prototype.isPaused=function(){return this._readableState.flowing===!1},d.prototype.setEncoding=function(n){vt||(vt=x("string_decoder/").StringDecoder);var s=new vt(n);this._readableState.decoder=s,this._readableState.encoding=this._readableState.decoder.encoding;for(var c=this._readableState.buffer.head,C="";c!==null;)C+=s.write(c.data),c=c.next;return this._readableState.buffer.clear(),C!==""&&this._readableState.buffer.push(C),this._readableState.length=C.length,this},d.prototype.read=function(n){St("read",n),n=parseInt(n,10);var s=this._readableState,c=n;if(n!==0&&(s.emittedReadable=!1),n===0&&s.needReadable&&((s.highWaterMark===0?0<s.length:s.length>=s.highWaterMark)||s.ended))return St("read: emitReadable",s.length,s.ended),s.length===0&&s.ended?Ct(this):v(this),null;if(n=B(n,s),n===0&&s.ended)return s.length===0&&Ct(this),null;var C=s.needReadable;St("need readable",C),(s.length===0||s.length-n<s.highWaterMark)&&(C=!0,St("length less than watermark",C)),s.ended||s.reading?(C=!1,St("reading or ended",C)):C&&(St("do read"),s.reading=!0,s.sync=!0,s.length===0&&(s.needReadable=!0),this._read(s.highWaterMark),s.sync=!1,!s.reading&&(n=B(c,s)));var z;return z=0<n?bt(n,s):null,z===null?(s.needReadable=s.length<=s.highWaterMark,n=0):(s.length-=n,s.awaitDrain=0),s.length===0&&(!s.ended&&(s.needReadable=!0),c!==n&&s.ended&&Ct(this)),z!==null&&this.emit("data",z),z},d.prototype._read=function(){Q(this,new w("_read()"))},d.prototype.pipe=function(n,s){function c(gt,Vt){St("onunpipe"),gt===Mt&&Vt&&Vt.hasUnpiped===!1&&(Vt.hasUnpiped=!0,z())}function C(){St("onend"),n.end()}function z(){St("cleanup"),n.removeListener("close",Rt),n.removeListener("finish",Yt),n.removeListener("drain",nt),n.removeListener("error",ut),n.removeListener("unpipe",c),Mt.removeListener("end",C),Mt.removeListener("end",Nt),Mt.removeListener("data",K),yt=!0,xt.awaitDrain&&(!n._writableState||n._writableState.needDrain)&&nt()}function K(gt){St("ondata");var Vt=n.write(gt);St("dest.write",Vt),Vt===!1&&((xt.pipesCount===1&&xt.pipes===n||1<xt.pipesCount&&It(xt.pipes,n)!==-1)&&!yt&&(St("false write response, pause",xt.awaitDrain),xt.awaitDrain++),Mt.pause())}function ut(gt){St("onerror",gt),Nt(),n.removeListener("error",ut),Jt(n,"error")===0&&Q(n,gt)}function Rt(){n.removeListener("finish",Yt),Nt()}function Yt(){St("onfinish"),n.removeListener("close",Rt),Nt()}function Nt(){St("unpipe"),Mt.unpipe(n)}var Mt=this,xt=this._readableState;switch(xt.pipesCount){case 0:xt.pipes=n;break;case 1:xt.pipes=[xt.pipes,n];break;default:xt.pipes.push(n)}xt.pipesCount+=1,St("pipe count=%d opts=%j",xt.pipesCount,s);var re=(!s||s.end!==!1)&&n!==b.stdout&&n!==b.stderr,X=re?C:Nt;xt.endEmitted?b.nextTick(X):Mt.once("end",X),n.on("unpipe",c);var nt=R(Mt);n.on("drain",nt);var yt=!1;return Mt.on("data",K),h(n,"error",ut),n.once("close",Rt),n.once("finish",Yt),n.emit("pipe",Mt),xt.flowing||(St("pipe resume"),Mt.resume()),n},d.prototype.unpipe=function(n){var s=this._readableState,c={hasUnpiped:!1};if(s.pipesCount===0)return this;if(s.pipesCount===1)return n&&n!==s.pipes?this:(n||(n=s.pipes),s.pipes=null,s.pipesCount=0,s.flowing=!1,n&&n.emit("unpipe",this,c),this);if(!n){var C=s.pipes,z=s.pipesCount;s.pipes=null,s.pipesCount=0,s.flowing=!1;for(var K=0;K<z;K++)C[K].emit("unpipe",this,{hasUnpiped:!1});return this}var ut=It(s.pipes,n);return ut===-1?this:(s.pipes.splice(ut,1),s.pipesCount-=1,s.pipesCount===1&&(s.pipes=s.pipes[0]),n.emit("unpipe",this,c),this)},d.prototype.on=function(n,s){var c=ct.prototype.on.call(this,n,s),C=this._readableState;return n==="data"?(C.readableListening=0<this.listenerCount("readable"),C.flowing!==!1&&this.resume()):n=="readable"&&!C.endEmitted&&!C.readableListening&&(C.readableListening=C.needReadable=!0,C.flowing=!1,C.emittedReadable=!1,St("on readable",C.length,C.reading),C.length?v(this):!C.reading&&b.nextTick(U,this)),c},d.prototype.addListener=d.prototype.on,d.prototype.removeListener=function(n,s){var c=ct.prototype.removeListener.call(this,n,s);return n==="readable"&&b.nextTick(Y,this),c},d.prototype.removeAllListeners=function(n){var s=ct.prototype.removeAllListeners.apply(this,arguments);return(n==="readable"||n===void 0)&&b.nextTick(Y,this),s},d.prototype.resume=function(){var n=this._readableState;return n.flowing||(St("resume"),n.flowing=!n.readableListening,P(this,n)),n.paused=!1,this},d.prototype.pause=function(){return St("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(St("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},d.prototype.wrap=function(n){var s=this,c=this._readableState,C=!1;for(var z in n.on("end",function(){if(St("wrapped end"),c.decoder&&!c.ended){var ut=c.decoder.end();ut&&ut.length&&s.push(ut)}s.push(null)}),n.on("data",function(ut){if(St("wrapped data"),c.decoder&&(ut=c.decoder.write(ut)),!(c.objectMode&&ut==null)&&(c.objectMode||ut&&ut.length)){var Rt=s.push(ut);Rt||(C=!0,n.pause())}}),n)this[z]===void 0&&typeof n[z]=="function"&&(this[z]=function(ut){return function(){return n[ut].apply(n,arguments)}}(z));for(var K=0;K<pt.length;K++)n.on(pt[K],this.emit.bind(this,pt[K]));return this._read=function(ut){St("wrapped _read",ut),C&&(C=!1,n.resume())},this},typeof Symbol=="function"&&(d.prototype[Symbol.asyncIterator]=function(){return Ot===void 0&&(Ot=x("./internal/streams/async_iterator")),Ot(this)}),Object.defineProperty(d.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(d.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(d.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(n){this._readableState&&(this._readableState.flowing=n)}}),d._fromList=bt,Object.defineProperty(d.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(d.from=function(n,s){return Ht===void 0&&(Ht=x("./internal/streams/from")),Ht(d,n,s)})}).call(this)}).call(this,x("_process"),typeof $.g=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:$.g)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,events:7,inherits:10,"string_decoder/":31,util:2}],19:[function(x,I){"use strict";function b(E,B){var a=this._transformState;a.transforming=!1;var v=a.writecb;if(v===null)return this.emit("error",new d);a.writechunk=null,a.writecb=null,B!=null&&this.push(B),v(E);var m=this._readableState;m.reading=!1,(m.needReadable||m.length<m.highWaterMark)&&this._read(m.highWaterMark)}function g(E){return this instanceof g?(T.call(this,E),this._transformState={afterTransform:b.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,E&&(typeof E.transform=="function"&&(this._transform=E.transform),typeof E.flush=="function"&&(this._flush=E.flush)),void this.on("prefinish",O)):new g(E)}function O(){var E=this;typeof this._flush!="function"||this._readableState.destroyed?L(this,null,null):this._flush(function(B,a){L(E,B,a)})}function L(E,B,a){if(B)return E.emit("error",B);if(a!=null&&E.push(a),E._writableState.length)throw new M;if(E._transformState.transforming)throw new u;return E.push(null)}I.exports=g;var h=x("../errors").codes,y=h.ERR_METHOD_NOT_IMPLEMENTED,d=h.ERR_MULTIPLE_CALLBACK,u=h.ERR_TRANSFORM_ALREADY_TRANSFORMING,M=h.ERR_TRANSFORM_WITH_LENGTH_0,T=x("./_stream_duplex");x("inherits")(g,T),g.prototype.push=function(E,B){return this._transformState.needTransform=!1,T.prototype.push.call(this,E,B)},g.prototype._transform=function(E,B,a){a(new y("_transform()"))},g.prototype._write=function(E,B,a){var v=this._transformState;if(v.writecb=a,v.writechunk=E,v.writeencoding=B,!v.transforming){var m=this._readableState;(v.needTransform||m.needReadable||m.length<m.highWaterMark)&&this._read(m.highWaterMark)}},g.prototype._read=function(){var E=this._transformState;E.writechunk===null||E.transforming?E.needTransform=!0:(E.transforming=!0,this._transform(E.writechunk,E.writeencoding,E.afterTransform))},g.prototype._destroy=function(E,B){T.prototype._destroy.call(this,E,function(a){B(a)})}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(x,I){(function(b,g){(function(){"use strict";function O(V){var w=this;this.next=null,this.entry=null,this.finish=function(){Ct(w,V)}}function L(V){return St.from(V)}function h(V){return St.isBuffer(V)||V instanceof ne}function y(){}function d(V,w,k){Tt=Tt||x("./_stream_duplex"),V=V||{},typeof k!="boolean"&&(k=w instanceof Tt),this.objectMode=!!V.objectMode,k&&(this.objectMode=this.objectMode||!!V.writableObjectMode),this.highWaterMark=et(this,V,"writableHighWaterMark",k),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var Q=V.decodeStrings===!1;this.decodeStrings=!Q,this.defaultEncoding=V.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(pt){A(w,pt)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=V.emitClose!==!1,this.autoDestroy=!!V.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new O(this)}function u(V){Tt=Tt||x("./_stream_duplex");var w=this instanceof Tt;return w||wt.call(u,this)?(this._writableState=new d(V,this,w),this.writable=!0,V&&(typeof V.write=="function"&&(this._write=V.write),typeof V.writev=="function"&&(this._writev=V.writev),typeof V.destroy=="function"&&(this._destroy=V.destroy),typeof V.final=="function"&&(this._final=V.final)),void Lt.call(this)):new u(V)}function M(V,w){var k=new ie;tt(V,k),b.nextTick(w,k)}function T(V,w,k,Q){var pt;return k===null?pt=new Ft:typeof k!="string"&&!w.objectMode&&(pt=new _t("chunk",["string","Buffer"],k)),!pt||(tt(V,pt),b.nextTick(Q,pt),!1)}function E(V,w,k){return V.objectMode||V.decodeStrings===!1||typeof w!="string"||(w=St.from(w,k)),w}function B(V,w,k,Q,pt,n){if(!k){var s=E(w,Q,pt);Q!==s&&(k=!0,pt="buffer",Q=s)}var c=w.objectMode?1:Q.length;w.length+=c;var C=w.length<w.highWaterMark;if(C||(w.needDrain=!0),w.writing||w.corked){var z=w.lastBufferedRequest;w.lastBufferedRequest={chunk:Q,encoding:pt,isBuf:k,callback:n,next:null},z?z.next=w.lastBufferedRequest:w.bufferedRequest=w.lastBufferedRequest,w.bufferedRequestCount+=1}else a(V,w,!1,c,Q,pt,n);return C}function a(V,w,k,Q,pt,n,s){w.writelen=Q,w.writecb=s,w.writing=!0,w.sync=!0,w.destroyed?w.onwrite(new te("write")):k?V._writev(pt,w.onwrite):V._write(pt,n,w.onwrite),w.sync=!1}function v(V,w,k,Q,pt){--w.pendingcb,k?(b.nextTick(pt,Q),b.nextTick(lt,V,w),V._writableState.errorEmitted=!0,tt(V,Q)):(pt(Q),V._writableState.errorEmitted=!0,tt(V,Q),lt(V,w))}function m(V){V.writing=!1,V.writecb=null,V.length-=V.writelen,V.writelen=0}function A(V,w){var k=V._writableState,Q=k.sync,pt=k.writecb;if(typeof pt!="function")throw new Ot;if(m(k),w)v(V,k,Q,w,pt);else{var n=U(k)||V.destroyed;n||k.corked||k.bufferProcessing||!k.bufferedRequest||Y(V,k),Q?b.nextTick(_,V,k,n,pt):_(V,k,n,pt)}}function _(V,w,k,Q){k||R(V,w),w.pendingcb--,Q(),lt(V,w)}function R(V,w){w.length===0&&w.needDrain&&(w.needDrain=!1,V.emit("drain"))}function Y(V,w){w.bufferProcessing=!0;var k=w.bufferedRequest;if(V._writev&&k&&k.next){var Q=w.bufferedRequestCount,pt=Array(Q),n=w.corkedRequestsFree;n.entry=k;for(var s=0,c=!0;k;)pt[s]=k,k.isBuf||(c=!1),k=k.next,s+=1;pt.allBuffers=c,a(V,w,!0,w.length,pt,"",n.finish),w.pendingcb++,w.lastBufferedRequest=null,n.next?(w.corkedRequestsFree=n.next,n.next=null):w.corkedRequestsFree=new O(w),w.bufferedRequestCount=0}else{for(;k;){var C=k.chunk,z=k.encoding,K=k.callback,ut=w.objectMode?1:C.length;if(a(V,w,!1,ut,C,z,K),k=k.next,w.bufferedRequestCount--,w.writing)break}k===null&&(w.lastBufferedRequest=null)}w.bufferedRequest=k,w.bufferProcessing=!1}function U(V){return V.ending&&V.length===0&&V.bufferedRequest===null&&!V.finished&&!V.writing}function P(V,w){V._final(function(k){w.pendingcb--,k&&tt(V,k),w.prefinished=!0,V.emit("prefinish"),lt(V,w)})}function Z(V,w){w.prefinished||w.finalCalled||(typeof V._final!="function"||w.destroyed?(w.prefinished=!0,V.emit("prefinish")):(w.pendingcb++,w.finalCalled=!0,b.nextTick(P,V,w)))}function lt(V,w){var k=U(w);if(k&&(Z(V,w),w.pendingcb===0&&(w.finished=!0,V.emit("finish"),w.autoDestroy))){var Q=V._readableState;(!Q||Q.autoDestroy&&Q.endEmitted)&&V.destroy()}return k}function bt(V,w,k){w.ending=!0,lt(V,w),k&&(w.finished?b.nextTick(k):V.once("finish",k)),w.ended=!0,V.writable=!1}function Ct(V,w,k){var Q=V.entry;for(V.entry=null;Q;){var pt=Q.callback;w.pendingcb--,pt(k),Q=Q.next}w.corkedRequestsFree.next=V}I.exports=u;var Tt;u.WritableState=d;var It={deprecate:x("util-deprecate")},Lt=x("./internal/streams/stream"),St=x("buffer").Buffer,ne=g.Uint8Array||function(){},Jt=x("./internal/streams/destroy"),ct=x("./internal/streams/state"),et=ct.getHighWaterMark,at=x("../errors").codes,_t=at.ERR_INVALID_ARG_TYPE,vt=at.ERR_METHOD_NOT_IMPLEMENTED,Ot=at.ERR_MULTIPLE_CALLBACK,Ht=at.ERR_STREAM_CANNOT_PIPE,te=at.ERR_STREAM_DESTROYED,Ft=at.ERR_STREAM_NULL_VALUES,ie=at.ERR_STREAM_WRITE_AFTER_END,G=at.ERR_UNKNOWN_ENCODING,tt=Jt.errorOrDestroy;x("inherits")(u,Lt),d.prototype.getBuffer=function(){for(var V=this.bufferedRequest,w=[];V;)w.push(V),V=V.next;return w},function(){try{Object.defineProperty(d.prototype,"buffer",{get:It.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(V){}}();var wt;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(wt=Function.prototype[Symbol.hasInstance],Object.defineProperty(u,Symbol.hasInstance,{value:function(V){return!!wt.call(this,V)||this===u&&V&&V._writableState instanceof d}})):wt=function(V){return V instanceof this},u.prototype.pipe=function(){tt(this,new Ht)},u.prototype.write=function(V,w,k){var Q=this._writableState,pt=!1,n=!Q.objectMode&&h(V);return n&&!St.isBuffer(V)&&(V=L(V)),typeof w=="function"&&(k=w,w=null),n?w="buffer":!w&&(w=Q.defaultEncoding),typeof k!="function"&&(k=y),Q.ending?M(this,k):(n||T(this,Q,V,k))&&(Q.pendingcb++,pt=B(this,Q,n,V,w,k)),pt},u.prototype.cork=function(){this._writableState.corked++},u.prototype.uncork=function(){var V=this._writableState;V.corked&&(V.corked--,!V.writing&&!V.corked&&!V.bufferProcessing&&V.bufferedRequest&&Y(this,V))},u.prototype.setDefaultEncoding=function(V){if(typeof V=="string"&&(V=V.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((V+"").toLowerCase())))throw new G(V);return this._writableState.defaultEncoding=V,this},Object.defineProperty(u.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),u.prototype._write=function(V,w,k){k(new vt("_write()"))},u.prototype._writev=null,u.prototype.end=function(V,w,k){var Q=this._writableState;return typeof V=="function"?(k=V,V=null,w=null):typeof w=="function"&&(k=w,w=null),V!=null&&this.write(V,w),Q.corked&&(Q.corked=1,this.uncork()),Q.ending||bt(this,Q,k),this},Object.defineProperty(u.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(u.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(V){this._writableState&&(this._writableState.destroyed=V)}}),u.prototype.destroy=Jt.destroy,u.prototype._undestroy=Jt.undestroy,u.prototype._destroy=function(V,w){w(V)}}).call(this)}).call(this,x("_process"),typeof $.g=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:$.g)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,inherits:10,"util-deprecate":32}],21:[function(x,I){(function(b){(function(){"use strict";function g(R,Y,U){return Y in R?Object.defineProperty(R,Y,{value:U,enumerable:!0,configurable:!0,writable:!0}):R[Y]=U,R}function O(R,Y){return{value:R,done:Y}}function L(R){var Y=R[M];if(Y!==null){var U=R[m].read();U!==null&&(R[a]=null,R[M]=null,R[T]=null,Y(O(U,!1)))}}function h(R){b.nextTick(L,R)}function y(R,Y){return function(U,P){R.then(function(){return Y[B]?void U(O(void 0,!0)):void Y[v](U,P)},P)}}var d,u=x("./end-of-stream"),M=Symbol("lastResolve"),T=Symbol("lastReject"),E=Symbol("error"),B=Symbol("ended"),a=Symbol("lastPromise"),v=Symbol("handlePromise"),m=Symbol("stream"),A=Object.getPrototypeOf(function(){}),_=Object.setPrototypeOf((d={get stream(){return this[m]},next:function(){var R=this,Y=this[E];if(Y!==null)return Promise.reject(Y);if(this[B])return Promise.resolve(O(void 0,!0));if(this[m].destroyed)return new Promise(function(lt,bt){b.nextTick(function(){R[E]?bt(R[E]):lt(O(void 0,!0))})});var U,P=this[a];if(P)U=new Promise(y(P,this));else{var Z=this[m].read();if(Z!==null)return Promise.resolve(O(Z,!1));U=new Promise(this[v])}return this[a]=U,U}},g(d,Symbol.asyncIterator,function(){return this}),g(d,"return",function(){var R=this;return new Promise(function(Y,U){R[m].destroy(null,function(P){return P?void U(P):void Y(O(void 0,!0))})})}),d),A);I.exports=function(R){var Y,U=Object.create(_,(Y={},g(Y,m,{value:R,writable:!0}),g(Y,M,{value:null,writable:!0}),g(Y,T,{value:null,writable:!0}),g(Y,E,{value:null,writable:!0}),g(Y,B,{value:R._readableState.endEmitted,writable:!0}),g(Y,v,{value:function(P,Z){var lt=U[m].read();lt?(U[a]=null,U[M]=null,U[T]=null,P(O(lt,!1))):(U[M]=P,U[T]=Z)},writable:!0}),Y));return U[a]=null,u(R,function(P){if(P&&P.code!=="ERR_STREAM_PREMATURE_CLOSE"){var Z=U[T];return Z!==null&&(U[a]=null,U[M]=null,U[T]=null,Z(P)),void(U[E]=P)}var lt=U[M];lt!==null&&(U[a]=null,U[M]=null,U[T]=null,lt(O(void 0,!0))),U[B]=!0}),R.on("readable",h.bind(null,U)),U}}).call(this)}).call(this,x("_process"))},{"./end-of-stream":24,_process:12}],22:[function(x,I){"use strict";function b(a,v){var m=Object.keys(a);if(Object.getOwnPropertySymbols){var A=Object.getOwnPropertySymbols(a);v&&(A=A.filter(function(_){return Object.getOwnPropertyDescriptor(a,_).enumerable})),m.push.apply(m,A)}return m}function g(a){for(var v,m=1;m<arguments.length;m++)v=arguments[m]==null?{}:arguments[m],m%2?b(Object(v),!0).forEach(function(A){O(a,A,v[A])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(v)):b(Object(v)).forEach(function(A){Object.defineProperty(a,A,Object.getOwnPropertyDescriptor(v,A))});return a}function O(a,v,m){return v in a?Object.defineProperty(a,v,{value:m,enumerable:!0,configurable:!0,writable:!0}):a[v]=m,a}function L(a,v){if(!(a instanceof v))throw new TypeError("Cannot call a class as a function")}function h(a,v){for(var m,A=0;A<v.length;A++)m=v[A],m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(a,m.key,m)}function y(a,v,m){return v&&h(a.prototype,v),m&&h(a,m),a}function d(a,v,m){M.prototype.copy.call(a,v,m)}var u=x("buffer"),M=u.Buffer,T=x("util"),E=T.inspect,B=E&&E.custom||"inspect";I.exports=function(){function a(){L(this,a),this.head=null,this.tail=null,this.length=0}return y(a,[{key:"push",value:function(v){var m={data:v,next:null};0<this.length?this.tail.next=m:this.head=m,this.tail=m,++this.length}},{key:"unshift",value:function(v){var m={data:v,next:this.head};this.length===0&&(this.tail=m),this.head=m,++this.length}},{key:"shift",value:function(){if(this.length!==0){var v=this.head.data;return this.head=this.length===1?this.tail=null:this.head.next,--this.length,v}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(v){if(this.length===0)return"";for(var m=this.head,A=""+m.data;m=m.next;)A+=v+m.data;return A}},{key:"concat",value:function(v){if(this.length===0)return M.alloc(0);for(var m=M.allocUnsafe(v>>>0),A=this.head,_=0;A;)d(A.data,m,_),_+=A.data.length,A=A.next;return m}},{key:"consume",value:function(v,m){var A;return v<this.head.data.length?(A=this.head.data.slice(0,v),this.head.data=this.head.data.slice(v)):v===this.head.data.length?A=this.shift():A=m?this._getString(v):this._getBuffer(v),A}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(v){var m=this.head,A=1,_=m.data;for(v-=_.length;m=m.next;){var R=m.data,Y=v>R.length?R.length:v;if(_+=Y===R.length?R:R.slice(0,v),v-=Y,v===0){Y===R.length?(++A,this.head=m.next?m.next:this.tail=null):(this.head=m,m.data=R.slice(Y));break}++A}return this.length-=A,_}},{key:"_getBuffer",value:function(v){var m=M.allocUnsafe(v),A=this.head,_=1;for(A.data.copy(m),v-=A.data.length;A=A.next;){var R=A.data,Y=v>R.length?R.length:v;if(R.copy(m,m.length-v,0,Y),v-=Y,v===0){Y===R.length?(++_,this.head=A.next?A.next:this.tail=null):(this.head=A,A.data=R.slice(Y));break}++_}return this.length-=_,m}},{key:B,value:function(v,m){return E(this,g({},m,{depth:0,customInspect:!1}))}}]),a}()},{buffer:3,util:2}],23:[function(x,I){(function(b){(function(){"use strict";function g(h,y){L(h,y),O(h)}function O(h){h._writableState&&!h._writableState.emitClose||h._readableState&&!h._readableState.emitClose||h.emit("close")}function L(h,y){h.emit("error",y)}I.exports={destroy:function(h,y){var d=this,u=this._readableState&&this._readableState.destroyed,M=this._writableState&&this._writableState.destroyed;return u||M?(y?y(h):h&&(this._writableState?!this._writableState.errorEmitted&&(this._writableState.errorEmitted=!0,b.nextTick(L,this,h)):b.nextTick(L,this,h)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(h||null,function(T){!y&&T?d._writableState?d._writableState.errorEmitted?b.nextTick(O,d):(d._writableState.errorEmitted=!0,b.nextTick(g,d,T)):b.nextTick(g,d,T):y?(b.nextTick(O,d),y(T)):b.nextTick(O,d)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(h,y){var d=h._readableState,u=h._writableState;d&&d.autoDestroy||u&&u.autoDestroy?h.destroy(y):h.emit("error",y)}}}).call(this)}).call(this,x("_process"))},{_process:12}],24:[function(x,I){"use strict";function b(y){var d=!1;return function(){if(!d){d=!0;for(var u=arguments.length,M=Array(u),T=0;T<u;T++)M[T]=arguments[T];y.apply(this,M)}}}function g(){}function O(y){return y.setHeader&&typeof y.abort=="function"}function L(y,d,u){if(typeof d=="function")return L(y,null,d);d||(d={}),u=b(u||g);var M=d.readable||d.readable!==!1&&y.readable,T=d.writable||d.writable!==!1&&y.writable,E=function(){y.writable||a()},B=y._writableState&&y._writableState.finished,a=function(){T=!1,B=!0,M||u.call(y)},v=y._readableState&&y._readableState.endEmitted,m=function(){M=!1,v=!0,T||u.call(y)},A=function(Y){u.call(y,Y)},_=function(){var Y;return M&&!v?(y._readableState&&y._readableState.ended||(Y=new h),u.call(y,Y)):T&&!B?(y._writableState&&y._writableState.ended||(Y=new h),u.call(y,Y)):void 0},R=function(){y.req.on("finish",a)};return O(y)?(y.on("complete",a),y.on("abort",_),y.req?R():y.on("request",R)):T&&!y._writableState&&(y.on("end",E),y.on("close",E)),y.on("end",m),y.on("finish",a),d.error!==!1&&y.on("error",A),y.on("close",_),function(){y.removeListener("complete",a),y.removeListener("abort",_),y.removeListener("request",R),y.req&&y.req.removeListener("finish",a),y.removeListener("end",E),y.removeListener("close",E),y.removeListener("finish",a),y.removeListener("end",m),y.removeListener("error",A),y.removeListener("close",_)}}var h=x("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;I.exports=L},{"../../../errors":15}],25:[function(x,I){I.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],26:[function(x,I){"use strict";function b(B){var a=!1;return function(){a||(a=!0,B.apply(void 0,arguments))}}function g(B){if(B)throw B}function O(B){return B.setHeader&&typeof B.abort=="function"}function L(B,a,v,m){m=b(m);var A=!1;B.on("close",function(){A=!0}),u===void 0&&(u=x("./end-of-stream")),u(B,{readable:a,writable:v},function(R){return R?m(R):(A=!0,void m())});var _=!1;return function(R){if(!A)return _?void 0:(_=!0,O(B)?B.abort():typeof B.destroy=="function"?B.destroy():void m(R||new E("pipe")))}}function h(B){B()}function y(B,a){return B.pipe(a)}function d(B){return B.length&&typeof B[B.length-1]=="function"?B.pop():g}var u,M=x("../../../errors").codes,T=M.ERR_MISSING_ARGS,E=M.ERR_STREAM_DESTROYED;I.exports=function(){for(var B=arguments.length,a=Array(B),v=0;v<B;v++)a[v]=arguments[v];var m=d(a);if(Array.isArray(a[0])&&(a=a[0]),2>a.length)throw new T("streams");var A,_=a.map(function(R,Y){var U=Y<a.length-1;return L(R,U,0<Y,function(P){A||(A=P),P&&_.forEach(h),U||(_.forEach(h),m(A))})});return a.reduce(y)}},{"../../../errors":15,"./end-of-stream":24}],27:[function(x,I){"use strict";function b(O,L,h){return O.highWaterMark==null?L?O[h]:null:O.highWaterMark}var g=x("../../../errors").codes.ERR_INVALID_OPT_VALUE;I.exports={getHighWaterMark:function(O,L,h,y){var d=b(L,y,h);if(d!=null){if(!(isFinite(d)&&it(d)===d)||0>d){var u=y?h:"highWaterMark";throw new g(u,d)}return it(d)}return O.objectMode?16:16384}}},{"../../../errors":15}],28:[function(x,I){I.exports=x("events").EventEmitter},{events:7}],29:[function(x,I,b){b=I.exports=x("./lib/_stream_readable.js"),b.Stream=b,b.Readable=b,b.Writable=x("./lib/_stream_writable.js"),b.Duplex=x("./lib/_stream_duplex.js"),b.Transform=x("./lib/_stream_transform.js"),b.PassThrough=x("./lib/_stream_passthrough.js"),b.finished=x("./lib/internal/streams/end-of-stream.js"),b.pipeline=x("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],30:[function(x,I,b){function g(y,d){for(var u in y)d[u]=y[u]}function O(y,d,u){return h(y,d,u)}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var L=x("buffer"),h=L.Buffer;h.from&&h.alloc&&h.allocUnsafe&&h.allocUnsafeSlow?I.exports=L:(g(L,b),b.Buffer=O),O.prototype=Object.create(h.prototype),g(h,O),O.from=function(y,d,u){if(typeof y=="number")throw new TypeError("Argument must not be a number");return h(y,d,u)},O.alloc=function(y,d,u){if(typeof y!="number")throw new TypeError("Argument must be a number");var M=h(y);return d===void 0?M.fill(0):typeof u=="string"?M.fill(d,u):M.fill(d),M},O.allocUnsafe=function(y){if(typeof y!="number")throw new TypeError("Argument must be a number");return h(y)},O.allocUnsafeSlow=function(y){if(typeof y!="number")throw new TypeError("Argument must be a number");return L.SlowBuffer(y)}},{buffer:3}],31:[function(x,I,b){"use strict";function g(_){if(!_)return"utf8";for(var R;;)switch(_){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return _;default:if(R)return;_=(""+_).toLowerCase(),R=!0}}function O(_){var R=g(_);if(typeof R!="string"&&(m.isEncoding===A||!A(_)))throw new Error("Unknown encoding: "+_);return R||_}function L(_){this.encoding=O(_);var R;switch(this.encoding){case"utf16le":this.text=M,this.end=T,R=4;break;case"utf8":this.fillLast=u,R=4;break;case"base64":this.text=E,this.end=B,R=3;break;default:return this.write=a,void(this.end=v)}this.lastNeed=0,this.lastTotal=0,this.lastChar=m.allocUnsafe(R)}function h(_){return 127>=_?0:_>>5==6?2:_>>4==14?3:_>>3==30?4:_>>6==2?-1:-2}function y(_,R,Y){var U=R.length-1;if(U<Y)return 0;var P=h(R[U]);return 0<=P?(0<P&&(_.lastNeed=P-1),P):--U<Y||P===-2?0:(P=h(R[U]),0<=P?(0<P&&(_.lastNeed=P-2),P):--U<Y||P===-2?0:(P=h(R[U]),0<=P?(0<P&&(P===2?P=0:_.lastNeed=P-3),P):0))}function d(_,R){if((192&R[0])!=128)return _.lastNeed=0,"\uFFFD";if(1<_.lastNeed&&1<R.length){if((192&R[1])!=128)return _.lastNeed=1,"\uFFFD";if(2<_.lastNeed&&2<R.length&&(192&R[2])!=128)return _.lastNeed=2,"\uFFFD"}}function u(_){var R=this.lastTotal-this.lastNeed,Y=d(this,_,R);return Y===void 0?this.lastNeed<=_.length?(_.copy(this.lastChar,R,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(_.copy(this.lastChar,R,0,_.length),void(this.lastNeed-=_.length)):Y}function M(_,R){if((_.length-R)%2==0){var Y=_.toString("utf16le",R);if(Y){var U=Y.charCodeAt(Y.length-1);if(55296<=U&&56319>=U)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=_[_.length-2],this.lastChar[1]=_[_.length-1],Y.slice(0,-1)}return Y}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=_[_.length-1],_.toString("utf16le",R,_.length-1)}function T(_){var R=_&&_.length?this.write(_):"";if(this.lastNeed){var Y=this.lastTotal-this.lastNeed;return R+this.lastChar.toString("utf16le",0,Y)}return R}function E(_,R){var Y=(_.length-R)%3;return Y==0?_.toString("base64",R):(this.lastNeed=3-Y,this.lastTotal=3,Y==1?this.lastChar[0]=_[_.length-1]:(this.lastChar[0]=_[_.length-2],this.lastChar[1]=_[_.length-1]),_.toString("base64",R,_.length-Y))}function B(_){var R=_&&_.length?this.write(_):"";return this.lastNeed?R+this.lastChar.toString("base64",0,3-this.lastNeed):R}function a(_){return _.toString(this.encoding)}function v(_){return _&&_.length?this.write(_):""}var m=x("safe-buffer").Buffer,A=m.isEncoding||function(_){switch(_=""+_,_&&_.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};b.StringDecoder=L,L.prototype.write=function(_){if(_.length===0)return"";var R,Y;if(this.lastNeed){if(R=this.fillLast(_),R===void 0)return"";Y=this.lastNeed,this.lastNeed=0}else Y=0;return Y<_.length?R?R+this.text(_,Y):this.text(_,Y):R||""},L.prototype.end=function(_){var R=_&&_.length?this.write(_):"";return this.lastNeed?R+"\uFFFD":R},L.prototype.text=function(_,R){var Y=y(this,_,R);if(!this.lastNeed)return _.toString("utf8",R);this.lastTotal=Y;var U=_.length-(Y-this.lastNeed);return _.copy(this.lastChar,0,U),_.toString("utf8",R,U)},L.prototype.fillLast=function(_){return this.lastNeed<=_.length?(_.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(_.copy(this.lastChar,this.lastTotal-this.lastNeed,0,_.length),void(this.lastNeed-=_.length))}},{"safe-buffer":30}],32:[function(x,I){(function(b){(function(){function g(O){try{if(!b.localStorage)return!1}catch(h){return!1}var L=b.localStorage[O];return L!=null&&(L+"").toLowerCase()==="true"}I.exports=function(O,L){function h(){if(!y){if(g("throwDeprecation"))throw new Error(L);g("traceDeprecation")?console.trace(L):console.warn(L),y=!0}return O.apply(this,arguments)}if(g("noDeprecation"))return O;var y=!1;return h}}).call(this)}).call(this,typeof $.g=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:$.g)},{}],"/":[function(x,I){function b(B){return B.replace(/a=ice-options:trickle\s\n/g,"")}function g(B){console.warn(B)}/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */const O=x("debug")("simple-peer"),L=x("get-browser-rtc"),h=x("randombytes"),y=x("readable-stream"),d=x("queue-microtask"),u=x("err-code"),{Buffer:M}=x("buffer"),T=65536;class E extends y.Duplex{constructor(a){if(a=Object.assign({allowHalfOpen:!1},a),super(a),this._id=h(4).toString("hex").slice(0,7),this._debug("new peer %o",a),this.channelName=a.initiator?a.channelName||h(20).toString("hex"):null,this.initiator=a.initiator||!1,this.channelConfig=a.channelConfig||E.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},E.config,a.config),this.offerOptions=a.offerOptions||{},this.answerOptions=a.answerOptions||{},this.sdpTransform=a.sdpTransform||(v=>v),this.streams=a.streams||(a.stream?[a.stream]:[]),this.trickle=a.trickle===void 0||a.trickle,this.allowHalfTrickle=a.allowHalfTrickle!==void 0&&a.allowHalfTrickle,this.iceCompleteTimeout=a.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=a.wrtc&&typeof a.wrtc=="object"?a.wrtc:L(),!this._wrtc)throw u(typeof window=="undefined"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(v){return void this.destroy(u(v,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=v=>{this._onIceCandidate(v)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(v=>{this.destroy(u(v,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=v=>{this._setupData(v)},this.streams&&this.streams.forEach(v=>{this.addStream(v)}),this._pc.ontrack=v=>{this._onTrack(v)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(a){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof a=="string")try{a=JSON.parse(a)}catch(v){a={}}this._debug("signal()"),a.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),a.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(a.transceiverRequest.kind,a.transceiverRequest.init)),a.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(a.candidate):this._pendingCandidates.push(a.candidate)),a.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(a)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(v=>{this._addIceCandidate(v)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(v=>{this.destroy(u(v,"ERR_SET_REMOTE_DESCRIPTION"))}),a.sdp||a.candidate||a.renegotiate||a.transceiverRequest||this.destroy(u(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(a){const v=new this._wrtc.RTCIceCandidate(a);this._pc.addIceCandidate(v).catch(m=>{!v.address||v.address.endsWith(".local")?g("Ignoring unsupported ICE candidate."):this.destroy(u(m,"ERR_ADD_ICE_CANDIDATE"))})}send(a){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(a)}}addTransceiver(a,v){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(a,v),this._needsNegotiation()}catch(m){this.destroy(u(m,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:a,init:v}})}}addStream(a){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),a.getTracks().forEach(v=>{this.addTrack(v,a)})}}addTrack(a,v){if(this.destroying)return;if(this.destroyed)throw u(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const m=this._senderMap.get(a)||new Map;let A=m.get(v);if(!A)A=this._pc.addTrack(a,v),m.set(v,A),this._senderMap.set(a,m),this._needsNegotiation();else throw A.removed?u(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):u(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(a,v,m){if(this.destroying)return;if(this.destroyed)throw u(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const A=this._senderMap.get(a),_=A?A.get(m):null;if(!_)throw u(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");v&&this._senderMap.set(v,A),_.replaceTrack==null?this.destroy(u(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):_.replaceTrack(v)}removeTrack(a,v){if(this.destroying)return;if(this.destroyed)throw u(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const m=this._senderMap.get(a),A=m?m.get(v):null;if(!A)throw u(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{A.removed=!0,this._pc.removeTrack(A)}catch(_){_.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(A):this.destroy(u(_,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(a){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),a.getTracks().forEach(v=>{this.removeTrack(v,a)})}}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,d(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(a){this._destroy(a,()=>{})}_destroy(a,v){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",a&&(a.message||a)),d(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",a&&(a.message||a)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(m){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(m){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,a&&this.emit("error",a),this.emit("close"),v()}))}_setupData(a){if(!a.channel)return this.destroy(u(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=a.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=T),this.channelName=this._channel.label,this._channel.onmessage=m=>{this._onChannelMessage(m)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=m=>{const A=m.error instanceof Error?m.error:new Error(`Datachannel error: ${m.message} ${m.filename}:${m.lineno}:${m.colno}`);this.destroy(u(A,"ERR_DATA_CHANNEL"))};let v=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(v&&this._onChannelClose(),v=!0):v=!1},5e3)}_read(){}_write(a,v,m){if(this.destroyed)return m(u(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(a)}catch(A){return this.destroy(u(A,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>T?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=m):m(null)}else this._debug("write before connect"),this._chunk=a,this._cb=m}_onFinish(){if(!this.destroyed){const a=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?a():this.once("connect",a)}}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(a=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(a.sdp=b(a.sdp)),a.sdp=this.sdpTransform(a.sdp);const v=()=>{if(!this.destroyed){const m=this._pc.localDescription||a;this._debug("signal"),this.emit("signal",{type:m.type,sdp:m.sdp})}};this._pc.setLocalDescription(a).then(()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?v():this.once("_iceComplete",v))}).catch(m=>{this.destroy(u(m,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(a=>{this.destroy(u(a,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(a=>{a.mid||!a.sender.track||a.requested||(a.requested=!0,this.addTransceiver(a.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(a=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(a.sdp=b(a.sdp)),a.sdp=this.sdpTransform(a.sdp);const v=()=>{if(!this.destroyed){const m=this._pc.localDescription||a;this._debug("signal"),this.emit("signal",{type:m.type,sdp:m.sdp}),this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(a).then(()=>{this.destroyed||(this.trickle||this._iceComplete?v():this.once("_iceComplete",v))}).catch(m=>{this.destroy(u(m,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(a=>{this.destroy(u(a,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(u(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const a=this._pc.iceConnectionState,v=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",a,v),this.emit("iceStateChange",a,v),(a==="connected"||a==="completed")&&(this._pcReady=!0,this._maybeReady()),a==="failed"&&this.destroy(u(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),a==="closed"&&this.destroy(u(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(a){const v=m=>(Object.prototype.toString.call(m.values)==="[object Array]"&&m.values.forEach(A=>{Object.assign(m,A)}),m);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(m=>{const A=[];m.forEach(_=>{A.push(v(_))}),a(null,A)},m=>a(m)):0<this._pc.getStats.length?this._pc.getStats(m=>{if(this.destroyed)return;const A=[];m.result().forEach(_=>{const R={};_.names().forEach(Y=>{R[Y]=_.stat(Y)}),R.id=_.id,R.type=_.type,R.timestamp=_.timestamp,A.push(v(R))}),a(null,A)},m=>a(m)):a(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const a=()=>{this.destroyed||this.getStats((v,m)=>{if(this.destroyed)return;v&&(m=[]);const A={},_={},R={};let Y=!1;m.forEach(P=>{(P.type==="remotecandidate"||P.type==="remote-candidate")&&(A[P.id]=P),(P.type==="localcandidate"||P.type==="local-candidate")&&(_[P.id]=P),(P.type==="candidatepair"||P.type==="candidate-pair")&&(R[P.id]=P)});const U=P=>{Y=!0;let Z=_[P.localCandidateId];Z&&(Z.ip||Z.address)?(this.localAddress=Z.ip||Z.address,this.localPort=+Z.port):Z&&Z.ipAddress?(this.localAddress=Z.ipAddress,this.localPort=+Z.portNumber):typeof P.googLocalAddress=="string"&&(Z=P.googLocalAddress.split(":"),this.localAddress=Z[0],this.localPort=+Z[1]),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let lt=A[P.remoteCandidateId];lt&&(lt.ip||lt.address)?(this.remoteAddress=lt.ip||lt.address,this.remotePort=+lt.port):lt&&lt.ipAddress?(this.remoteAddress=lt.ipAddress,this.remotePort=+lt.portNumber):typeof P.googRemoteAddress=="string"&&(lt=P.googRemoteAddress.split(":"),this.remoteAddress=lt[0],this.remotePort=+lt[1]),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(m.forEach(P=>{P.type==="transport"&&P.selectedCandidatePairId&&U(R[P.selectedCandidatePairId]),(P.type==="googCandidatePair"&&P.googActiveConnection==="true"||(P.type==="candidatepair"||P.type==="candidate-pair")&&P.selected)&&U(P)}),!Y&&(!Object.keys(R).length||Object.keys(_).length))return void setTimeout(a,100);if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(Z){return this.destroy(u(Z,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const P=this._cb;this._cb=null,P(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};a()}_onInterval(){this._cb&&this._channel&&!(this._channel.bufferedAmount>T)&&this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(a=>{this._pc.removeTrack(a),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(a){this.destroyed||(a.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:a.candidate.candidate,sdpMLineIndex:a.candidate.sdpMLineIndex,sdpMid:a.candidate.sdpMid}}):!a.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),a.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(a){if(this.destroyed)return;let v=a.data;v instanceof ArrayBuffer&&(v=M.from(v)),this.push(v)}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const a=this._cb;this._cb=null,a(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(a){this.destroyed||a.streams.forEach(v=>{this._debug("on track"),this.emit("track",a.track,v),this._remoteTracks.push({track:a.track,stream:v}),this._remoteStreams.some(m=>m.id===v.id)||(this._remoteStreams.push(v),d(()=>{this._debug("on stream"),this.emit("stream",v)}))})}_debug(){const a=[].slice.call(arguments);a[0]="["+this._id+"] "+a[0],O.apply(null,a)}}E.WEBRTC_SUPPORT=!!L(),E.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},E.channelConfig={},I.exports=E},{buffer:3,debug:4,"err-code":6,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/")})},"../../../node_modules/.pnpm/yjs@13.6.18/node_modules/yjs/dist/yjs.mjs":(Gt,kt,$)=>{"use strict";$.d(kt,{QW:()=>ct,NG:()=>pt,D$:()=>c,gJ:()=>Yt,ay:()=>zt});var it=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/observable.js"),ft=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/array.js"),rt=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/math.js"),x=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/map.js"),I=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/encoding.js"),b=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/decoding.js"),g=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/random.js"),O=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/promise.js"),L=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/buffer.js"),h=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/error.js"),y=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/binary.js"),d=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/function.js"),u=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/set.js"),M=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/logging.js"),T=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/logging.common.js");const E=(r,t)=>({[Symbol.iterator](){return this},next(){const e=r.next();return{value:e.done?void 0:t(e.value),done:e.done}}}),B=r=>({[Symbol.iterator](){return this},next:r}),a=(r,t)=>B(()=>{let e;do e=r.next();while(!e.done&&!t(e.value));return e}),v=(r,t)=>B(()=>{const{done:e,value:i}=r.next();return{done:e,value:e?void 0:t(i)}});var m=$("../../../node_modules/.pnpm/lib0@0.2.97/node_modules/lib0/object.js");class A extends null{constructor(t,e){super(),this.doc=t,this.awareness=e}}class _{constructor(t,e){this.clock=t,this.len=e}}class R{constructor(){this.clients=new Map}}const Y=(r,t,e)=>t.clients.forEach((i,o)=>{const l=r.doc.store.clients.get(o);for(let p=0;p<i.length;p++){const S=i[p];vn(r,l,S.clock,S.len,e)}}),U=(r,t)=>{let e=0,i=r.length-1;for(;e<=i;){const o=rt.GW((e+i)/2),l=r[o],p=l.clock;if(p<=t){if(t<p+l.len)return o;e=o+1}else i=o-1}return null},P=(r,t)=>{const e=r.clients.get(t.client);return e!==void 0&&U(e,t.clock)!==null},Z=r=>{r.clients.forEach(t=>{t.sort((o,l)=>o.clock-l.clock);let e,i;for(e=1,i=1;e<t.length;e++){const o=t[i-1],l=t[e];o.clock+o.len>=l.clock?o.len=rt.Fp(o.len,l.clock+l.len-o.clock):(i<e&&(t[i]=l),i++)}t.length=i})},lt=r=>{const t=new R;for(let e=0;e<r.length;e++)r[e].clients.forEach((i,o)=>{if(!t.clients.has(o)){const l=i.slice();for(let p=e+1;p<r.length;p++)ft.s7(l,r[p].clients.get(o)||[]);t.clients.set(o,l)}});return Z(t),t},bt=(r,t,e,i)=>{x.Yu(r.clients,t,()=>[]).push(new _(e,i))},Ct=()=>new R,Tt=r=>{const t=Ct();return r.clients.forEach((e,i)=>{const o=[];for(let l=0;l<e.length;l++){const p=e[l];if(p.deleted){const S=p.id.clock;let D=p.length;if(l+1<e.length)for(let W=e[l+1];l+1<e.length&&W.deleted;W=e[++l+1])D+=W.length;o.push(new _(S,D))}}o.length>0&&t.clients.set(i,o)}),t},It=(r,t)=>{I.uE(r.restEncoder,t.clients.size),ft.Dp(t.clients.entries()).sort((e,i)=>i[0]-e[0]).forEach(([e,i])=>{r.resetDsCurVal(),I.uE(r.restEncoder,e);const o=i.length;I.uE(r.restEncoder,o);for(let l=0;l<o;l++){const p=i[l];r.writeDsClock(p.clock),r.writeDsLen(p.len)}})},Lt=r=>{const t=new R,e=b.yg(r.restDecoder);for(let i=0;i<e;i++){r.resetDsCurVal();const o=b.yg(r.restDecoder),l=b.yg(r.restDecoder);if(l>0){const p=x.Yu(t.clients,o,()=>[]);for(let S=0;S<l;S++)p.push(new _(r.readDsClock(),r.readDsLen()))}}return t},St=(r,t,e)=>{const i=new R,o=b.yg(r.restDecoder);for(let l=0;l<o;l++){r.resetDsCurVal();const p=b.yg(r.restDecoder),S=b.yg(r.restDecoder),D=e.clients.get(p)||[],W=$t(e,p);for(let j=0;j<S;j++){const F=r.readDsClock(),q=F+r.readDsLen();if(F<W){W<q&&bt(i,p,W,q-W);let ht=de(D,F),mt=D[ht];for(!mt.deleted&&mt.id.clock<F&&(D.splice(ht+1,0,Qe(t,mt,F-mt.id.clock)),ht++);ht<D.length&&(mt=D[ht++],mt.id.clock<q);)mt.deleted||(q<mt.id.clock+mt.length&&D.splice(ht,0,Qe(t,mt,q-mt.id.clock)),mt.delete(t))}else bt(i,p,F,q-F)}}if(i.clients.size>0){const l=new Ft;return I.uE(l.restEncoder,0),It(l,i),l.toUint8Array()}return null},ne=(r,t)=>{if(r.clients.size!==t.clients.size)return!1;for(const[e,i]of r.clients.entries()){const o=t.clients.get(e);if(o===void 0||i.length!==o.length)return!1;for(let l=0;l<i.length;l++){const p=i[l],S=o[l];if(p.clock!==S.clock||p.len!==S.len)return!1}}return!0},Jt=g.U7;class ct extends it.g{constructor({guid:t=g.k$(),collectionid:e=null,gc:i=!0,gcFilter:o=()=>!0,meta:l=null,autoLoad:p=!1,shouldLoad:S=!0}={}){super(),this.gc=i,this.gcFilter=o,this.clientID=Jt(),this.guid=t,this.collectionid=e,this.share=new Map,this.store=new bn,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=S,this.autoLoad=p,this.meta=l,this.isLoaded=!1,this.isSynced=!1,this.whenLoaded=O.Ue(W=>{this.on("load",()=>{this.isLoaded=!0,W(this)})});const D=()=>O.Ue(W=>{const j=F=>{(F===void 0||F===!0)&&(this.off("sync",j),W())};this.on("sync",j)});this.on("sync",W=>{W===!1&&this.isSynced&&(this.whenSynced=D()),this.isSynced=W===void 0||W===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=D()}load(){const t=this._item;t!==null&&!this.shouldLoad&&zt(t.parent.doc,e=>{e.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(ft.Dp(this.subdocs).map(t=>t.guid))}transact(t,e=null){return zt(this,t,e)}get(t,e=se){const i=x.Yu(this.share,t,()=>{const l=new e;return l._integrate(this,null),l}),o=i.constructor;if(e!==se&&o!==e)if(o===se){const l=new e;l._map=i._map,i._map.forEach(p=>{for(;p!==null;p=p.left)p.parent=l}),l._start=i._start;for(let p=l._start;p!==null;p=p.right)p.parent=l;return l._length=i._length,this.share.set(t,l),l._integrate(this,null),l}else throw new Error(`Type with the name ${t} has already been defined with a different constructor`);return i}getArray(t=""){return this.get(t,be)}getText(t=""){return this.get(t,De)}getMap(t=""){return this.get(t,Se)}getXmlElement(t=""){return this.get(t,ke)}getXmlFragment(t=""){return this.get(t,Ce)}toJSON(){const t={};return this.share.forEach((e,i)=>{t[i]=e.toJSON()}),t}destroy(){ft.Dp(this.subdocs).forEach(e=>e.destroy());const t=this._item;if(t!==null){this._item=null;const e=t.content;e.doc=new ct({guid:this.guid,...e.opts,shouldLoad:!1}),e.doc._item=t,zt(t.parent.doc,i=>{const o=e.doc;t.deleted||i.subdocsAdded.add(o),i.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class et{constructor(t){this.restDecoder=t}resetDsCurVal(){}readDsClock(){return b.yg(this.restDecoder)}readDsLen(){return b.yg(this.restDecoder)}}class at extends et{readLeftID(){return gt(b.yg(this.restDecoder),b.yg(this.restDecoder))}readRightID(){return gt(b.yg(this.restDecoder),b.yg(this.restDecoder))}readClient(){return b.yg(this.restDecoder)}readInfo(){return b.kj(this.restDecoder)}readString(){return b.kf(this.restDecoder)}readParentInfo(){return b.yg(this.restDecoder)===1}readTypeRef(){return b.yg(this.restDecoder)}readLen(){return b.yg(this.restDecoder)}readAny(){return b.v_(this.restDecoder)}readBuf(){return L.f9(b.HN(this.restDecoder))}readJSON(){return JSON.parse(b.kf(this.restDecoder))}readKey(){return b.kf(this.restDecoder)}}class _t{constructor(t){this.dsCurrVal=0,this.restDecoder=t}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=b.yg(this.restDecoder),this.dsCurrVal}readDsLen(){const t=b.yg(this.restDecoder)+1;return this.dsCurrVal+=t,t}}class vt extends _t{constructor(t){super(t),this.keys=[],b.yg(t),this.keyClockDecoder=new b.dD(b.HN(t)),this.clientDecoder=new b.UF(b.HN(t)),this.leftClockDecoder=new b.dD(b.HN(t)),this.rightClockDecoder=new b.dD(b.HN(t)),this.infoDecoder=new b.XW(b.HN(t),b.kj),this.stringDecoder=new b.sO(b.HN(t)),this.parentInfoDecoder=new b.XW(b.HN(t),b.kj),this.typeRefDecoder=new b.UF(b.HN(t)),this.lenDecoder=new b.UF(b.HN(t))}readLeftID(){return new nt(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new nt(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return b.v_(this.restDecoder)}readBuf(){return b.HN(this.restDecoder)}readJSON(){return b.v_(this.restDecoder)}readKey(){const t=this.keyClockDecoder.read();if(t<this.keys.length)return this.keys[t];{const e=this.stringDecoder.read();return this.keys.push(e),e}}}class Ot{constructor(){this.restEncoder=I.Mf()}toUint8Array(){return I._f(this.restEncoder)}resetDsCurVal(){}writeDsClock(t){I.uE(this.restEncoder,t)}writeDsLen(t){I.uE(this.restEncoder,t)}}class Ht extends Ot{writeLeftID(t){I.uE(this.restEncoder,t.client),I.uE(this.restEncoder,t.clock)}writeRightID(t){I.uE(this.restEncoder,t.client),I.uE(this.restEncoder,t.clock)}writeClient(t){I.uE(this.restEncoder,t)}writeInfo(t){I.$F(this.restEncoder,t)}writeString(t){I.uw(this.restEncoder,t)}writeParentInfo(t){I.uE(this.restEncoder,t?1:0)}writeTypeRef(t){I.uE(this.restEncoder,t)}writeLen(t){I.uE(this.restEncoder,t)}writeAny(t){I.EM(this.restEncoder,t)}writeBuf(t){I.mP(this.restEncoder,t)}writeJSON(t){I.uw(this.restEncoder,JSON.stringify(t))}writeKey(t){I.uw(this.restEncoder,t)}}class te{constructor(){this.restEncoder=I.Mf(),this.dsCurrVal=0}toUint8Array(){return I._f(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(t){const e=t-this.dsCurrVal;this.dsCurrVal=t,I.uE(this.restEncoder,e)}writeDsLen(t){t===0&&h.zR(),I.uE(this.restEncoder,t-1),this.dsCurrVal+=t}}class Ft extends te{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new I.sX,this.clientEncoder=new I.HE,this.leftClockEncoder=new I.sX,this.rightClockEncoder=new I.sX,this.infoEncoder=new I.GF(I.$F),this.stringEncoder=new I.TS,this.parentInfoEncoder=new I.GF(I.$F),this.typeRefEncoder=new I.HE,this.lenEncoder=new I.HE}toUint8Array(){const t=I.Mf();return I.uE(t,0),I.mP(t,this.keyClockEncoder.toUint8Array()),I.mP(t,this.clientEncoder.toUint8Array()),I.mP(t,this.leftClockEncoder.toUint8Array()),I.mP(t,this.rightClockEncoder.toUint8Array()),I.mP(t,I._f(this.infoEncoder)),I.mP(t,this.stringEncoder.toUint8Array()),I.mP(t,I._f(this.parentInfoEncoder)),I.mP(t,this.typeRefEncoder.toUint8Array()),I.mP(t,this.lenEncoder.toUint8Array()),I.HK(t,I._f(this.restEncoder)),I._f(t)}writeLeftID(t){this.clientEncoder.write(t.client),this.leftClockEncoder.write(t.clock)}writeRightID(t){this.clientEncoder.write(t.client),this.rightClockEncoder.write(t.clock)}writeClient(t){this.clientEncoder.write(t)}writeInfo(t){this.infoEncoder.write(t)}writeString(t){this.stringEncoder.write(t)}writeParentInfo(t){this.parentInfoEncoder.write(t?1:0)}writeTypeRef(t){this.typeRefEncoder.write(t)}writeLen(t){this.lenEncoder.write(t)}writeAny(t){I.EM(this.restEncoder,t)}writeBuf(t){I.mP(this.restEncoder,t)}writeJSON(t){I.EM(this.restEncoder,t)}writeKey(t){const e=this.keyMap.get(t);e===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(t)):this.keyClockEncoder.write(e)}}const ie=(r,t,e,i)=>{i=rt.Fp(i,t[0].id.clock);const o=de(t,i);I.uE(r.restEncoder,t.length-o),r.writeClient(e),I.uE(r.restEncoder,i);const l=t[o];l.write(r,i-l.id.clock);for(let p=o+1;p<t.length;p++)t[p].write(r,0)},G=(r,t,e)=>{const i=new Map;e.forEach((o,l)=>{$t(t,l)>o&&i.set(l,o)}),Be(t).forEach((o,l)=>{e.has(l)||i.set(l,0)}),I.uE(r.restEncoder,i.size),ft.Dp(i.entries()).sort((o,l)=>l[0]-o[0]).forEach(([o,l])=>{ie(r,t.clients.get(o),o,l)})},tt=(r,t)=>{const e=x.Ue(),i=b.yg(r.restDecoder);for(let o=0;o<i;o++){const l=b.yg(r.restDecoder),p=new Array(l),S=r.readClient();let D=b.yg(r.restDecoder);e.set(S,{i:0,refs:p});for(let W=0;W<l;W++){const j=r.readInfo();switch(y.kr&j){case 0:{const F=r.readLen();p[W]=new ae(gt(S,D),F),D+=F;break}case 10:{const F=b.yg(r.restDecoder);p[W]=new ce(gt(S,D),F),D+=F;break}default:{const F=(j&(y.rc|y.x1))===0,q=new Kt(gt(S,D),null,(j&y.x1)===y.x1?r.readLeftID():null,null,(j&y.rc)===y.rc?r.readRightID():null,F?r.readParentInfo()?t.get(r.readString()):r.readLeftID():null,F&&(j&y.cq)===y.cq?r.readString():null,ts(r,j));p[W]=q,D+=q.length}}}}return e},wt=(r,t,e)=>{const i=[];let o=ft.Dp(e.keys()).sort((ht,mt)=>ht-mt);if(o.length===0)return null;const l=()=>{if(o.length===0)return null;let ht=e.get(o[o.length-1]);for(;ht.refs.length===ht.i;)if(o.pop(),o.length>0)ht=e.get(o[o.length-1]);else return null;return ht};let p=l();if(p===null)return null;const S=new bn,D=new Map,W=(ht,mt)=>{const Wt=D.get(ht);(Wt==null||Wt>mt)&&D.set(ht,mt)};let j=p.refs[p.i++];const F=new Map,q=()=>{for(const ht of i){const mt=ht.id.client,Wt=e.get(mt);Wt?(Wt.i--,S.clients.set(mt,Wt.refs.slice(Wt.i)),e.delete(mt),Wt.i=0,Wt.refs=[]):S.clients.set(mt,[ht]),o=o.filter(Dt=>Dt!==mt)}i.length=0};for(;;){if(j.constructor!==ce){const mt=x.Yu(F,j.id.client,()=>$t(t,j.id.client))-j.id.clock;if(mt<0)i.push(j),W(j.id.client,j.id.clock-1),q();else{const Wt=j.getMissing(r,t);if(Wt!==null){i.push(j);const Dt=e.get(Wt)||{refs:[],i:0};if(Dt.refs.length===Dt.i)W(Wt,$t(t,Wt)),q();else{j=Dt.refs[Dt.i++];continue}}else(mt===0||mt<j.length)&&(j.integrate(r,mt),F.set(j.id.client,j.id.clock+j.length))}}if(i.length>0)j=i.pop();else if(p!==null&&p.i<p.refs.length)j=p.refs[p.i++];else{if(p=l(),p===null)break;j=p.refs[p.i++]}}if(S.clients.size>0){const ht=new Ft;return G(ht,S,new Map),I.uE(ht.restEncoder,0),{missing:D,update:ht.toUint8Array()}}return null},V=(r,t)=>G(r,t.doc.store,t.beforeState),w=(r,t,e,i=new vt(r))=>zt(t,o=>{o.local=!1;let l=!1;const p=o.doc,S=p.store,D=tt(i,p),W=wt(o,S,D),j=S.pendingStructs;if(j){for(const[q,ht]of j.missing)if(ht<$t(S,q)){l=!0;break}if(W){for(const[q,ht]of W.missing){const mt=j.missing.get(q);(mt==null||mt>ht)&&j.missing.set(q,ht)}j.update=He([j.update,W.update])}}else S.pendingStructs=W;const F=St(i,o,S);if(S.pendingDs){const q=new vt(b.l1(S.pendingDs));b.yg(q.restDecoder);const ht=St(q,o,S);F&&ht?S.pendingDs=He([F,ht]):S.pendingDs=F||ht}else S.pendingDs=F;if(l){const q=S.pendingStructs.update;S.pendingStructs=null,Q(o.doc,q)}},e,!1),k=(r,t,e)=>w(r,t,e,new at(r)),Q=(r,t,e,i=vt)=>{const o=b.l1(t);w(o,r,e,new i(o))},pt=(r,t,e)=>Q(r,t,e,at),n=(r,t,e=new Map)=>{G(r,t.store,e),It(r,Tt(t.store))},s=(r,t=new Uint8Array([0]),e=new Ft)=>{const i=z(t);n(e,r,i);const o=[e.toUint8Array()];if(r.store.pendingDs&&o.push(r.store.pendingDs),r.store.pendingStructs&&o.push(Dn(r.store.pendingStructs.update,t)),o.length>1){if(e.constructor===Ht)return hs(o.map((l,p)=>p===0?l:gs(l)));if(e.constructor===Ft)return He(o)}return o[0]},c=(r,t)=>s(r,t,new Ht),C=r=>{const t=new Map,e=b.yg(r.restDecoder);for(let i=0;i<e;i++){const o=b.yg(r.restDecoder),l=b.yg(r.restDecoder);t.set(o,l)}return t},z=r=>C(new et(b.l1(r))),K=(r,t)=>(I.uE(r.restEncoder,t.size),ft.Dp(t.entries()).sort((e,i)=>i[0]-e[0]).forEach(([e,i])=>{I.uE(r.restEncoder,e),I.uE(r.restEncoder,i)}),r),ut=(r,t)=>K(r,Be(t.store)),Rt=(r,t=new te)=>(r instanceof Map?K(t,r):ut(t,r),t.toUint8Array()),Yt=r=>Rt(r,new Ot);class Nt{constructor(){this.l=[]}}const Mt=()=>new Nt,xt=(r,t)=>r.l.push(t),re=(r,t)=>{const e=r.l,i=e.length;r.l=e.filter(o=>t!==o),i===r.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},X=(r,t,e)=>d.PP(r.l,[t,e]);class nt{constructor(t,e){this.client=t,this.clock=e}}const yt=(r,t)=>r===t||r!==null&&t!==null&&r.client===t.client&&r.clock===t.clock,gt=(r,t)=>new nt(r,t),Vt=(r,t)=>{encoding.writeVarUint(r,t.client),encoding.writeVarUint(r,t.clock)},Xt=r=>gt(decoding.readVarUint(r),decoding.readVarUint(r)),ee=r=>{for(const[t,e]of r.doc.share.entries())if(e===r)return t;throw h.zR()},Qt=(r,t)=>{for(;t!==null;){if(t.parent===r)return!0;t=t.parent._item}return!1},Ee=r=>{const t=[];let e=r._start;for(;e;)t.push(e),e=e.right;console.log("Children: ",t),console.log("Children content: ",t.filter(i=>!i.deleted).map(i=>i.content))};class Me{constructor(t,e=t.getMap("users")){const i=new Map;this.yusers=e,this.doc=t,this.clients=new Map,this.dss=i;const o=(l,p)=>{const S=l.get("ds"),D=l.get("ids"),W=j=>this.clients.set(j,p);S.observe(j=>{j.changes.added.forEach(F=>{F.content.getContent().forEach(q=>{q instanceof Uint8Array&&this.dss.set(p,lt([this.dss.get(p)||Ct(),Lt(new et(decoding.createDecoder(q)))]))})})}),this.dss.set(p,lt(S.map(j=>Lt(new et(decoding.createDecoder(j)))))),D.observe(j=>j.changes.added.forEach(F=>F.content.getContent().forEach(W))),D.forEach(W)};e.observe(l=>{l.keysChanged.forEach(p=>o(e.get(p),p))}),e.forEach(o)}setUserMapping(t,e,i,{filter:o=()=>!0}={}){const l=this.yusers;let p=l.get(i);p||(p=new Se,p.set("ids",new be),p.set("ds",new be),l.set(i,p)),p.get("ids").push([e]),l.observe(S=>{setTimeout(()=>{const D=l.get(i);if(D!==p){p=D,this.clients.forEach((F,q)=>{i===F&&p.get("ids").push([q])});const W=new Ot,j=this.dss.get(i);j&&(It(W,j),p.get("ds").push([W.toUint8Array()]))}},0)}),t.on("afterTransaction",S=>{setTimeout(()=>{const D=p.get("ds"),W=S.deleteSet;if(S.local&&W.clients.size>0&&o(S,W)){const j=new Ot;It(j,W),D.push([j.toUint8Array()])}})})}getUserByClientId(t){return this.clients.get(t)||null}getUserByDeletedId(t){for(const[e,i]of this.dss.entries())if(P(i,t))return e;return null}}class Le{constructor(t,e,i,o=0){this.type=t,this.tname=e,this.item=i,this.assoc=o}}const tn=r=>{const t={};return r.type&&(t.type=r.type),r.tname&&(t.tname=r.tname),r.item&&(t.item=r.item),r.assoc!=null&&(t.assoc=r.assoc),t},Ne=r=>{var t;return new Le(r.type==null?null:gt(r.type.client,r.type.clock),(t=r.tname)!=null?t:null,r.item==null?null:gt(r.item.client,r.item.clock),r.assoc==null?0:r.assoc)};class en{constructor(t,e,i=0){this.type=t,this.index=e,this.assoc=i}}const nn=(r,t,e=0)=>new en(r,t,e),Te=(r,t,e)=>{let i=null,o=null;return r._item===null?o=ee(r):i=gt(r._item.id.client,r._item.id.clock),new Le(i,o,t,e)},N=(r,t,e=0)=>{let i=r._start;if(e<0){if(t===0)return Te(r,null,e);t--}for(;i!==null;){if(!i.deleted&&i.countable){if(i.length>t)return Te(r,gt(i.id.client,i.id.clock+t),e);t-=i.length}if(i.right===null&&e<0)return Te(r,i.lastId,e);i=i.right}return Te(r,null,e)},H=(r,t)=>{const{type:e,tname:i,item:o,assoc:l}=t;if(o!==null)encoding.writeVarUint(r,0),Vt(r,o);else if(i!==null)encoding.writeUint8(r,1),encoding.writeVarString(r,i);else if(e!==null)encoding.writeUint8(r,2),Vt(r,e);else throw error.unexpectedCase();return encoding.writeVarInt(r,l),r},J=r=>{const t=encoding.createEncoder();return H(t,r),encoding.toUint8Array(t)},ot=r=>{let t=null,e=null,i=null;switch(decoding.readVarUint(r)){case 0:i=Xt(r);break;case 1:e=decoding.readVarString(r);break;case 2:t=Xt(r)}const o=decoding.hasContent(r)?decoding.readVarInt(r):0;return new Le(t,e,i,o)},st=r=>ot(decoding.createDecoder(r)),Et=(r,t,e=!0)=>{const i=t.store,o=r.item,l=r.type,p=r.tname,S=r.assoc;let D=null,W=0;if(o!==null){if($t(i,o.client)<=o.clock)return null;const j=e?gn(i,o):{item:Re(i,o),diff:0},F=j.item;if(!(F instanceof Kt))return null;if(D=F.parent,D._item===null||!D._item.deleted){W=F.deleted||!F.countable?0:j.diff+(S>=0?0:1);let q=F.left;for(;q!==null;)!q.deleted&&q.countable&&(W+=q.length),q=q.left}}else{if(p!==null)D=t.get(p);else if(l!==null){if($t(i,l.client)<=l.clock)return null;const{item:j}=e?gn(i,l):{item:Re(i,l)};if(j instanceof Kt&&j.content instanceof pe)D=j.content.type;else return null}else throw error.unexpectedCase();S>=0?W=D._length:W=0}return nn(D,W,r.assoc)},dt=(r,t)=>r===t||r!==null&&t!==null&&r.tname===t.tname&&yt(r.item,t.item)&&yt(r.type,t.type)&&r.assoc===t.assoc;class At{constructor(t,e){this.ds=t,this.sv=e}}const Ut=(r,t)=>{const e=r.ds.clients,i=t.ds.clients,o=r.sv,l=t.sv;if(o.size!==l.size||e.size!==i.size)return!1;for(const[p,S]of o.entries())if(l.get(p)!==S)return!1;for(const[p,S]of e.entries()){const D=i.get(p)||[];if(S.length!==D.length)return!1;for(let W=0;W<S.length;W++){const j=S[W],F=D[W];if(j.clock!==F.clock||j.len!==F.len)return!1}}return!0},Bt=(r,t=new te)=>(It(t,r.ds),K(t,r.sv),t.toUint8Array()),Pt=r=>Bt(r,new Ot),Zt=(r,t=new _t(decoding.createDecoder(r)))=>new At(Lt(t),C(t)),le=r=>Zt(r,new et(decoding.createDecoder(r))),ge=(r,t)=>new At(r,t),xe=ge(Ct(),new Map),yn=r=>ge(Tt(r.store),Be(r.store)),he=(r,t)=>t===void 0?!r.deleted:t.sv.has(r.id.client)&&(t.sv.get(r.id.client)||0)>r.id.clock&&!P(t.ds,r.id),sn=(r,t)=>{const e=x.Yu(r.meta,sn,u.Ue),i=r.doc.store;e.has(t)||(t.sv.forEach((o,l)=>{o<$t(i,l)&&oe(r,gt(l,o))}),Y(r,t.ds,o=>{}),e.add(t))},sr=(r,t,e=new ct)=>{if(r.gc)throw new Error("Garbage-collection must be disabled in `originDoc`!");const{sv:i,ds:o}=t,l=new Ft;return r.transact(p=>{let S=0;i.forEach(D=>{D>0&&S++}),encoding.writeVarUint(l.restEncoder,S);for(const[D,W]of i){if(W===0)continue;W<$t(r.store,D)&&oe(p,gt(D,W));const j=r.store.clients.get(D)||[],F=de(j,W-1);encoding.writeVarUint(l.restEncoder,F+1),l.writeClient(D),encoding.writeVarUint(l.restEncoder,0);for(let q=0;q<=F;q++)j[q].write(l,0)}It(l,o)}),Q(e,l.toUint8Array(),"snapshot"),e},rs=(r,t,e=vt)=>{const i=new e(decoding.createDecoder(t)),o=new me(i,!1);for(let p=o.curr;p!==null;p=o.next())if((r.sv.get(p.id.client)||0)<p.id.clock+p.length)return!1;const l=lt([r.ds,Lt(i)]);return ne(r.ds,l)},rr=(r,t)=>rs(r,t,at);class bn{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const Be=r=>{const t=new Map;return r.clients.forEach((e,i)=>{const o=e[e.length-1];t.set(i,o.id.clock+o.length)}),t},$t=(r,t)=>{const e=r.clients.get(t);if(e===void 0)return 0;const i=e[e.length-1];return i.id.clock+i.length},wn=(r,t)=>{let e=r.clients.get(t.id.client);if(e===void 0)e=[],r.clients.set(t.id.client,e);else{const i=e[e.length-1];if(i.id.clock+i.length!==t.id.clock)throw h.zR()}e.push(t)},de=(r,t)=>{let e=0,i=r.length-1,o=r[i],l=o.id.clock;if(l===t)return i;let p=rt.GW(t/(l+o.length-1)*i);for(;e<=i;){if(o=r[p],l=o.id.clock,l<=t){if(t<l+o.length)return p;e=p+1}else i=p-1;p=rt.GW((e+i)/2)}throw h.zR()},Re=(r,t)=>{const e=r.clients.get(t.client);return e[de(e,t.clock)]},rn=(r,t,e)=>{const i=de(t,e),o=t[i];return o.id.clock<e&&o instanceof Kt?(t.splice(i+1,0,Qe(r,o,e-o.id.clock)),i+1):i},oe=(r,t)=>{const e=r.doc.store.clients.get(t.client);return e[rn(r,e,t.clock)]},_n=(r,t,e)=>{const i=t.clients.get(e.client),o=de(i,e.clock),l=i[o];return e.clock!==l.id.clock+l.length-1&&l.constructor!==ae&&i.splice(o+1,0,Qe(r,l,e.clock-l.id.clock+1)),l},is=(r,t,e)=>{const i=r.clients.get(t.id.client);i[de(i,t.id.clock)]=e},vn=(r,t,e,i,o)=>{if(i===0)return;const l=e+i;let p=rn(r,t,e),S;do S=t[p++],l<S.id.clock+S.length&&rn(r,t,l),o(S);while(p<t.length&&t[p].id.clock<l)};class os{constructor(t,e,i){this.doc=t,this.deleteSet=new R,this.beforeState=Be(t.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=e,this.meta=new Map,this.local=i,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const En=(r,t)=>t.deleteSet.clients.size===0&&!x.Yj(t.afterState,(e,i)=>t.beforeState.get(i)!==e)?!1:(Z(t.deleteSet),V(r,t),It(r,t.deleteSet),!0),Sn=(r,t,e)=>{const i=t._item;(i===null||i.id.clock<(r.beforeState.get(i.id.client)||0)&&!i.deleted)&&x.Yu(r.changed,t,u.Ue).add(e)},We=(r,t)=>{let e=r[t],i=r[t-1],o=t;for(;o>0;e=i,i=r[--o-1]){if(i.deleted===e.deleted&&i.constructor===e.constructor&&i.mergeWith(e)){e instanceof Kt&&e.parentSub!==null&&e.parent._map.get(e.parentSub)===e&&e.parent._map.set(e.parentSub,i);continue}break}const l=t-o;return l&&r.splice(t+1-l,l),l},Cn=(r,t,e)=>{for(const[i,o]of r.clients.entries()){const l=t.clients.get(i);for(let p=o.length-1;p>=0;p--){const S=o[p],D=S.clock+S.len;for(let W=de(l,S.clock),j=l[W];W<l.length&&j.id.clock<D;j=l[++W]){const F=l[W];if(S.clock+S.len<=F.id.clock)break;F instanceof Kt&&F.deleted&&!F.keep&&e(F)&&F.gc(t,!1)}}}},kn=(r,t)=>{r.clients.forEach((e,i)=>{const o=t.clients.get(i);for(let l=e.length-1;l>=0;l--){const p=e[l],S=rt.VV(o.length-1,1+de(o,p.clock+p.len-1));for(let D=S,W=o[D];D>0&&W.id.clock>=p.clock;W=o[D])D-=1+We(o,D)}})},or=(r,t,e)=>{Cn(r,t,e),kn(r,t)},Tn=(r,t)=>{if(t<r.length){const e=r[t],i=e.doc,o=i.store,l=e.deleteSet,p=e._mergeStructs;try{Z(l),e.afterState=Be(e.doc.store),i.emit("beforeObserverCalls",[e,i]);const S=[];e.changed.forEach((D,W)=>S.push(()=>{(W._item===null||!W._item.deleted)&&W._callObserver(e,D)})),S.push(()=>{e.changedParentTypes.forEach((D,W)=>{W._dEH.l.length>0&&(W._item===null||!W._item.deleted)&&(D=D.filter(j=>j.target._item===null||!j.target._item.deleted),D.forEach(j=>{j.currentTarget=W,j._path=null}),D.sort((j,F)=>j.path.length-F.path.length),X(W._dEH,D,e))})}),S.push(()=>i.emit("afterTransaction",[e,i])),(0,d.PP)(S,[]),e._needFormattingCleanup&&Ds(e)}finally{i.gc&&Cn(l,o,i.gcFilter),kn(l,o),e.afterState.forEach((j,F)=>{const q=e.beforeState.get(F)||0;if(q!==j){const ht=o.clients.get(F),mt=rt.Fp(de(ht,q),1);for(let Wt=ht.length-1;Wt>=mt;)Wt-=1+We(ht,Wt)}});for(let j=p.length-1;j>=0;j--){const{client:F,clock:q}=p[j].id,ht=o.clients.get(F),mt=de(ht,q);mt+1<ht.length&&We(ht,mt+1)>1||mt>0&&We(ht,mt)}if(!e.local&&e.afterState.get(i.clientID)!==e.beforeState.get(i.clientID)&&(M.S0(T.ud,T.Pl,"[yjs] ",T.YW,T.hM,"Changed the client-id because another client seems to be using it."),i.clientID=Jt()),i.emit("afterTransactionCleanup",[e,i]),i._observers.has("update")){const j=new Ht;En(j,e)&&i.emit("update",[j.toUint8Array(),e.origin,i,e])}if(i._observers.has("updateV2")){const j=new Ft;En(j,e)&&i.emit("updateV2",[j.toUint8Array(),e.origin,i,e])}const{subdocsAdded:S,subdocsLoaded:D,subdocsRemoved:W}=e;(S.size>0||W.size>0||D.size>0)&&(S.forEach(j=>{j.clientID=i.clientID,j.collectionid==null&&(j.collectionid=i.collectionid),i.subdocs.add(j)}),W.forEach(j=>i.subdocs.delete(j)),i.emit("subdocs",[{loaded:D,added:S,removed:W},i,e]),W.forEach(j=>j.destroy())),r.length<=t+1?(i._transactionCleanups=[],i.emit("afterAllTransactions",[i,r])):Tn(r,t+1)}}},zt=(r,t,e=null,i=!0)=>{const o=r._transactionCleanups;let l=!1,p=null;r._transaction===null&&(l=!0,r._transaction=new os(r,e,i),o.push(r._transaction),o.length===1&&r.emit("beforeAllTransactions",[r]),r.emit("beforeTransaction",[r._transaction,r]));try{p=t(r._transaction)}finally{if(l){const S=r._transaction===o[0];r._transaction=null,S&&Tn(o,0)}}return p};class ls{constructor(t,e){this.insertions=e,this.deletions=t,this.meta=new Map}}const Rn=(r,t,e)=>{Y(r,e.deletions,i=>{i instanceof Kt&&t.scope.some(o=>Qt(o,i))&&mn(i,!1)})},An=(r,t,e)=>{let i=null;const o=r.doc,l=r.scope;zt(o,S=>{for(;t.length>0&&r.currStackItem===null;){const D=o.store,W=t.pop(),j=new Set,F=[];let q=!1;Y(S,W.insertions,ht=>{if(ht instanceof Kt){if(ht.redone!==null){let{item:mt,diff:Wt}=gn(D,ht.id);Wt>0&&(mt=oe(S,gt(mt.id.client,mt.id.clock+Wt))),ht=mt}!ht.deleted&&l.some(mt=>Qt(mt,ht))&&F.push(ht)}}),Y(S,W.deletions,ht=>{ht instanceof Kt&&l.some(mt=>Qt(mt,ht))&&!P(W.insertions,ht.id)&&j.add(ht)}),j.forEach(ht=>{q=Qn(S,ht,j,W.insertions,r.ignoreRemoteMapChanges,r)!==null||q});for(let ht=F.length-1;ht>=0;ht--){const mt=F[ht];r.deleteFilter(mt)&&(mt.delete(S),q=!0)}r.currStackItem=q?W:null}S.changed.forEach((D,W)=>{D.has(null)&&W._searchMarker&&(W._searchMarker.length=0)}),i=S},r);const p=r.currStackItem;if(p!=null){const S=i.changedParentTypes;r.emit("stack-item-popped",[{stackItem:p,type:e,changedParentTypes:S,origin:r},r]),r.currStackItem=null}return p};class lr extends null{constructor(t,{captureTimeout:e=500,captureTransaction:i=D=>!0,deleteFilter:o=()=>!0,trackedOrigins:l=new Set([null]),ignoreRemoteMapChanges:p=!1,doc:S=array.isArray(t)?t[0].doc:t.doc}={}){super(),this.scope=[],this.doc=S,this.addToScope(t),this.deleteFilter=o,l.add(this),this.trackedOrigins=l,this.captureTransaction=i,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.currStackItem=null,this.lastChange=0,this.ignoreRemoteMapChanges=p,this.captureTimeout=e,this.afterTransactionHandler=D=>{if(!this.captureTransaction(D)||!this.scope.some(Dt=>D.changedParentTypes.has(Dt))||!this.trackedOrigins.has(D.origin)&&(!D.origin||!this.trackedOrigins.has(D.origin.constructor)))return;const W=this.undoing,j=this.redoing,F=W?this.redoStack:this.undoStack;W?this.stopCapturing():j||this.clear(!1,!0);const q=new R;D.afterState.forEach((Dt,jt)=>{const ue=D.beforeState.get(jt)||0,ss=Dt-ue;ss>0&&bt(q,jt,ue,ss)});const ht=time.getUnixTime();let mt=!1;if(this.lastChange>0&&ht-this.lastChange<this.captureTimeout&&F.length>0&&!W&&!j){const Dt=F[F.length-1];Dt.deletions=lt([Dt.deletions,D.deleteSet]),Dt.insertions=lt([Dt.insertions,q])}else F.push(new ls(D.deleteSet,q)),mt=!0;!W&&!j&&(this.lastChange=ht),Y(D,D.deleteSet,Dt=>{Dt instanceof Kt&&this.scope.some(jt=>Qt(jt,Dt))&&mn(Dt,!0)});const Wt=[{stackItem:F[F.length-1],origin:D.origin,type:W?"redo":"undo",changedParentTypes:D.changedParentTypes},this];mt?this.emit("stack-item-added",Wt):this.emit("stack-item-updated",Wt)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",()=>{this.destroy()})}addToScope(t){t=array.isArray(t)?t:[t],t.forEach(e=>{this.scope.every(i=>i!==e)&&(e.doc!==this.doc&&logging.warn("[yjs#509] Not same Y.Doc"),this.scope.push(e))})}addTrackedOrigin(t){this.trackedOrigins.add(t)}removeTrackedOrigin(t){this.trackedOrigins.delete(t)}clear(t=!0,e=!0){(t&&this.canUndo()||e&&this.canRedo())&&this.doc.transact(i=>{t&&(this.undoStack.forEach(o=>Rn(i,this,o)),this.undoStack=[]),e&&(this.redoStack.forEach(o=>Rn(i,this,o)),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:t,redoStackCleared:e}])})}stopCapturing(){this.lastChange=0}undo(){this.undoing=!0;let t;try{t=An(this,this.undoStack,"undo")}finally{this.undoing=!1}return t}redo(){this.redoing=!0;let t;try{t=An(this,this.redoStack,"redo")}finally{this.redoing=!1}return t}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}}function*cs(r){const t=b.yg(r.restDecoder);for(let e=0;e<t;e++){const i=b.yg(r.restDecoder),o=r.readClient();let l=b.yg(r.restDecoder);for(let p=0;p<i;p++){const S=r.readInfo();if(S===10){const D=b.yg(r.restDecoder);yield new ce(gt(o,l),D),l+=D}else if(y.kr&S){const D=(S&(y.rc|y.x1))===0,W=new Kt(gt(o,l),null,(S&y.x1)===y.x1?r.readLeftID():null,null,(S&y.rc)===y.rc?r.readRightID():null,D?r.readParentInfo()?r.readString():r.readLeftID():null,D&&(S&y.cq)===y.cq?r.readString():null,ts(r,S));yield W,l+=W.length}else{const D=r.readLen();yield new ae(gt(o,l),D),l+=D}}}}class me{constructor(t,e){this.gen=cs(t),this.curr=null,this.done=!1,this.filterSkips=e,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===ce);return this.curr}}const cr=r=>as(r,at),as=(r,t=vt)=>{const e=[],i=new t(decoding.createDecoder(r)),o=new me(i,!1);for(let p=o.curr;p!==null;p=o.next())e.push(p);logging.print("Structs: ",e);const l=Lt(i);logging.print("DeleteSet: ",l)},ar=r=>us(r,at),us=(r,t=vt)=>{const e=[],i=new t(decoding.createDecoder(r)),o=new me(i,!1);for(let l=o.curr;l!==null;l=o.next())e.push(l);return{structs:e,ds:Lt(i)}};class on{constructor(t){this.currClient=0,this.startClock=0,this.written=0,this.encoder=t,this.clientStructs=[]}}const hs=r=>He(r,at,Ht),ds=(r,t=te,e=vt)=>{const i=new t,o=new me(new e(decoding.createDecoder(r)),!1);let l=o.curr;if(l!==null){let p=0,S=l.id.client,D=l.id.clock!==0,W=D?0:l.id.clock+l.length;for(;l!==null;l=o.next())S!==l.id.client&&(W!==0&&(p++,encoding.writeVarUint(i.restEncoder,S),encoding.writeVarUint(i.restEncoder,W)),S=l.id.client,W=0,D=l.id.clock!==0),l.constructor===ce&&(D=!0),D||(W=l.id.clock+l.length);W!==0&&(p++,encoding.writeVarUint(i.restEncoder,S),encoding.writeVarUint(i.restEncoder,W));const j=encoding.createEncoder();return encoding.writeVarUint(j,p),encoding.writeBinaryEncoder(j,i.restEncoder),i.restEncoder=j,i.toUint8Array()}else return encoding.writeVarUint(i.restEncoder,0),i.toUint8Array()},ur=r=>ds(r,Ot,at),fs=(r,t=vt)=>{const e=new Map,i=new Map,o=new me(new t(decoding.createDecoder(r)),!1);let l=o.curr;if(l!==null){let p=l.id.client,S=l.id.clock;for(e.set(p,S);l!==null;l=o.next())p!==l.id.client&&(i.set(p,S),e.set(l.id.client,l.id.clock),p=l.id.client),S=l.id.clock+l.length;i.set(p,S)}return{from:e,to:i}},hr=r=>fs(r,at),ps=(r,t)=>{if(r.constructor===ae){const{client:e,clock:i}=r.id;return new ae(gt(e,i+t),r.length-t)}else if(r.constructor===ce){const{client:e,clock:i}=r.id;return new ce(gt(e,i+t),r.length-t)}else{const e=r,{client:i,clock:o}=e.id;return new Kt(gt(i,o+t),null,gt(i,o+t-1),null,e.rightOrigin,e.parent,e.parentSub,e.content.splice(t))}},He=(r,t=vt,e=Ft)=>{if(r.length===1)return r[0];const i=r.map(j=>new t(b.l1(j)));let o=i.map(j=>new me(j,!0)),l=null;const p=new e,S=new on(p);for(;o=o.filter(q=>q.curr!==null),o.sort((q,ht)=>{if(q.curr.id.client===ht.curr.id.client){const mt=q.curr.id.clock-ht.curr.id.clock;return mt===0?q.curr.constructor===ht.curr.constructor?0:q.curr.constructor===ce?1:-1:mt}else return ht.curr.id.client-q.curr.id.client}),o.length!==0;){const j=o[0],F=j.curr.id.client;if(l!==null){let q=j.curr,ht=!1;for(;q!==null&&q.id.clock+q.length<=l.struct.id.clock+l.struct.length&&q.id.client>=l.struct.id.client;)q=j.next(),ht=!0;if(q===null||q.id.client!==F||ht&&q.id.clock>l.struct.id.clock+l.struct.length)continue;if(F!==l.struct.id.client)ye(S,l.struct,l.offset),l={struct:q,offset:0},j.next();else if(l.struct.id.clock+l.struct.length<q.id.clock)if(l.struct.constructor===ce)l.struct.length=q.id.clock+q.length-l.struct.id.clock;else{ye(S,l.struct,l.offset);const mt=q.id.clock-l.struct.id.clock-l.struct.length;l={struct:new ce(gt(F,l.struct.id.clock+l.struct.length),mt),offset:0}}else{const mt=l.struct.id.clock+l.struct.length-q.id.clock;mt>0&&(l.struct.constructor===ce?l.struct.length-=mt:q=ps(q,mt)),l.struct.mergeWith(q)||(ye(S,l.struct,l.offset),l={struct:q,offset:0},j.next())}}else l={struct:j.curr,offset:0},j.next();for(let q=j.curr;q!==null&&q.id.client===F&&q.id.clock===l.struct.id.clock+l.struct.length&&q.constructor!==ce;q=j.next())ye(S,l.struct,l.offset),l={struct:q,offset:0}}l!==null&&(ye(S,l.struct,l.offset),l=null),ln(S);const D=i.map(j=>Lt(j)),W=lt(D);return It(p,W),p.toUint8Array()},Dn=(r,t,e=vt,i=Ft)=>{const o=z(t),l=new i,p=new on(l),S=new e(b.l1(r)),D=new me(S,!1);for(;D.curr;){const j=D.curr,F=j.id.client,q=o.get(F)||0;if(D.curr.constructor===ce){D.next();continue}if(j.id.clock+j.length>q)for(ye(p,j,rt.Fp(q-j.id.clock,0)),D.next();D.curr&&D.curr.id.client===F;)ye(p,D.curr,0),D.next();else for(;D.curr&&D.curr.id.client===F&&D.curr.id.clock+D.curr.length<=q;)D.next()}ln(p);const W=Lt(S);return It(l,W),l.toUint8Array()},dr=(r,t)=>Dn(r,t,at,Ht),In=r=>{r.written>0&&(r.clientStructs.push({written:r.written,restEncoder:I._f(r.encoder.restEncoder)}),r.encoder.restEncoder=I.Mf(),r.written=0)},ye=(r,t,e)=>{r.written>0&&r.currClient!==t.id.client&&In(r),r.written===0&&(r.currClient=t.id.client,r.encoder.writeClient(t.id.client),I.uE(r.encoder.restEncoder,t.id.clock+e)),t.write(r.encoder,e),r.written++},ln=r=>{In(r);const t=r.encoder.restEncoder;I.uE(t,r.clientStructs.length);for(let e=0;e<r.clientStructs.length;e++){const i=r.clientStructs[e];I.uE(t,i.written),I.HK(t,i.restEncoder)}},Ye=(r,t,e,i)=>{const o=new e(b.l1(r)),l=new me(o,!1),p=new i,S=new on(p);for(let W=l.curr;W!==null;W=l.next())ye(S,t(W),0);ln(S);const D=Lt(o);return It(p,D),p.toUint8Array()},Un=({formatting:r=!0,subdocs:t=!0,yxml:e=!0}={})=>{let i=0;const o=map.create(),l=map.create(),p=map.create(),S=map.create();return S.set(null,null),D=>{switch(D.constructor){case ae:case ce:return D;case Kt:{const W=D,j=W.content;switch(j.constructor){case Ue:break;case pe:{if(e){const F=j.type;F instanceof ke&&(F.nodeName=map.setIfUndefined(l,F.nodeName,()=>"node-"+i)),F instanceof Fe&&(F.hookName=map.setIfUndefined(l,F.hookName,()=>"hook-"+i))}break}case ve:{const F=j;F.arr=F.arr.map(()=>i);break}case Ie:{const F=j;F.content=new Uint8Array([i]);break}case Oe:{const F=j;t&&(F.opts={},F.doc.guid=i+"");break}case _e:{const F=j;F.embed={};break}case qt:{const F=j;r&&(F.key=map.setIfUndefined(p,F.key,()=>i+""),F.value=map.setIfUndefined(S,F.value,()=>({i})));break}case Ve:{const F=j;F.arr=F.arr.map(()=>i);break}case fe:{const F=j;F.str=string.repeat(i%10+"",F.str.length);break}default:error.unexpectedCase()}return W.parentSub&&(W.parentSub=map.setIfUndefined(o,W.parentSub,()=>i+"")),i++,D}default:error.unexpectedCase()}}},fr=(r,t)=>Ye(r,Un(t),at,Ht),pr=(r,t)=>Ye(r,Un(t),vt,Ft),gr=r=>Ye(r,f.id,at,Ft),gs=r=>Ye(r,d.id,vt,Ht),On="You must not compute changes after the event-handler fired.";class Ge{constructor(t,e){this.target=t,this.currentTarget=t,this.transaction=e,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=ms(this.currentTarget,this.target))}deletes(t){return P(this.transaction.deleteSet,t.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw h.Ue(On);const t=new Map,e=this.target;this.transaction.changed.get(e).forEach(o=>{if(o!==null){const l=e._map.get(o);let p,S;if(this.adds(l)){let D=l.left;for(;D!==null&&this.adds(D);)D=D.left;if(this.deletes(l))if(D!==null&&this.deletes(D))p="delete",S=ft.Z$(D.content.getContent());else return;else D!==null&&this.deletes(D)?(p="update",S=ft.Z$(D.content.getContent())):(p="add",S=void 0)}else if(this.deletes(l))p="delete",S=ft.Z$(l.content.getContent());else return;t.set(o,{action:p,oldValue:S})}}),this._keys=t}return this._keys}get delta(){return this.changes.delta}adds(t){return t.id.clock>=(this.transaction.beforeState.get(t.id.client)||0)}get changes(){let t=this._changes;if(t===null){if(this.transaction.doc._transactionCleanups.length===0)throw h.Ue(On);const e=this.target,i=u.Ue(),o=u.Ue(),l=[];if(t={added:i,deleted:o,delta:l,keys:this.keys},this.transaction.changed.get(e).has(null)){let S=null;const D=()=>{S&&l.push(S)};for(let W=e._start;W!==null;W=W.right)W.deleted?this.deletes(W)&&!this.adds(W)&&((S===null||S.delete===void 0)&&(D(),S={delete:0}),S.delete+=W.length,o.add(W)):this.adds(W)?((S===null||S.insert===void 0)&&(D(),S={insert:[]}),S.insert=S.insert.concat(W.content.getContent()),i.add(W)):((S===null||S.retain===void 0)&&(D(),S={retain:0}),S.retain+=W.length);S!==null&&S.retain===void 0&&D()}this._changes=t}return t}}const ms=(r,t)=>{const e=[];for(;t._item!==null&&t!==r;){if(t._item.parentSub!==null)e.unshift(t._item.parentSub);else{let i=0,o=t._item.parent._start;for(;o!==t._item&&o!==null;)!o.deleted&&o.countable&&(i+=o.length),o=o.right;e.unshift(i)}t=t._item.parent}return e},Mn=80;let cn=0;class ys{constructor(t,e){t.marker=!0,this.p=t,this.index=e,this.timestamp=cn++}}const bs=r=>{r.timestamp=cn++},Ln=(r,t,e)=>{r.p.marker=!1,r.p=t,t.marker=!0,r.index=e,r.timestamp=cn++},ws=(r,t,e)=>{if(r.length>=Mn){const i=r.reduce((o,l)=>o.timestamp<l.timestamp?o:l);return Ln(i,t,e),i}else{const i=new ys(t,e);return r.push(i),i}},ze=(r,t)=>{if(r._start===null||t===0||r._searchMarker===null)return null;const e=r._searchMarker.length===0?null:r._searchMarker.reduce((l,p)=>rt.Wn(t-l.index)<rt.Wn(t-p.index)?l:p);let i=r._start,o=0;for(e!==null&&(i=e.p,o=e.index,bs(e));i.right!==null&&o<t;){if(!i.deleted&&i.countable){if(t<o+i.length)break;o+=i.length}i=i.right}for(;i.left!==null&&o>t;)i=i.left,!i.deleted&&i.countable&&(o-=i.length);for(;i.left!==null&&i.left.id.client===i.id.client&&i.left.id.clock+i.left.length===i.id.clock;)i=i.left,!i.deleted&&i.countable&&(o-=i.length);return e!==null&&rt.Wn(e.index-o)<i.parent.length/Mn?(Ln(e,i,o),e):ws(r._searchMarker,i,o)},je=(r,t,e)=>{for(let i=r.length-1;i>=0;i--){const o=r[i];if(e>0){let l=o.p;for(l.marker=!1;l&&(l.deleted||!l.countable);)l=l.left,l&&!l.deleted&&l.countable&&(o.index-=l.length);if(l===null||l.marker===!0){r.splice(i,1);continue}o.p=l,l.marker=!0}(t<o.index||e>0&&t===o.index)&&(o.index=rt.Fp(t,o.index+e))}},mr=r=>{let t=r._start;const e=[];for(;t;)e.push(t),t=t.right;return e},Ke=(r,t,e)=>{const i=r,o=t.changedParentTypes;for(;x.Yu(o,r,()=>[]).push(e),r._item!==null;)r=r._item.parent;X(i._eH,e,t)};class se{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=Mt(),this._dEH=Mt(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(t,e){this.doc=t,this._item=e}_copy(){throw h.Nw()}clone(){throw h.Nw()}_write(t){}get _first(){let t=this._start;for(;t!==null&&t.deleted;)t=t.right;return t}_callObserver(t,e){!t.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(t){xt(this._eH,t)}observeDeep(t){xt(this._dEH,t)}unobserve(t){re(this._eH,t)}unobserveDeep(t){re(this._dEH,t)}toJSON(){}}const Nn=(r,t,e)=>{t<0&&(t=r._length+t),e<0&&(e=r._length+e);let i=e-t;const o=[];let l=r._start;for(;l!==null&&i>0;){if(l.countable&&!l.deleted){const p=l.content.getContent();if(p.length<=t)t-=p.length;else{for(let S=t;S<p.length&&i>0;S++)o.push(p[S]),i--;t=0}}l=l.right}return o},xn=r=>{const t=[];let e=r._start;for(;e!==null;){if(e.countable&&!e.deleted){const i=e.content.getContent();for(let o=0;o<i.length;o++)t.push(i[o])}e=e.right}return t},yr=(r,t)=>{const e=[];let i=r._start;for(;i!==null;){if(i.countable&&he(i,t)){const o=i.content.getContent();for(let l=0;l<o.length;l++)e.push(o[l])}i=i.right}return e},Pe=(r,t)=>{let e=0,i=r._start;for(;i!==null;){if(i.countable&&!i.deleted){const o=i.content.getContent();for(let l=0;l<o.length;l++)t(o[l],e++,r)}i=i.right}},Bn=(r,t)=>{const e=[];return Pe(r,(i,o)=>{e.push(t(i,o,r))}),e},_s=r=>{let t=r._start,e=null,i=0;return{[Symbol.iterator](){return this},next:()=>{if(e===null){for(;t!==null&&t.deleted;)t=t.right;if(t===null)return{done:!0,value:void 0};e=t.content.getContent(),i=0,t=t.right}const o=e[i++];return e.length<=i&&(e=null),{done:!1,value:o}}}},jn=(r,t)=>{const e=ze(r,t);let i=r._start;for(e!==null&&(i=e.p,t-=e.index);i!==null;i=i.right)if(!i.deleted&&i.countable){if(t<i.length)return i.content.getContent()[t];t-=i.length}},$e=(r,t,e,i)=>{let o=e;const l=r.doc,p=l.clientID,S=l.store,D=e===null?t._start:e.right;let W=[];const j=()=>{W.length>0&&(o=new Kt(gt(p,$t(S,p)),o,o&&o.lastId,D,D&&D.id,t,null,new ve(W)),o.integrate(r,0),W=[])};i.forEach(F=>{if(F===null)W.push(F);else switch(F.constructor){case Number:case Object:case Boolean:case Array:case String:W.push(F);break;default:switch(j(),F.constructor){case Uint8Array:case ArrayBuffer:o=new Kt(gt(p,$t(S,p)),o,o&&o.lastId,D,D&&D.id,t,null,new Ie(new Uint8Array(F))),o.integrate(r,0);break;case ct:o=new Kt(gt(p,$t(S,p)),o,o&&o.lastId,D,D&&D.id,t,null,new Oe(F)),o.integrate(r,0);break;default:if(F instanceof se)o=new Kt(gt(p,$t(S,p)),o,o&&o.lastId,D,D&&D.id,t,null,new pe(F)),o.integrate(r,0);else throw new Error("Unexpected content type in insert operation")}}}),j()},Pn=()=>h.Ue("Length exceeded!"),Fn=(r,t,e,i)=>{if(e>t._length)throw Pn();if(e===0)return t._searchMarker&&je(t._searchMarker,e,i.length),$e(r,t,null,i);const o=e,l=ze(t,e);let p=t._start;for(l!==null&&(p=l.p,e-=l.index,e===0&&(p=p.prev,e+=p&&p.countable&&!p.deleted?p.length:0));p!==null;p=p.right)if(!p.deleted&&p.countable){if(e<=p.length){e<p.length&&oe(r,gt(p.id.client,p.id.clock+e));break}e-=p.length}return t._searchMarker&&je(t._searchMarker,o,i.length),$e(r,t,p,i)},vs=(r,t,e)=>{let o=(t._searchMarker||[]).reduce((l,p)=>p.index>l.index?p:l,{index:0,p:t._start}).p;if(o)for(;o.right;)o=o.right;return $e(r,t,o,e)},Vn=(r,t,e,i)=>{if(i===0)return;const o=e,l=i,p=ze(t,e);let S=t._start;for(p!==null&&(S=p.p,e-=p.index);S!==null&&e>0;S=S.right)!S.deleted&&S.countable&&(e<S.length&&oe(r,gt(S.id.client,S.id.clock+e)),e-=S.length);for(;i>0&&S!==null;)S.deleted||(i<S.length&&oe(r,gt(S.id.client,S.id.clock+i)),S.delete(r),i-=S.length),S=S.right;if(i>0)throw Pn();t._searchMarker&&je(t._searchMarker,o,-l+i)},Je=(r,t,e)=>{const i=t._map.get(e);i!==void 0&&i.delete(r)},an=(r,t,e,i)=>{const o=t._map.get(e)||null,l=r.doc,p=l.clientID;let S;if(i==null)S=new ve([i]);else switch(i.constructor){case Number:case Object:case Boolean:case Array:case String:S=new ve([i]);break;case Uint8Array:S=new Ie(i);break;case ct:S=new Oe(i);break;default:if(i instanceof se)S=new pe(i);else throw new Error("Unexpected content type")}new Kt(gt(p,$t(l.store,p)),o,o&&o.lastId,null,null,t,e,S).integrate(r,0)},un=(r,t)=>{const e=r._map.get(t);return e!==void 0&&!e.deleted?e.content.getContent()[e.length-1]:void 0},Wn=r=>{const t={};return r._map.forEach((e,i)=>{e.deleted||(t[i]=e.content.getContent()[e.length-1])}),t},Hn=(r,t)=>{const e=r._map.get(t);return e!==void 0&&!e.deleted},br=(r,t,e)=>{let i=r._map.get(t)||null;for(;i!==null&&(!e.sv.has(i.id.client)||i.id.clock>=(e.sv.get(i.id.client)||0));)i=i.left;return i!==null&&he(i,e)?i.content.getContent()[i.length-1]:void 0},Es=(r,t)=>{const e={};return r._map.forEach((i,o)=>{let l=i;for(;l!==null&&(!t.sv.has(l.id.client)||l.id.clock>=(t.sv.get(l.id.client)||0));)l=l.left;l!==null&&he(l,t)&&(e[o]=l.content.getContent()[l.length-1])}),e},Xe=r=>a(r.entries(),t=>!t[1].deleted);class Ss extends Ge{}class be extends se{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(t){const e=new be;return e.push(t),e}_integrate(t,e){super._integrate(t,e),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new be}clone(){const t=new be;return t.insert(0,this.toArray().map(e=>e instanceof se?e.clone():e)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}_callObserver(t,e){super._callObserver(t,e),Ke(this,t,new Ss(this,t))}insert(t,e){this.doc!==null?zt(this.doc,i=>{Fn(i,this,t,e)}):this._prelimContent.splice(t,0,...e)}push(t){this.doc!==null?zt(this.doc,e=>{vs(e,this,t)}):this._prelimContent.push(...t)}unshift(t){this.insert(0,t)}delete(t,e=1){this.doc!==null?zt(this.doc,i=>{Vn(i,this,t,e)}):this._prelimContent.splice(t,e)}get(t){return jn(this,t)}toArray(){return xn(this)}slice(t=0,e=this.length){return Nn(this,t,e)}toJSON(){return this.map(t=>t instanceof se?t.toJSON():t)}map(t){return Bn(this,t)}forEach(t){Pe(this,t)}[Symbol.iterator](){return _s(this)}_write(t){t.writeTypeRef(Ks)}}const Cs=r=>new be;class ks extends Ge{constructor(t,e,i){super(t,e),this.keysChanged=i}}class Se extends se{constructor(t){super(),this._prelimContent=null,t===void 0?this._prelimContent=new Map:this._prelimContent=new Map(t)}_integrate(t,e){super._integrate(t,e),this._prelimContent.forEach((i,o)=>{this.set(o,i)}),this._prelimContent=null}_copy(){return new Se}clone(){const t=new Se;return this.forEach((e,i)=>{t.set(i,e instanceof se?e.clone():e)}),t}_callObserver(t,e){Ke(this,t,new ks(this,t,e))}toJSON(){const t={};return this._map.forEach((e,i)=>{if(!e.deleted){const o=e.content.getContent()[e.length-1];t[i]=o instanceof se?o.toJSON():o}}),t}get size(){return[...Xe(this._map)].length}keys(){return v(Xe(this._map),t=>t[0])}values(){return v(Xe(this._map),t=>t[1].content.getContent()[t[1].length-1])}entries(){return v(Xe(this._map),t=>[t[0],t[1].content.getContent()[t[1].length-1]])}forEach(t){this._map.forEach((e,i)=>{e.deleted||t(e.content.getContent()[e.length-1],i,this)})}[Symbol.iterator](){return this.entries()}delete(t){this.doc!==null?zt(this.doc,e=>{Je(e,this,t)}):this._prelimContent.delete(t)}set(t,e){return this.doc!==null?zt(this.doc,i=>{an(i,this,t,e)}):this._prelimContent.set(t,e),e}get(t){return un(this,t)}has(t){return Hn(this,t)}clear(){this.doc!==null?zt(this.doc,t=>{this.forEach(function(e,i,o){Je(t,o,i)})}):this._prelimContent.clear()}_write(t){t.writeTypeRef($s)}}const Ts=r=>new Se,we=(r,t)=>r===t||typeof r=="object"&&typeof t=="object"&&r&&t&&m.$m(r,t);class hn{constructor(t,e,i,o){this.left=t,this.right=e,this.index=i,this.currentAttributes=o}forward(){switch(this.right===null&&h.zR(),this.right.content.constructor){case qt:this.right.deleted||Ae(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const Yn=(r,t,e)=>{for(;t.right!==null&&e>0;){switch(t.right.content.constructor){case qt:t.right.deleted||Ae(t.currentAttributes,t.right.content);break;default:t.right.deleted||(e<t.right.length&&oe(r,gt(t.right.id.client,t.right.id.clock+e)),t.index+=t.right.length,e-=t.right.length);break}t.left=t.right,t.right=t.right.right}return t},Ze=(r,t,e,i)=>{const o=new Map,l=i?ze(t,e):null;if(l){const p=new hn(l.p.left,l.p,l.index,o);return Yn(r,p,e-l.index)}else{const p=new hn(null,t._start,0,o);return Yn(r,p,e)}},Gn=(r,t,e,i)=>{for(;e.right!==null&&(e.right.deleted===!0||e.right.content.constructor===qt&&we(i.get(e.right.content.key),e.right.content.value));)e.right.deleted||i.delete(e.right.content.key),e.forward();const o=r.doc,l=o.clientID;i.forEach((p,S)=>{const D=e.left,W=e.right,j=new Kt(gt(l,$t(o.store,l)),D,D&&D.lastId,W,W&&W.id,t,null,new qt(S,p));j.integrate(r,0),e.right=j,e.forward()})},Ae=(r,t)=>{const{key:e,value:i}=t;i===null?r.delete(e):r.set(e,i)},zn=(r,t)=>{var e;for(;r.right!==null;){if(!(r.right.deleted||r.right.content.constructor===qt&&we((e=t[r.right.content.key])!=null?e:null,r.right.content.value)))break;r.forward()}},Kn=(r,t,e,i)=>{var S;const o=r.doc,l=o.clientID,p=new Map;for(const D in i){const W=i[D],j=(S=e.currentAttributes.get(D))!=null?S:null;if(!we(j,W)){p.set(D,j);const{left:F,right:q}=e;e.right=new Kt(gt(l,$t(o.store,l)),F,F&&F.lastId,q,q&&q.id,t,null,new qt(D,W)),e.right.integrate(r,0),e.forward()}}return p},dn=(r,t,e,i,o)=>{e.currentAttributes.forEach((q,ht)=>{o[ht]===void 0&&(o[ht]=null)});const l=r.doc,p=l.clientID;zn(e,o);const S=Kn(r,t,e,o),D=i.constructor===String?new fe(i):i instanceof se?new pe(i):new _e(i);let{left:W,right:j,index:F}=e;t._searchMarker&&je(t._searchMarker,e.index,D.getLength()),j=new Kt(gt(p,$t(l.store,p)),W,W&&W.lastId,j,j&&j.id,t,null,D),j.integrate(r,0),e.right=j,e.index=F,e.forward(),Gn(r,t,e,S)},$n=(r,t,e,i,o)=>{const l=r.doc,p=l.clientID;zn(e,o);const S=Kn(r,t,e,o);t:for(;e.right!==null&&(i>0||S.size>0&&(e.right.deleted||e.right.content.constructor===qt));){if(!e.right.deleted)switch(e.right.content.constructor){case qt:{const{key:D,value:W}=e.right.content,j=o[D];if(j!==void 0){if(we(j,W))S.delete(D);else{if(i===0)break t;S.set(D,W)}e.right.delete(r)}else e.currentAttributes.set(D,W);break}default:i<e.right.length&&oe(r,gt(e.right.id.client,e.right.id.clock+i)),i-=e.right.length;break}e.forward()}if(i>0){let D="";for(;i>0;i--)D+=`
`;e.right=new Kt(gt(p,$t(l.store,p)),e.left,e.left&&e.left.lastId,e.right,e.right&&e.right.id,t,null,new fe(D)),e.right.integrate(r,0),e.forward()}Gn(r,t,e,S)},Jn=(r,t,e,i,o)=>{var W,j;let l=t;const p=x.Ue();for(;l&&(!l.countable||l.deleted);){if(!l.deleted&&l.content.constructor===qt){const F=l.content;p.set(F.key,F)}l=l.right}let S=0,D=!1;for(;t!==l;){if(e===t&&(D=!0),!t.deleted){const F=t.content;switch(F.constructor){case qt:{const{key:q,value:ht}=F,mt=(W=i.get(q))!=null?W:null;(p.get(q)!==F||mt===ht)&&(t.delete(r),S++,!D&&((j=o.get(q))!=null?j:null)===ht&&mt!==ht&&(mt===null?o.delete(q):o.set(q,mt))),!D&&!t.deleted&&Ae(o,F);break}}}t=t.right}return S},Rs=(r,t)=>{for(;t&&t.right&&(t.right.deleted||!t.right.countable);)t=t.right;const e=new Set;for(;t&&(t.deleted||!t.countable);){if(!t.deleted&&t.content.constructor===qt){const i=t.content.key;e.has(i)?t.delete(r):e.add(i)}t=t.left}},As=r=>{let t=0;return zt(r.doc,e=>{let i=r._start,o=r._start,l=x.Ue();const p=x.JG(l);for(;o;){if(o.deleted===!1)switch(o.content.constructor){case qt:Ae(p,o.content);break;default:t+=Jn(e,i,o,l,p),l=x.JG(p),i=o;break}o=o.right}}),t},Ds=r=>{const t=new Set,e=r.doc;for(const[i,o]of r.afterState.entries()){const l=r.beforeState.get(i)||0;o!==l&&vn(r,e.store.clients.get(i),l,o,p=>{!p.deleted&&p.content.constructor===qt&&p.constructor!==ae&&t.add(p.parent)})}zt(e,i=>{Y(r,r.deleteSet,o=>{if(o instanceof ae||!o.parent._hasFormatting||t.has(o.parent))return;const l=o.parent;o.content.constructor===qt?t.add(l):Rs(i,o)});for(const o of t)As(o)})},Xn=(r,t,e)=>{const i=e,o=x.JG(t.currentAttributes),l=t.right;for(;e>0&&t.right!==null;){if(t.right.deleted===!1)switch(t.right.content.constructor){case pe:case _e:case fe:e<t.right.length&&oe(r,gt(t.right.id.client,t.right.id.clock+e)),e-=t.right.length,t.right.delete(r);break}t.forward()}l&&Jn(r,l,t.right,o,t.currentAttributes);const p=(t.left||t.right).parent;return p._searchMarker&&je(p._searchMarker,t.index,-i+e),t};class Is extends Ge{constructor(t,e,i){super(t,e),this.childListChanged=!1,this.keysChanged=new Set,i.forEach(o=>{o===null?this.childListChanged=!0:this.keysChanged.add(o)})}get changes(){if(this._changes===null){const t={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=t}return this._changes}get delta(){if(this._delta===null){const t=this.target.doc,e=[];zt(t,i=>{var ht,mt,Wt;const o=new Map,l=new Map;let p=this.target._start,S=null;const D={};let W="",j=0,F=0;const q=()=>{if(S!==null){let Dt=null;switch(S){case"delete":F>0&&(Dt={delete:F}),F=0;break;case"insert":(typeof W=="object"||W.length>0)&&(Dt={insert:W},o.size>0&&(Dt.attributes={},o.forEach((jt,ue)=>{jt!==null&&(Dt.attributes[ue]=jt)}))),W="";break;case"retain":j>0&&(Dt={retain:j},m.xb(D)||(Dt.attributes=m.f0({},D))),j=0;break}Dt&&e.push(Dt),S=null}};for(;p!==null;){switch(p.content.constructor){case pe:case _e:this.adds(p)?this.deletes(p)||(q(),S="insert",W=p.content.getContent()[0],q()):this.deletes(p)?(S!=="delete"&&(q(),S="delete"),F+=1):p.deleted||(S!=="retain"&&(q(),S="retain"),j+=1);break;case fe:this.adds(p)?this.deletes(p)||(S!=="insert"&&(q(),S="insert"),W+=p.content.str):this.deletes(p)?(S!=="delete"&&(q(),S="delete"),F+=p.length):p.deleted||(S!=="retain"&&(q(),S="retain"),j+=p.length);break;case qt:{const{key:Dt,value:jt}=p.content;if(this.adds(p)){if(!this.deletes(p)){const ue=(ht=o.get(Dt))!=null?ht:null;we(ue,jt)?jt!==null&&p.delete(i):(S==="retain"&&q(),we(jt,(mt=l.get(Dt))!=null?mt:null)?delete D[Dt]:D[Dt]=jt)}}else if(this.deletes(p)){l.set(Dt,jt);const ue=(Wt=o.get(Dt))!=null?Wt:null;we(ue,jt)||(S==="retain"&&q(),D[Dt]=ue)}else if(!p.deleted){l.set(Dt,jt);const ue=D[Dt];ue!==void 0&&(we(ue,jt)?ue!==null&&p.delete(i):(S==="retain"&&q(),jt===null?delete D[Dt]:D[Dt]=jt))}p.deleted||(S==="insert"&&q(),Ae(o,p.content));break}}p=p.right}for(q();e.length>0;){const Dt=e[e.length-1];if(Dt.retain!==void 0&&Dt.attributes===void 0)e.pop();else break}}),this._delta=e}return this._delta}}class De extends se{constructor(t){super(),this._pending=t!==void 0?[()=>this.insert(0,t)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this._length}_integrate(t,e){super._integrate(t,e);try{this._pending.forEach(i=>i())}catch(i){console.error(i)}this._pending=null}_copy(){return new De}clone(){const t=new De;return t.applyDelta(this.toDelta()),t}_callObserver(t,e){super._callObserver(t,e);const i=new Is(this,t,e);Ke(this,t,i),!t.local&&this._hasFormatting&&(t._needFormattingCleanup=!0)}toString(){let t="",e=this._start;for(;e!==null;)!e.deleted&&e.countable&&e.content.constructor===fe&&(t+=e.content.str),e=e.right;return t}toJSON(){return this.toString()}applyDelta(t,{sanitize:e=!0}={}){this.doc!==null?zt(this.doc,i=>{const o=new hn(null,this._start,0,new Map);for(let l=0;l<t.length;l++){const p=t[l];if(p.insert!==void 0){const S=!e&&typeof p.insert=="string"&&l===t.length-1&&o.right===null&&p.insert.slice(-1)===`
`?p.insert.slice(0,-1):p.insert;(typeof S!="string"||S.length>0)&&dn(i,this,o,S,p.attributes||{})}else p.retain!==void 0?$n(i,this,o,p.retain,p.attributes||{}):p.delete!==void 0&&Xn(i,o,p.delete)}}):this._pending.push(()=>this.applyDelta(t))}toDelta(t,e,i){const o=[],l=new Map,p=this.doc;let S="",D=this._start;function W(){if(S.length>0){const F={};let q=!1;l.forEach((mt,Wt)=>{q=!0,F[Wt]=mt});const ht={insert:S};q&&(ht.attributes=F),o.push(ht),S=""}}const j=()=>{for(;D!==null;){if(he(D,t)||e!==void 0&&he(D,e))switch(D.content.constructor){case fe:{const F=l.get("ychange");t!==void 0&&!he(D,t)?(F===void 0||F.user!==D.id.client||F.type!=="removed")&&(W(),l.set("ychange",i?i("removed",D.id):{type:"removed"})):e!==void 0&&!he(D,e)?(F===void 0||F.user!==D.id.client||F.type!=="added")&&(W(),l.set("ychange",i?i("added",D.id):{type:"added"})):F!==void 0&&(W(),l.delete("ychange")),S+=D.content.str;break}case pe:case _e:{W();const F={insert:D.content.getContent()[0]};if(l.size>0){const q={};F.attributes=q,l.forEach((ht,mt)=>{q[mt]=ht})}o.push(F);break}case qt:he(D,t)&&(W(),Ae(l,D.content));break}D=D.right}W()};return t||e?zt(p,F=>{t&&sn(F,t),e&&sn(F,e),j()},"cleanup"):j(),o}insert(t,e,i){if(e.length<=0)return;const o=this.doc;o!==null?zt(o,l=>{const p=Ze(l,this,t,!i);i||(i={},p.currentAttributes.forEach((S,D)=>{i[D]=S})),dn(l,this,p,e,i)}):this._pending.push(()=>this.insert(t,e,i))}insertEmbed(t,e,i){const o=this.doc;o!==null?zt(o,l=>{const p=Ze(l,this,t,!i);dn(l,this,p,e,i||{})}):this._pending.push(()=>this.insertEmbed(t,e,i||{}))}delete(t,e){if(e===0)return;const i=this.doc;i!==null?zt(i,o=>{Xn(o,Ze(o,this,t,!0),e)}):this._pending.push(()=>this.delete(t,e))}format(t,e,i){if(e===0)return;const o=this.doc;o!==null?zt(o,l=>{const p=Ze(l,this,t,!1);p.right!==null&&$n(l,this,p,e,i)}):this._pending.push(()=>this.format(t,e,i))}removeAttribute(t){this.doc!==null?zt(this.doc,e=>{Je(e,this,t)}):this._pending.push(()=>this.removeAttribute(t))}setAttribute(t,e){this.doc!==null?zt(this.doc,i=>{an(i,this,t,e)}):this._pending.push(()=>this.setAttribute(t,e))}getAttribute(t){return un(this,t)}getAttributes(){return Wn(this)}_write(t){t.writeTypeRef(Js)}}const Us=r=>new De;class fn{constructor(t,e=()=>!0){this._filter=e,this._root=t,this._currentNode=t._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let t=this._currentNode,e=t&&t.content&&t.content.type;if(t!==null&&(!this._firstCall||t.deleted||!this._filter(e)))do if(e=t.content.type,!t.deleted&&(e.constructor===ke||e.constructor===Ce)&&e._start!==null)t=e._start;else for(;t!==null;)if(t.right!==null){t=t.right;break}else t.parent===this._root?t=null:t=t.parent._item;while(t!==null&&(t.deleted||!this._filter(t.content.type)));return this._firstCall=!1,t===null?{value:void 0,done:!0}:(this._currentNode=t,{value:t.content.type,done:!1})}}class Ce extends se{constructor(){super(),this._prelimContent=[]}get firstChild(){const t=this._first;return t?t.content.getContent()[0]:null}_integrate(t,e){super._integrate(t,e),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Ce}clone(){const t=new Ce;return t.insert(0,this.toArray().map(e=>e instanceof se?e.clone():e)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(t){return new fn(this,t)}querySelector(t){t=t.toUpperCase();const i=new fn(this,o=>o.nodeName&&o.nodeName.toUpperCase()===t).next();return i.done?null:i.value}querySelectorAll(t){return t=t.toUpperCase(),ft.Dp(new fn(this,e=>e.nodeName&&e.nodeName.toUpperCase()===t))}_callObserver(t,e){Ke(this,t,new Ls(this,e,t))}toString(){return Bn(this,t=>t.toString()).join("")}toJSON(){return this.toString()}toDOM(t=document,e={},i){const o=t.createDocumentFragment();return i!==void 0&&i._createAssociation(o,this),Pe(this,l=>{o.insertBefore(l.toDOM(t,e,i),null)}),o}insert(t,e){this.doc!==null?zt(this.doc,i=>{Fn(i,this,t,e)}):this._prelimContent.splice(t,0,...e)}insertAfter(t,e){if(this.doc!==null)zt(this.doc,i=>{const o=t&&t instanceof se?t._item:t;$e(i,this,o,e)});else{const i=this._prelimContent,o=t===null?0:i.findIndex(l=>l===t)+1;if(o===0&&t!==null)throw h.Ue("Reference item not found");i.splice(o,0,...e)}}delete(t,e=1){this.doc!==null?zt(this.doc,i=>{Vn(i,this,t,e)}):this._prelimContent.splice(t,e)}toArray(){return xn(this)}push(t){this.insert(this.length,t)}unshift(t){this.insert(0,t)}get(t){return jn(this,t)}slice(t=0,e=this.length){return Nn(this,t,e)}forEach(t){Pe(this,t)}_write(t){t.writeTypeRef(Zs)}}const Os=r=>new Ce;class ke extends Ce{constructor(t="UNDEFINED"){super(),this.nodeName=t,this._prelimAttrs=new Map}get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_integrate(t,e){super._integrate(t,e),this._prelimAttrs.forEach((i,o)=>{this.setAttribute(o,i)}),this._prelimAttrs=null}_copy(){return new ke(this.nodeName)}clone(){const t=new ke(this.nodeName),e=this.getAttributes();return m.Ed(e,(i,o)=>{typeof i=="string"&&t.setAttribute(o,i)}),t.insert(0,this.toArray().map(i=>i instanceof se?i.clone():i)),t}toString(){const t=this.getAttributes(),e=[],i=[];for(const S in t)i.push(S);i.sort();const o=i.length;for(let S=0;S<o;S++){const D=i[S];e.push(D+'="'+t[D]+'"')}const l=this.nodeName.toLocaleLowerCase(),p=e.length>0?" "+e.join(" "):"";return`<${l}${p}>${super.toString()}</${l}>`}removeAttribute(t){this.doc!==null?zt(this.doc,e=>{Je(e,this,t)}):this._prelimAttrs.delete(t)}setAttribute(t,e){this.doc!==null?zt(this.doc,i=>{an(i,this,t,e)}):this._prelimAttrs.set(t,e)}getAttribute(t){return un(this,t)}hasAttribute(t){return Hn(this,t)}getAttributes(t){return t?Es(this,t):Wn(this)}toDOM(t=document,e={},i){const o=t.createElement(this.nodeName),l=this.getAttributes();for(const p in l){const S=l[p];typeof S=="string"&&o.setAttribute(p,S)}return Pe(this,p=>{o.appendChild(p.toDOM(t,e,i))}),i!==void 0&&i._createAssociation(o,this),o}_write(t){t.writeTypeRef(Xs),t.writeKey(this.nodeName)}}const Ms=r=>new ke(r.readKey());class Ls extends Ge{constructor(t,e,i){super(t,i),this.childListChanged=!1,this.attributesChanged=new Set,e.forEach(o=>{o===null?this.childListChanged=!0:this.attributesChanged.add(o)})}}class Fe extends Se{constructor(t){super(),this.hookName=t}_copy(){return new Fe(this.hookName)}clone(){const t=new Fe(this.hookName);return this.forEach((e,i)=>{t.set(i,e)}),t}toDOM(t=document,e={},i){const o=e[this.hookName];let l;return o!==void 0?l=o.createDom(this):l=document.createElement(this.hookName),l.setAttribute("data-yjs-hook",this.hookName),i!==void 0&&i._createAssociation(l,this),l}_write(t){t.writeTypeRef(qs),t.writeKey(this.hookName)}}const Ns=r=>new Fe(r.readKey());class qe extends De{get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_copy(){return new qe}clone(){const t=new qe;return t.applyDelta(this.toDelta()),t}toDOM(t=document,e,i){const o=t.createTextNode(this.toString());return i!==void 0&&i._createAssociation(o,this),o}toString(){return this.toDelta().map(t=>{const e=[];for(const o in t.attributes){const l=[];for(const p in t.attributes[o])l.push({key:p,value:t.attributes[o][p]});l.sort((p,S)=>p.key<S.key?-1:1),e.push({nodeName:o,attrs:l})}e.sort((o,l)=>o.nodeName<l.nodeName?-1:1);let i="";for(let o=0;o<e.length;o++){const l=e[o];i+=`<${l.nodeName}`;for(let p=0;p<l.attrs.length;p++){const S=l.attrs[p];i+=` ${S.key}="${S.value}"`}i+=">"}i+=t.insert;for(let o=e.length-1;o>=0;o--)i+=`</${e[o].nodeName}>`;return i}).join("")}toJSON(){return this.toString()}_write(t){t.writeTypeRef(Qs)}}const xs=r=>new qe;class pn{constructor(t,e){this.id=t,this.length=e}get deleted(){throw h.Nw()}mergeWith(t){return!1}write(t,e,i){throw h.Nw()}integrate(t,e){throw h.Nw()}}const Bs=0;class ae extends pn{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,e){e>0&&(this.id.clock+=e,this.length-=e),wn(t.doc.store,this)}write(t,e){t.writeInfo(Bs),t.writeLen(this.length-e)}getMissing(t,e){return null}}class Ie{constructor(t){this.content=t}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new Ie(this.content)}splice(t){throw h.Nw()}mergeWith(t){return!1}integrate(t,e){}delete(t){}gc(t){}write(t,e){t.writeBuf(this.content)}getRef(){return 3}}const js=r=>new Ie(r.readBuf());class Ue{constructor(t){this.len=t}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new Ue(this.len)}splice(t){const e=new Ue(this.len-t);return this.len=t,e}mergeWith(t){return this.len+=t.len,!0}integrate(t,e){bt(t.deleteSet,e.id.client,e.id.clock,this.len),e.markDeleted()}delete(t){}gc(t){}write(t,e){t.writeLen(this.len-e)}getRef(){return 1}}const Ps=r=>new Ue(r.readLen()),Zn=(r,t)=>new ct({guid:r,...t,shouldLoad:t.shouldLoad||t.autoLoad||!1});class Oe{constructor(t){t._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=t;const e={};this.opts=e,t.gc||(e.gc=!1),t.autoLoad&&(e.autoLoad=!0),t.meta!==null&&(e.meta=t.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new Oe(Zn(this.doc.guid,this.opts))}splice(t){throw h.Nw()}mergeWith(t){return!1}integrate(t,e){this.doc._item=e,t.subdocsAdded.add(this.doc),this.doc.shouldLoad&&t.subdocsLoaded.add(this.doc)}delete(t){t.subdocsAdded.has(this.doc)?t.subdocsAdded.delete(this.doc):t.subdocsRemoved.add(this.doc)}gc(t){}write(t,e){t.writeString(this.doc.guid),t.writeAny(this.opts)}getRef(){return 9}}const Fs=r=>new Oe(Zn(r.readString(),r.readAny()));class _e{constructor(t){this.embed=t}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new _e(this.embed)}splice(t){throw h.Nw()}mergeWith(t){return!1}integrate(t,e){}delete(t){}gc(t){}write(t,e){t.writeJSON(this.embed)}getRef(){return 5}}const Vs=r=>new _e(r.readJSON());class qt{constructor(t,e){this.key=t,this.value=e}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new qt(this.key,this.value)}splice(t){throw h.Nw()}mergeWith(t){return!1}integrate(t,e){const i=e.parent;i._searchMarker=null,i._hasFormatting=!0}delete(t){}gc(t){}write(t,e){t.writeKey(this.key),t.writeJSON(this.value)}getRef(){return 6}}const Ws=r=>new qt(r.readKey(),r.readJSON());class Ve{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Ve(this.arr)}splice(t){const e=new Ve(this.arr.slice(t));return this.arr=this.arr.slice(0,t),e}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){const i=this.arr.length;t.writeLen(i-e);for(let o=e;o<i;o++){const l=this.arr[o];t.writeString(l===void 0?"undefined":JSON.stringify(l))}}getRef(){return 2}}const Hs=r=>{const t=r.readLen(),e=[];for(let i=0;i<t;i++){const o=r.readString();o==="undefined"?e.push(void 0):e.push(JSON.parse(o))}return new Ve(e)};class ve{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new ve(this.arr)}splice(t){const e=new ve(this.arr.slice(t));return this.arr=this.arr.slice(0,t),e}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){const i=this.arr.length;t.writeLen(i-e);for(let o=e;o<i;o++){const l=this.arr[o];t.writeAny(l)}}getRef(){return 8}}const Ys=r=>{const t=r.readLen(),e=[];for(let i=0;i<t;i++)e.push(r.readAny());return new ve(e)};class fe{constructor(t){this.str=t}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new fe(this.str)}splice(t){const e=new fe(this.str.slice(t));this.str=this.str.slice(0,t);const i=this.str.charCodeAt(t-1);return i>=55296&&i<=56319&&(this.str=this.str.slice(0,t-1)+"\uFFFD",e.str="\uFFFD"+e.str.slice(1)),e}mergeWith(t){return this.str+=t.str,!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){t.writeString(e===0?this.str:this.str.slice(e))}getRef(){return 4}}const Gs=r=>new fe(r.readString()),zs=[Cs,Ts,Us,Ms,Os,Ns,xs],Ks=0,$s=1,Js=2,Xs=3,Zs=4,qs=5,Qs=6;class pe{constructor(t){this.type=t}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new pe(this.type._copy())}splice(t){throw h.Nw()}mergeWith(t){return!1}integrate(t,e){this.type._integrate(t.doc,e)}delete(t){let e=this.type._start;for(;e!==null;)e.deleted?e.id.clock<(t.beforeState.get(e.id.client)||0)&&t._mergeStructs.push(e):e.delete(t),e=e.right;this.type._map.forEach(i=>{i.deleted?i.id.clock<(t.beforeState.get(i.id.client)||0)&&t._mergeStructs.push(i):i.delete(t)}),t.changed.delete(this.type)}gc(t){let e=this.type._start;for(;e!==null;)e.gc(t,!0),e=e.right;this.type._start=null,this.type._map.forEach(i=>{for(;i!==null;)i.gc(t,!0),i=i.left}),this.type._map=new Map}write(t,e){this.type._write(t)}getRef(){return 7}}const tr=r=>new pe(zs[r.readTypeRef()](r)),gn=(r,t)=>{let e=t,i=0,o;do i>0&&(e=gt(e.client,e.clock+i)),o=Re(r,e),i=e.clock-o.id.clock,e=o.redone;while(e!==null&&o instanceof Kt);return{item:o,diff:i}},mn=(r,t)=>{for(;r!==null&&r.keep!==t;)r.keep=t,r=r.parent._item},Qe=(r,t,e)=>{const{client:i,clock:o}=t.id,l=new Kt(gt(i,o+e),t,gt(i,o+e-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(e));return t.deleted&&l.markDeleted(),t.keep&&(l.keep=!0),t.redone!==null&&(l.redone=gt(t.redone.client,t.redone.clock+e)),t.right=l,l.right!==null&&(l.right.left=l),r._mergeStructs.push(l),l.parentSub!==null&&l.right===null&&l.parent._map.set(l.parentSub,l),t.length=e,l},qn=(r,t)=>array.some(r,e=>P(e.deletions,t)),Qn=(r,t,e,i,o,l)=>{const p=r.doc,S=p.store,D=p.clientID,W=t.redone;if(W!==null)return oe(r,W);let j=t.parent._item,F=null,q;if(j!==null&&j.deleted===!0){if(j.redone===null&&(!e.has(j)||Qn(r,j,e,i,o,l)===null))return null;for(;j.redone!==null;)j=oe(r,j.redone)}const ht=j===null?t.parent:j.content.type;if(t.parentSub===null){for(F=t.left,q=t;F!==null;){let jt=F;for(;jt!==null&&jt.parent._item!==j;)jt=jt.redone===null?null:oe(r,jt.redone);if(jt!==null&&jt.parent._item===j){F=jt;break}F=F.left}for(;q!==null;){let jt=q;for(;jt!==null&&jt.parent._item!==j;)jt=jt.redone===null?null:oe(r,jt.redone);if(jt!==null&&jt.parent._item===j){q=jt;break}q=q.right}}else if(q=null,t.right&&!o){for(F=t;F!==null&&F.right!==null&&(F.right.redone||P(i,F.right.id)||qn(l.undoStack,F.right.id)||qn(l.redoStack,F.right.id));)for(F=F.right;F.redone;)F=oe(r,F.redone);if(F&&F.right!==null)return null}else F=ht._map.get(t.parentSub)||null;const mt=$t(S,D),Wt=gt(D,mt),Dt=new Kt(Wt,F,F&&F.lastId,q,q&&q.id,ht,t.parentSub,t.content.copy());return t.redone=Wt,mn(Dt,!0),Dt.integrate(r,0),Dt};class Kt extends pn{constructor(t,e,i,o,l,p,S,D){super(t,D.getLength()),this.origin=i,this.left=e,this.right=o,this.rightOrigin=l,this.parent=p,this.parentSub=S,this.redone=null,this.content=D,this.info=this.content.isCountable()?y.Qn:0}set marker(t){(this.info&y.Ko)>0!==t&&(this.info^=y.Ko)}get marker(){return(this.info&y.Ko)>0}get keep(){return(this.info&y.Vw)>0}set keep(t){this.keep!==t&&(this.info^=y.Vw)}get countable(){return(this.info&y.Qn)>0}get deleted(){return(this.info&y.CY)>0}set deleted(t){this.deleted!==t&&(this.info^=y.CY)}markDeleted(){this.info|=y.CY}getMissing(t,e){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=$t(e,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=$t(e,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===nt&&this.id.client!==this.parent.client&&this.parent.clock>=$t(e,this.parent.client))return this.parent.client;if(this.origin&&(this.left=_n(t,e,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=oe(t,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===ae||this.right&&this.right.constructor===ae)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===Kt&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===Kt&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===nt){const i=Re(e,this.parent);i.constructor===ae?this.parent=null:this.parent=i.content.type}return null}integrate(t,e){if(e>0&&(this.id.clock+=e,this.left=_n(t,t.doc.store,gt(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(e),this.length-=e),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let i=this.left,o;if(i!==null)o=i.right;else if(this.parentSub!==null)for(o=this.parent._map.get(this.parentSub)||null;o!==null&&o.left!==null;)o=o.left;else o=this.parent._start;const l=new Set,p=new Set;for(;o!==null&&o!==this.right;){if(p.add(o),l.add(o),yt(this.origin,o.origin)){if(o.id.client<this.id.client)i=o,l.clear();else if(yt(this.rightOrigin,o.rightOrigin))break}else if(o.origin!==null&&p.has(Re(t.doc.store,o.origin)))l.has(Re(t.doc.store,o.origin))||(i=o,l.clear());else break;o=o.right}this.left=i}if(this.left!==null){const i=this.left.right;this.right=i,this.left.right=this}else{let i;if(this.parentSub!==null)for(i=this.parent._map.get(this.parentSub)||null;i!==null&&i.left!==null;)i=i.left;else i=this.parent._start,this.parent._start=this;this.right=i}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(t)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),wn(t.doc.store,this),this.content.integrate(t,this),Sn(t,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(t)}else new ae(this.id,this.length).integrate(t,0)}get next(){let t=this.right;for(;t!==null&&t.deleted;)t=t.right;return t}get prev(){let t=this.left;for(;t!==null&&t.deleted;)t=t.left;return t}get lastId(){return this.length===1?this.id:gt(this.id.client,this.id.clock+this.length-1)}mergeWith(t){if(this.constructor===t.constructor&&yt(t.origin,this.lastId)&&this.right===t&&yt(this.rightOrigin,t.rightOrigin)&&this.id.client===t.id.client&&this.id.clock+this.length===t.id.clock&&this.deleted===t.deleted&&this.redone===null&&t.redone===null&&this.content.constructor===t.content.constructor&&this.content.mergeWith(t.content)){const e=this.parent._searchMarker;return e&&e.forEach(i=>{i.p===t&&(i.p=this,!this.deleted&&this.countable&&(i.index-=this.length))}),t.keep&&(this.keep=!0),this.right=t.right,this.right!==null&&(this.right.left=this),this.length+=t.length,!0}return!1}delete(t){if(!this.deleted){const e=this.parent;this.countable&&this.parentSub===null&&(e._length-=this.length),this.markDeleted(),bt(t.deleteSet,this.id.client,this.id.clock,this.length),Sn(t,e,this.parentSub),this.content.delete(t)}}gc(t,e){if(!this.deleted)throw h.zR();this.content.gc(t),e?is(t,this,new ae(this.id,this.length)):this.content=new Ue(this.length)}write(t,e){const i=e>0?gt(this.id.client,this.id.clock+e-1):this.origin,o=this.rightOrigin,l=this.parentSub,p=this.content.getRef()&y.kr|(i===null?0:y.x1)|(o===null?0:y.rc)|(l===null?0:y.cq);if(t.writeInfo(p),i!==null&&t.writeLeftID(i),o!==null&&t.writeRightID(o),i===null&&o===null){const S=this.parent;if(S._item!==void 0){const D=S._item;if(D===null){const W=ee(S);t.writeParentInfo(!0),t.writeString(W)}else t.writeParentInfo(!1),t.writeLeftID(D.id)}else S.constructor===String?(t.writeParentInfo(!0),t.writeString(S)):S.constructor===nt?(t.writeParentInfo(!1),t.writeLeftID(S)):h.zR();l!==null&&t.writeString(l)}this.content.write(t,e)}}const ts=(r,t)=>er[t&y.kr](r),er=[()=>{h.zR()},Ps,Hs,js,Gs,Vs,Ws,tr,Ys,Fs,()=>{h.zR()}],nr=10;class ce extends pn{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,e){h.zR()}write(t,e){t.writeInfo(nr),I.uE(t.restEncoder,this.length-e)}getMissing(t,e){return null}}const es=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof $.g!="undefined"?$.g:{},ns="__ $YJS$ __";es[ns]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438"),es[ns]=!0}}]);})();
