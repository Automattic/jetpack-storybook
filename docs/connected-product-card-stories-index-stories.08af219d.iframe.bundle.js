"use strict";(()=>{var q=(c,n,e)=>{if(!n.has(c))throw TypeError("Cannot "+e)};var s=(c,n,e)=>(q(c,n,"read from private field"),e?e.call(c):n.get(c)),b=(c,n,e)=>{if(n.has(c))throw TypeError("Cannot add the same private member more than once");n instanceof WeakSet?n.add(c):n.set(c,e)},U=(c,n,e,i)=>(q(c,n,"write to private field"),i?i.call(c,e):n.set(c,e),e);var j=(c,n,e)=>(q(c,n,"access private method"),e);(self.webpackChunk_automattic_jetpack_storybook=self.webpackChunk_automattic_jetpack_storybook||[]).push([[5462],{"../../packages/my-jetpack/_inc/components/connected-product-card/stories/index.stories.jsx":(c,n,e)=>{var S,d,M;e.r(n),e.d(n,{Default:()=>m,__namedExportsOrder:()=>l,default:()=>O});var i=e("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),u=e("../../../node_modules/.pnpm/react-router-dom@6.6.2_react-dom@18.2.0_react@18.2.0/node_modules/react-router-dom/dist/index.js"),h=e("../../../node_modules/.pnpm/react-router@6.6.2_react@18.2.0/node_modules/react-router/dist/index.js"),r=e("../../packages/my-jetpack/_inc/components/connected-product-card/index.jsx"),k=e("../../packages/my-jetpack/_inc/components/product-card/action-button.jsx"),f=e("../../packages/my-jetpack/_inc/components/product-detail-card/stories/utils.js"),E=e("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");window.myJetpackRest={};const x=(0,f.As)(),O={title:"Packages/My Jetpack/Connected Product Card",component:r.Z,argTypes:{slug:{options:(0,f.h7)(),control:{type:"select"}},status:{options:Object.values(k.N),control:{type:"select"}}}},m=(_=>(0,E.jsx)(u.UT,{children:(0,E.jsx)(h.Z5,{children:(0,E.jsx)(h.AW,{path:"/",element:(0,E.jsx)(r.Z,{..._})})})})).bind({});m.parameters={mockData:x},m.args={admin:!1,slug:"backup"},m.parameters={...m.parameters,docs:{...(S=m.parameters)==null?void 0:S.docs,source:{originalSource:`args => <HashRouter>
        <Routes>
            <Route path="/" element={<ConnectedProductCard {...args} />} />
        </Routes>
    </HashRouter>`,...(M=(d=m.parameters)==null?void 0:d.docs)==null?void 0:M.source}}};const l=["Default"]},"../../../node_modules/.pnpm/@tanstack+react-query@5.20.5_react@18.2.0/node_modules/@tanstack/react-query/build/modern/useMutation.js":(c,n,e)=>{var l,S,d,M,_,K,I,y,A,p,D,T,Q,W,tt,H;e.d(n,{D:()=>v});var i=e("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),u=(I=class extends null{constructor(t){super();b(this,_);b(this,l,void 0);b(this,S,void 0);b(this,d,void 0);b(this,M,void 0);this.mutationId=t.mutationId,U(this,S,t.defaultOptions),U(this,d,t.mutationCache),U(this,l,[]),this.state=t.state||h(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options={...s(this,S),...t},this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){s(this,l).includes(t)||(s(this,l).push(t),this.clearGcTimeout(),s(this,d).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){U(this,l,s(this,l).filter(o=>o!==t)),this.scheduleGc(),s(this,d).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){s(this,l).length||(this.state.status==="pending"?this.scheduleGc():s(this,d).remove(this))}continue(){var t,o;return(o=(t=s(this,M))==null?void 0:t.continue())!=null?o:this.execute(this.state.variables)}async execute(t){var P,w,R,B,J,Z,C,L,G,V,Y,z,et,st,at,nt,ot,it,rt,ct;const o=()=>{var g;return U(this,M,createRetryer({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(X,ut)=>{j(this,_,K).call(this,{type:"failed",failureCount:X,error:ut})},onPause:()=>{j(this,_,K).call(this,{type:"pause"})},onContinue:()=>{j(this,_,K).call(this,{type:"continue"})},retry:(g=this.options.retry)!=null?g:0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode})),s(this,M).promise},a=this.state.status==="pending";try{if(!a){j(this,_,K).call(this,{type:"pending",variables:t}),await((w=(P=s(this,d).config).onMutate)==null?void 0:w.call(P,t,this));const X=await((B=(R=this.options).onMutate)==null?void 0:B.call(R,t));X!==this.state.context&&j(this,_,K).call(this,{type:"pending",context:X,variables:t})}const g=await o();return await((Z=(J=s(this,d).config).onSuccess)==null?void 0:Z.call(J,g,t,this.state.context,this)),await((L=(C=this.options).onSuccess)==null?void 0:L.call(C,g,t,this.state.context)),await((V=(G=s(this,d).config).onSettled)==null?void 0:V.call(G,g,null,this.state.variables,this.state.context,this)),await((z=(Y=this.options).onSettled)==null?void 0:z.call(Y,g,null,t,this.state.context)),j(this,_,K).call(this,{type:"success",data:g}),g}catch(g){try{throw await((st=(et=s(this,d).config).onError)==null?void 0:st.call(et,g,t,this.state.context,this)),await((nt=(at=this.options).onError)==null?void 0:nt.call(at,g,t,this.state.context)),await((it=(ot=s(this,d).config).onSettled)==null?void 0:it.call(ot,void 0,g,this.state.variables,this.state.context,this)),await((ct=(rt=this.options).onSettled)==null?void 0:ct.call(rt,void 0,g,t,this.state.context)),g}finally{j(this,_,K).call(this,{type:"error",error:g})}}}},l=new WeakMap,S=new WeakMap,d=new WeakMap,M=new WeakMap,_=new WeakSet,K=function(t){const o=a=>{switch(t.type){case"failed":return{...a,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...a,isPaused:!0};case"continue":return{...a,isPaused:!1};case"pending":return{...a,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:!canFetch(this.options.networkMode),status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...a,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...a,data:void 0,error:t.error,failureCount:a.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=o(this.state),notifyManager.batch(()=>{s(this,l).forEach(a=>{a.onMutationUpdate(t)}),s(this,d).notify({mutation:this,type:"updated",action:t})})},I);function h(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var r=e("../../../node_modules/.pnpm/@tanstack+query-core@5.20.5/node_modules/@tanstack/query-core/build/modern/notifyManager.js"),k=e("../../../node_modules/.pnpm/@tanstack+query-core@5.20.5/node_modules/@tanstack/query-core/build/modern/subscribable.js"),f=e("../../../node_modules/.pnpm/@tanstack+query-core@5.20.5/node_modules/@tanstack/query-core/build/modern/utils.js"),E=(H=class extends k.l{constructor(t,o){super();b(this,T);b(this,W);b(this,y,void 0);b(this,A,void 0);b(this,p,void 0);b(this,D,void 0);U(this,y,t),this.setOptions(o),this.bindMethods(),j(this,T,Q).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var a;const o=this.options;this.options=s(this,y).defaultMutationOptions(t),(0,f.VS)(o,this.options)||s(this,y).getMutationCache().notify({type:"observerOptionsUpdated",mutation:s(this,p),observer:this}),o!=null&&o.mutationKey&&this.options.mutationKey&&(0,f.Ym)(o.mutationKey)!==(0,f.Ym)(this.options.mutationKey)?this.reset():(a=s(this,p))==null||a.setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=s(this,p))==null||t.removeObserver(this)}onMutationUpdate(t){j(this,T,Q).call(this),j(this,W,tt).call(this,t)}getCurrentResult(){return s(this,A)}reset(){var t;(t=s(this,p))==null||t.removeObserver(this),U(this,p,void 0),j(this,T,Q).call(this),j(this,W,tt).call(this)}mutate(t,o){var a;return U(this,D,o),(a=s(this,p))==null||a.removeObserver(this),U(this,p,s(this,y).getMutationCache().build(s(this,y),this.options)),s(this,p).addObserver(this),s(this,p).execute(t)}},y=new WeakMap,A=new WeakMap,p=new WeakMap,D=new WeakMap,T=new WeakSet,Q=function(){var o,a;const t=(a=(o=s(this,p))==null?void 0:o.state)!=null?a:h();U(this,A,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},W=new WeakSet,tt=function(t){r.V.batch(()=>{var o,a,P,w,R,B,J,Z;if(s(this,D)&&this.hasListeners()){const C=s(this,A).variables,L=s(this,A).context;(t==null?void 0:t.type)==="success"?((a=(o=s(this,D)).onSuccess)==null||a.call(o,t.data,C,L),(w=(P=s(this,D)).onSettled)==null||w.call(P,t.data,null,C,L)):(t==null?void 0:t.type)==="error"&&((B=(R=s(this,D)).onError)==null||B.call(R,t.error,C,L),(Z=(J=s(this,D)).onSettled)==null||Z.call(J,void 0,t.error,C,L))}this.listeners.forEach(C=>{C(s(this,A))})})},H),x=e("../../../node_modules/.pnpm/@tanstack+react-query@5.20.5_react@18.2.0/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js"),O=e("../../../node_modules/.pnpm/@tanstack+react-query@5.20.5_react@18.2.0/node_modules/@tanstack/react-query/build/modern/utils.js");function v(F,t){const o=(0,x.NL)(t),[a]=i.useState(()=>new E(o,F));i.useEffect(()=>{a.setOptions(F)},[a,F]);const P=i.useSyncExternalStore(i.useCallback(R=>a.subscribe(r.V.batchCalls(R)),[a]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),w=i.useCallback((R,B)=>{a.mutate(R,B).catch(m)},[a]);if(P.error&&(0,O.L)(a.options.throwOnError,[P.error]))throw P.error;return{...P,mutate:w,mutateAsync:P.mutate}}function m(){}},"../../../node_modules/.pnpm/@wordpress+icons@9.44.0_react@18.2.0/node_modules/@wordpress/icons/build-module/library/check.js":(c,n,e)=>{e.d(n,{Z:()=>r});var i=e("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),u=e("../../../node_modules/.pnpm/@wordpress+primitives@3.51.0/node_modules/@wordpress/primitives/build-module/svg/index.js");const r=(0,i.createElement)(u.Wj,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,i.createElement)(u.y$,{d:"M16.7 7.1l-6.3 8.5-3.3-2.5-.9 1.2 4.5 3.4L17.9 8z"}))},"../../../node_modules/.pnpm/@wordpress+icons@9.44.0_react@18.2.0/node_modules/@wordpress/icons/build-module/library/chevron-down.js":(c,n,e)=>{e.d(n,{Z:()=>r});var i=e("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),u=e("../../../node_modules/.pnpm/@wordpress+primitives@3.51.0/node_modules/@wordpress/primitives/build-module/svg/index.js");const r=(0,i.createElement)(u.Wj,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,i.createElement)(u.y$,{d:"M17.5 11.6L12 16l-5.5-4.4.9-1.2L12 14l4.5-3.6 1 1.2z"}))},"../../packages/my-jetpack/_inc/components/connected-product-card/index.jsx":(c,n,e)=>{e.d(n,{Z:()=>y});var i=e("../components/components/text/index.tsx"),u=e("../connection/components/use-connection/index.jsx"),h=e("../../../node_modules/.pnpm/prop-types@15.8.1/node_modules/prop-types/index.js"),r=e.n(h),k=e("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),f=e("../../packages/my-jetpack/_inc/constants.ts"),E=e("../../packages/my-jetpack/_inc/data/products/use-activate.ts"),x=e("../../../node_modules/.pnpm/@wordpress+i18n@4.53.0/node_modules/@wordpress/i18n/build-module/index.js"),O=e("../../packages/my-jetpack/_inc/data/constants.ts"),v=e("../../packages/my-jetpack/_inc/data/use-simple-mutation.ts"),m=e("../../packages/my-jetpack/_inc/data/products/use-product.ts");const l=x.__,d=A=>{const{detail:p,refetch:D}=(0,m.Z)(A),{mutate:T,isPending:$}=(0,v.Z)({name:O.yv,query:{path:`${O.Jk}/${A}/install-standalone`,method:"POST"},options:{onSuccess:D},errorMessage:(0,x.gB)(l("Failed to install standalone plugin for %1$s. Please try again","jetpack-my-jetpack"),p.name)});return{install:T,isPending:$}};var M=e("../../packages/my-jetpack/_inc/hooks/use-my-jetpack-navigate/index.ts"),_=e("../../packages/my-jetpack/_inc/components/product-card/index.jsx"),N=e("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");const I=({admin:A,slug:p,children:D,isDataLoading:T,Description:$=null,additionalActions:W=null,secondaryAction:dt=null,upgradeInInterstitial:H=!1,primaryActionOverride:F})=>{const{isRegistered:t,isUserConnected:o}=(0,u.Z)(),{install:a,isPending:P}=d(p),{activate:w,isPending:R}=(0,E.Z)(p),{detail:B}=(0,m.Z)(p),{name:J,description:Z,requiresUserConnection:C,status:L}=B,G=(0,M.Z)(f.xB.Connection),V=(0,k.useCallback)(()=>{if((!t||!o)&&C){G();return}w()},[w,t,o,C,G]),Y=()=>{const z=Z.replace(/\s(?=[^\s]*$)/,"\xA0");return(0,N.jsx)(i.ZP,{variant:"body-small",style:{flexGrow:1},children:z})};return(0,N.jsx)(_.ZP,{name:J,Description:$||Y,status:L,admin:A,isFetching:R||P,isDataLoading:T,isInstallingStandalone:P,additionalActions:W,primaryActionOverride:F,secondaryAction:dt,slug:p,onActivate:V,onInstallStandalone:a,onActivateStandalone:a,upgradeInInterstitial:H,children:D})};I.propTypes={children:r().node,admin:r().bool.isRequired,slug:r().string.isRequired,isDataLoading:r().bool,additionalActions:r().array,primaryActionOverride:r().object,secondaryAction:r().object};const y=I;I.__docgenInfo={description:"",methods:[],displayName:"ConnectedProductCard",props:{Description:{defaultValue:{value:"null",computed:!1},required:!1},additionalActions:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"array"},required:!1},secondaryAction:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"object"},required:!1},upgradeInInterstitial:{defaultValue:{value:"false",computed:!1},required:!1},children:{description:"",type:{name:"node"},required:!1},admin:{description:"",type:{name:"bool"},required:!0},slug:{description:"",type:{name:"string"},required:!0},isDataLoading:{description:"",type:{name:"bool"},required:!1},primaryActionOverride:{description:"",type:{name:"object"},required:!1}}}},"../../packages/my-jetpack/_inc/components/product-detail-card/stories/utils.js":(c,n,e)=>{e.d(n,{As:()=>l,TN:()=>m,h7:()=>S});const v={"anti-spam":{slug:"anti-spam",name:"Anti-Spam",title:"Jepack Anti-Spam",description:"Stop comment and form spam",is_upgradable_by_bundle:["security"],long_description:"Save time and get better responses by automatically blocking spam from your comments and forms.",status:"active",features:["Comment and form spam protection","Powered by Akismet","Block spam without CAPTCHAs","Advanced stats"],pricingForUi:{currency_code:"USD",full_price:119,discount_price:59}},backup:{slug:"backup",name:"Backup",title:"Jepack Backup",description:"Save every change",is_upgradable_by_bundle:["security"],long_description:"Never lose a word, image, page, or time worrying about your site with automated backups & one-click restores.",status:"active",features:["Real-time cloud backups","10GB of backup storage","30-day archive & activity log","One-click restores"],pricingForUi:{currency_code:"USD",full_price:119,discount_price:59}},boost:{slug:"boost",name:"Boost",title:"Jepack Boost",description:"Instant speed and SEO",long_description:"Jetpack Boost gives your site the same performance advantages as the world\u2019s leading websites, no developer required.",status:"inactive",features:["Check your site performance","Enable improvements in one click","Standalone free plugin for those focused on speed"],pricingForUi:{available:!0,is_free:!0}},crm:{slug:"crm",name:"CRM",title:"Jetpack CRM",description:"Connect with your people",long_description:"All of your contacts in one place. Build better relationships with your customers and clients.",status:"inactive",features:["Manage unlimited contacts","Manage billing and create invoices","Fully integrated with WordPress & WooCommerce","Infinitely customizable with integrations and extensions"],pricingForUi:{available:!0,is_free:!0}},extras:{slug:"extras",name:"Extras",title:"Jetpack Extras",description:"Basic tools for a successful site",long_description:"Secure and speed up your site for free with Jetpack's powerful WordPress tools.",status:"active",features:["Measure your impact with beautiful stats","Speed up your site with optimized images","Protect your site against bot attacks","Get notifications if your site goes offline","Enhance your site with dozens of other features"],pricingForUi:{available:!0,is_free:!0}},scan:{slug:"scan",name:"Scan",title:"Jepack Scan",description:"Stay one step ahead of threats",is_upgradable_by_bundle:["security"],long_description:"Automatic scanning and one-click fixes keep your site one step ahead of security threats and malware.",status:"inactive",features:["Automated daily scanning","One-click fixes for most issues","Instant email notifications","Access to latest Firewall rules"],pricingForUi:{currency_code:"USD",full_price:119,discount_price:59}},search:{slug:"search",name:"Search",title:"Jetpack Search",description:"Help them find what they need",long_description:"Help your site visitors find answers instantly so they keep reading and buying. Great for sites with a lot of content.",status:"inactive",features:["Instant search and indexing","Powerful filtering","Supports 38 languages","Spelling correction"],pricingForUi:{currency_code:"USD",full_price:59.95,discount_price:29.975,coupon_discount:50}},security:{slug:"security",name:"Security",title:"Security",description:"Comprehensive site security, including Backup, Scan, and Anti-spam.",long_description:"Comprehensive site security, including Backup, Scan, and Anti-spam.",status:"inactive",is_bundle:!0,supportedProducts:["backup","scan","anti-spam"],features:["Real-time cloud backups with 10GB storage","Automated real-time malware scan","One-click fixes for most threats","Comment & form spam protection"],pricingForUi:{currency_code:"USD",full_price:299,discount_price:149}},videopress:{slug:"videopress",name:"VideoPress",title:"Jetpack Site VideoPress",description:"High quality, ad-free video",long_description:"High-quality, ad-free video built specifically for WordPress.",status:"inactive",features:["1TB of storage","Built into WordPress editor","Ad-free and customizable player","Unlimited users"],pricingForUi:{currency_code:"USD",full_price:119,discount_price:59}}};function m(d){const _=d.constructor===Array?d:[d],N=_.map(y=>({url:`my-jetpack/v1/site/products/${y}?_locale=user`,method:"GET",status:200,response:v[y]})),I=_.map(y=>({url:`my-jetpack/v1/site/products/${y}?_locale=user`,method:"POST",status:200,response:{...v[y],status:v[y].status==="active"?"inactive":"active"}}));return[...N,...I]}function l(){return m([...Object.keys(v)])}function S(){return["anti-spam","backup","boost","crm","extras","scan","search","videopress"]}},"../../packages/my-jetpack/_inc/constants.ts":(c,n,e)=>{e.d(n,{f6:()=>u,w6:()=>i,xB:()=>r});const i="my-jetpack-my-plans-manage",u="my-jetpack-my-plans-purchase",h="my-jetpack-product-checkout",r={Home:"/",Connection:"/connection",AddAkismet:"/add-akismet",AddAntiSpam:"/add-anti-spam",AddBackup:"/add-backup",AddBoost:"/add-boost",AddCRM:"/add-crm",AddCreator:"/add-creator",AddJetpackAI:"/add-jetpack-ai",AddExtras:"/add-extras",AddProtect:"/add-protect",AddScan:"/add-scan",AddSocial:"/add-social",AddSearch:"/add-search",AddVideoPress:"/add-videopress",AddStats:"/add-stats",AddLicense:"/add-license",RedeemToken:"/redeem-token"}},"../../packages/my-jetpack/_inc/data/products/use-activate.ts":(c,n,e)=>{e.d(n,{Z:()=>E});var i=e("../../../node_modules/.pnpm/@wordpress+i18n@4.53.0/node_modules/@wordpress/i18n/build-module/index.js"),u=e("../../packages/my-jetpack/_inc/data/constants.ts"),h=e("../../packages/my-jetpack/_inc/data/use-simple-mutation.ts"),r=e("../../packages/my-jetpack/_inc/data/products/use-product.ts");const k=i.__,E=x=>{const{detail:O,refetch:v}=(0,r.Z)(x),{mutate:m,isPending:l}=(0,h.Z)({name:u.iG,query:{path:`${u.Jk}/${x}`,method:"POST"},options:{onSuccess:v},errorMessage:(0,i.gB)(k("Failed to activate %1$s. Please try again","jetpack-my-jetpack"),O.name)});return{activate:m,isPending:l}}},"../../packages/my-jetpack/_inc/data/use-simple-mutation.ts":(c,n,e)=>{e.d(n,{Z:()=>k});var i=e("../../../node_modules/.pnpm/@tanstack+react-query@5.20.5_react@18.2.0/node_modules/@tanstack/react-query/build/modern/useMutation.js"),u=e("../../../node_modules/.pnpm/@wordpress+api-fetch@6.50.0/node_modules/@wordpress/api-fetch/build-module/index.js"),h=e("../../packages/my-jetpack/_inc/data/notices/use-fetching-error-notice.ts");const k=({name:f,query:E,options:x,errorMessage:O})=>{const v=(0,i.D)({mutationKey:[f],mutationFn:()=>(0,u.Z)(E),...x}),{isError:m,isPending:l}=v;return(0,h.o)({infoName:f,isError:!l&&m,overrideMessage:O}),v}},"../../packages/my-jetpack/_inc/hooks/use-my-jetpack-navigate/index.ts":(c,n,e)=>{e.d(n,{Z:()=>h});var i=e("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),u=e("../../../node_modules/.pnpm/react-router@6.6.2_react@18.2.0/node_modules/react-router/dist/index.js");function h(r){const k=(0,u.s0)();return(0,i.useCallback)(f=>k(r,f),[k,r])}}}]);})();
