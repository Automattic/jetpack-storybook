"use strict";(()=>{var me=Object.defineProperty;var Re=(T,l,s)=>l in T?me(T,l,{enumerable:!0,configurable:!0,writable:!0,value:s}):T[l]=s;var K=(T,l,s)=>(Re(T,typeof l!="symbol"?l+"":l,s),s);(self.webpackChunk_automattic_jetpack_storybook=self.webpackChunk_automattic_jetpack_storybook||[]).push([[9677],{"../analytics/index.jsx":(T,l,s)=>{s.d(l,{Z:()=>m});var I=s("../../../node_modules/.pnpm/debug@4.3.4/node_modules/debug/src/browser.js"),C=s.n(I);const d=C()("dops:analytics");let _,c;window._tkq=window._tkq||[],window.ga=window.ga||function(){(window.ga.q=window.ga.q||[]).push(arguments)},window.ga.l=+new Date;function E(t,o){let i="";if(typeof t=="object"){for(const u in t)i+="&x_"+encodeURIComponent(u)+"="+encodeURIComponent(t[u]);d("Bumping stats %o",t)}else i="&x_"+encodeURIComponent(t)+"="+encodeURIComponent(o),d('Bumping stat "%s" in group "%s"',o,t);return i}function f(t,o){let i="";if(typeof t=="object"){for(const u in t)i+="&"+encodeURIComponent(u)+"="+encodeURIComponent(t[u]);d("Built stats %o",t)}else i="&"+encodeURIComponent(t)+"="+encodeURIComponent(o),d('Built stat "%s" in group "%s"',o,t);return i}const r={initialize:function(t,o,i){r.setUser(t,o),r.setSuperProps(i),r.identifyUser()},setGoogleAnalyticsEnabled:function(t,o=null){this.googleAnalyticsEnabled=t,this.googleAnalyticsKey=o},setMcAnalyticsEnabled:function(t){this.mcAnalyticsEnabled=t},setUser:function(t,o){c={ID:t,username:o}},setSuperProps:function(t){_=t},assignSuperProps:function(t){_=Object.assign(_||{},t)},mc:{bumpStat:function(t,o){const i=E(t,o);r.mcAnalyticsEnabled&&(new Image().src=document.location.protocol+"//pixel.wp.com/g.gif?v=wpcom-no-pv"+i+"&t="+Math.random())},bumpStatWithPageView:function(t,o){const i=f(t,o);r.mcAnalyticsEnabled&&(new Image().src=document.location.protocol+"//pixel.wp.com/g.gif?v=wpcom"+i+"&t="+Math.random())}},pageView:{record:function(t,o){r.tracks.recordPageView(t),r.ga.recordPageView(t,o)}},purchase:{record:function(t,o,i,u,p,S,R){r.ga.recordPurchase(t,o,i,u,p,S,R)}},tracks:{recordEvent:function(t,o){if(o=o||{},t.indexOf("akismet_")!==0&&t.indexOf("jetpack_")!==0){d('- Event name must be prefixed by "akismet_" or "jetpack_"');return}_&&(d("- Super Props: %o",_),o=Object.assign(o,_)),d('Record event "%s" called with props %s',t,JSON.stringify(o)),window._tkq.push(["recordEvent",t,o])},recordJetpackClick:function(t){const o=typeof t=="object"?t:{target:t};r.tracks.recordEvent("jetpack_wpa_click",o)},recordPageView:function(t){r.tracks.recordEvent("akismet_page_view",{path:t})},setOptOut:function(t){d("Pushing setOptOut: %o",t),window._tkq.push(["setOptOut",t])}},ga:{initialized:!1,initialize:function(){let t={};r.ga.initialized||(c&&(t={userId:"u-"+c.ID}),window.ga("create",this.googleAnalyticsKey,"auto",t),r.ga.initialized=!0)},recordPageView:function(t,o){r.ga.initialize(),d("Recording Page View ~ [URL: "+t+"] [Title: "+o+"]"),this.googleAnalyticsEnabled&&(window.ga("set","page",t),window.ga("send",{hitType:"pageview",page:t,title:o}))},recordEvent:function(t,o,i,u){r.ga.initialize();let p="Recording Event ~ [Category: "+t+"] [Action: "+o+"]";typeof i!="undefined"&&(p+=" [Option Label: "+i+"]"),typeof u!="undefined"&&(p+=" [Option Value: "+u+"]"),d(p),this.googleAnalyticsEnabled&&window.ga("send","event",t,o,i,u)},recordPurchase:function(t,o,i,u,p,S,R){window.ga("require","ecommerce"),window.ga("ecommerce:addTransaction",{id:t,revenue:u,currency:R}),window.ga("ecommerce:addItem",{id:t,name:o,sku:i,price:p,quantity:S}),window.ga("ecommerce:send")}},identifyUser:function(){c&&window._tkq.push(["identifyUser",c.ID,c.username])},setProperties:function(t){window._tkq.push(["setProperties",t])},clearedIdentity:function(){window._tkq.push(["clearIdentity"])}},m=r},"../connection/components/use-connection/index.jsx":(T,l,s)=>{s.d(l,{Z:()=>f});var I=s("../api/index.jsx"),C=s("../../../node_modules/.pnpm/@wordpress+data@9.22.0_react@18.2.0/node_modules/@wordpress/data/build-module/components/use-dispatch/use-dispatch.js"),d=s("../../../node_modules/.pnpm/@wordpress+data@9.22.0_react@18.2.0/node_modules/@wordpress/data/build-module/components/use-select/index.js"),_=s("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),c=s("../connection/state/store.jsx");const E=window!=null&&window.JP_CONNECTION_INITIAL_STATE?window.JP_CONNECTION_INITIAL_STATE:{},f=({registrationNonce:r=E.registrationNonce,apiRoot:m=E.apiRoot,apiNonce:t=E.apiNonce,redirectUri:o,autoTrigger:i,from:u,skipUserConnection:p}={})=>{const{registerSite:S,connectUser:R,refreshConnectedPlugins:N}=(0,C.Z)(c.t),A=(0,d.Z)(g=>g(c.t).getRegistrationError()),{siteIsRegistering:P,userIsConnecting:y,userConnectionData:O,connectedPlugins:U,connectionErrors:D,isRegistered:w,isUserConnected:h,hasConnectedOwner:L,isOfflineMode:b}=(0,d.Z)(g=>({siteIsRegistering:g(c.t).getSiteIsRegistering(),userIsConnecting:g(c.t).getUserIsConnecting(),userConnectionData:g(c.t).getUserConnectionData(),connectedPlugins:g(c.t).getConnectedPlugins(),connectionErrors:g(c.t).getConnectionErrors(),isOfflineMode:g(c.t).getIsOfflineMode(),...g(c.t).getConnectionStatus()})),k=()=>{if(p){if(o)return window.location=o,Promise.resolve(o)}else return R({from:u,redirectUri:o});return Promise.resolve()},v=g=>(g&&g.preventDefault(),w?k():S({registrationNonce:r,redirectUri:o}).then(()=>k()));return(0,_.useEffect)(()=>{I.ZP.setApiRoot(m),I.ZP.setApiNonce(t)},[m,t]),(0,_.useEffect)(()=>{i&&!P&&!y&&v()},[]),{handleRegisterSite:v,handleConnectUser:k,refreshConnectedPlugins:N,isRegistered:w,isUserConnected:h,siteIsRegistering:P,userIsConnecting:y,registrationError:A,userConnectionData:O,hasConnectedOwner:L,connectedPlugins:U,connectionErrors:D,isOfflineMode:b}}},"../connection/state/store.jsx":(T,l,s)=>{s.d(l,{t:()=>j});var I=s("../api/index.jsx");const C="SET_CONNECTION_STATUS",d="SET_CONNECTION_STATUS_IS_FETCHING",_="FETCH_CONNECTION_STATUS",c="SET_SITE_IS_REGISTERING",E="SET_USER_IS_CONNECTING",f="SET_REGISTRATION_ERROR",r="CLEAR_REGISTRATION_ERROR",m="REGISTER_SITE",t="SET_AUTHORIZATION_URL",o="CONNECT_USER",i="DISCONNECT_USER_SUCCESS",u="FETCH_AUTHORIZATION_URL",p="SET_CONNECTED_PLUGINS",S="REFRESH_CONNECTED_PLUGINS",R="SET_CONNECTION_ERRORS",N="SET_IS_OFFLINE_MODE",A=e=>({type:C,connectionStatus:e}),P=e=>({type:d,isFetching:e}),y=()=>({type:_}),O=e=>({type:c,isRegistering:e}),U=e=>({type:E,isConnecting:e}),D=()=>({type:i}),w=e=>({type:f,registrationError:e}),h=()=>({type:r}),L=e=>({type:t,authorizationUrl:e}),b=e=>({type:u,redirectUri:e}),k=e=>({type:p,connectedPlugins:e}),v=e=>({type:R,connectionErrors:e}),g=e=>({type:N,isOfflineMode:e});function*J({from:e,redirectFunc:n,redirectUri:a}={}){yield U(!0),yield{type:o,from:e,redirectFunc:n,redirectUri:a}}function*V({registrationNonce:e,redirectUri:n}){yield h(),yield O(!0);try{const a=yield{type:m,registrationNonce:e,redirectUri:n};return yield A({isRegistered:!0}),yield L(a.authorizeUrl),yield O(!1),Promise.resolve(a)}catch(a){return yield w(a),yield O(!1),Promise.reject(a)}}const z={setConnectionStatus:A,setConnectionStatusIsFetching:P,fetchConnectionStatus:y,fetchAuthorizationUrl:b,setSiteIsRegistering:O,setUserIsConnecting:U,setRegistrationError:w,clearRegistrationError:h,setAuthorizationUrl:L,registerSite:V,connectUser:J,disconnectUserSuccess:D,setConnectedPlugins:k,refreshConnectedPlugins:()=>async({dispatch:e})=>await new Promise(n=>I.ZP.fetchConnectedPlugins().then(a=>{e(k(a)),n(a)})),setConnectionErrors:v,setIsOfflineMode:g};var X=s("../../../node_modules/.pnpm/@wordpress+data@9.22.0_react@18.2.0/node_modules/@wordpress/data/build-module/factory.js");const j="jetpack-connection",Q=({registrationNonce:e,redirectUri:n})=>I.ZP.registerSite(e,n),Y=(0,X.R)(({resolveSelect:e})=>({from:n,redirectFunc:a,redirectUri:F}={})=>new Promise((Ie,Ce)=>{e(j).getAuthorizationUrl(F).then(Z=>{const Te=a||(fe=>window.location.assign(fe)),W=new URL(Z);n&&W.searchParams.set("from",encodeURIComponent(n));const H=W.toString();Te(H),Ie(H)}).catch(Z=>{Ce(Z)})})),$={FETCH_AUTHORIZATION_URL:({redirectUri:e})=>I.ZP.fetchAuthorizationUrl(e),REGISTER_SITE:Q,CONNECT_USER:Y};var B=s("../../../node_modules/.pnpm/@wordpress+data@9.22.0_react@18.2.0/node_modules/@wordpress/data/build-module/index.js");const q=(e={},n)=>{switch(n.type){case C:return{...e,...n.connectionStatus};case i:return{...e,isUserConnected:!1}}return e},ee=(e={},n)=>{switch(n.type){case p:return n.connectedPlugins}return e},te=(e=!1,n)=>{switch(n.type){case d:return n.isFetching}return e},ne=(e=!1,n)=>{switch(n.type){case c:return n.isRegistering}return e},oe=(e=!1,n)=>{switch(n.type){case E:return n.isConnecting}return e},se=(e,n)=>{switch(n.type){case r:return!1;case f:return n.registrationError;default:return e}},ie=(e,n)=>{switch(n.type){case t:return n.authorizationUrl;default:return e}},re=(e,n)=>{switch(n.type){default:return e}},ce=(e={},n)=>{switch(n.type){case R:return n.connectionErrors}return e},ae=(e=!1,n)=>{switch(n.type){case N:return n.isConnecting}return e},de=(0,B.UY)({connectionStatus:q,connectionStatusIsFetching:te,siteIsRegistering:ne,userIsConnecting:oe,registrationError:se,authorizationUrl:ie,userConnectionData:re,connectedPlugins:ee,connectionErrors:ce,isOfflineMode:ae});var ue=s("../../../node_modules/.pnpm/@wordpress+data@9.22.0_react@18.2.0/node_modules/@wordpress/data/build-module/select.js"),le=s("../../../node_modules/.pnpm/@wordpress+data@9.22.0_react@18.2.0/node_modules/@wordpress/data/build-module/dispatch.js");const _e={...{getAuthorizationUrl:{isFulfilled:(e,...n)=>{const a=!!e.authorizationUrl,F=(0,ue.Y)(j).hasFinishedResolution("getAuthorizationUrl",n);return a&&!F&&(0,le.W)(j).finishResolution("getAuthorizationUrl",n),a},*fulfill(e){const n=yield z.fetchAuthorizationUrl(e);yield z.setAuthorizationUrl(n.authorizeUrl)}}}},Ee={...{getConnectionStatus:e=>e.connectionStatus||{},getConnectionStatusIsFetching:()=>!1,getSiteIsRegistering:e=>e.siteIsRegistering||!1,getUserIsConnecting:e=>e.userIsConnecting||!1,getRegistrationError:e=>e.registrationError||!1,getAuthorizationUrl:e=>e.authorizationUrl||!1,getUserConnectionData:e=>e.userConnectionData||!1,getConnectedPlugins:e=>e.connectedPlugins||[],getConnectionErrors:e=>e.connectionErrors||[],getIsOfflineMode:e=>e.isOfflineMode||!1,getWpcomUser:e=>{var n,a;return(a=(n=e==null?void 0:e.userConnectionData)==null?void 0:n.currentUser)==null?void 0:a.wpcomUser},getBlogId:e=>{var n,a;return(a=(n=e==null?void 0:e.userConnectionData)==null?void 0:n.currentUser)==null?void 0:a.blogId}}};var pe=s("../../../node_modules/.pnpm/@wordpress+data@9.22.0_react@18.2.0/node_modules/@wordpress/data/build-module/redux-store/index.js");const M=class{static mayBeInit(n,a){M.store===null&&(M.store=(0,pe.Z)(n,a),(0,B.z2)(M.store))}};let x=M;K(x,"store",null);const ge=x,G=window.JP_CONNECTION_INITIAL_STATE;G||console.error("Jetpack Connection package: Initial state is missing. Check documentation to see how to use the Connection composer package to set up the initial state."),ge.mayBeInit(j,{__experimentalUseThunks:!0,reducer:de,actions:z,selectors:Ee,resolvers:_e,controls:$,initialState:G||{}})},"../../packages/my-jetpack/_inc/hooks/use-analytics/index.js":(T,l,s)=>{s.d(l,{Z:()=>c});var I=s("../analytics/index.jsx"),C=s("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),d=s("../../packages/my-jetpack/_inc/hooks/use-my-jetpack-connection/index.js");const c=()=>{var U;const{isUserConnected:E,connectedPlugins:f,userConnectionData:r={}}=(0,d.Z)(),{login:m,ID:t}=((U=r.currentUser)==null?void 0:U.wpcomUser)||{};(0,C.useEffect)(()=>{E&&t&&m&&I.Z.initialize(t,m)},[t,E,m]);const o=Object.keys(f||{}).sort().join(",").replaceAll("jetpack-",""),{clearedIdentity:i,ga:u,mc:p,pageView:S,purchase:R,setGoogleAnalyticsEnabled:N,setMcAnalyticsEnabled:A,setProperties:P,tracks:y}=I.Z,O=(0,C.useCallback)((D,w)=>{var h;y.recordEvent(D,{...w,version:(h=window==null?void 0:window.myJetpackInitialState)==null?void 0:h.myJetpackVersion,referring_plugins:o})},[]);return{clearedIdentity:i,ga:u,mc:p,pageView:S,purchase:R,recordEvent:O,setGoogleAnalyticsEnabled:N,setMcAnalyticsEnabled:A,setProperties:P,tracks:y}}},"../../packages/my-jetpack/_inc/hooks/use-my-jetpack-connection/index.js":(T,l,s)=>{s.d(l,{Z:()=>C});var I=s("../connection/components/use-connection/index.jsx");function C(){const{apiRoot:d,apiNonce:_}=myJetpackRest,{topJetpackMenuItemUrl:c}=myJetpackInitialState,E=(0,I.Z)({apiRoot:d,apiNonce:_}),{registrationNonce:f}=JP_CONNECTION_INITIAL_STATE,r=E.isRegistered;return{apiNonce:_,apiRoot:d,registrationNonce:f,...E,isSiteConnected:r,topJetpackMenuItemUrl:c}}}}]);})();
