(()=>{(self.webpackChunk_automattic_jetpack_storybook=self.webpackChunk_automattic_jetpack_storybook||[]).push([[4581],{"../../../node_modules/.pnpm/@wordpress+compose@6.18.0_react@18.2.0/node_modules/@wordpress/compose/build-module/hooks/use-focusable-iframe/index.js":(Wt,kt,J)=>{"use strict";J.d(kt,{Z:()=>at});var pt=J("../../../node_modules/.pnpm/@wordpress+compose@6.18.0_react@18.2.0/node_modules/@wordpress/compose/build-module/hooks/use-ref-effect/index.js");function at(){return(0,pt.Z)(ut=>{const{ownerDocument:L}=ut;if(!L)return;const{defaultView:N}=L;if(!N)return;function y(){L&&L.activeElement===ut&&ut.focus()}return N.addEventListener("blur",y),()=>{N.removeEventListener("blur",y)}},[])}},"../../../node_modules/.pnpm/@wordpress+sync@0.3.0/node_modules/@wordpress/sync/build-module/connect-indexdb.js":(Wt,kt,J)=>{"use strict";J.d(kt,{D:()=>$t});var pt=J("../../../node_modules/.pnpm/yjs@13.6.7/node_modules/yjs/dist/yjs.mjs"),at=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/promise.js"),ut=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/error.js");const L=st=>at.Ue((et,lt)=>{st.onerror=yt=>lt(new Error(yt.target.error)),st.onsuccess=yt=>et(yt.target.result)}),N=(st,et)=>at.Ue((lt,yt)=>{const _t=indexedDB.open(st);_t.onupgradeneeded=Rt=>et(Rt.target.result),_t.onerror=Rt=>yt(ut.Ue(Rt.target.error)),_t.onsuccess=Rt=>{const xt=Rt.target.result;xt.onversionchange=()=>{xt.close()},typeof addEventListener!="undefined"&&addEventListener("unload",()=>xt.close()),lt(xt)}}),y=st=>L(indexedDB.deleteDatabase(st)),m=(st,et)=>et.forEach(lt=>st.createObjectStore.apply(st,lt)),x=(st,et,lt="readwrite")=>{const yt=st.transaction(et,lt);return et.map(_t=>Y(yt,_t))},V=(st,et)=>L(st.count(et)),u=(st,et)=>L(st.get(et)),_=(st,et)=>L(st.delete(et)),h=(st,et,lt)=>L(st.put(et,lt)),d=(st,et,lt)=>L(st.add(et,lt)),T=(st,et)=>L(st.add(et)),R=(st,et,lt)=>L(st.getAll(et,lt)),S=(st,et,lt)=>L(st.getAllKeys(et,lt)),M=(st,et,lt)=>{let yt=null;return A(st,et,_t=>(yt=_t,!1),lt).then(()=>yt)},a=(st,et=null)=>M(st,et,"prev"),b=(st,et=null)=>M(st,et,"next"),g=(st,et,lt)=>promise.all([S(st,et,lt),R(st,et,lt)]).then(([yt,_t])=>yt.map((Rt,xt)=>({k:Rt,v:_t[xt]}))),E=(st,et)=>at.Ue((lt,yt)=>{st.onerror=yt,st.onsuccess=async _t=>{const Rt=_t.target.result;if(Rt===null||await et(Rt)===!1)return lt();Rt.continue()}}),v=(st,et,lt,yt="next")=>E(st.openCursor(et,yt),_t=>lt(_t.value,_t.key)),A=(st,et,lt,yt="next")=>E(st.openKeyCursor(et,yt),_t=>lt(_t.key)),Y=(st,et)=>st.objectStore(et),O=(st,et,lt,yt)=>IDBKeyRange.bound(st,et,lt,yt),j=(st,et)=>IDBKeyRange.upperBound(st,et),q=(st,et)=>IDBKeyRange.lowerBound(st,et);var it=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/observable.js");const bt="custom",Et="updates",Tt=500,At=(st,et=()=>{},lt=()=>{})=>{const[yt]=x(st.db,[Et]);return R(yt,q(st._dbref,!1)).then(_t=>{st._destroyed||(et(yt),pt.ay(st.doc,()=>{_t.forEach(Rt=>pt.NG(st.doc,Rt))},st,!1),lt(yt))}).then(()=>a(yt).then(_t=>{st._dbref=_t+1})).then(()=>V(yt).then(_t=>{st._dbsize=_t})).then(()=>yt)},Ut=(st,et=!0)=>At(st).then(lt=>{(et||st._dbsize>=Tt)&&T(lt,pt.D$(st.doc)).then(()=>_(lt,j(st._dbref,!0))).then(()=>V(lt).then(yt=>{st._dbsize=yt}))}),wt=st=>idb.deleteDB(st);class Jt extends it.y{constructor(et,lt){super(),this.doc=lt,this.name=et,this._dbref=0,this._dbsize=0,this._destroyed=!1,this.db=null,this.synced=!1,this._db=N(et,yt=>m(yt,[["updates",{autoIncrement:!0}],["custom"]])),this.whenSynced=at.Ue(yt=>this.on("synced",()=>yt(this))),this._db.then(yt=>{this.db=yt,At(this,xt=>T(xt,pt.D$(lt)),()=>{if(this._destroyed)return this;this.synced=!0,this.emit("synced",[this])})}),this._storeTimeout=1e3,this._storeTimeoutId=null,this._storeUpdate=(yt,_t)=>{if(this.db&&_t!==this){const[Rt]=x(this.db,[Et]);T(Rt,yt),++this._dbsize>=Tt&&(this._storeTimeoutId!==null&&clearTimeout(this._storeTimeoutId),this._storeTimeoutId=setTimeout(()=>{Ut(this,!1),this._storeTimeoutId=null},this._storeTimeout))}},lt.on("update",this._storeUpdate),this.destroy=this.destroy.bind(this),lt.on("destroy",this.destroy)}destroy(){return this._storeTimeoutId&&clearTimeout(this._storeTimeoutId),this.doc.off("update",this._storeUpdate),this.doc.off("destroy",this.destroy),this._destroyed=!0,this._db.then(et=>{et.close()})}clearData(){return this.destroy().then(()=>{y(this.name)})}get(et){return this._db.then(lt=>{const[yt]=x(lt,[bt],"readonly");return u(yt,et)})}set(et,lt){return this._db.then(yt=>{const[_t]=x(yt,[bt]);return h(_t,lt,et)})}del(et){return this._db.then(lt=>{const[yt]=x(lt,[bt]);return _(yt,et)})}}function $t(st,et,lt){const yt=`${et}-${st}`,_t=new Jt(yt,lt);return new Promise(Rt=>{_t.on("synced",()=>{Rt(()=>_t.destroy())})})}},"../../../node_modules/.pnpm/@wordpress+sync@0.3.0/node_modules/@wordpress/sync/build-module/connect-webrtc.js":(Wt,kt,J)=>{"use strict";J.d(kt,{o:()=>hn});var pt=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/observable.js"),at=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/time.js"),ut=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/math.js");const L=1200,N=2500,y=3e4,m=H=>{if(H.shouldConnect&&H.ws===null){const $=new WebSocket(H.url),Z=H.binaryType;let ht=null;Z&&($.binaryType=Z),H.ws=$,H.connecting=!0,H.connected=!1,$.onmessage=St=>{H.lastMessageReceived=at.ZG();const Mt=St.data,Nt=typeof Mt=="string"?JSON.parse(Mt):Mt;Nt&&Nt.type==="pong"&&(clearTimeout(ht),ht=setTimeout(vt,y/2)),H.emit("message",[Nt,H])};const dt=St=>{H.ws!==null&&(H.ws=null,H.connecting=!1,H.connected?(H.connected=!1,H.emit("disconnect",[{type:"disconnect",error:St},H])):H.unsuccessfulReconnects++,setTimeout(m,ut.VV(ut.mv(H.unsuccessfulReconnects+1)*L,N),H)),clearTimeout(ht)},vt=()=>{H.ws===$&&H.send({type:"ping"})};$.onclose=()=>dt(null),$.onerror=St=>dt(St),$.onopen=()=>{H.lastMessageReceived=at.ZG(),H.connecting=!1,H.connected=!0,H.unsuccessfulReconnects=0,H.emit("connect",[{type:"connect"},H]),ht=setTimeout(vt,y/2)}}};class x extends pt.y{constructor($,{binaryType:Z}={}){super(),this.url=$,this.ws=null,this.binaryType=Z||null,this.connected=!1,this.connecting=!1,this.unsuccessfulReconnects=0,this.lastMessageReceived=0,this.shouldConnect=!0,this._checkInterval=setInterval(()=>{this.connected&&y<at.ZG()-this.lastMessageReceived&&this.ws.close()},y/2),m(this)}send($){this.ws&&this.ws.send(JSON.stringify($))}destroy(){clearInterval(this._checkInterval),this.disconnect(),super.destroy()}disconnect(){this.shouldConnect=!1,this.ws!==null&&this.ws.close()}connect(){this.shouldConnect=!0,!this.connected&&this.ws===null&&m(this)}}var V=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/map.js"),u=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/error.js"),_=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/random.js"),h=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/encoding.js"),d=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/decoding.js"),T=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/logging.js"),R=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/logging.common.js"),S=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/promise.js"),M=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/set.js"),a=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/buffer.js"),b=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/storage.js");const g=new Map;class E{constructor($){this.room=$,this.onmessage=null,this._onChange=Z=>Z.key===$&&this.onmessage!==null&&this.onmessage({data:a.Gh(Z.newValue||"")}),b.z2(this._onChange)}postMessage($){b.XN.setItem(this.room,a.s3(a.eh($)))}close(){b.F(this._onChange)}}const v=typeof BroadcastChannel=="undefined"?E:BroadcastChannel,A=H=>V.Yu(g,H,()=>{const $=M.Ue(),Z=new v(H);return Z.onmessage=ht=>$.forEach(dt=>dt(ht.data,"broadcastchannel")),{bc:Z,subs:$}}),Y=(H,$)=>(A(H).subs.add($),$),O=(H,$)=>{const Z=A(H),ht=Z.subs.delete($);return ht&&Z.subs.size===0&&(Z.bc.close(),g.delete(H)),ht},j=(H,$,Z=null)=>{const ht=A(H);ht.bc.postMessage($),ht.subs.forEach(dt=>dt($,Z))},q=()=>{let H=!0;return($,Z)=>{if(H){H=!1;try{$()}finally{H=!0}}else Z!==void 0&&Z()}};var it=J("../../../node_modules/.pnpm/simple-peer@9.11.1/node_modules/simple-peer/simplepeer.min.js"),bt=J.n(it),Et=J("../../../node_modules/.pnpm/yjs@13.6.7/node_modules/yjs/dist/yjs.mjs");const Tt=0,At=1,Ut=2,wt=(H,$)=>{h.uE(H,Tt);const Z=Et.gJ($);h.mP(H,Z)},Jt=(H,$,Z)=>{h.uE(H,At),h.mP(H,Et.D$($,Z))},$t=(H,$,Z)=>Jt($,Z,d.HN(H)),st=(H,$,Z)=>{try{Et.NG($,d.HN(H),Z)}catch(ht){console.error("Caught error while handling a Yjs update",ht)}},et=(H,$)=>{h.uE(H,Ut),h.mP(H,$)},lt=st,yt=(H,$,Z,ht)=>{const dt=d.yg(H);switch(dt){case Tt:$t(H,$,Z);break;case At:st(H,Z,ht);break;case Ut:lt(H,Z,ht);break;default:throw new Error("Unknown message type")}return dt};var _t=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/function.js");const Rt=3e4;class xt extends pt.y{constructor($){super(),this.doc=$,this.clientID=$.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{const Z=at.ZG();this.getLocalState()!==null&&Rt/2<=Z-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const ht=[];this.meta.forEach((dt,vt)=>{vt!==this.clientID&&Rt<=Z-dt.lastUpdated&&this.states.has(vt)&&ht.push(vt)}),ht.length>0&&Xt(this,ht,"timeout")},ut.GW(Rt/10)),$.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState($){const Z=this.clientID,ht=this.meta.get(Z),dt=ht===void 0?0:ht.clock+1,vt=this.states.get(Z);$===null?this.states.delete(Z):this.states.set(Z,$),this.meta.set(Z,{clock:dt,lastUpdated:at.ZG()});const St=[],Mt=[],Nt=[],Ht=[];$===null?Ht.push(Z):vt==null?$!=null&&St.push(Z):(Mt.push(Z),_t.Hi(vt,$)||Nt.push(Z)),(St.length>0||Nt.length>0||Ht.length>0)&&this.emit("change",[{added:St,updated:Nt,removed:Ht},"local"]),this.emit("update",[{added:St,updated:Mt,removed:Ht},"local"])}setLocalStateField($,Z){const ht=this.getLocalState();ht!==null&&this.setLocalState({...ht,[$]:Z})}getStates(){return this.states}}const Xt=(H,$,Z)=>{const ht=[];for(let dt=0;dt<$.length;dt++){const vt=$[dt];if(H.states.has(vt)){if(H.states.delete(vt),vt===H.clientID){const St=H.meta.get(vt);H.meta.set(vt,{clock:St.clock+1,lastUpdated:at.ZG()})}ht.push(vt)}}ht.length>0&&(H.emit("change",[{added:[],updated:[],removed:ht},Z]),H.emit("update",[{added:[],updated:[],removed:ht},Z]))},Ft=(H,$,Z=H.states)=>{const ht=$.length,dt=h.Mf();h.uE(dt,ht);for(let vt=0;vt<ht;vt++){const St=$[vt],Mt=Z.get(St)||null,Nt=H.meta.get(St).clock;h.uE(dt,St),h.uE(dt,Nt),h.uw(dt,JSON.stringify(Mt))}return h._f(dt)},ee=(H,$)=>{const Z=decoding.createDecoder(H),ht=encoding.createEncoder(),dt=decoding.readVarUint(Z);encoding.writeVarUint(ht,dt);for(let vt=0;vt<dt;vt++){const St=decoding.readVarUint(Z),Mt=decoding.readVarUint(Z),Nt=JSON.parse(decoding.readVarString(Z)),Ht=$(Nt);encoding.writeVarUint(ht,St),encoding.writeVarUint(ht,Mt),encoding.writeVarString(ht,JSON.stringify(Ht))}return encoding.toUint8Array(ht)},te=(H,$,Z)=>{const ht=d.l1($),dt=at.ZG(),vt=[],St=[],Mt=[],Nt=[],Ht=d.yg(ht);for(let Qt=0;Qt<Ht;Qt++){const re=d.yg(ht);let fe=d.yg(ht);const de=JSON.parse(d.kf(ht)),Ie=H.meta.get(re),Je=H.states.get(re),Xe=Ie===void 0?0:Ie.clock;(Xe<fe||Xe===fe&&de===null&&H.states.has(re))&&(de===null?re===H.clientID&&H.getLocalState()!=null?fe++:H.states.delete(re):H.states.set(re,de),H.meta.set(re,{clock:fe,lastUpdated:dt}),Ie===void 0&&de!==null?vt.push(re):Ie!==void 0&&de===null?Nt.push(re):de!==null&&(_t.Hi(de,Je)||Mt.push(re),St.push(re)))}(vt.length>0||Mt.length>0||Nt.length>0)&&H.emit("change",[{added:vt,updated:Mt,removed:Nt},Z]),(vt.length>0||St.length>0||Nt.length>0)&&H.emit("update",[{added:vt,updated:St,removed:Nt},Z])};var W=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/string.js");const ot=(H,$)=>{const Z=W.lz(H).buffer,ht=W.lz($).buffer;return crypto.subtle.importKey("raw",Z,"PBKDF2",!1,["deriveKey"]).then(dt=>crypto.subtle.deriveKey({name:"PBKDF2",salt:ht,iterations:1e5,hash:"SHA-256"},dt,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]))},I=(H,$)=>{if(!$)return S.DB(H);const Z=crypto.getRandomValues(new Uint8Array(12));return crypto.subtle.encrypt({name:"AES-GCM",iv:Z},$,H).then(ht=>{const dt=h.Mf();return h.uw(dt,"AES-GCM"),h.mP(dt,Z),h.mP(dt,new Uint8Array(ht)),h._f(dt)})},G=(H,$)=>{const Z=h.Mf();return h.EM(Z,H),I(h._f(Z),$)},C=(H,$)=>{if(!$)return S.DB(H);const Z=d.l1(H);d.kf(Z)!=="AES-GCM"&&S.d1(u.Ue("Unknown encryption algorithm"));const dt=d.HN(Z),vt=d.HN(Z);return crypto.subtle.decrypt({name:"AES-GCM",iv:dt},$,vt).then(St=>new Uint8Array(St))},U=(H,$)=>C(H,$).then(Z=>d.v_(d.l1(new Uint8Array(Z))));var rt=J("../../../node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js");const n=T.YX("y-webrtc"),r=0,c=3,k=1,K=4,z=new Map,ct=new Map,Ct=H=>{let $=!0;H.webrtcConns.forEach(Z=>{Z.synced||($=!1)}),(!$&&H.synced||$&&!H.synced)&&(H.synced=$,H.provider.emit("synced",[{synced:$}]),n("synced ",R.Pl,H.name,R.YW," with all peers"))},Bt=(H,$,Z)=>{const ht=d.l1($),dt=h.Mf(),vt=d.yg(ht);if(H===void 0)return null;const St=H.awareness,Mt=H.doc;let Nt=!1;switch(vt){case r:{h.uE(dt,r);const Ht=yt(ht,dt,Mt,H);Ht===At&&!H.synced&&Z(),Ht===Tt&&(Nt=!0);break}case c:h.uE(dt,k),h.mP(dt,Ft(St,Array.from(St.getStates().keys()))),Nt=!0;break;case k:te(St,d.HN(ht),H);break;case K:{const Ht=d.kj(ht)===1,Qt=d.kf(ht);if(Qt!==H.peerId&&(H.bcConns.has(Qt)&&!Ht||!H.bcConns.has(Qt)&&Ht)){const re=[],fe=[];Ht?(H.bcConns.add(Qt),fe.push(Qt)):(H.bcConns.delete(Qt),re.push(Qt)),H.provider.emit("peers",[{added:fe,removed:re,webrtcPeers:Array.from(H.webrtcConns.keys()),bcPeers:Array.from(H.bcConns)}]),gt(H)}break}default:return console.error("Unable to compute message"),dt}return Nt?dt:null},Ot=(H,$)=>{const Z=H.room;return n("received message from ",R.Pl,H.remotePeerId,R.s7," (",Z.name,")",R.YW,R.WO),Bt(Z,$,()=>{H.synced=!0,n("synced ",R.Pl,Z.name,R.YW," with ",R.Pl,H.remotePeerId),Ct(Z)})},Dt=(H,$)=>{n("send message to ",R.Pl,H.remotePeerId,R.YW,R.s7," (",H.room.name,")",R.WO);try{H.peer.send(h._f($))}catch(Z){}},Lt=(H,$)=>{n("broadcast message in ",R.Pl,H.name,R.YW),H.webrtcConns.forEach(Z=>{try{Z.peer.send($)}catch(ht){}})};class ie{constructor($,Z,ht,dt){n("establishing connection to ",R.Pl,ht),this.room=dt,this.remotePeerId=ht,this.closed=!1,this.connected=!1,this.synced=!1,this.peer=new(bt())({initiator:Z,...dt.provider.peerOpts}),this.peer.on("signal",vt=>{Yt($,dt,{to:ht,from:dt.peerId,type:"signal",signal:vt})}),this.peer.on("connect",()=>{n("connected to ",R.Pl,ht),this.connected=!0;const St=dt.provider.doc,Mt=dt.awareness,Nt=h.Mf();h.uE(Nt,r),wt(Nt,St),Dt(this,Nt);const Ht=Mt.getStates();if(Ht.size>0){const Qt=h.Mf();h.uE(Qt,k),h.mP(Qt,Ft(Mt,Array.from(Ht.keys()))),Dt(this,Qt)}}),this.peer.on("close",()=>{this.connected=!1,this.closed=!0,dt.webrtcConns.has(this.remotePeerId)&&(dt.webrtcConns.delete(this.remotePeerId),dt.provider.emit("peers",[{removed:[this.remotePeerId],added:[],webrtcPeers:Array.from(dt.webrtcConns.keys()),bcPeers:Array.from(dt.bcConns)}])),Ct(dt),this.peer.destroy(),n("closed connection to ",R.Pl,ht),mt(dt)}),this.peer.on("error",vt=>{n("Error in connection to ",R.Pl,ht,": ",vt),mt(dt)}),this.peer.on("data",vt=>{const St=Ot(this,vt);St!==null&&Dt(this,St)})}destroy(){this.peer.destroy()}}const X=(H,$)=>I($,H.key).then(Z=>H.mux(()=>j(H.name,Z))),nt=(H,$)=>{H.bcconnected&&X(H,$),Lt(H,$)},mt=H=>{z.forEach($=>{$.connected&&($.send({type:"subscribe",topics:[H.name]}),H.webrtcConns.size<H.provider.maxConns&&Yt($,H,{type:"announce",from:H.peerId}))})},gt=H=>{if(H.provider.filterBcConns){const $=h.Mf();h.uE($,K),h.$F($,1),h.uw($,H.peerId),X(H,h._f($))}};class jt{constructor($,Z,ht,dt){this.peerId=_.k$(),this.doc=$,this.awareness=Z.awareness,this.provider=Z,this.synced=!1,this.name=ht,this.key=dt,this.webrtcConns=new Map,this.bcConns=new Set,this.mux=q(),this.bcconnected=!1,this._bcSubscriber=vt=>C(new Uint8Array(vt),dt).then(St=>this.mux(()=>{const Mt=Bt(this,St,()=>{});Mt&&X(this,h._f(Mt))})),this._docUpdateHandler=(vt,St)=>{const Mt=h.Mf();h.uE(Mt,r),et(Mt,vt),nt(this,h._f(Mt))},this._awarenessUpdateHandler=({added:vt,updated:St,removed:Mt},Nt)=>{const Ht=vt.concat(St).concat(Mt),Qt=h.Mf();h.uE(Qt,k),h.mP(Qt,Ft(this.awareness,Ht)),nt(this,h._f(Qt))},this._beforeUnloadHandler=()=>{Xt(this.awareness,[$.clientID],"window unload"),ct.forEach(vt=>{vt.disconnect()})},typeof window!="undefined"?window.addEventListener("beforeunload",this._beforeUnloadHandler):typeof rt!="undefined"&&rt.on("exit",this._beforeUnloadHandler)}connect(){this.doc.on("update",this._docUpdateHandler),this.awareness.on("update",this._awarenessUpdateHandler),mt(this);const $=this.name;Y($,this._bcSubscriber),this.bcconnected=!0,gt(this);const Z=h.Mf();h.uE(Z,r),wt(Z,this.doc),X(this,h._f(Z));const ht=h.Mf();h.uE(ht,r),Jt(ht,this.doc),X(this,h._f(ht));const dt=h.Mf();h.uE(dt,c),X(this,h._f(dt));const vt=h.Mf();h.uE(vt,k),h.mP(vt,Ft(this.awareness,[this.doc.clientID])),X(this,h._f(vt))}disconnect(){z.forEach(Z=>{Z.connected&&Z.send({type:"unsubscribe",topics:[this.name]})}),Xt(this.awareness,[this.doc.clientID],"disconnect");const $=h.Mf();h.uE($,K),h.$F($,0),h.uw($,this.peerId),X(this,h._f($)),O(this.name,this._bcSubscriber),this.bcconnected=!1,this.doc.off("update",this._docUpdateHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.webrtcConns.forEach(Z=>Z.destroy())}destroy(){this.disconnect(),typeof window!="undefined"?window.removeEventListener("beforeunload",this._beforeUnloadHandler):typeof rt!="undefined"&&rt.off("exit",this._beforeUnloadHandler)}}const Zt=(H,$,Z,ht)=>{if(ct.has(Z))throw u.Ue(`A Yjs Doc connected to room "${Z}" already exists!`);const dt=new jt(H,$,Z,ht);return ct.set(Z,dt),dt},Yt=(H,$,Z)=>{$.key?G(Z,$.key).then(ht=>{H.send({type:"publish",topic:$.name,data:a.s3(ht)})}):H.send({type:"publish",topic:$.name,data:Z})};class ce extends x{constructor($){super($),this.providers=new Set,this.on("connect",()=>{n(`connected (${$})`);const Z=Array.from(ct.keys());this.send({type:"subscribe",topics:Z}),ct.forEach(ht=>Yt(this,ht,{type:"announce",from:ht.peerId}))}),this.on("message",Z=>{switch(Z.type){case"publish":{const ht=Z.topic,dt=ct.get(ht);if(dt==null||typeof ht!="string")return;const vt=St=>{const Mt=dt.webrtcConns,Nt=dt.peerId;if(St==null||St.from===Nt||St.to!==void 0&&St.to!==Nt||dt.bcConns.has(St.from))return;const Ht=Mt.has(St.from)?()=>{}:()=>dt.provider.emit("peers",[{removed:[],added:[St.from],webrtcPeers:Array.from(dt.webrtcConns.keys()),bcPeers:Array.from(dt.bcConns)}]);switch(St.type){case"announce":Mt.size<dt.provider.maxConns&&(V.Yu(Mt,St.from,()=>new ie(this,!0,St.from,dt)),Ht());break;case"signal":St.to===Nt&&(V.Yu(Mt,St.from,()=>new ie(this,!1,St.from,dt)).peer.signal(St.signal),Ht());break}};dt.key?typeof Z.data=="string"&&U(a.Gh(Z.data),dt.key).then(vt):vt(Z.data)}}}),this.on("disconnect",()=>n(`disconnect (${$})`))}}class Se extends pt.y{constructor($,Z,{signaling:ht=["wss://y-webrtc-eu.fly.dev"],password:dt=null,awareness:vt=new xt(Z),maxConns:St=20+ut.GW(_.TN()*15),filterBcConns:Mt=!0,peerOpts:Nt={}}={}){super(),this.roomName=$,this.doc=Z,this.filterBcConns=Mt,this.awareness=vt,this.shouldConnect=!1,this.signalingUrls=ht,this.signalingConns=[],this.maxConns=St,this.peerOpts=Nt,this.key=dt?ot(dt,$):S.DB(null),this.room=null,this.key.then(Ht=>{this.room=Zt(Z,this,$,Ht),this.shouldConnect?this.room.connect():this.room.disconnect()}),this.connect(),this.destroy=this.destroy.bind(this),Z.on("destroy",this.destroy)}get connected(){return this.room!==null&&this.shouldConnect}connect(){this.shouldConnect=!0,this.signalingUrls.forEach($=>{const Z=V.Yu(z,$,()=>new ce($));this.signalingConns.push(Z),Z.providers.add(this)}),this.room&&this.room.connect()}disconnect(){this.shouldConnect=!1,this.signalingConns.forEach($=>{$.providers.delete(this),$.providers.size===0&&($.destroy(),z.delete($.url))}),this.room&&this.room.disconnect()}destroy(){this.doc.off("destroy",this.destroy),this.key.then(()=>{this.room.destroy(),ct.delete(this.roomName)}),super.destroy()}}function hn(H,$,Z){const ht=`${$}-${H}`;return new Se(ht,Z,{password:window.__experimentalCollaborativeEditingSecret}),Promise.resolve(()=>!0)}},"../../../node_modules/.pnpm/@wordpress+sync@0.3.0/node_modules/@wordpress/sync/build-module/provider.js":(Wt,kt,J)=>{"use strict";J.d(kt,{G:()=>at});var pt=J("../../../node_modules/.pnpm/yjs@13.6.7/node_modules/yjs/dist/yjs.mjs");const at=(ut,L)=>{const N={},y={},m={};function x(h,d){N[h]=d}async function V(h,d,T){const R=new pt.QW;m[h]=m[h]||{},m[h][d]=R;const S=()=>{const b=N[h].fromCRDTDoc(R);T(b)};R.on("update",S);const M=await ut(d,h,R);L&&await L(d,h,R);const a=N[h].fetch;a&&a(d).then(b=>{R.transact(()=>{N[h].applyChangesToDoc(R,b)})}),y[h]=y[h]||{},y[h][d]=()=>{M(),R.off("update",S)}}async function u(h,d,T){const R=m[h][d];if(!R)throw"Error doc "+h+" "+d+" not found";R.transact(()=>{N[h].applyChangesToDoc(R,T)})}async function _(h,d){var T;(T=y==null?void 0:y[h])!=null&&T[d]&&y[h][d]()}return{register:x,bootstrap:V,update:u,discard:_}}},"../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/array.js":(Wt,kt,J)=>{"use strict";J.d(kt,{Dp:()=>N,Z$:()=>pt,kJ:()=>h,s7:()=>L});const pt=S=>S[S.length-1],at=()=>[],ut=S=>S.slice(),L=(S,M)=>{for(let a=0;a<M.length;a++)S.push(M[a])},N=Array.from,y=(S,M)=>{for(let a=0;a<S.length;a++)if(!M(S[a],a,S))return!1;return!0},m=(S,M)=>{for(let a=0;a<S.length;a++)if(M(S[a],a,S))return!0;return!1},x=(S,M)=>S.length===M.length&&y(S,(a,b)=>a===M[b]),V=S=>_(S,[],(M,a)=>M.concat(a)),u=(S,M)=>{const a=new Array(S);for(let b=0;b<S;b++)a[b]=M(b,a);return a},_=(S,M,a)=>S.reduce(a,M),h=Array.isArray,d=S=>N(set.from(S)),T=(S,M)=>{const a=set.create(),b=[];for(let g=0;g<S.length;g++){const E=S[g],v=M(E);a.has(v)||(a.add(v),b.push(E))}return b},R=(S,M)=>{const a=Array(S.length);for(let b=0;b<S.length;b++)a[b]=M(S[b],b,S);return a}},"../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/binary.js":(Wt,kt,J)=>{"use strict";J.d(kt,{$2:()=>lt,CY:()=>ut,Ko:()=>L,Qn:()=>at,RP:()=>Ot,Tg:()=>Dt,Vw:()=>pt,cq:()=>y,jS:()=>yt,kr:()=>et,rc:()=>m,x1:()=>x});const pt=1,at=2,ut=4,L=8,N=16,y=32,m=64,x=128,V=256,u=512,_=1024,h=2048,d=4096,T=8192,R=16384,S=32768,M=65536,a=1<<17,b=1<<18,g=1<<19,E=1<<20,v=1<<21,A=1<<22,Y=1<<23,O=1<<24,j=1<<25,q=1<<26,it=1<<27,bt=1<<28,Et=1<<29,Tt=1<<30,At=null,Ut=0,wt=1,Jt=3,$t=7,st=15,et=31,lt=63,yt=127,_t=255,Rt=511,xt=1023,Xt=2047,Ft=4095,ee=8191,te=16383,W=32767,ot=65535,I=a-1,G=b-1,C=g-1,U=E-1,rt=v-1,n=A-1,r=Y-1,c=O-1,k=j-1,K=q-1,z=it-1,ct=bt-1,Ct=Et-1,Bt=Tt-1,Ot=2147483647,Dt=4294967295},"../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/buffer.js":(Wt,kt,J)=>{"use strict";J.d(kt,{Gh:()=>_,Te:()=>L,eh:()=>N,f9:()=>S,s3:()=>u});var pt=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/string.js"),at=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/environment.js");const ut=g=>new Uint8Array(g),L=(g,E,v)=>new Uint8Array(g,E,v),N=g=>new Uint8Array(g),y=g=>{let E="";for(let v=0;v<g.byteLength;v++)E+=pt.IK(g[v]);return btoa(E)},m=g=>Buffer.from(g.buffer,g.byteOffset,g.byteLength).toString("base64"),x=g=>{const E=atob(g),v=ut(E.length);for(let A=0;A<E.length;A++)v[A]=E.charCodeAt(A);return v},V=g=>{const E=Buffer.from(g,"base64");return new Uint8Array(E.buffer,E.byteOffset,E.byteLength)},u=at.jU?y:m,_=at.jU?x:V,h=g=>u(g).replaceAll("+","-").replaceAll("/","_").replaceAll("=",""),d=g=>_(g.replaceAll("-","+").replaceAll("_","/")),T=g=>array.map(g,E=>E.toString(16).padStart(2,"0")).join(""),R=g=>{const E=g.length,v=new Uint8Array(math.ceil(E/2));for(let A=0;A<E;A+=2)v[v.length-A/2-1]=Number.parseInt(g.slice(E-A-2,E-A),16);return v},S=g=>{const E=ut(g.byteLength);return E.set(g),E},M=g=>{const E=encoding.createEncoder();return encoding.writeAny(E,g),encoding.toUint8Array(E)},a=g=>decoding.readAny(decoding.createDecoder(g)),b=(g,E)=>{if(E===0)return g;g=new Uint8Array(g),g[0]<<=E;for(let v=1;v<g.length;v++)g[v-1]|=g[v]>>>8-E,g[v]<<=E;return g}},"../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/decoding.js":(Wt,kt,J)=>{"use strict";J.d(kt,{HN:()=>T,UF:()=>Xt,XW:()=>_t,dD:()=>ee,kf:()=>Et,kj:()=>M,l1:()=>u,sO:()=>te,v_:()=>yt,yg:()=>Y});var pt=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/buffer.js"),at=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/binary.js"),ut=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/math.js"),L=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/number.js"),N=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/string.js"),y=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/error.js");const m=y.Ue("Unexpected end of array"),x=y.Ue("Integer out of Range");class V{constructor(ot){this.arr=ot,this.pos=0}}const u=W=>new V(W),_=W=>W.pos!==W.arr.length,h=(W,ot=W.pos)=>{const I=u(W.arr);return I.pos=ot,I},d=(W,ot)=>{const I=pt.Te(W.arr.buffer,W.pos+W.arr.byteOffset,ot);return W.pos+=ot,I},T=W=>d(W,Y(W)),R=W=>d(W,W.arr.length-W.pos),S=W=>W.pos++,M=W=>W.arr[W.pos++],a=W=>{const ot=W.arr[W.pos]+(W.arr[W.pos+1]<<8);return W.pos+=2,ot},b=W=>{const ot=W.arr[W.pos]+(W.arr[W.pos+1]<<8)+(W.arr[W.pos+2]<<16)+(W.arr[W.pos+3]<<24)>>>0;return W.pos+=4,ot},g=W=>{const ot=W.arr[W.pos+3]+(W.arr[W.pos+2]<<8)+(W.arr[W.pos+1]<<16)+(W.arr[W.pos]<<24)>>>0;return W.pos+=4,ot},E=W=>W.arr[W.pos],v=W=>W.arr[W.pos]+(W.arr[W.pos+1]<<8),A=W=>W.arr[W.pos]+(W.arr[W.pos+1]<<8)+(W.arr[W.pos+2]<<16)+(W.arr[W.pos+3]<<24)>>>0,Y=W=>{let ot=0,I=1;const G=W.arr.length;for(;W.pos<G;){const C=W.arr[W.pos++];if(ot=ot+(C&at.jS)*I,I*=128,C<at.x1)return ot;if(ot>L.YM)throw x}throw m},O=W=>{let ot=W.arr[W.pos++],I=ot&at.$2,G=64;const C=(ot&at.rc)>0?-1:1;if(!(ot&at.x1))return C*I;const U=W.arr.length;for(;W.pos<U;){if(ot=W.arr[W.pos++],I=I+(ot&at.jS)*G,G*=128,ot<at.x1)return C*I;if(I>L.YM)throw x}throw m},j=W=>{const ot=W.pos,I=Y(W);return W.pos=ot,I},q=W=>{const ot=W.pos,I=O(W);return W.pos=ot,I},it=W=>{let ot=Y(W);if(ot===0)return"";{let I=String.fromCodePoint(M(W));if(--ot<100)for(;ot--;)I+=String.fromCodePoint(M(W));else for(;ot>0;){const G=ot<1e4?ot:1e4,C=W.arr.subarray(W.pos,W.pos+G);W.pos+=G,I+=String.fromCodePoint.apply(null,C),ot-=G}return decodeURIComponent(escape(I))}},bt=W=>N.CO.decode(T(W)),Et=N.CO?bt:it,Tt=W=>{const ot=encoding.createEncoder();let I;for(;;){if(I=M(W),I===0)return encoding.toUint8Array(ot);I===1&&(I=M(W)),encoding.write(ot,I)}},At=W=>string.decodeUtf8(Tt(W)),Ut=W=>{const ot=W.pos,I=Et(W);return W.pos=ot,I},wt=(W,ot)=>{const I=new DataView(W.arr.buffer,W.arr.byteOffset+W.pos,ot);return W.pos+=ot,I},Jt=W=>wt(W,4).getFloat32(0,!1),$t=W=>wt(W,8).getFloat64(0,!1),st=W=>wt(W,8).getBigInt64(0,!1),et=W=>wt(W,8).getBigUint64(0,!1),lt=[W=>{},W=>null,O,Jt,$t,st,W=>!1,W=>!0,Et,W=>{const ot=Y(W),I={};for(let G=0;G<ot;G++){const C=Et(W);I[C]=yt(W)}return I},W=>{const ot=Y(W),I=[];for(let G=0;G<ot;G++)I.push(yt(W));return I},T],yt=W=>lt[127-M(W)](W);class _t extends V{constructor(ot,I){super(ot),this.reader=I,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),_(this)?this.count=Y(this)+1:this.count=-1),this.count--,this.s}}class Rt extends null{constructor(ot,I){super(ot),this.s=I}read(){return this.s+=O(this),this.s}}class xt extends null{constructor(ot,I){super(ot),this.s=I,this.count=0}read(){return this.count===0&&(this.s+=O(this),_(this)?this.count=Y(this)+1:this.count=-1),this.count--,this.s}}class Xt extends V{constructor(ot){super(ot),this.s=0,this.count=0}read(){if(this.count===0){this.s=O(this);const ot=ut.GR(this.s);this.count=1,ot&&(this.s=-this.s,this.count=Y(this)+2)}return this.count--,this.s}}class Ft extends null{constructor(ot){super(ot),this.s=0,this.count=0}read(){if(this.count===0){this.s=O(this);const ot=math.isNegativeZero(this.s);this.count=1,ot&&(this.s=-this.s,this.count=Y(this)+2)}return this.count--,this.s++}}class ee extends V{constructor(ot){super(ot),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const ot=O(this),I=ot&1;this.diff=ut.GW(ot/2),this.count=1,I&&(this.count=Y(this)+2)}return this.s+=this.diff,this.count--,this.s}}class te{constructor(ot){this.decoder=new Xt(ot),this.str=Et(this.decoder),this.spos=0}read(){const ot=this.spos+this.decoder.read(),I=this.str.slice(this.spos,ot);return this.spos=ot,I}}},"../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/encoding.js":(Wt,kt,J)=>{"use strict";J.d(kt,{$F:()=>S,EM:()=>Rt,GF:()=>xt,HE:()=>te,HK:()=>Ut,Mf:()=>x,TS:()=>G,_f:()=>h,mP:()=>wt,sX:()=>I,uE:()=>A,uw:()=>bt});var pt=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/buffer.js"),at=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/math.js"),ut=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/number.js"),L=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/binary.js"),N=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/string.js"),y=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/array.js");class m{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const x=()=>new m,V=C=>{const U=x();return C(U),h(U)},u=C=>{let U=C.cpos;for(let rt=0;rt<C.bufs.length;rt++)U+=C.bufs[rt].length;return U},_=C=>C.cpos>0||C.bufs.length>0,h=C=>{const U=new Uint8Array(u(C));let rt=0;for(let n=0;n<C.bufs.length;n++){const r=C.bufs[n];U.set(r,rt),rt+=r.length}return U.set(pt.Te(C.cbuf.buffer,0,C.cpos),rt),U},d=(C,U)=>{const rt=C.cbuf.length;rt-C.cpos<U&&(C.bufs.push(pt.Te(C.cbuf.buffer,0,C.cpos)),C.cbuf=new Uint8Array(at.Fp(rt,U)*2),C.cpos=0)},T=(C,U)=>{const rt=C.cbuf.length;C.cpos===rt&&(C.bufs.push(C.cbuf),C.cbuf=new Uint8Array(rt*2),C.cpos=0),C.cbuf[C.cpos++]=U},R=(C,U,rt)=>{let n=null;for(let r=0;r<C.bufs.length&&n===null;r++){const c=C.bufs[r];U<c.length?n=c:U-=c.length}n===null&&(n=C.cbuf),n[U]=rt},S=T,M=null,a=(C,U)=>{T(C,U&binary.BITS8),T(C,U>>>8&binary.BITS8)},b=(C,U,rt)=>{R(C,U,rt&binary.BITS8),R(C,U+1,rt>>>8&binary.BITS8)},g=(C,U)=>{for(let rt=0;rt<4;rt++)T(C,U&binary.BITS8),U>>>=8},E=(C,U)=>{for(let rt=3;rt>=0;rt--)T(C,U>>>8*rt&binary.BITS8)},v=(C,U,rt)=>{for(let n=0;n<4;n++)R(C,U+n,rt&binary.BITS8),rt>>>=8},A=(C,U)=>{for(;U>L.jS;)T(C,L.x1|L.jS&U),U=at.GW(U/128);T(C,L.jS&U)},Y=(C,U)=>{const rt=at.GR(U);for(rt&&(U=-U),T(C,(U>L.$2?L.x1:0)|(rt?L.rc:0)|L.$2&U),U=at.GW(U/64);U>0;)T(C,(U>L.jS?L.x1:0)|L.jS&U),U=at.GW(U/128)},O=new Uint8Array(3e4),j=O.length/3,q=(C,U)=>{if(U.length<j){const rt=N.YZ.encodeInto(U,O).written||0;A(C,rt);for(let n=0;n<rt;n++)T(C,O[n])}else wt(C,N.lz(U))},it=(C,U)=>{const rt=unescape(encodeURIComponent(U)),n=rt.length;A(C,n);for(let r=0;r<n;r++)T(C,rt.codePointAt(r))},bt=N.YZ&&N.YZ.encodeInto?q:it,Et=(C,U)=>Tt(C,string.encodeUtf8(U)),Tt=(C,U)=>{for(let rt=0;rt<U.length;rt++){const n=U[rt];(n===0||n===1)&&T(C,1),T(C,U[rt])}T(C,0)},At=(C,U)=>Ut(C,h(U)),Ut=(C,U)=>{const rt=C.cbuf.length,n=C.cpos,r=at.VV(rt-n,U.length),c=U.length-r;C.cbuf.set(U.subarray(0,r),n),C.cpos+=r,c>0&&(C.bufs.push(C.cbuf),C.cbuf=new Uint8Array(at.Fp(rt*2,c)),C.cbuf.set(U.subarray(r)),C.cpos=c)},wt=(C,U)=>{A(C,U.byteLength),Ut(C,U)},Jt=(C,U)=>{d(C,U);const rt=new DataView(C.cbuf.buffer,C.cpos,U);return C.cpos+=U,rt},$t=(C,U)=>Jt(C,4).setFloat32(0,U,!1),st=(C,U)=>Jt(C,8).setFloat64(0,U,!1),et=(C,U)=>Jt(C,8).setBigInt64(0,U,!1),lt=(C,U)=>Jt(C,8).setBigUint64(0,U,!1),yt=new DataView(new ArrayBuffer(4)),_t=C=>(yt.setFloat32(0,C),yt.getFloat32(0)===C),Rt=(C,U)=>{switch(typeof U){case"string":T(C,119),bt(C,U);break;case"number":ut.U(U)&&at.Wn(U)<=L.RP?(T(C,125),Y(C,U)):_t(U)?(T(C,124),$t(C,U)):(T(C,123),st(C,U));break;case"bigint":T(C,122),et(C,U);break;case"object":if(U===null)T(C,126);else if(y.kJ(U)){T(C,117),A(C,U.length);for(let rt=0;rt<U.length;rt++)Rt(C,U[rt])}else if(U instanceof Uint8Array)T(C,116),wt(C,U);else{T(C,118);const rt=Object.keys(U);A(C,rt.length);for(let n=0;n<rt.length;n++){const r=rt[n];bt(C,r),Rt(C,U[r])}}break;case"boolean":T(C,U?120:121);break;default:T(C,127)}};class xt extends m{constructor(U){super(),this.w=U,this.s=null,this.count=0}write(U){this.s===U?this.count++:(this.count>0&&A(this,this.count-1),this.count=1,this.w(this,U),this.s=U)}}class Xt extends null{constructor(U){super(),this.s=U}write(U){Y(this,U-this.s),this.s=U}}class Ft extends null{constructor(U){super(),this.s=U,this.count=0}write(U){this.s===U&&this.count>0?this.count++:(this.count>0&&A(this,this.count-1),this.count=1,Y(this,U-this.s),this.s=U)}}const ee=C=>{C.count>0&&(Y(C.encoder,C.count===1?C.s:-C.s),C.count>1&&A(C.encoder,C.count-2))};class te{constructor(){this.encoder=new m,this.s=0,this.count=0}write(U){this.s===U?this.count++:(ee(this),this.count=1,this.s=U)}toUint8Array(){return ee(this),h(this.encoder)}}class W{constructor(){this.encoder=new m,this.s=0,this.count=0}write(U){this.s+this.count===U?this.count++:(ee(this),this.count=1,this.s=U)}toUint8Array(){return ee(this),h(this.encoder)}}const ot=C=>{if(C.count>0){const U=C.diff*2+(C.count===1?0:1);Y(C.encoder,U),C.count>1&&A(C.encoder,C.count-2)}};class I{constructor(){this.encoder=new m,this.s=0,this.count=0,this.diff=0}write(U){this.diff===U-this.s?(this.s=U,this.count++):(ot(this),this.count=1,this.diff=U-this.s,this.s=U)}toUint8Array(){return ot(this),h(this.encoder)}}class G{constructor(){this.sarr=[],this.s="",this.lensE=new te}write(U){this.s+=U,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(U.length)}toUint8Array(){const U=new m;return this.sarr.push(this.s),this.s="",bt(U,this.sarr.join("")),Ut(U,this.lensE.toUint8Array()),h(U)}}},"../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/environment.js":(Wt,kt,J)=>{"use strict";J.d(kt,{E0:()=>R,jU:()=>x,hH:()=>g});var pt=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/map.js"),at=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/string.js");const ut=E=>E===void 0?null:E;var L=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/storage.js"),N=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/function.js"),y=J("../../../node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js");const m=typeof y!="undefined"&&y.release&&/node|io\.js/.test(y.release.name),x=typeof window!="undefined"&&typeof document!="undefined"&&!m,V=typeof navigator!="undefined"?/Mac/.test(navigator.platform):!1;let u;const _=[],h=()=>{if(u===void 0)if(m){u=pt.Ue();const E=y.argv;let v=null;for(let A=0;A<E.length;A++){const Y=E[A];Y[0]==="-"?(v!==null&&u.set(v,""),v=Y):v!==null?(u.set(v,Y),v=null):_.push(Y)}v!==null&&u.set(v,"")}else typeof location=="object"?(u=pt.Ue(),(location.search||"?").slice(1).split("&").forEach(E=>{if(E.length!==0){const[v,A]=E.split("=");u.set(`--${at.NF(v,"-")}`,A),u.set(`-${at.NF(v,"-")}`,A)}})):u=pt.Ue();return u},d=E=>h().has(E),T=(E,v)=>h().get(E)||v,R=E=>ut(m?y.env[E.toUpperCase()]:L.XN.getItem(E)),S=E=>h().get("--"+E)||R(E),a=(E=>d("--"+E)||R(E)!==null)("production"),b=m&&N.gB(y.env.FORCE_COLOR,["true","1","2"]),g=!d("no-colors")&&(!m||y.stdout.isTTY||b)&&(!m||d("color")||b||R("COLORTERM")!==null||(R("TERM")||"").includes("color"))},"../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/error.js":(Wt,kt,J)=>{"use strict";J.d(kt,{Nw:()=>at,Ue:()=>pt,zR:()=>ut});const pt=L=>new Error(L),at=()=>{throw pt("Method unimplemented")},ut=()=>{throw pt("Unexpected case")}},"../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/function.js":(Wt,kt,J)=>{"use strict";J.d(kt,{Hi:()=>V,PP:()=>ut,WY:()=>L,gB:()=>u,id:()=>y});var pt=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/array.js"),at=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/object.js");const ut=(S,M,a=0)=>{try{for(;a<S.length;a++)S[a](...M)}finally{a<S.length&&ut(S,M,a+1)}},L=()=>{},N=S=>S(),y=S=>S,m=(S,M)=>S===M,x=(S,M)=>S===M||S!=null&&M!=null&&S.constructor===M.constructor&&(array.isArray(S)&&array.equalFlat(S,M)||typeof S=="object"&&object.equalFlat(S,M)),V=(S,M)=>{if(S==null||M==null)return m(S,M);if(S.constructor!==M.constructor)return!1;if(S===M)return!0;switch(S.constructor){case ArrayBuffer:S=new Uint8Array(S),M=new Uint8Array(M);case Uint8Array:{if(S.byteLength!==M.byteLength)return!1;for(let a=0;a<S.length;a++)if(S[a]!==M[a])return!1;break}case Set:{if(S.size!==M.size)return!1;for(const a of S)if(!M.has(a))return!1;break}case Map:{if(S.size!==M.size)return!1;for(const a of S.keys())if(!M.has(a)||!V(S.get(a),M.get(a)))return!1;break}case Object:if(at.kE(S)!==at.kE(M))return!1;for(const a in S)if(!at.l$(S,a)||!V(S[a],M[a]))return!1;break;case Array:if(S.length!==M.length)return!1;for(let a=0;a<S.length;a++)if(!V(S[a],M[a]))return!1;break;default:return!1}return!0},u=(S,M)=>M.includes(S),_=pt.kJ,h=S=>S&&S.constructor===String,d=S=>S!=null&&S.constructor===Number,T=(S,M)=>S&&S.constructor===M,R=S=>M=>M&&M.constructor===S},"../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/logging.common.js":(Wt,kt,J)=>{"use strict";J.d(kt,{Ej:()=>x,Pl:()=>y,ZA:()=>u,s7:()=>V,ud:()=>d,Wd:()=>h,hM:()=>_,YW:()=>m,WO:()=>T,_X:()=>R,YX:()=>b});const pt=Symbol,at=g=>typeof g=="symbol";var ut=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/time.js"),L=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/environment.js"),N=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/function.js");const y=pt(),m=pt(),x=pt(),V=pt(),u=pt(),_=pt(),h=pt(),d=pt(),T=pt(),R=g=>{const E=[],v=[];let A=0;for(;A<g.length;A++){const Y=g[A];Y.constructor===String||Y.constructor===Number?E.push(Y):Y.constructor===Object&&v.push(JSON.stringify(Y))}return v},S=[u,h,d,x];let M=0,a=ut.ZG();const b=(g,E)=>{const v=S[M],A=L.E0("log"),Y=A!==null&&(A==="*"||A==="true"||new RegExp(A,"gi").test(E));return M=(M+1)%S.length,E+=": ",Y?(...O)=>{const j=ut.ZG(),q=j-a;a=j,g(v,E,T,...O.map(it=>typeof it=="string"||typeof it=="symbol"?it:JSON.stringify(it)),v," +"+q+"ms")}:N.WY}},"../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/logging.js":(Wt,kt,J)=>{"use strict";J.d(kt,{YX:()=>ie,S0:()=>C});var pt=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/environment.js"),at=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/set.js");class ut{constructor(nt,mt){this.left=nt,this.right=mt}}const L=(X,nt)=>new ut(X,nt),N=(X,nt)=>new ut(nt,X),y=(X,nt)=>X.forEach(mt=>nt(mt.left,mt.right)),m=(X,nt)=>X.map(mt=>nt(mt.left,mt.right));var x=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/map.js");const V=typeof document!="undefined"?document:{},u=X=>V.createElement(X),_=()=>V.createDocumentFragment(),h=X=>V.createTextNode(X),d=typeof DOMParser!="undefined"?new DOMParser:null,T=(X,nt,mt)=>X.dispatchEvent(new CustomEvent(nt,mt)),R=(X,nt)=>(pair.forEach(nt,(mt,gt)=>{gt===!1?X.removeAttribute(mt):gt===!0?X.setAttribute(mt,""):X.setAttribute(mt,gt)}),X),S=(X,nt)=>(nt.forEach((mt,gt)=>{X.setAttribute(gt,mt)}),X),M=X=>{const nt=_();for(let mt=0;mt<X.length;mt++)et(nt,X[mt]);return nt},a=(X,nt)=>(et(X,M(nt)),X),b=X=>X.remove(),g=(X,nt,mt)=>X.addEventListener(nt,mt),E=(X,nt,mt)=>X.removeEventListener(nt,mt),v=(X,nt)=>(pair.forEach(nt,(mt,gt)=>g(X,mt,gt)),X),A=(X,nt)=>(pair.forEach(nt,(mt,gt)=>E(X,mt,gt)),X),Y=(X,nt=[],mt=[])=>a(R(u(X),nt),mt),O=(X,nt)=>{const mt=u("canvas");return mt.height=nt,mt.width=X,mt},j=null,q=X=>`${X.left}:${X.right};`,it=X=>X.map(q).join(""),bt=X=>x.UI(X,(nt,mt)=>`${mt}:${nt};`).join(""),Et=(X,nt)=>X.querySelector(nt),Tt=(X,nt)=>X.querySelectorAll(nt),At=X=>V.getElementById(X),Ut=X=>d.parseFromString(`<html><body>${X}</body></html>`,"text/html").body,wt=X=>M(Ut(X).childNodes),Jt=X=>Ut(X).firstElementChild,$t=(X,nt)=>X.replaceWith(nt),st=(X,nt,mt)=>X.insertBefore(nt,mt),et=(X,nt)=>X.appendChild(nt),lt=V.ELEMENT_NODE,yt=V.TEXT_NODE,_t=V.CDATA_SECTION_NODE,Rt=V.COMMENT_NODE,xt=V.DOCUMENT_NODE,Xt=V.DOCUMENT_TYPE_NODE,Ft=V.DOCUMENT_FRAGMENT_NODE,ee=(X,nt)=>X.nodeType===nt,te=(X,nt)=>{let mt=nt.parentNode;for(;mt&&mt!==X;)mt=mt.parentNode;return mt===X};var W=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/logging.common.js");const ot={[W.Pl]:L("font-weight","bold"),[W.YW]:L("font-weight","normal"),[W.Ej]:L("color","blue"),[W.ZA]:L("color","green"),[W.s7]:L("color","grey"),[W.hM]:L("color","red"),[W.Wd]:L("color","purple"),[W.ud]:L("color","orange"),[W.WO]:L("color","black")},I=X=>{const nt=[],mt=[],gt=x.Ue();let jt=[],Zt=0;for(;Zt<X.length;Zt++){const Yt=X[Zt],ce=ot[Yt];if(ce!==void 0)gt.set(ce.left,ce.right);else if(Yt.constructor===String||Yt.constructor===Number){const Se=bt(gt);Zt>0||Se.length>0?(nt.push("%c"+Yt),mt.push(Se)):nt.push(Yt)}else break}for(Zt>0&&(jt=mt,jt.unshift(nt.join("")));Zt<X.length;Zt++){const Yt=X[Zt];Yt instanceof Symbol||jt.push(Yt)}return jt},G=pt.hH?I:W._X,C=(...X)=>{console.log(...G(X)),Ct.forEach(nt=>nt.print(X))},U=(...X)=>{console.warn(...G(X)),X.unshift(common.ORANGE),Ct.forEach(nt=>nt.print(X))},rt=X=>{console.error(X),Ct.forEach(nt=>nt.printError(X))},n=(X,nt)=>{env.isBrowser&&console.log("%c                      ",`font-size: ${nt}px; background-size: contain; background-repeat: no-repeat; background-image: url(${X})`),Ct.forEach(mt=>mt.printImg(X,nt))},r=(X,nt)=>n(`data:image/gif;base64,${X}`,nt),c=(...X)=>{console.group(...G(X)),Ct.forEach(nt=>nt.group(X))},k=(...X)=>{console.groupCollapsed(...G(X)),Ct.forEach(nt=>nt.groupCollapsed(X))},K=()=>{console.groupEnd(),Ct.forEach(X=>X.groupEnd())},z=X=>Ct.forEach(nt=>nt.printDom(X())),ct=(X,nt)=>n(X.toDataURL(),nt),Ct=at.Ue(),Bt=X=>{const nt=[],mt=new Map;let gt=0;for(;gt<X.length;gt++){const jt=X[gt],Zt=ot[jt];if(Zt!==void 0)mt.set(Zt.left,Zt.right);else if(jt.constructor===String||jt.constructor===Number){const Yt=dom.element("span",[pair.create("style",dom.mapToStyleString(mt))],[dom.text(jt.toString())]);Yt.innerHTML===""&&(Yt.innerHTML="&nbsp;"),nt.push(Yt)}else break}for(;gt<X.length;gt++){let jt=X[gt];jt instanceof Symbol||(jt.constructor!==String&&jt.constructor!==Number&&(jt=" "+json.stringify(jt)+" "),nt.push(dom.element("span",[],[dom.text(jt)])))}return nt},Ot="font-family:monospace;border-bottom:1px solid #e2e2e2;padding:2px;";class Dt{constructor(nt){this.dom=nt,this.ccontainer=this.dom,this.depth=0,Ct.add(this)}group(nt,mt=!1){eventloop.enqueue(()=>{const gt=dom.element("span",[pair.create("hidden",mt),pair.create("style","color:grey;font-size:120%;")],[dom.text("\u25BC")]),jt=dom.element("span",[pair.create("hidden",!mt),pair.create("style","color:grey;font-size:125%;")],[dom.text("\u25B6")]),Zt=dom.element("div",[pair.create("style",`${Ot};padding-left:${this.depth*10}px`)],[gt,jt,dom.text(" ")].concat(Bt(nt))),Yt=dom.element("div",[pair.create("hidden",mt)]),ce=dom.element("div",[],[Zt,Yt]);dom.append(this.ccontainer,[ce]),this.ccontainer=Yt,this.depth++,dom.addEventListener(Zt,"click",Se=>{Yt.toggleAttribute("hidden"),gt.toggleAttribute("hidden"),jt.toggleAttribute("hidden")})})}groupCollapsed(nt){this.group(nt,!0)}groupEnd(){eventloop.enqueue(()=>{this.depth>0&&(this.depth--,this.ccontainer=this.ccontainer.parentElement.parentElement)})}print(nt){eventloop.enqueue(()=>{dom.append(this.ccontainer,[dom.element("div",[pair.create("style",`${Ot};padding-left:${this.depth*10}px`)],Bt(nt))])})}printError(nt){this.print([common.RED,common.BOLD,nt.toString()])}printImg(nt,mt){eventloop.enqueue(()=>{dom.append(this.ccontainer,[dom.element("img",[pair.create("src",nt),pair.create("height",`${math.round(mt*1.5)}px`)])])})}printDom(nt){eventloop.enqueue(()=>{dom.append(this.ccontainer,[nt])})}destroy(){eventloop.enqueue(()=>{Ct.delete(this)})}}const Lt=X=>new Dt(X),ie=X=>W.YX(C,X)},"../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/map.js":(Wt,kt,J)=>{"use strict";J.d(kt,{JG:()=>at,UI:()=>L,Ue:()=>pt,Yj:()=>N,Yu:()=>ut});const pt=()=>new Map,at=m=>{const x=pt();return m.forEach((V,u)=>{x.set(u,V)}),x},ut=(m,x,V)=>{let u=m.get(x);return u===void 0&&m.set(x,u=V()),u},L=(m,x)=>{const V=[];for(const[u,_]of m)V.push(x(_,u));return V},N=(m,x)=>{for(const[V,u]of m)if(x(u,V))return!0;return!1},y=(m,x)=>{for(const[V,u]of m)if(!x(u,V))return!1;return!0}},"../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/math.js":(Wt,kt,J)=>{"use strict";J.d(kt,{Fp:()=>h,GR:()=>M,GW:()=>pt,VV:()=>_,Wn:()=>ut,mv:()=>y});const pt=Math.floor,at=Math.ceil,ut=Math.abs,L=Math.imul,N=Math.round,y=Math.log10,m=Math.log2,x=Math.log,V=Math.sqrt,u=(a,b)=>a+b,_=(a,b)=>a<b?a:b,h=(a,b)=>a>b?a:b,d=Number.isNaN,T=Math.pow,R=a=>Math.pow(10,a),S=Math.sign,M=a=>a!==0?a<0:1/a<0},"../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/number.js":(Wt,kt,J)=>{"use strict";J.d(kt,{U:()=>x,YM:()=>ut});var pt=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/math.js"),at=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/binary.js");const ut=Number.MAX_SAFE_INTEGER,L=Number.MIN_SAFE_INTEGER,N=null,y=at.RP,m=at.Tg,x=Number.isInteger||(h=>typeof h=="number"&&isFinite(h)&&pt.GW(h)===h),V=Number.isNaN,u=Number.parseInt,_=h=>{h&=binary.BITS32;let d=0;for(;h;)h&=h-1,d++;return d}},"../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/object.js":(Wt,kt,J)=>{"use strict";J.d(kt,{$m:()=>_,Ed:()=>L,f0:()=>at,kE:()=>y,l$:()=>u,xb:()=>x});const pt=()=>Object.create(null),at=Object.assign,ut=Object.keys,L=(h,d)=>{for(const T in h)d(h[T],T)},N=(h,d)=>{const T=[];for(const R in h)T.push(d(h[R],R));return T},y=h=>ut(h).length,m=(h,d)=>{for(const T in h)if(d(h[T],T))return!0;return!1},x=h=>{for(const d in h)return!1;return!0},V=(h,d)=>{for(const T in h)if(!d(h[T],T))return!1;return!0},u=(h,d)=>Object.prototype.hasOwnProperty.call(h,d),_=(h,d)=>h===d||y(h)===y(d)&&V(h,(T,R)=>(T!==void 0||u(d,R))&&d[R]===T)},"../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/observable.js":(Wt,kt,J)=>{"use strict";J.d(kt,{y:()=>L});var pt=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/map.js"),at=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/set.js"),ut=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/array.js");class L{constructor(){this._observers=pt.Ue()}on(y,m){pt.Yu(this._observers,y,at.Ue).add(m)}once(y,m){const x=(...V)=>{this.off(y,x),m(...V)};this.on(y,x)}off(y,m){const x=this._observers.get(y);x!==void 0&&(x.delete(m),x.size===0&&this._observers.delete(y))}emit(y,m){return ut.Dp((this._observers.get(y)||pt.Ue()).values()).forEach(x=>x(...m))}destroy(){this._observers=pt.Ue()}}},"../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/promise.js":(Wt,kt,J)=>{"use strict";J.d(kt,{DB:()=>N,Ue:()=>pt,d1:()=>L});const pt=u=>new Promise(u),at=u=>new Promise(u),ut=Promise.all.bind(Promise),L=u=>Promise.reject(u),N=u=>Promise.resolve(u),y=u=>Promise.resolve(u),m=(u,_,h=10)=>pt((d,T)=>{const R=time.getUnixTime(),S=u>0,a=setInterval(()=>{_()?(clearInterval(a),d()):S&&time.getUnixTime()-R>u&&(clearInterval(a),T(new Error("Timeout")))},h)}),x=u=>pt((_,h)=>setTimeout(_,u)),V=u=>u instanceof Promise||u&&u.then&&u.catch&&u.finally},"../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/random.js":(Wt,kt,J)=>{"use strict";J.d(kt,{TN:()=>ut,U7:()=>L,k$:()=>x});const pt=crypto.subtle,at=crypto.getRandomValues.bind(crypto),ut=Math.random,L=()=>at(new Uint32Array(1))[0],N=()=>{const V=getRandomValues(new Uint32Array(8));return(V[0]&binary.BITS21)*(binary.BITS32+1)+(V[1]>>>0)},y=V=>V[math.floor(ut()*V.length)],m=[1e7]+-1e3+-4e3+-8e3+-1e11,x=()=>m.replace(/[018]/g,V=>(V^L()&15>>V/4).toString(16))},"../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/set.js":(Wt,kt,J)=>{"use strict";J.d(kt,{Ue:()=>pt});const pt=()=>new Set,at=N=>Array.from(N),ut=N=>N.values().next().value||void 0,L=N=>new Set(N)},"../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/storage.js":(Wt,kt,J)=>{"use strict";J.d(kt,{F:()=>y,XN:()=>L,z2:()=>N});class pt{constructor(){this.map=new Map}setItem(x,V){this.map.set(x,V)}getItem(x){return this.map.get(x)}}let at=new pt,ut=!0;try{typeof localStorage!="undefined"&&(at=localStorage,ut=!1)}catch(m){}const L=at,N=m=>ut||addEventListener("storage",m),y=m=>ut||removeEventListener("storage",m)},"../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/string.js":(Wt,kt,J)=>{"use strict";J.d(kt,{CO:()=>R,IK:()=>pt,NF:()=>x,YZ:()=>_,lz:()=>d});const pt=String.fromCharCode,at=String.fromCodePoint,ut=pt(65535),L=g=>g.toLowerCase(),N=/^\s*/g,y=g=>g.replace(N,""),m=/([A-Z])/g,x=(g,E)=>y(g.replace(m,v=>`${E}${L(v)}`)),V=g=>unescape(encodeURIComponent(g)).length,u=g=>{const E=unescape(encodeURIComponent(g)),v=E.length,A=new Uint8Array(v);for(let Y=0;Y<v;Y++)A[Y]=E.codePointAt(Y);return A},_=typeof TextEncoder!="undefined"?new TextEncoder:null,d=_?g=>_.encode(g):u,T=g=>{let E=g.length,v="",A=0;for(;E>0;){const Y=E<1e4?E:1e4,O=g.subarray(A,A+Y);A+=Y,v+=String.fromCodePoint.apply(null,O),E-=Y}return decodeURIComponent(escape(v))};let R=typeof TextDecoder=="undefined"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});R&&R.decode(new Uint8Array).length===1&&(R=null);const S=g=>R.decode(g),M=null,a=(g,E,v,A="")=>g.slice(0,E)+A+g.slice(E+v),b=(g,E)=>array.unfold(E,()=>g).join("")},"../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/time.js":(Wt,kt,J)=>{"use strict";J.d(kt,{ZG:()=>at});const pt=()=>new Date,at=Date.now,ut=L=>{if(L<6e4){const V=metric.prefix(L,-1);return math.round(V.n*100)/100+V.prefix+"s"}L=math.floor(L/1e3);const N=L%60,y=math.floor(L/60)%60,m=math.floor(L/3600)%24,x=math.floor(L/86400);return x>0?x+"d"+(m>0||y>30?" "+(y>30?m+1:m)+"h":""):m>0?m+"h"+(y>0||N>30?" "+(N>30?y+1:y)+"min":""):y+"min"+(N>0?" "+N+"s":"")}},"../../../node_modules/.pnpm/simple-peer@9.11.1/node_modules/simple-peer/simplepeer.min.js":(Wt,kt,J)=>{(function(pt){if(!0)Wt.exports=pt();else var at})(function(){var pt=Math.floor,at=Math.abs,ut=Math.pow;return function(){function L(N,y,m){function x(_,h){if(!y[_]){if(!N[_]){var d=void 0;if(!h&&d)return require(_,!0);if(V)return V(_,!0);var T=new Error("Cannot find module '"+_+"'");throw T.code="MODULE_NOT_FOUND",T}var R=y[_]={exports:{}};N[_][0].call(R.exports,function(S){var M=N[_][1][S];return x(M||S)},R,R.exports,L,N,y,m)}return y[_].exports}for(var V=void 0,u=0;u<m.length;u++)x(m[u]);return x}return L}()({1:[function(L,N,y){"use strict";function m(b){var g=b.length;if(0<g%4)throw new Error("Invalid string. Length must be a multiple of 4");var E=b.indexOf("=");E===-1&&(E=g);var v=E===g?0:4-E%4;return[E,v]}function x(b,g,E){return 3*(g+E)/4-E}function V(b){var g,E,v=m(b),A=v[0],Y=v[1],O=new R(x(b,A,Y)),j=0,q=0<Y?A-4:A;for(E=0;E<q;E+=4)g=T[b.charCodeAt(E)]<<18|T[b.charCodeAt(E+1)]<<12|T[b.charCodeAt(E+2)]<<6|T[b.charCodeAt(E+3)],O[j++]=255&g>>16,O[j++]=255&g>>8,O[j++]=255&g;return Y===2&&(g=T[b.charCodeAt(E)]<<2|T[b.charCodeAt(E+1)]>>4,O[j++]=255&g),Y===1&&(g=T[b.charCodeAt(E)]<<10|T[b.charCodeAt(E+1)]<<4|T[b.charCodeAt(E+2)]>>2,O[j++]=255&g>>8,O[j++]=255&g),O}function u(b){return d[63&b>>18]+d[63&b>>12]+d[63&b>>6]+d[63&b]}function _(b,g,E){for(var v,A=[],Y=g;Y<E;Y+=3)v=(16711680&b[Y]<<16)+(65280&b[Y+1]<<8)+(255&b[Y+2]),A.push(u(v));return A.join("")}function h(b){for(var g,E=b.length,v=E%3,A=[],Y=16383,O=0,j=E-v;O<j;O+=Y)A.push(_(b,O,O+Y>j?j:O+Y));return v===1?(g=b[E-1],A.push(d[g>>2]+d[63&g<<4]+"==")):v===2&&(g=(b[E-2]<<8)+b[E-1],A.push(d[g>>10]+d[63&g>>4]+d[63&g<<2]+"=")),A.join("")}y.byteLength=function(b){var g=m(b),E=g[0],v=g[1];return 3*(E+v)/4-v},y.toByteArray=V,y.fromByteArray=h;for(var d=[],T=[],R=typeof Uint8Array=="undefined"?Array:Uint8Array,S="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",M=0,a=S.length;M<a;++M)d[M]=S[M],T[S.charCodeAt(M)]=M;T[45]=62,T[95]=63},{}],2:[function(){},{}],3:[function(L,N,y){(function(){(function(){/*!
* The buffer module from node.js, for the browser.
*
* @author   Feross Aboukhadijeh <https://feross.org>
* @license  MIT
*/"use strict";var m=String.fromCharCode,x=Math.min;function V(n){if(2147483647<n)throw new RangeError('The value "'+n+'" is invalid for option "size"');var r=new Uint8Array(n);return r.__proto__=u.prototype,r}function u(n,r,c){if(typeof n=="number"){if(typeof r=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return T(n)}return _(n,r,c)}function _(n,r,c){if(typeof n=="string")return R(n,r);if(ArrayBuffer.isView(n))return S(n);if(n==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof n);if(I(n,ArrayBuffer)||n&&I(n.buffer,ArrayBuffer))return M(n,r,c);if(typeof n=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var k=n.valueOf&&n.valueOf();if(k!=null&&k!==n)return u.from(k,r,c);var K=a(n);if(K)return K;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof n[Symbol.toPrimitive]=="function")return u.from(n[Symbol.toPrimitive]("string"),r,c);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof n)}function h(n){if(typeof n!="number")throw new TypeError('"size" argument must be of type number');if(0>n)throw new RangeError('The value "'+n+'" is invalid for option "size"')}function d(n,r,c){return h(n),0>=n||r===void 0?V(n):typeof c=="string"?V(n).fill(r,c):V(n).fill(r)}function T(n){return h(n),V(0>n?0:0|b(n))}function R(n,r){if((typeof r!="string"||r==="")&&(r="utf8"),!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r);var c=0|g(n,r),k=V(c),K=k.write(n,r);return K!==c&&(k=k.slice(0,K)),k}function S(n){for(var r=0>n.length?0:0|b(n.length),c=V(r),k=0;k<r;k+=1)c[k]=255&n[k];return c}function M(n,r,c){if(0>r||n.byteLength<r)throw new RangeError('"offset" is outside of buffer bounds');if(n.byteLength<r+(c||0))throw new RangeError('"length" is outside of buffer bounds');var k;return k=r===void 0&&c===void 0?new Uint8Array(n):c===void 0?new Uint8Array(n,r):new Uint8Array(n,r,c),k.__proto__=u.prototype,k}function a(n){if(u.isBuffer(n)){var r=0|b(n.length),c=V(r);return c.length===0||n.copy(c,0,0,r),c}return n.length===void 0?n.type==="Buffer"&&Array.isArray(n.data)?S(n.data):void 0:typeof n.length!="number"||G(n.length)?V(0):S(n)}function b(n){if(n>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|n}function g(n,r){if(u.isBuffer(n))return n.length;if(ArrayBuffer.isView(n)||I(n,ArrayBuffer))return n.byteLength;if(typeof n!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof n);var c=n.length,k=2<arguments.length&&arguments[2]===!0;if(!k&&c===0)return 0;for(var K=!1;;)switch(r){case"ascii":case"latin1":case"binary":return c;case"utf8":case"utf-8":return Ft(n).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*c;case"hex":return c>>>1;case"base64":return W(n).length;default:if(K)return k?-1:Ft(n).length;r=(""+r).toLowerCase(),K=!0}}function E(n,r,c){var k=!1;if((r===void 0||0>r)&&(r=0),r>this.length||((c===void 0||c>this.length)&&(c=this.length),0>=c)||(c>>>=0,r>>>=0,c<=r))return"";for(n||(n="utf8");;)switch(n){case"hex":return $t(this,r,c);case"utf8":case"utf-8":return At(this,r,c);case"ascii":return wt(this,r,c);case"latin1":case"binary":return Jt(this,r,c);case"base64":return Tt(this,r,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return st(this,r,c);default:if(k)throw new TypeError("Unknown encoding: "+n);n=(n+"").toLowerCase(),k=!0}}function v(n,r,c){var k=n[r];n[r]=n[c],n[c]=k}function A(n,r,c,k,K){if(n.length===0)return-1;if(typeof c=="string"?(k=c,c=0):2147483647<c?c=2147483647:-2147483648>c&&(c=-2147483648),c=+c,G(c)&&(c=K?0:n.length-1),0>c&&(c=n.length+c),c>=n.length){if(K)return-1;c=n.length-1}else if(0>c)if(K)c=0;else return-1;if(typeof r=="string"&&(r=u.from(r,k)),u.isBuffer(r))return r.length===0?-1:Y(n,r,c,k,K);if(typeof r=="number")return r&=255,typeof Uint8Array.prototype.indexOf=="function"?K?Uint8Array.prototype.indexOf.call(n,r,c):Uint8Array.prototype.lastIndexOf.call(n,r,c):Y(n,[r],c,k,K);throw new TypeError("val must be string, number or Buffer")}function Y(n,r,c,k,K){function z(X,nt){return ct===1?X[nt]:X.readUInt16BE(nt*ct)}var ct=1,Ct=n.length,Bt=r.length;if(k!==void 0&&(k=(k+"").toLowerCase(),k==="ucs2"||k==="ucs-2"||k==="utf16le"||k==="utf-16le")){if(2>n.length||2>r.length)return-1;ct=2,Ct/=2,Bt/=2,c/=2}var Ot;if(K){var Dt=-1;for(Ot=c;Ot<Ct;Ot++)if(z(n,Ot)!==z(r,Dt===-1?0:Ot-Dt))Dt!==-1&&(Ot-=Ot-Dt),Dt=-1;else if(Dt===-1&&(Dt=Ot),Ot-Dt+1===Bt)return Dt*ct}else for(c+Bt>Ct&&(c=Ct-Bt),Ot=c;0<=Ot;Ot--){for(var Lt=!0,ie=0;ie<Bt;ie++)if(z(n,Ot+ie)!==z(r,ie)){Lt=!1;break}if(Lt)return Ot}return-1}function O(n,r,c,k){c=+c||0;var K=n.length-c;k?(k=+k,k>K&&(k=K)):k=K;var z=r.length;k>z/2&&(k=z/2);for(var ct,Ct=0;Ct<k;++Ct){if(ct=parseInt(r.substr(2*Ct,2),16),G(ct))return Ct;n[c+Ct]=ct}return Ct}function j(n,r,c,k){return ot(Ft(r,n.length-c),n,c,k)}function q(n,r,c,k){return ot(ee(r),n,c,k)}function it(n,r,c,k){return q(n,r,c,k)}function bt(n,r,c,k){return ot(W(r),n,c,k)}function Et(n,r,c,k){return ot(te(r,n.length-c),n,c,k)}function Tt(n,r,c){return r===0&&c===n.length?C.fromByteArray(n):C.fromByteArray(n.slice(r,c))}function At(n,r,c){c=x(n.length,c);for(var k=[],K=r;K<c;){var z=n[K],ct=null,Ct=239<z?4:223<z?3:191<z?2:1;if(K+Ct<=c){var Bt,Ot,Dt,Lt;Ct===1?128>z&&(ct=z):Ct===2?(Bt=n[K+1],(192&Bt)==128&&(Lt=(31&z)<<6|63&Bt,127<Lt&&(ct=Lt))):Ct===3?(Bt=n[K+1],Ot=n[K+2],(192&Bt)==128&&(192&Ot)==128&&(Lt=(15&z)<<12|(63&Bt)<<6|63&Ot,2047<Lt&&(55296>Lt||57343<Lt)&&(ct=Lt))):Ct===4&&(Bt=n[K+1],Ot=n[K+2],Dt=n[K+3],(192&Bt)==128&&(192&Ot)==128&&(192&Dt)==128&&(Lt=(15&z)<<18|(63&Bt)<<12|(63&Ot)<<6|63&Dt,65535<Lt&&1114112>Lt&&(ct=Lt)))}ct===null?(ct=65533,Ct=1):65535<ct&&(ct-=65536,k.push(55296|1023&ct>>>10),ct=56320|1023&ct),k.push(ct),K+=Ct}return Ut(k)}function Ut(n){var r=n.length;if(r<=4096)return m.apply(String,n);for(var c="",k=0;k<r;)c+=m.apply(String,n.slice(k,k+=4096));return c}function wt(n,r,c){var k="";c=x(n.length,c);for(var K=r;K<c;++K)k+=m(127&n[K]);return k}function Jt(n,r,c){var k="";c=x(n.length,c);for(var K=r;K<c;++K)k+=m(n[K]);return k}function $t(n,r,c){var k=n.length;(!r||0>r)&&(r=0),(!c||0>c||c>k)&&(c=k);for(var K="",z=r;z<c;++z)K+=Xt(n[z]);return K}function st(n,r,c){for(var k=n.slice(r,c),K="",z=0;z<k.length;z+=2)K+=m(k[z]+256*k[z+1]);return K}function et(n,r,c){if(n%1!=0||0>n)throw new RangeError("offset is not uint");if(n+r>c)throw new RangeError("Trying to access beyond buffer length")}function lt(n,r,c,k,K,z){if(!u.isBuffer(n))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>K||r<z)throw new RangeError('"value" argument is out of bounds');if(c+k>n.length)throw new RangeError("Index out of range")}function yt(n,r,c,k){if(c+k>n.length)throw new RangeError("Index out of range");if(0>c)throw new RangeError("Index out of range")}function _t(n,r,c,k,K){return r=+r,c>>>=0,K||yt(n,r,c,4,34028234663852886e22,-34028234663852886e22),U.write(n,r,c,k,23,4),c+4}function Rt(n,r,c,k,K){return r=+r,c>>>=0,K||yt(n,r,c,8,17976931348623157e292,-17976931348623157e292),U.write(n,r,c,k,52,8),c+8}function xt(n){if(n=n.split("=")[0],n=n.trim().replace(rt,""),2>n.length)return"";for(;n.length%4!=0;)n+="=";return n}function Xt(n){return 16>n?"0"+n.toString(16):n.toString(16)}function Ft(n,r){r=r||1/0;for(var c,k=n.length,K=null,z=[],ct=0;ct<k;++ct){if(c=n.charCodeAt(ct),55295<c&&57344>c){if(!K){if(56319<c){-1<(r-=3)&&z.push(239,191,189);continue}else if(ct+1===k){-1<(r-=3)&&z.push(239,191,189);continue}K=c;continue}if(56320>c){-1<(r-=3)&&z.push(239,191,189),K=c;continue}c=(K-55296<<10|c-56320)+65536}else K&&-1<(r-=3)&&z.push(239,191,189);if(K=null,128>c){if(0>(r-=1))break;z.push(c)}else if(2048>c){if(0>(r-=2))break;z.push(192|c>>6,128|63&c)}else if(65536>c){if(0>(r-=3))break;z.push(224|c>>12,128|63&c>>6,128|63&c)}else if(1114112>c){if(0>(r-=4))break;z.push(240|c>>18,128|63&c>>12,128|63&c>>6,128|63&c)}else throw new Error("Invalid code point")}return z}function ee(n){for(var r=[],c=0;c<n.length;++c)r.push(255&n.charCodeAt(c));return r}function te(n,r){for(var c,k,K,z=[],ct=0;ct<n.length&&!(0>(r-=2));++ct)c=n.charCodeAt(ct),k=c>>8,K=c%256,z.push(K),z.push(k);return z}function W(n){return C.toByteArray(xt(n))}function ot(n,r,c,k){for(var K=0;K<k&&!(K+c>=r.length||K>=n.length);++K)r[K+c]=n[K];return K}function I(n,r){return n instanceof r||n!=null&&n.constructor!=null&&n.constructor.name!=null&&n.constructor.name===r.name}function G(n){return n!==n}var C=L("base64-js"),U=L("ieee754");y.Buffer=u,y.SlowBuffer=function(n){return+n!=n&&(n=0),u.alloc(+n)},y.INSPECT_MAX_BYTES=50,y.kMaxLength=2147483647,u.TYPED_ARRAY_SUPPORT=function(){try{var n=new Uint8Array(1);return n.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},n.foo()===42}catch(r){return!1}}(),u.TYPED_ARRAY_SUPPORT||typeof console=="undefined"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){return u.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){return u.isBuffer(this)?this.byteOffset:void 0}}),typeof Symbol!="undefined"&&Symbol.species!=null&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),u.poolSize=8192,u.from=function(n,r,c){return _(n,r,c)},u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,u.alloc=function(n,r,c){return d(n,r,c)},u.allocUnsafe=function(n){return T(n)},u.allocUnsafeSlow=function(n){return T(n)},u.isBuffer=function(n){return n!=null&&n._isBuffer===!0&&n!==u.prototype},u.compare=function(n,r){if(I(n,Uint8Array)&&(n=u.from(n,n.offset,n.byteLength)),I(r,Uint8Array)&&(r=u.from(r,r.offset,r.byteLength)),!u.isBuffer(n)||!u.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(n===r)return 0;for(var c=n.length,k=r.length,K=0,z=x(c,k);K<z;++K)if(n[K]!==r[K]){c=n[K],k=r[K];break}return c<k?-1:k<c?1:0},u.isEncoding=function(n){switch((n+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(n,r){if(!Array.isArray(n))throw new TypeError('"list" argument must be an Array of Buffers');if(n.length===0)return u.alloc(0);var c;if(r===void 0)for(r=0,c=0;c<n.length;++c)r+=n[c].length;var k=u.allocUnsafe(r),K=0;for(c=0;c<n.length;++c){var z=n[c];if(I(z,Uint8Array)&&(z=u.from(z)),!u.isBuffer(z))throw new TypeError('"list" argument must be an Array of Buffers');z.copy(k,K),K+=z.length}return k},u.byteLength=g,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var n=this.length;if(n%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<n;r+=2)v(this,r,r+1);return this},u.prototype.swap32=function(){var n=this.length;if(n%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<n;r+=4)v(this,r,r+3),v(this,r+1,r+2);return this},u.prototype.swap64=function(){var n=this.length;if(n%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<n;r+=8)v(this,r,r+7),v(this,r+1,r+6),v(this,r+2,r+5),v(this,r+3,r+4);return this},u.prototype.toString=function(){var n=this.length;return n===0?"":arguments.length===0?At(this,0,n):E.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(n){if(!u.isBuffer(n))throw new TypeError("Argument must be a Buffer");return this===n||u.compare(this,n)===0},u.prototype.inspect=function(){var n="",r=y.INSPECT_MAX_BYTES;return n=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(n+=" ... "),"<Buffer "+n+">"},u.prototype.compare=function(n,r,c,k,K){if(I(n,Uint8Array)&&(n=u.from(n,n.offset,n.byteLength)),!u.isBuffer(n))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof n);if(r===void 0&&(r=0),c===void 0&&(c=n?n.length:0),k===void 0&&(k=0),K===void 0&&(K=this.length),0>r||c>n.length||0>k||K>this.length)throw new RangeError("out of range index");if(k>=K&&r>=c)return 0;if(k>=K)return-1;if(r>=c)return 1;if(r>>>=0,c>>>=0,k>>>=0,K>>>=0,this===n)return 0;for(var z=K-k,ct=c-r,Ct=x(z,ct),Bt=this.slice(k,K),Ot=n.slice(r,c),Dt=0;Dt<Ct;++Dt)if(Bt[Dt]!==Ot[Dt]){z=Bt[Dt],ct=Ot[Dt];break}return z<ct?-1:ct<z?1:0},u.prototype.includes=function(n,r,c){return this.indexOf(n,r,c)!==-1},u.prototype.indexOf=function(n,r,c){return A(this,n,r,c,!0)},u.prototype.lastIndexOf=function(n,r,c){return A(this,n,r,c,!1)},u.prototype.write=function(n,r,c,k){if(r===void 0)k="utf8",c=this.length,r=0;else if(c===void 0&&typeof r=="string")k=r,c=this.length,r=0;else if(isFinite(r))r>>>=0,isFinite(c)?(c>>>=0,k===void 0&&(k="utf8")):(k=c,c=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var K=this.length-r;if((c===void 0||c>K)&&(c=K),0<n.length&&(0>c||0>r)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");k||(k="utf8");for(var z=!1;;)switch(k){case"hex":return O(this,n,r,c);case"utf8":case"utf-8":return j(this,n,r,c);case"ascii":return q(this,n,r,c);case"latin1":case"binary":return it(this,n,r,c);case"base64":return bt(this,n,r,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Et(this,n,r,c);default:if(z)throw new TypeError("Unknown encoding: "+k);k=(""+k).toLowerCase(),z=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},u.prototype.slice=function(n,r){var c=this.length;n=~~n,r=r===void 0?c:~~r,0>n?(n+=c,0>n&&(n=0)):n>c&&(n=c),0>r?(r+=c,0>r&&(r=0)):r>c&&(r=c),r<n&&(r=n);var k=this.subarray(n,r);return k.__proto__=u.prototype,k},u.prototype.readUIntLE=function(n,r,c){n>>>=0,r>>>=0,c||et(n,r,this.length);for(var k=this[n],K=1,z=0;++z<r&&(K*=256);)k+=this[n+z]*K;return k},u.prototype.readUIntBE=function(n,r,c){n>>>=0,r>>>=0,c||et(n,r,this.length);for(var k=this[n+--r],K=1;0<r&&(K*=256);)k+=this[n+--r]*K;return k},u.prototype.readUInt8=function(n,r){return n>>>=0,r||et(n,1,this.length),this[n]},u.prototype.readUInt16LE=function(n,r){return n>>>=0,r||et(n,2,this.length),this[n]|this[n+1]<<8},u.prototype.readUInt16BE=function(n,r){return n>>>=0,r||et(n,2,this.length),this[n]<<8|this[n+1]},u.prototype.readUInt32LE=function(n,r){return n>>>=0,r||et(n,4,this.length),(this[n]|this[n+1]<<8|this[n+2]<<16)+16777216*this[n+3]},u.prototype.readUInt32BE=function(n,r){return n>>>=0,r||et(n,4,this.length),16777216*this[n]+(this[n+1]<<16|this[n+2]<<8|this[n+3])},u.prototype.readIntLE=function(n,r,c){n>>>=0,r>>>=0,c||et(n,r,this.length);for(var k=this[n],K=1,z=0;++z<r&&(K*=256);)k+=this[n+z]*K;return K*=128,k>=K&&(k-=ut(2,8*r)),k},u.prototype.readIntBE=function(n,r,c){n>>>=0,r>>>=0,c||et(n,r,this.length);for(var k=r,K=1,z=this[n+--k];0<k&&(K*=256);)z+=this[n+--k]*K;return K*=128,z>=K&&(z-=ut(2,8*r)),z},u.prototype.readInt8=function(n,r){return n>>>=0,r||et(n,1,this.length),128&this[n]?-1*(255-this[n]+1):this[n]},u.prototype.readInt16LE=function(n,r){n>>>=0,r||et(n,2,this.length);var c=this[n]|this[n+1]<<8;return 32768&c?4294901760|c:c},u.prototype.readInt16BE=function(n,r){n>>>=0,r||et(n,2,this.length);var c=this[n+1]|this[n]<<8;return 32768&c?4294901760|c:c},u.prototype.readInt32LE=function(n,r){return n>>>=0,r||et(n,4,this.length),this[n]|this[n+1]<<8|this[n+2]<<16|this[n+3]<<24},u.prototype.readInt32BE=function(n,r){return n>>>=0,r||et(n,4,this.length),this[n]<<24|this[n+1]<<16|this[n+2]<<8|this[n+3]},u.prototype.readFloatLE=function(n,r){return n>>>=0,r||et(n,4,this.length),U.read(this,n,!0,23,4)},u.prototype.readFloatBE=function(n,r){return n>>>=0,r||et(n,4,this.length),U.read(this,n,!1,23,4)},u.prototype.readDoubleLE=function(n,r){return n>>>=0,r||et(n,8,this.length),U.read(this,n,!0,52,8)},u.prototype.readDoubleBE=function(n,r){return n>>>=0,r||et(n,8,this.length),U.read(this,n,!1,52,8)},u.prototype.writeUIntLE=function(n,r,c,k){if(n=+n,r>>>=0,c>>>=0,!k){var K=ut(2,8*c)-1;lt(this,n,r,c,K,0)}var z=1,ct=0;for(this[r]=255&n;++ct<c&&(z*=256);)this[r+ct]=255&n/z;return r+c},u.prototype.writeUIntBE=function(n,r,c,k){if(n=+n,r>>>=0,c>>>=0,!k){var K=ut(2,8*c)-1;lt(this,n,r,c,K,0)}var z=c-1,ct=1;for(this[r+z]=255&n;0<=--z&&(ct*=256);)this[r+z]=255&n/ct;return r+c},u.prototype.writeUInt8=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,1,255,0),this[r]=255&n,r+1},u.prototype.writeUInt16LE=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,2,65535,0),this[r]=255&n,this[r+1]=n>>>8,r+2},u.prototype.writeUInt16BE=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,2,65535,0),this[r]=n>>>8,this[r+1]=255&n,r+2},u.prototype.writeUInt32LE=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,4,4294967295,0),this[r+3]=n>>>24,this[r+2]=n>>>16,this[r+1]=n>>>8,this[r]=255&n,r+4},u.prototype.writeUInt32BE=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,4,4294967295,0),this[r]=n>>>24,this[r+1]=n>>>16,this[r+2]=n>>>8,this[r+3]=255&n,r+4},u.prototype.writeIntLE=function(n,r,c,k){if(n=+n,r>>>=0,!k){var K=ut(2,8*c-1);lt(this,n,r,c,K-1,-K)}var z=0,ct=1,Ct=0;for(this[r]=255&n;++z<c&&(ct*=256);)0>n&&Ct===0&&this[r+z-1]!==0&&(Ct=1),this[r+z]=255&(n/ct>>0)-Ct;return r+c},u.prototype.writeIntBE=function(n,r,c,k){if(n=+n,r>>>=0,!k){var K=ut(2,8*c-1);lt(this,n,r,c,K-1,-K)}var z=c-1,ct=1,Ct=0;for(this[r+z]=255&n;0<=--z&&(ct*=256);)0>n&&Ct===0&&this[r+z+1]!==0&&(Ct=1),this[r+z]=255&(n/ct>>0)-Ct;return r+c},u.prototype.writeInt8=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,1,127,-128),0>n&&(n=255+n+1),this[r]=255&n,r+1},u.prototype.writeInt16LE=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,2,32767,-32768),this[r]=255&n,this[r+1]=n>>>8,r+2},u.prototype.writeInt16BE=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,2,32767,-32768),this[r]=n>>>8,this[r+1]=255&n,r+2},u.prototype.writeInt32LE=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,4,2147483647,-2147483648),this[r]=255&n,this[r+1]=n>>>8,this[r+2]=n>>>16,this[r+3]=n>>>24,r+4},u.prototype.writeInt32BE=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,4,2147483647,-2147483648),0>n&&(n=4294967295+n+1),this[r]=n>>>24,this[r+1]=n>>>16,this[r+2]=n>>>8,this[r+3]=255&n,r+4},u.prototype.writeFloatLE=function(n,r,c){return _t(this,n,r,!0,c)},u.prototype.writeFloatBE=function(n,r,c){return _t(this,n,r,!1,c)},u.prototype.writeDoubleLE=function(n,r,c){return Rt(this,n,r,!0,c)},u.prototype.writeDoubleBE=function(n,r,c){return Rt(this,n,r,!1,c)},u.prototype.copy=function(n,r,c,k){if(!u.isBuffer(n))throw new TypeError("argument should be a Buffer");if(c||(c=0),k||k===0||(k=this.length),r>=n.length&&(r=n.length),r||(r=0),0<k&&k<c&&(k=c),k===c||n.length===0||this.length===0)return 0;if(0>r)throw new RangeError("targetStart out of bounds");if(0>c||c>=this.length)throw new RangeError("Index out of range");if(0>k)throw new RangeError("sourceEnd out of bounds");k>this.length&&(k=this.length),n.length-r<k-c&&(k=n.length-r+c);var K=k-c;if(this===n&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(r,c,k);else if(this===n&&c<r&&r<k)for(var z=K-1;0<=z;--z)n[z+r]=this[z+c];else Uint8Array.prototype.set.call(n,this.subarray(c,k),r);return K},u.prototype.fill=function(n,r,c,k){if(typeof n=="string"){if(typeof r=="string"?(k=r,r=0,c=this.length):typeof c=="string"&&(k=c,c=this.length),k!==void 0&&typeof k!="string")throw new TypeError("encoding must be a string");if(typeof k=="string"&&!u.isEncoding(k))throw new TypeError("Unknown encoding: "+k);if(n.length===1){var K=n.charCodeAt(0);(k==="utf8"&&128>K||k==="latin1")&&(n=K)}}else typeof n=="number"&&(n&=255);if(0>r||this.length<r||this.length<c)throw new RangeError("Out of range index");if(c<=r)return this;r>>>=0,c=c===void 0?this.length:c>>>0,n||(n=0);var z;if(typeof n=="number")for(z=r;z<c;++z)this[z]=n;else{var ct=u.isBuffer(n)?n:u.from(n,k),Ct=ct.length;if(Ct===0)throw new TypeError('The value "'+n+'" is invalid for argument "value"');for(z=0;z<c-r;++z)this[z+r]=ct[z%Ct]}return this};var rt=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,L("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:9}],4:[function(L,N,y){(function(m){(function(){function x(){let u;try{u=y.storage.getItem("debug")}catch(_){}return!u&&typeof m!="undefined"&&"env"in m&&(u=m.env.DEBUG),u}y.formatArgs=function(u){if(u[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+u[0]+(this.useColors?"%c ":" ")+"+"+N.exports.humanize(this.diff),!this.useColors)return;const _="color: "+this.color;u.splice(1,0,_,"color: inherit");let h=0,d=0;u[0].replace(/%[a-zA-Z%]/g,T=>{T==="%%"||(h++,T==="%c"&&(d=h))}),u.splice(d,0,_)},y.save=function(u){try{u?y.storage.setItem("debug",u):y.storage.removeItem("debug")}catch(_){}},y.load=x,y.useColors=function(){return!!(typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))||!(typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},y.storage=function(){try{return localStorage}catch(u){}}(),y.destroy=(()=>{let u=!1;return()=>{u||(u=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),y.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],y.log=console.debug||console.log||(()=>{}),N.exports=L("./common")(y);const{formatters:V}=N.exports;V.j=function(u){try{return JSON.stringify(u)}catch(_){return"[UnexpectedJSONParseError]: "+_.message}}}).call(this)}).call(this,L("_process"))},{"./common":5,_process:12}],5:[function(L,N){N.exports=function(y){function m(u){function _(...T){if(!_.enabled)return;const R=_,S=+new Date,M=S-(h||S);R.diff=M,R.prev=h,R.curr=S,h=S,T[0]=m.coerce(T[0]),typeof T[0]!="string"&&T.unshift("%O");let a=0;T[0]=T[0].replace(/%([a-zA-Z%])/g,(g,E)=>{if(g==="%%")return"%";a++;const v=m.formatters[E];if(typeof v=="function"){const A=T[a];g=v.call(R,A),T.splice(a,1),a--}return g}),m.formatArgs.call(R,T),(R.log||m.log).apply(R,T)}let h,d=null;return _.namespace=u,_.useColors=m.useColors(),_.color=m.selectColor(u),_.extend=x,_.destroy=m.destroy,Object.defineProperty(_,"enabled",{enumerable:!0,configurable:!1,get:()=>d===null?m.enabled(u):d,set:T=>{d=T}}),typeof m.init=="function"&&m.init(_),_}function x(u,_){const h=m(this.namespace+(typeof _=="undefined"?":":_)+u);return h.log=this.log,h}function V(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}return m.debug=m,m.default=m,m.coerce=function(u){return u instanceof Error?u.stack||u.message:u},m.disable=function(){const u=[...m.names.map(V),...m.skips.map(V).map(_=>"-"+_)].join(",");return m.enable(""),u},m.enable=function(u){m.save(u),m.names=[],m.skips=[];let _;const h=(typeof u=="string"?u:"").split(/[\s,]+/),d=h.length;for(_=0;_<d;_++)h[_]&&(u=h[_].replace(/\*/g,".*?"),u[0]==="-"?m.skips.push(new RegExp("^"+u.substr(1)+"$")):m.names.push(new RegExp("^"+u+"$")))},m.enabled=function(u){if(u[u.length-1]==="*")return!0;let _,h;for(_=0,h=m.skips.length;_<h;_++)if(m.skips[_].test(u))return!1;for(_=0,h=m.names.length;_<h;_++)if(m.names[_].test(u))return!0;return!1},m.humanize=L("ms"),m.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(y).forEach(u=>{m[u]=y[u]}),m.names=[],m.skips=[],m.formatters={},m.selectColor=function(u){let _=0;for(let h=0;h<u.length;h++)_=(_<<5)-_+u.charCodeAt(h),_|=0;return m.colors[at(_)%m.colors.length]},m.enable(m.load()),m}},{ms:11}],6:[function(L,N){"use strict";function y(m,x){for(const V in x)Object.defineProperty(m,V,{value:x[V],enumerable:!0,configurable:!0});return m}N.exports=function(m,x,V){if(!m||typeof m=="string")throw new TypeError("Please pass an Error to err-code");V||(V={}),typeof x=="object"&&(V=x,x=""),x&&(V.code=x);try{return y(m,V)}catch(u){V.message=m.message,V.stack=m.stack;const _=function(){};return _.prototype=Object.create(Object.getPrototypeOf(m)),y(new _,V)}}},{}],7:[function(L,N){"use strict";function y(O){console&&console.warn&&console.warn(O)}function m(){m.init.call(this)}function x(O){if(typeof O!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof O)}function V(O){return O._maxListeners===void 0?m.defaultMaxListeners:O._maxListeners}function u(O,j,q,it){var bt,Et,Tt;if(x(q),Et=O._events,Et===void 0?(Et=O._events=Object.create(null),O._eventsCount=0):(Et.newListener!==void 0&&(O.emit("newListener",j,q.listener?q.listener:q),Et=O._events),Tt=Et[j]),Tt===void 0)Tt=Et[j]=q,++O._eventsCount;else if(typeof Tt=="function"?Tt=Et[j]=it?[q,Tt]:[Tt,q]:it?Tt.unshift(q):Tt.push(q),bt=V(O),0<bt&&Tt.length>bt&&!Tt.warned){Tt.warned=!0;var At=new Error("Possible EventEmitter memory leak detected. "+Tt.length+" "+(j+" listeners added. Use emitter.setMaxListeners() to increase limit"));At.name="MaxListenersExceededWarning",At.emitter=O,At.type=j,At.count=Tt.length,y(At)}return O}function _(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(O,j,q){var it={fired:!1,wrapFn:void 0,target:O,type:j,listener:q},bt=_.bind(it);return bt.listener=q,it.wrapFn=bt,bt}function d(O,j,q){var it=O._events;if(it===void 0)return[];var bt=it[j];return bt===void 0?[]:typeof bt=="function"?q?[bt.listener||bt]:[bt]:q?M(bt):R(bt,bt.length)}function T(O){var j=this._events;if(j!==void 0){var q=j[O];if(typeof q=="function")return 1;if(q!==void 0)return q.length}return 0}function R(O,j){for(var q=Array(j),it=0;it<j;++it)q[it]=O[it];return q}function S(O,j){for(;j+1<O.length;j++)O[j]=O[j+1];O.pop()}function M(O){for(var j=Array(O.length),q=0;q<j.length;++q)j[q]=O[q].listener||O[q];return j}function a(O,j,q){typeof O.on=="function"&&b(O,"error",j,q)}function b(O,j,q,it){if(typeof O.on=="function")it.once?O.once(j,q):O.on(j,q);else if(typeof O.addEventListener=="function")O.addEventListener(j,function bt(Et){it.once&&O.removeEventListener(j,bt),q(Et)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof O)}var g,E=typeof Reflect=="object"?Reflect:null,v=E&&typeof E.apply=="function"?E.apply:function(O,j,q){return Function.prototype.apply.call(O,j,q)};g=E&&typeof E.ownKeys=="function"?E.ownKeys:Object.getOwnPropertySymbols?function(O){return Object.getOwnPropertyNames(O).concat(Object.getOwnPropertySymbols(O))}:function(O){return Object.getOwnPropertyNames(O)};var A=Number.isNaN||function(O){return O!==O};N.exports=m,N.exports.once=function(O,j){return new Promise(function(q,it){function bt(Tt){O.removeListener(j,Et),it(Tt)}function Et(){typeof O.removeListener=="function"&&O.removeListener("error",bt),q([].slice.call(arguments))}b(O,j,Et,{once:!0}),j!=="error"&&a(O,bt,{once:!0})})},m.EventEmitter=m,m.prototype._events=void 0,m.prototype._eventsCount=0,m.prototype._maxListeners=void 0;var Y=10;Object.defineProperty(m,"defaultMaxListeners",{enumerable:!0,get:function(){return Y},set:function(O){if(typeof O!="number"||0>O||A(O))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+O+".");Y=O}}),m.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},m.prototype.setMaxListeners=function(O){if(typeof O!="number"||0>O||A(O))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+O+".");return this._maxListeners=O,this},m.prototype.getMaxListeners=function(){return V(this)},m.prototype.emit=function(O){for(var j=[],q=1;q<arguments.length;q++)j.push(arguments[q]);var it=O==="error",bt=this._events;if(bt!==void 0)it=it&&bt.error===void 0;else if(!it)return!1;if(it){var Et;if(0<j.length&&(Et=j[0]),Et instanceof Error)throw Et;var Tt=new Error("Unhandled error."+(Et?" ("+Et.message+")":""));throw Tt.context=Et,Tt}var At=bt[O];if(At===void 0)return!1;if(typeof At=="function")v(At,this,j);else for(var Ut=At.length,wt=R(At,Ut),q=0;q<Ut;++q)v(wt[q],this,j);return!0},m.prototype.addListener=function(O,j){return u(this,O,j,!1)},m.prototype.on=m.prototype.addListener,m.prototype.prependListener=function(O,j){return u(this,O,j,!0)},m.prototype.once=function(O,j){return x(j),this.on(O,h(this,O,j)),this},m.prototype.prependOnceListener=function(O,j){return x(j),this.prependListener(O,h(this,O,j)),this},m.prototype.removeListener=function(O,j){var q,it,bt,Et,Tt;if(x(j),it=this._events,it===void 0)return this;if(q=it[O],q===void 0)return this;if(q===j||q.listener===j)--this._eventsCount==0?this._events=Object.create(null):(delete it[O],it.removeListener&&this.emit("removeListener",O,q.listener||j));else if(typeof q!="function"){for(bt=-1,Et=q.length-1;0<=Et;Et--)if(q[Et]===j||q[Et].listener===j){Tt=q[Et].listener,bt=Et;break}if(0>bt)return this;bt===0?q.shift():S(q,bt),q.length===1&&(it[O]=q[0]),it.removeListener!==void 0&&this.emit("removeListener",O,Tt||j)}return this},m.prototype.off=m.prototype.removeListener,m.prototype.removeAllListeners=function(O){var j,q,it;if(q=this._events,q===void 0)return this;if(q.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):q[O]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete q[O]),this;if(arguments.length===0){var bt,Et=Object.keys(q);for(it=0;it<Et.length;++it)bt=Et[it],bt!=="removeListener"&&this.removeAllListeners(bt);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(j=q[O],typeof j=="function")this.removeListener(O,j);else if(j!==void 0)for(it=j.length-1;0<=it;it--)this.removeListener(O,j[it]);return this},m.prototype.listeners=function(O){return d(this,O,!0)},m.prototype.rawListeners=function(O){return d(this,O,!1)},m.listenerCount=function(O,j){return typeof O.listenerCount=="function"?O.listenerCount(j):T.call(O,j)},m.prototype.listenerCount=T,m.prototype.eventNames=function(){return 0<this._eventsCount?g(this._events):[]}},{}],8:[function(L,N){N.exports=function(){if(typeof globalThis=="undefined")return null;var y={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return y.RTCPeerConnection?y:null}},{}],9:[function(L,N,y){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */y.read=function(m,x,V,u,_){var h,d,T=8*_-u-1,R=(1<<T)-1,S=R>>1,M=-7,a=V?_-1:0,b=V?-1:1,g=m[x+a];for(a+=b,h=g&(1<<-M)-1,g>>=-M,M+=T;0<M;h=256*h+m[x+a],a+=b,M-=8);for(d=h&(1<<-M)-1,h>>=-M,M+=u;0<M;d=256*d+m[x+a],a+=b,M-=8);if(h===0)h=1-S;else{if(h===R)return d?NaN:(g?-1:1)*(1/0);d+=ut(2,u),h-=S}return(g?-1:1)*d*ut(2,h-u)},y.write=function(m,x,V,u,_,h){var d,T,R,S=Math.LN2,M=Math.log,a=8*h-_-1,b=(1<<a)-1,g=b>>1,E=_===23?ut(2,-24)-ut(2,-77):0,v=u?0:h-1,A=u?1:-1,Y=0>x||x===0&&0>1/x?1:0;for(x=at(x),isNaN(x)||x===1/0?(T=isNaN(x)?1:0,d=b):(d=pt(M(x)/S),1>x*(R=ut(2,-d))&&(d--,R*=2),x+=1<=d+g?E/R:E*ut(2,1-g),2<=x*R&&(d++,R/=2),d+g>=b?(T=0,d=b):1<=d+g?(T=(x*R-1)*ut(2,_),d+=g):(T=x*ut(2,g-1)*ut(2,_),d=0));8<=_;m[V+v]=255&T,v+=A,T/=256,_-=8);for(d=d<<_|T,a+=_;0<a;m[V+v]=255&d,v+=A,d/=256,a-=8);m[V+v-A]|=128*Y}},{}],10:[function(L,N){N.exports=typeof Object.create=="function"?function(y,m){m&&(y.super_=m,y.prototype=Object.create(m.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}))}:function(y,m){if(m){y.super_=m;var x=function(){};x.prototype=m.prototype,y.prototype=new x,y.prototype.constructor=y}}},{}],11:[function(L,N){var y=Math.round;function m(h){if(h+="",!(100<h.length)){var d=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(h);if(d){var T=parseFloat(d[1]),R=(d[2]||"ms").toLowerCase();return R==="years"||R==="year"||R==="yrs"||R==="yr"||R==="y"?315576e5*T:R==="weeks"||R==="week"||R==="w"?6048e5*T:R==="days"||R==="day"||R==="d"?864e5*T:R==="hours"||R==="hour"||R==="hrs"||R==="hr"||R==="h"?36e5*T:R==="minutes"||R==="minute"||R==="mins"||R==="min"||R==="m"?6e4*T:R==="seconds"||R==="second"||R==="secs"||R==="sec"||R==="s"?1e3*T:R==="milliseconds"||R==="millisecond"||R==="msecs"||R==="msec"||R==="ms"?T:void 0}}}function x(h){var d=at(h);return 864e5<=d?y(h/864e5)+"d":36e5<=d?y(h/36e5)+"h":6e4<=d?y(h/6e4)+"m":1e3<=d?y(h/1e3)+"s":h+"ms"}function V(h){var d=at(h);return 864e5<=d?u(h,d,864e5,"day"):36e5<=d?u(h,d,36e5,"hour"):6e4<=d?u(h,d,6e4,"minute"):1e3<=d?u(h,d,1e3,"second"):h+" ms"}function u(h,d,T,R){return y(h/T)+" "+R+(d>=1.5*T?"s":"")}var _=24*(60*6e4);N.exports=function(h,d){d=d||{};var T=typeof h;if(T=="string"&&0<h.length)return m(h);if(T==="number"&&isFinite(h))return d.long?V(h):x(h);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(h))}},{}],12:[function(L,N){function y(){throw new Error("setTimeout has not been defined")}function m(){throw new Error("clearTimeout has not been defined")}function x(E){if(T===setTimeout)return setTimeout(E,0);if((T===y||!T)&&setTimeout)return T=setTimeout,setTimeout(E,0);try{return T(E,0)}catch(v){try{return T.call(null,E,0)}catch(A){return T.call(this,E,0)}}}function V(E){if(R===clearTimeout)return clearTimeout(E);if((R===m||!R)&&clearTimeout)return R=clearTimeout,clearTimeout(E);try{return R(E)}catch(v){try{return R.call(null,E)}catch(A){return R.call(this,E)}}}function u(){b&&M&&(b=!1,M.length?a=M.concat(a):g=-1,a.length&&_())}function _(){if(!b){var E=x(u);b=!0;for(var v=a.length;v;){for(M=a,a=[];++g<v;)M&&M[g].run();g=-1,v=a.length}M=null,b=!1,V(E)}}function h(E,v){this.fun=E,this.array=v}function d(){}var T,R,S=N.exports={};(function(){try{T=typeof setTimeout=="function"?setTimeout:y}catch(E){T=y}try{R=typeof clearTimeout=="function"?clearTimeout:m}catch(E){R=m}})();var M,a=[],b=!1,g=-1;S.nextTick=function(E){var v=Array(arguments.length-1);if(1<arguments.length)for(var A=1;A<arguments.length;A++)v[A-1]=arguments[A];a.push(new h(E,v)),a.length!==1||b||x(_)},h.prototype.run=function(){this.fun.apply(null,this.array)},S.title="browser",S.browser=!0,S.env={},S.argv=[],S.version="",S.versions={},S.on=d,S.addListener=d,S.once=d,S.off=d,S.removeListener=d,S.removeAllListeners=d,S.emit=d,S.prependListener=d,S.prependOnceListener=d,S.listeners=function(){return[]},S.binding=function(){throw new Error("process.binding is not supported")},S.cwd=function(){return"/"},S.chdir=function(){throw new Error("process.chdir is not supported")},S.umask=function(){return 0}},{}],13:[function(L,N){(function(y){(function(){/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let m;N.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window=="undefined"?y:window):x=>(m||(m=Promise.resolve())).then(x).catch(V=>setTimeout(()=>{throw V},0))}).call(this)}).call(this,typeof J.g=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:J.g)},{}],14:[function(L,N){(function(y,m){(function(){"use strict";var x=L("safe-buffer").Buffer,V=m.crypto||m.msCrypto;N.exports=V&&V.getRandomValues?function(u,_){if(u>4294967295)throw new RangeError("requested too many random bytes");var h=x.allocUnsafe(u);if(0<u)if(65536<u)for(var d=0;d<u;d+=65536)V.getRandomValues(h.slice(d,d+65536));else V.getRandomValues(h);return typeof _=="function"?y.nextTick(function(){_(null,h)}):h}:function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,L("_process"),typeof J.g=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:J.g)},{_process:12,"safe-buffer":30}],15:[function(L,N){"use strict";function y(d,T){d.prototype=Object.create(T.prototype),d.prototype.constructor=d,d.__proto__=T}function m(d,T,R){function S(a,b,g){return typeof T=="string"?T:T(a,b,g)}R||(R=Error);var M=function(a){function b(g,E,v){return a.call(this,S(g,E,v))||this}return y(b,a),b}(R);M.prototype.name=R.name,M.prototype.code=d,h[d]=M}function x(d,T){if(Array.isArray(d)){var R=d.length;return d=d.map(function(S){return S+""}),2<R?"one of ".concat(T," ").concat(d.slice(0,R-1).join(", "),", or ")+d[R-1]:R===2?"one of ".concat(T," ").concat(d[0]," or ").concat(d[1]):"of ".concat(T," ").concat(d[0])}return"of ".concat(T," ").concat(d+"")}function V(d,T,R){return d.substr(!R||0>R?0:+R,T.length)===T}function u(d,T,R){return(R===void 0||R>d.length)&&(R=d.length),d.substring(R-T.length,R)===T}function _(d,T,R){return typeof R!="number"&&(R=0),!(R+T.length>d.length)&&d.indexOf(T,R)!==-1}var h={};m("ERR_INVALID_OPT_VALUE",function(d,T){return'The value "'+T+'" is invalid for option "'+d+'"'},TypeError),m("ERR_INVALID_ARG_TYPE",function(d,T,R){var S;typeof T=="string"&&V(T,"not ")?(S="must not be",T=T.replace(/^not /,"")):S="must be";var M;if(u(d," argument"))M="The ".concat(d," ").concat(S," ").concat(x(T,"type"));else{var a=_(d,".")?"property":"argument";M='The "'.concat(d,'" ').concat(a," ").concat(S," ").concat(x(T,"type"))}return M+=". Received type ".concat(typeof R),M},TypeError),m("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),m("ERR_METHOD_NOT_IMPLEMENTED",function(d){return"The "+d+" method is not implemented"}),m("ERR_STREAM_PREMATURE_CLOSE","Premature close"),m("ERR_STREAM_DESTROYED",function(d){return"Cannot call "+d+" after a stream was destroyed"}),m("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),m("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),m("ERR_STREAM_WRITE_AFTER_END","write after end"),m("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),m("ERR_UNKNOWN_ENCODING",function(d){return"Unknown encoding: "+d},TypeError),m("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),N.exports.codes=h},{}],16:[function(L,N){(function(y){(function(){"use strict";function m(S){return this instanceof m?(_.call(this,S),h.call(this,S),this.allowHalfOpen=!0,void(S&&(S.readable===!1&&(this.readable=!1),S.writable===!1&&(this.writable=!1),S.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",x))))):new m(S)}function x(){this._writableState.ended||y.nextTick(V,this)}function V(S){S.end()}var u=Object.keys||function(S){var M=[];for(var a in S)M.push(a);return M};N.exports=m;var _=L("./_stream_readable"),h=L("./_stream_writable");L("inherits")(m,_);for(var d,T=u(h.prototype),R=0;R<T.length;R++)d=T[R],m.prototype[d]||(m.prototype[d]=h.prototype[d]);Object.defineProperty(m.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(m.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(m.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(m.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(S){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=S,this._writableState.destroyed=S)}})}).call(this)}).call(this,L("_process"))},{"./_stream_readable":18,"./_stream_writable":20,_process:12,inherits:10}],17:[function(L,N){"use strict";function y(x){return this instanceof y?void m.call(this,x):new y(x)}N.exports=y;var m=L("./_stream_transform");L("inherits")(y,m),y.prototype._transform=function(x,V,u){u(null,x)}},{"./_stream_transform":19,inherits:10}],18:[function(L,N){(function(y,m){(function(){"use strict";function x(n){return et.from(n)}function V(n){return et.isBuffer(n)||n instanceof lt}function u(n,r,c){return typeof n.prependListener=="function"?n.prependListener(r,c):void(n._events&&n._events[r]?Array.isArray(n._events[r])?n._events[r].unshift(c):n._events[r]=[c,n._events[r]]:n.on(r,c))}function _(n,r,c){Ut=Ut||L("./_stream_duplex"),n=n||{},typeof c!="boolean"&&(c=r instanceof Ut),this.objectMode=!!n.objectMode,c&&(this.objectMode=this.objectMode||!!n.readableObjectMode),this.highWaterMark=te(this,n,"readableHighWaterMark",c),this.buffer=new Xt,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=n.emitClose!==!1,this.autoDestroy=!!n.autoDestroy,this.destroyed=!1,this.defaultEncoding=n.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,n.encoding&&(!_t&&(_t=L("string_decoder/").StringDecoder),this.decoder=new _t(n.encoding),this.encoding=n.encoding)}function h(n){if(Ut=Ut||L("./_stream_duplex"),!(this instanceof h))return new h(n);var r=this instanceof Ut;this._readableState=new _(n,this,r),this.readable=!0,n&&(typeof n.read=="function"&&(this._read=n.read),typeof n.destroy=="function"&&(this._destroy=n.destroy)),st.call(this)}function d(n,r,c,k,K){wt("readableAddChunk",r);var z=n._readableState;if(r===null)z.reading=!1,a(n,z);else{var ct;if(K||(ct=R(z,r)),ct)U(n,ct);else if(!(z.objectMode||r&&0<r.length))k||(z.reading=!1,E(n,z));else if(typeof r=="string"||z.objectMode||Object.getPrototypeOf(r)===et.prototype||(r=x(r)),k)z.endEmitted?U(n,new C):T(n,z,r,!0);else if(z.ended)U(n,new I);else{if(z.destroyed)return!1;z.reading=!1,z.decoder&&!c?(r=z.decoder.write(r),z.objectMode||r.length!==0?T(n,z,r,!1):E(n,z)):T(n,z,r,!1)}}return!z.ended&&(z.length<z.highWaterMark||z.length===0)}function T(n,r,c,k){r.flowing&&r.length===0&&!r.sync?(r.awaitDrain=0,n.emit("data",c)):(r.length+=r.objectMode?1:c.length,k?r.buffer.unshift(c):r.buffer.push(c),r.needReadable&&b(n)),E(n,r)}function R(n,r){var c;return V(r)||typeof r=="string"||r===void 0||n.objectMode||(c=new ot("chunk",["string","Buffer","Uint8Array"],r)),c}function S(n){return 1073741824<=n?n=1073741824:(n--,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n++),n}function M(n,r){return 0>=n||r.length===0&&r.ended?0:r.objectMode?1:n===n?(n>r.highWaterMark&&(r.highWaterMark=S(n)),n<=r.length?n:r.ended?r.length:(r.needReadable=!0,0)):r.flowing&&r.length?r.buffer.head.data.length:r.length}function a(n,r){if(wt("onEofChunk"),!r.ended){if(r.decoder){var c=r.decoder.end();c&&c.length&&(r.buffer.push(c),r.length+=r.objectMode?1:c.length)}r.ended=!0,r.sync?b(n):(r.needReadable=!1,!r.emittedReadable&&(r.emittedReadable=!0,g(n)))}}function b(n){var r=n._readableState;wt("emitReadable",r.needReadable,r.emittedReadable),r.needReadable=!1,r.emittedReadable||(wt("emitReadable",r.flowing),r.emittedReadable=!0,y.nextTick(g,n))}function g(n){var r=n._readableState;wt("emitReadable_",r.destroyed,r.length,r.ended),!r.destroyed&&(r.length||r.ended)&&(n.emit("readable"),r.emittedReadable=!1),r.needReadable=!r.flowing&&!r.ended&&r.length<=r.highWaterMark,it(n)}function E(n,r){r.readingMore||(r.readingMore=!0,y.nextTick(v,n,r))}function v(n,r){for(;!r.reading&&!r.ended&&(r.length<r.highWaterMark||r.flowing&&r.length===0);){var c=r.length;if(wt("maybeReadMore read 0"),n.read(0),c===r.length)break}r.readingMore=!1}function A(n){return function(){var r=n._readableState;wt("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,r.awaitDrain===0&&$t(n,"data")&&(r.flowing=!0,it(n))}}function Y(n){var r=n._readableState;r.readableListening=0<n.listenerCount("readable"),r.resumeScheduled&&!r.paused?r.flowing=!0:0<n.listenerCount("data")&&n.resume()}function O(n){wt("readable nexttick read 0"),n.read(0)}function j(n,r){r.resumeScheduled||(r.resumeScheduled=!0,y.nextTick(q,n,r))}function q(n,r){wt("resume",r.reading),r.reading||n.read(0),r.resumeScheduled=!1,n.emit("resume"),it(n),r.flowing&&!r.reading&&n.read(0)}function it(n){var r=n._readableState;for(wt("flow",r.flowing);r.flowing&&n.read()!==null;);}function bt(n,r){if(r.length===0)return null;var c;return r.objectMode?c=r.buffer.shift():!n||n>=r.length?(c=r.decoder?r.buffer.join(""):r.buffer.length===1?r.buffer.first():r.buffer.concat(r.length),r.buffer.clear()):c=r.buffer.consume(n,r.decoder),c}function Et(n){var r=n._readableState;wt("endReadable",r.endEmitted),r.endEmitted||(r.ended=!0,y.nextTick(Tt,r,n))}function Tt(n,r){if(wt("endReadableNT",n.endEmitted,n.length),!n.endEmitted&&n.length===0&&(n.endEmitted=!0,r.readable=!1,r.emit("end"),n.autoDestroy)){var c=r._writableState;(!c||c.autoDestroy&&c.finished)&&r.destroy()}}function At(n,r){for(var c=0,k=n.length;c<k;c++)if(n[c]===r)return c;return-1}N.exports=h;var Ut;h.ReadableState=_;var wt,Jt=L("events").EventEmitter,$t=function(n,r){return n.listeners(r).length},st=L("./internal/streams/stream"),et=L("buffer").Buffer,lt=m.Uint8Array||function(){},yt=L("util");wt=yt&&yt.debuglog?yt.debuglog("stream"):function(){};var _t,Rt,xt,Xt=L("./internal/streams/buffer_list"),Ft=L("./internal/streams/destroy"),ee=L("./internal/streams/state"),te=ee.getHighWaterMark,W=L("../errors").codes,ot=W.ERR_INVALID_ARG_TYPE,I=W.ERR_STREAM_PUSH_AFTER_EOF,G=W.ERR_METHOD_NOT_IMPLEMENTED,C=W.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;L("inherits")(h,st);var U=Ft.errorOrDestroy,rt=["error","close","destroy","pause","resume"];Object.defineProperty(h.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(n){this._readableState&&(this._readableState.destroyed=n)}}),h.prototype.destroy=Ft.destroy,h.prototype._undestroy=Ft.undestroy,h.prototype._destroy=function(n,r){r(n)},h.prototype.push=function(n,r){var c,k=this._readableState;return k.objectMode?c=!0:typeof n=="string"&&(r=r||k.defaultEncoding,r!==k.encoding&&(n=et.from(n,r),r=""),c=!0),d(this,n,r,!1,c)},h.prototype.unshift=function(n){return d(this,n,null,!0,!1)},h.prototype.isPaused=function(){return this._readableState.flowing===!1},h.prototype.setEncoding=function(n){_t||(_t=L("string_decoder/").StringDecoder);var r=new _t(n);this._readableState.decoder=r,this._readableState.encoding=this._readableState.decoder.encoding;for(var c=this._readableState.buffer.head,k="";c!==null;)k+=r.write(c.data),c=c.next;return this._readableState.buffer.clear(),k!==""&&this._readableState.buffer.push(k),this._readableState.length=k.length,this},h.prototype.read=function(n){wt("read",n),n=parseInt(n,10);var r=this._readableState,c=n;if(n!==0&&(r.emittedReadable=!1),n===0&&r.needReadable&&((r.highWaterMark===0?0<r.length:r.length>=r.highWaterMark)||r.ended))return wt("read: emitReadable",r.length,r.ended),r.length===0&&r.ended?Et(this):b(this),null;if(n=M(n,r),n===0&&r.ended)return r.length===0&&Et(this),null;var k=r.needReadable;wt("need readable",k),(r.length===0||r.length-n<r.highWaterMark)&&(k=!0,wt("length less than watermark",k)),r.ended||r.reading?(k=!1,wt("reading or ended",k)):k&&(wt("do read"),r.reading=!0,r.sync=!0,r.length===0&&(r.needReadable=!0),this._read(r.highWaterMark),r.sync=!1,!r.reading&&(n=M(c,r)));var K;return K=0<n?bt(n,r):null,K===null?(r.needReadable=r.length<=r.highWaterMark,n=0):(r.length-=n,r.awaitDrain=0),r.length===0&&(!r.ended&&(r.needReadable=!0),c!==n&&r.ended&&Et(this)),K!==null&&this.emit("data",K),K},h.prototype._read=function(){U(this,new G("_read()"))},h.prototype.pipe=function(n,r){function c(gt,jt){wt("onunpipe"),gt===Dt&&jt&&jt.hasUnpiped===!1&&(jt.hasUnpiped=!0,K())}function k(){wt("onend"),n.end()}function K(){wt("cleanup"),n.removeListener("close",Ct),n.removeListener("finish",Bt),n.removeListener("drain",nt),n.removeListener("error",ct),n.removeListener("unpipe",c),Dt.removeListener("end",k),Dt.removeListener("end",Ot),Dt.removeListener("data",z),mt=!0,Lt.awaitDrain&&(!n._writableState||n._writableState.needDrain)&&nt()}function z(gt){wt("ondata");var jt=n.write(gt);wt("dest.write",jt),jt===!1&&((Lt.pipesCount===1&&Lt.pipes===n||1<Lt.pipesCount&&At(Lt.pipes,n)!==-1)&&!mt&&(wt("false write response, pause",Lt.awaitDrain),Lt.awaitDrain++),Dt.pause())}function ct(gt){wt("onerror",gt),Ot(),n.removeListener("error",ct),$t(n,"error")===0&&U(n,gt)}function Ct(){n.removeListener("finish",Bt),Ot()}function Bt(){wt("onfinish"),n.removeListener("close",Ct),Ot()}function Ot(){wt("unpipe"),Dt.unpipe(n)}var Dt=this,Lt=this._readableState;switch(Lt.pipesCount){case 0:Lt.pipes=n;break;case 1:Lt.pipes=[Lt.pipes,n];break;default:Lt.pipes.push(n)}Lt.pipesCount+=1,wt("pipe count=%d opts=%j",Lt.pipesCount,r);var ie=(!r||r.end!==!1)&&n!==y.stdout&&n!==y.stderr,X=ie?k:Ot;Lt.endEmitted?y.nextTick(X):Dt.once("end",X),n.on("unpipe",c);var nt=A(Dt);n.on("drain",nt);var mt=!1;return Dt.on("data",z),u(n,"error",ct),n.once("close",Ct),n.once("finish",Bt),n.emit("pipe",Dt),Lt.flowing||(wt("pipe resume"),Dt.resume()),n},h.prototype.unpipe=function(n){var r=this._readableState,c={hasUnpiped:!1};if(r.pipesCount===0)return this;if(r.pipesCount===1)return n&&n!==r.pipes?this:(n||(n=r.pipes),r.pipes=null,r.pipesCount=0,r.flowing=!1,n&&n.emit("unpipe",this,c),this);if(!n){var k=r.pipes,K=r.pipesCount;r.pipes=null,r.pipesCount=0,r.flowing=!1;for(var z=0;z<K;z++)k[z].emit("unpipe",this,{hasUnpiped:!1});return this}var ct=At(r.pipes,n);return ct===-1?this:(r.pipes.splice(ct,1),r.pipesCount-=1,r.pipesCount===1&&(r.pipes=r.pipes[0]),n.emit("unpipe",this,c),this)},h.prototype.on=function(n,r){var c=st.prototype.on.call(this,n,r),k=this._readableState;return n==="data"?(k.readableListening=0<this.listenerCount("readable"),k.flowing!==!1&&this.resume()):n=="readable"&&!k.endEmitted&&!k.readableListening&&(k.readableListening=k.needReadable=!0,k.flowing=!1,k.emittedReadable=!1,wt("on readable",k.length,k.reading),k.length?b(this):!k.reading&&y.nextTick(O,this)),c},h.prototype.addListener=h.prototype.on,h.prototype.removeListener=function(n,r){var c=st.prototype.removeListener.call(this,n,r);return n==="readable"&&y.nextTick(Y,this),c},h.prototype.removeAllListeners=function(n){var r=st.prototype.removeAllListeners.apply(this,arguments);return(n==="readable"||n===void 0)&&y.nextTick(Y,this),r},h.prototype.resume=function(){var n=this._readableState;return n.flowing||(wt("resume"),n.flowing=!n.readableListening,j(this,n)),n.paused=!1,this},h.prototype.pause=function(){return wt("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(wt("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},h.prototype.wrap=function(n){var r=this,c=this._readableState,k=!1;for(var K in n.on("end",function(){if(wt("wrapped end"),c.decoder&&!c.ended){var ct=c.decoder.end();ct&&ct.length&&r.push(ct)}r.push(null)}),n.on("data",function(ct){if(wt("wrapped data"),c.decoder&&(ct=c.decoder.write(ct)),!(c.objectMode&&ct==null)&&(c.objectMode||ct&&ct.length)){var Ct=r.push(ct);Ct||(k=!0,n.pause())}}),n)this[K]===void 0&&typeof n[K]=="function"&&(this[K]=function(ct){return function(){return n[ct].apply(n,arguments)}}(K));for(var z=0;z<rt.length;z++)n.on(rt[z],this.emit.bind(this,rt[z]));return this._read=function(ct){wt("wrapped _read",ct),k&&(k=!1,n.resume())},this},typeof Symbol=="function"&&(h.prototype[Symbol.asyncIterator]=function(){return Rt===void 0&&(Rt=L("./internal/streams/async_iterator")),Rt(this)}),Object.defineProperty(h.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(h.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(h.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(n){this._readableState&&(this._readableState.flowing=n)}}),h._fromList=bt,Object.defineProperty(h.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(h.from=function(n,r){return xt===void 0&&(xt=L("./internal/streams/from")),xt(h,n,r)})}).call(this)}).call(this,L("_process"),typeof J.g=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:J.g)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,events:7,inherits:10,"string_decoder/":31,util:2}],19:[function(L,N){"use strict";function y(S,M){var a=this._transformState;a.transforming=!1;var b=a.writecb;if(b===null)return this.emit("error",new h);a.writechunk=null,a.writecb=null,M!=null&&this.push(M),b(S);var g=this._readableState;g.reading=!1,(g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}function m(S){return this instanceof m?(R.call(this,S),this._transformState={afterTransform:y.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,S&&(typeof S.transform=="function"&&(this._transform=S.transform),typeof S.flush=="function"&&(this._flush=S.flush)),void this.on("prefinish",x)):new m(S)}function x(){var S=this;typeof this._flush!="function"||this._readableState.destroyed?V(this,null,null):this._flush(function(M,a){V(S,M,a)})}function V(S,M,a){if(M)return S.emit("error",M);if(a!=null&&S.push(a),S._writableState.length)throw new T;if(S._transformState.transforming)throw new d;return S.push(null)}N.exports=m;var u=L("../errors").codes,_=u.ERR_METHOD_NOT_IMPLEMENTED,h=u.ERR_MULTIPLE_CALLBACK,d=u.ERR_TRANSFORM_ALREADY_TRANSFORMING,T=u.ERR_TRANSFORM_WITH_LENGTH_0,R=L("./_stream_duplex");L("inherits")(m,R),m.prototype.push=function(S,M){return this._transformState.needTransform=!1,R.prototype.push.call(this,S,M)},m.prototype._transform=function(S,M,a){a(new _("_transform()"))},m.prototype._write=function(S,M,a){var b=this._transformState;if(b.writecb=a,b.writechunk=S,b.writeencoding=M,!b.transforming){var g=this._readableState;(b.needTransform||g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}},m.prototype._read=function(){var S=this._transformState;S.writechunk===null||S.transforming?S.needTransform=!0:(S.transforming=!0,this._transform(S.writechunk,S.writeencoding,S.afterTransform))},m.prototype._destroy=function(S,M){R.prototype._destroy.call(this,S,function(a){M(a)})}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(L,N){(function(y,m){(function(){"use strict";function x(I){var G=this;this.next=null,this.entry=null,this.finish=function(){Et(G,I)}}function V(I){return wt.from(I)}function u(I){return wt.isBuffer(I)||I instanceof Jt}function _(){}function h(I,G,C){Tt=Tt||L("./_stream_duplex"),I=I||{},typeof C!="boolean"&&(C=G instanceof Tt),this.objectMode=!!I.objectMode,C&&(this.objectMode=this.objectMode||!!I.writableObjectMode),this.highWaterMark=et(this,I,"writableHighWaterMark",C),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var U=I.decodeStrings===!1;this.decodeStrings=!U,this.defaultEncoding=I.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(rt){E(G,rt)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=I.emitClose!==!1,this.autoDestroy=!!I.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new x(this)}function d(I){Tt=Tt||L("./_stream_duplex");var G=this instanceof Tt;return G||ot.call(d,this)?(this._writableState=new h(I,this,G),this.writable=!0,I&&(typeof I.write=="function"&&(this._write=I.write),typeof I.writev=="function"&&(this._writev=I.writev),typeof I.destroy=="function"&&(this._destroy=I.destroy),typeof I.final=="function"&&(this._final=I.final)),void Ut.call(this)):new d(I)}function T(I,G){var C=new ee;W(I,C),y.nextTick(G,C)}function R(I,G,C,U){var rt;return C===null?rt=new Ft:typeof C!="string"&&!G.objectMode&&(rt=new yt("chunk",["string","Buffer"],C)),!rt||(W(I,rt),y.nextTick(U,rt),!1)}function S(I,G,C){return I.objectMode||I.decodeStrings===!1||typeof G!="string"||(G=wt.from(G,C)),G}function M(I,G,C,U,rt,n){if(!C){var r=S(G,U,rt);U!==r&&(C=!0,rt="buffer",U=r)}var c=G.objectMode?1:U.length;G.length+=c;var k=G.length<G.highWaterMark;if(k||(G.needDrain=!0),G.writing||G.corked){var K=G.lastBufferedRequest;G.lastBufferedRequest={chunk:U,encoding:rt,isBuf:C,callback:n,next:null},K?K.next=G.lastBufferedRequest:G.bufferedRequest=G.lastBufferedRequest,G.bufferedRequestCount+=1}else a(I,G,!1,c,U,rt,n);return k}function a(I,G,C,U,rt,n,r){G.writelen=U,G.writecb=r,G.writing=!0,G.sync=!0,G.destroyed?G.onwrite(new Xt("write")):C?I._writev(rt,G.onwrite):I._write(rt,n,G.onwrite),G.sync=!1}function b(I,G,C,U,rt){--G.pendingcb,C?(y.nextTick(rt,U),y.nextTick(it,I,G),I._writableState.errorEmitted=!0,W(I,U)):(rt(U),I._writableState.errorEmitted=!0,W(I,U),it(I,G))}function g(I){I.writing=!1,I.writecb=null,I.length-=I.writelen,I.writelen=0}function E(I,G){var C=I._writableState,U=C.sync,rt=C.writecb;if(typeof rt!="function")throw new Rt;if(g(C),G)b(I,C,U,G,rt);else{var n=O(C)||I.destroyed;n||C.corked||C.bufferProcessing||!C.bufferedRequest||Y(I,C),U?y.nextTick(v,I,C,n,rt):v(I,C,n,rt)}}function v(I,G,C,U){C||A(I,G),G.pendingcb--,U(),it(I,G)}function A(I,G){G.length===0&&G.needDrain&&(G.needDrain=!1,I.emit("drain"))}function Y(I,G){G.bufferProcessing=!0;var C=G.bufferedRequest;if(I._writev&&C&&C.next){var U=G.bufferedRequestCount,rt=Array(U),n=G.corkedRequestsFree;n.entry=C;for(var r=0,c=!0;C;)rt[r]=C,C.isBuf||(c=!1),C=C.next,r+=1;rt.allBuffers=c,a(I,G,!0,G.length,rt,"",n.finish),G.pendingcb++,G.lastBufferedRequest=null,n.next?(G.corkedRequestsFree=n.next,n.next=null):G.corkedRequestsFree=new x(G),G.bufferedRequestCount=0}else{for(;C;){var k=C.chunk,K=C.encoding,z=C.callback,ct=G.objectMode?1:k.length;if(a(I,G,!1,ct,k,K,z),C=C.next,G.bufferedRequestCount--,G.writing)break}C===null&&(G.lastBufferedRequest=null)}G.bufferedRequest=C,G.bufferProcessing=!1}function O(I){return I.ending&&I.length===0&&I.bufferedRequest===null&&!I.finished&&!I.writing}function j(I,G){I._final(function(C){G.pendingcb--,C&&W(I,C),G.prefinished=!0,I.emit("prefinish"),it(I,G)})}function q(I,G){G.prefinished||G.finalCalled||(typeof I._final!="function"||G.destroyed?(G.prefinished=!0,I.emit("prefinish")):(G.pendingcb++,G.finalCalled=!0,y.nextTick(j,I,G)))}function it(I,G){var C=O(G);if(C&&(q(I,G),G.pendingcb===0&&(G.finished=!0,I.emit("finish"),G.autoDestroy))){var U=I._readableState;(!U||U.autoDestroy&&U.endEmitted)&&I.destroy()}return C}function bt(I,G,C){G.ending=!0,it(I,G),C&&(G.finished?y.nextTick(C):I.once("finish",C)),G.ended=!0,I.writable=!1}function Et(I,G,C){var U=I.entry;for(I.entry=null;U;){var rt=U.callback;G.pendingcb--,rt(C),U=U.next}G.corkedRequestsFree.next=I}N.exports=d;var Tt;d.WritableState=h;var At={deprecate:L("util-deprecate")},Ut=L("./internal/streams/stream"),wt=L("buffer").Buffer,Jt=m.Uint8Array||function(){},$t=L("./internal/streams/destroy"),st=L("./internal/streams/state"),et=st.getHighWaterMark,lt=L("../errors").codes,yt=lt.ERR_INVALID_ARG_TYPE,_t=lt.ERR_METHOD_NOT_IMPLEMENTED,Rt=lt.ERR_MULTIPLE_CALLBACK,xt=lt.ERR_STREAM_CANNOT_PIPE,Xt=lt.ERR_STREAM_DESTROYED,Ft=lt.ERR_STREAM_NULL_VALUES,ee=lt.ERR_STREAM_WRITE_AFTER_END,te=lt.ERR_UNKNOWN_ENCODING,W=$t.errorOrDestroy;L("inherits")(d,Ut),h.prototype.getBuffer=function(){for(var I=this.bufferedRequest,G=[];I;)G.push(I),I=I.next;return G},function(){try{Object.defineProperty(h.prototype,"buffer",{get:At.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(I){}}();var ot;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(ot=Function.prototype[Symbol.hasInstance],Object.defineProperty(d,Symbol.hasInstance,{value:function(I){return!!ot.call(this,I)||this===d&&I&&I._writableState instanceof h}})):ot=function(I){return I instanceof this},d.prototype.pipe=function(){W(this,new xt)},d.prototype.write=function(I,G,C){var U=this._writableState,rt=!1,n=!U.objectMode&&u(I);return n&&!wt.isBuffer(I)&&(I=V(I)),typeof G=="function"&&(C=G,G=null),n?G="buffer":!G&&(G=U.defaultEncoding),typeof C!="function"&&(C=_),U.ending?T(this,C):(n||R(this,U,I,C))&&(U.pendingcb++,rt=M(this,U,n,I,G,C)),rt},d.prototype.cork=function(){this._writableState.corked++},d.prototype.uncork=function(){var I=this._writableState;I.corked&&(I.corked--,!I.writing&&!I.corked&&!I.bufferProcessing&&I.bufferedRequest&&Y(this,I))},d.prototype.setDefaultEncoding=function(I){if(typeof I=="string"&&(I=I.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((I+"").toLowerCase())))throw new te(I);return this._writableState.defaultEncoding=I,this},Object.defineProperty(d.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),d.prototype._write=function(I,G,C){C(new _t("_write()"))},d.prototype._writev=null,d.prototype.end=function(I,G,C){var U=this._writableState;return typeof I=="function"?(C=I,I=null,G=null):typeof G=="function"&&(C=G,G=null),I!=null&&this.write(I,G),U.corked&&(U.corked=1,this.uncork()),U.ending||bt(this,U,C),this},Object.defineProperty(d.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(d.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(I){this._writableState&&(this._writableState.destroyed=I)}}),d.prototype.destroy=$t.destroy,d.prototype._undestroy=$t.undestroy,d.prototype._destroy=function(I,G){G(I)}}).call(this)}).call(this,L("_process"),typeof J.g=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:J.g)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,inherits:10,"util-deprecate":32}],21:[function(L,N){(function(y){(function(){"use strict";function m(A,Y,O){return Y in A?Object.defineProperty(A,Y,{value:O,enumerable:!0,configurable:!0,writable:!0}):A[Y]=O,A}function x(A,Y){return{value:A,done:Y}}function V(A){var Y=A[T];if(Y!==null){var O=A[g].read();O!==null&&(A[a]=null,A[T]=null,A[R]=null,Y(x(O,!1)))}}function u(A){y.nextTick(V,A)}function _(A,Y){return function(O,j){A.then(function(){return Y[M]?void O(x(void 0,!0)):void Y[b](O,j)},j)}}var h,d=L("./end-of-stream"),T=Symbol("lastResolve"),R=Symbol("lastReject"),S=Symbol("error"),M=Symbol("ended"),a=Symbol("lastPromise"),b=Symbol("handlePromise"),g=Symbol("stream"),E=Object.getPrototypeOf(function(){}),v=Object.setPrototypeOf((h={get stream(){return this[g]},next:function(){var A=this,Y=this[S];if(Y!==null)return Promise.reject(Y);if(this[M])return Promise.resolve(x(void 0,!0));if(this[g].destroyed)return new Promise(function(it,bt){y.nextTick(function(){A[S]?bt(A[S]):it(x(void 0,!0))})});var O,j=this[a];if(j)O=new Promise(_(j,this));else{var q=this[g].read();if(q!==null)return Promise.resolve(x(q,!1));O=new Promise(this[b])}return this[a]=O,O}},m(h,Symbol.asyncIterator,function(){return this}),m(h,"return",function(){var A=this;return new Promise(function(Y,O){A[g].destroy(null,function(j){return j?void O(j):void Y(x(void 0,!0))})})}),h),E);N.exports=function(A){var Y,O=Object.create(v,(Y={},m(Y,g,{value:A,writable:!0}),m(Y,T,{value:null,writable:!0}),m(Y,R,{value:null,writable:!0}),m(Y,S,{value:null,writable:!0}),m(Y,M,{value:A._readableState.endEmitted,writable:!0}),m(Y,b,{value:function(j,q){var it=O[g].read();it?(O[a]=null,O[T]=null,O[R]=null,j(x(it,!1))):(O[T]=j,O[R]=q)},writable:!0}),Y));return O[a]=null,d(A,function(j){if(j&&j.code!=="ERR_STREAM_PREMATURE_CLOSE"){var q=O[R];return q!==null&&(O[a]=null,O[T]=null,O[R]=null,q(j)),void(O[S]=j)}var it=O[T];it!==null&&(O[a]=null,O[T]=null,O[R]=null,it(x(void 0,!0))),O[M]=!0}),A.on("readable",u.bind(null,O)),O}}).call(this)}).call(this,L("_process"))},{"./end-of-stream":24,_process:12}],22:[function(L,N){"use strict";function y(a,b){var g=Object.keys(a);if(Object.getOwnPropertySymbols){var E=Object.getOwnPropertySymbols(a);b&&(E=E.filter(function(v){return Object.getOwnPropertyDescriptor(a,v).enumerable})),g.push.apply(g,E)}return g}function m(a){for(var b,g=1;g<arguments.length;g++)b=arguments[g]==null?{}:arguments[g],g%2?y(Object(b),!0).forEach(function(E){x(a,E,b[E])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):y(Object(b)).forEach(function(E){Object.defineProperty(a,E,Object.getOwnPropertyDescriptor(b,E))});return a}function x(a,b,g){return b in a?Object.defineProperty(a,b,{value:g,enumerable:!0,configurable:!0,writable:!0}):a[b]=g,a}function V(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function u(a,b){for(var g,E=0;E<b.length;E++)g=b[E],g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(a,g.key,g)}function _(a,b,g){return b&&u(a.prototype,b),g&&u(a,g),a}function h(a,b,g){T.prototype.copy.call(a,b,g)}var d=L("buffer"),T=d.Buffer,R=L("util"),S=R.inspect,M=S&&S.custom||"inspect";N.exports=function(){function a(){V(this,a),this.head=null,this.tail=null,this.length=0}return _(a,[{key:"push",value:function(b){var g={data:b,next:null};0<this.length?this.tail.next=g:this.head=g,this.tail=g,++this.length}},{key:"unshift",value:function(b){var g={data:b,next:this.head};this.length===0&&(this.tail=g),this.head=g,++this.length}},{key:"shift",value:function(){if(this.length!==0){var b=this.head.data;return this.head=this.length===1?this.tail=null:this.head.next,--this.length,b}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(b){if(this.length===0)return"";for(var g=this.head,E=""+g.data;g=g.next;)E+=b+g.data;return E}},{key:"concat",value:function(b){if(this.length===0)return T.alloc(0);for(var g=T.allocUnsafe(b>>>0),E=this.head,v=0;E;)h(E.data,g,v),v+=E.data.length,E=E.next;return g}},{key:"consume",value:function(b,g){var E;return b<this.head.data.length?(E=this.head.data.slice(0,b),this.head.data=this.head.data.slice(b)):b===this.head.data.length?E=this.shift():E=g?this._getString(b):this._getBuffer(b),E}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(b){var g=this.head,E=1,v=g.data;for(b-=v.length;g=g.next;){var A=g.data,Y=b>A.length?A.length:b;if(v+=Y===A.length?A:A.slice(0,b),b-=Y,b===0){Y===A.length?(++E,this.head=g.next?g.next:this.tail=null):(this.head=g,g.data=A.slice(Y));break}++E}return this.length-=E,v}},{key:"_getBuffer",value:function(b){var g=T.allocUnsafe(b),E=this.head,v=1;for(E.data.copy(g),b-=E.data.length;E=E.next;){var A=E.data,Y=b>A.length?A.length:b;if(A.copy(g,g.length-b,0,Y),b-=Y,b===0){Y===A.length?(++v,this.head=E.next?E.next:this.tail=null):(this.head=E,E.data=A.slice(Y));break}++v}return this.length-=v,g}},{key:M,value:function(b,g){return S(this,m({},g,{depth:0,customInspect:!1}))}}]),a}()},{buffer:3,util:2}],23:[function(L,N){(function(y){(function(){"use strict";function m(u,_){V(u,_),x(u)}function x(u){u._writableState&&!u._writableState.emitClose||u._readableState&&!u._readableState.emitClose||u.emit("close")}function V(u,_){u.emit("error",_)}N.exports={destroy:function(u,_){var h=this,d=this._readableState&&this._readableState.destroyed,T=this._writableState&&this._writableState.destroyed;return d||T?(_?_(u):u&&(this._writableState?!this._writableState.errorEmitted&&(this._writableState.errorEmitted=!0,y.nextTick(V,this,u)):y.nextTick(V,this,u)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(u||null,function(R){!_&&R?h._writableState?h._writableState.errorEmitted?y.nextTick(x,h):(h._writableState.errorEmitted=!0,y.nextTick(m,h,R)):y.nextTick(m,h,R):_?(y.nextTick(x,h),_(R)):y.nextTick(x,h)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(u,_){var h=u._readableState,d=u._writableState;h&&h.autoDestroy||d&&d.autoDestroy?u.destroy(_):u.emit("error",_)}}}).call(this)}).call(this,L("_process"))},{_process:12}],24:[function(L,N){"use strict";function y(_){var h=!1;return function(){if(!h){h=!0;for(var d=arguments.length,T=Array(d),R=0;R<d;R++)T[R]=arguments[R];_.apply(this,T)}}}function m(){}function x(_){return _.setHeader&&typeof _.abort=="function"}function V(_,h,d){if(typeof h=="function")return V(_,null,h);h||(h={}),d=y(d||m);var T=h.readable||h.readable!==!1&&_.readable,R=h.writable||h.writable!==!1&&_.writable,S=function(){_.writable||a()},M=_._writableState&&_._writableState.finished,a=function(){R=!1,M=!0,T||d.call(_)},b=_._readableState&&_._readableState.endEmitted,g=function(){T=!1,b=!0,R||d.call(_)},E=function(Y){d.call(_,Y)},v=function(){var Y;return T&&!b?(_._readableState&&_._readableState.ended||(Y=new u),d.call(_,Y)):R&&!M?(_._writableState&&_._writableState.ended||(Y=new u),d.call(_,Y)):void 0},A=function(){_.req.on("finish",a)};return x(_)?(_.on("complete",a),_.on("abort",v),_.req?A():_.on("request",A)):R&&!_._writableState&&(_.on("end",S),_.on("close",S)),_.on("end",g),_.on("finish",a),h.error!==!1&&_.on("error",E),_.on("close",v),function(){_.removeListener("complete",a),_.removeListener("abort",v),_.removeListener("request",A),_.req&&_.req.removeListener("finish",a),_.removeListener("end",S),_.removeListener("close",S),_.removeListener("finish",a),_.removeListener("end",g),_.removeListener("error",E),_.removeListener("close",v)}}var u=L("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;N.exports=V},{"../../../errors":15}],25:[function(L,N){N.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],26:[function(L,N){"use strict";function y(M){var a=!1;return function(){a||(a=!0,M.apply(void 0,arguments))}}function m(M){if(M)throw M}function x(M){return M.setHeader&&typeof M.abort=="function"}function V(M,a,b,g){g=y(g);var E=!1;M.on("close",function(){E=!0}),d===void 0&&(d=L("./end-of-stream")),d(M,{readable:a,writable:b},function(A){return A?g(A):(E=!0,void g())});var v=!1;return function(A){if(!E)return v?void 0:(v=!0,x(M)?M.abort():typeof M.destroy=="function"?M.destroy():void g(A||new S("pipe")))}}function u(M){M()}function _(M,a){return M.pipe(a)}function h(M){return M.length&&typeof M[M.length-1]=="function"?M.pop():m}var d,T=L("../../../errors").codes,R=T.ERR_MISSING_ARGS,S=T.ERR_STREAM_DESTROYED;N.exports=function(){for(var M=arguments.length,a=Array(M),b=0;b<M;b++)a[b]=arguments[b];var g=h(a);if(Array.isArray(a[0])&&(a=a[0]),2>a.length)throw new R("streams");var E,v=a.map(function(A,Y){var O=Y<a.length-1;return V(A,O,0<Y,function(j){E||(E=j),j&&v.forEach(u),O||(v.forEach(u),g(E))})});return a.reduce(_)}},{"../../../errors":15,"./end-of-stream":24}],27:[function(L,N){"use strict";function y(x,V,u){return x.highWaterMark==null?V?x[u]:null:x.highWaterMark}var m=L("../../../errors").codes.ERR_INVALID_OPT_VALUE;N.exports={getHighWaterMark:function(x,V,u,_){var h=y(V,_,u);if(h!=null){if(!(isFinite(h)&&pt(h)===h)||0>h){var d=_?u:"highWaterMark";throw new m(d,h)}return pt(h)}return x.objectMode?16:16384}}},{"../../../errors":15}],28:[function(L,N){N.exports=L("events").EventEmitter},{events:7}],29:[function(L,N,y){y=N.exports=L("./lib/_stream_readable.js"),y.Stream=y,y.Readable=y,y.Writable=L("./lib/_stream_writable.js"),y.Duplex=L("./lib/_stream_duplex.js"),y.Transform=L("./lib/_stream_transform.js"),y.PassThrough=L("./lib/_stream_passthrough.js"),y.finished=L("./lib/internal/streams/end-of-stream.js"),y.pipeline=L("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],30:[function(L,N,y){function m(_,h){for(var d in _)h[d]=_[d]}function x(_,h,d){return u(_,h,d)}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var V=L("buffer"),u=V.Buffer;u.from&&u.alloc&&u.allocUnsafe&&u.allocUnsafeSlow?N.exports=V:(m(V,y),y.Buffer=x),x.prototype=Object.create(u.prototype),m(u,x),x.from=function(_,h,d){if(typeof _=="number")throw new TypeError("Argument must not be a number");return u(_,h,d)},x.alloc=function(_,h,d){if(typeof _!="number")throw new TypeError("Argument must be a number");var T=u(_);return h===void 0?T.fill(0):typeof d=="string"?T.fill(h,d):T.fill(h),T},x.allocUnsafe=function(_){if(typeof _!="number")throw new TypeError("Argument must be a number");return u(_)},x.allocUnsafeSlow=function(_){if(typeof _!="number")throw new TypeError("Argument must be a number");return V.SlowBuffer(_)}},{buffer:3}],31:[function(L,N,y){"use strict";function m(v){if(!v)return"utf8";for(var A;;)switch(v){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return v;default:if(A)return;v=(""+v).toLowerCase(),A=!0}}function x(v){var A=m(v);if(typeof A!="string"&&(g.isEncoding===E||!E(v)))throw new Error("Unknown encoding: "+v);return A||v}function V(v){this.encoding=x(v);var A;switch(this.encoding){case"utf16le":this.text=T,this.end=R,A=4;break;case"utf8":this.fillLast=d,A=4;break;case"base64":this.text=S,this.end=M,A=3;break;default:return this.write=a,void(this.end=b)}this.lastNeed=0,this.lastTotal=0,this.lastChar=g.allocUnsafe(A)}function u(v){return 127>=v?0:v>>5==6?2:v>>4==14?3:v>>3==30?4:v>>6==2?-1:-2}function _(v,A,Y){var O=A.length-1;if(O<Y)return 0;var j=u(A[O]);return 0<=j?(0<j&&(v.lastNeed=j-1),j):--O<Y||j===-2?0:(j=u(A[O]),0<=j?(0<j&&(v.lastNeed=j-2),j):--O<Y||j===-2?0:(j=u(A[O]),0<=j?(0<j&&(j===2?j=0:v.lastNeed=j-3),j):0))}function h(v,A){if((192&A[0])!=128)return v.lastNeed=0,"\uFFFD";if(1<v.lastNeed&&1<A.length){if((192&A[1])!=128)return v.lastNeed=1,"\uFFFD";if(2<v.lastNeed&&2<A.length&&(192&A[2])!=128)return v.lastNeed=2,"\uFFFD"}}function d(v){var A=this.lastTotal-this.lastNeed,Y=h(this,v,A);return Y===void 0?this.lastNeed<=v.length?(v.copy(this.lastChar,A,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(v.copy(this.lastChar,A,0,v.length),void(this.lastNeed-=v.length)):Y}function T(v,A){if((v.length-A)%2==0){var Y=v.toString("utf16le",A);if(Y){var O=Y.charCodeAt(Y.length-1);if(55296<=O&&56319>=O)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=v[v.length-2],this.lastChar[1]=v[v.length-1],Y.slice(0,-1)}return Y}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=v[v.length-1],v.toString("utf16le",A,v.length-1)}function R(v){var A=v&&v.length?this.write(v):"";if(this.lastNeed){var Y=this.lastTotal-this.lastNeed;return A+this.lastChar.toString("utf16le",0,Y)}return A}function S(v,A){var Y=(v.length-A)%3;return Y==0?v.toString("base64",A):(this.lastNeed=3-Y,this.lastTotal=3,Y==1?this.lastChar[0]=v[v.length-1]:(this.lastChar[0]=v[v.length-2],this.lastChar[1]=v[v.length-1]),v.toString("base64",A,v.length-Y))}function M(v){var A=v&&v.length?this.write(v):"";return this.lastNeed?A+this.lastChar.toString("base64",0,3-this.lastNeed):A}function a(v){return v.toString(this.encoding)}function b(v){return v&&v.length?this.write(v):""}var g=L("safe-buffer").Buffer,E=g.isEncoding||function(v){switch(v=""+v,v&&v.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};y.StringDecoder=V,V.prototype.write=function(v){if(v.length===0)return"";var A,Y;if(this.lastNeed){if(A=this.fillLast(v),A===void 0)return"";Y=this.lastNeed,this.lastNeed=0}else Y=0;return Y<v.length?A?A+this.text(v,Y):this.text(v,Y):A||""},V.prototype.end=function(v){var A=v&&v.length?this.write(v):"";return this.lastNeed?A+"\uFFFD":A},V.prototype.text=function(v,A){var Y=_(this,v,A);if(!this.lastNeed)return v.toString("utf8",A);this.lastTotal=Y;var O=v.length-(Y-this.lastNeed);return v.copy(this.lastChar,0,O),v.toString("utf8",A,O)},V.prototype.fillLast=function(v){return this.lastNeed<=v.length?(v.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(v.copy(this.lastChar,this.lastTotal-this.lastNeed,0,v.length),void(this.lastNeed-=v.length))}},{"safe-buffer":30}],32:[function(L,N){(function(y){(function(){function m(x){try{if(!y.localStorage)return!1}catch(u){return!1}var V=y.localStorage[x];return V!=null&&(V+"").toLowerCase()==="true"}N.exports=function(x,V){function u(){if(!_){if(m("throwDeprecation"))throw new Error(V);m("traceDeprecation")?console.trace(V):console.warn(V),_=!0}return x.apply(this,arguments)}if(m("noDeprecation"))return x;var _=!1;return u}}).call(this)}).call(this,typeof J.g=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:J.g)},{}],"/":[function(L,N){function y(M){return M.replace(/a=ice-options:trickle\s\n/g,"")}function m(M){console.warn(M)}/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */const x=L("debug")("simple-peer"),V=L("get-browser-rtc"),u=L("randombytes"),_=L("readable-stream"),h=L("queue-microtask"),d=L("err-code"),{Buffer:T}=L("buffer"),R=65536;class S extends _.Duplex{constructor(a){if(a=Object.assign({allowHalfOpen:!1},a),super(a),this._id=u(4).toString("hex").slice(0,7),this._debug("new peer %o",a),this.channelName=a.initiator?a.channelName||u(20).toString("hex"):null,this.initiator=a.initiator||!1,this.channelConfig=a.channelConfig||S.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},S.config,a.config),this.offerOptions=a.offerOptions||{},this.answerOptions=a.answerOptions||{},this.sdpTransform=a.sdpTransform||(b=>b),this.streams=a.streams||(a.stream?[a.stream]:[]),this.trickle=a.trickle===void 0||a.trickle,this.allowHalfTrickle=a.allowHalfTrickle!==void 0&&a.allowHalfTrickle,this.iceCompleteTimeout=a.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=a.wrtc&&typeof a.wrtc=="object"?a.wrtc:V(),!this._wrtc)throw d(typeof window=="undefined"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(b){return void this.destroy(d(b,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=b=>{this._onIceCandidate(b)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(b=>{this.destroy(d(b,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=b=>{this._setupData(b)},this.streams&&this.streams.forEach(b=>{this.addStream(b)}),this._pc.ontrack=b=>{this._onTrack(b)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(a){if(!this.destroying){if(this.destroyed)throw d(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof a=="string")try{a=JSON.parse(a)}catch(b){a={}}this._debug("signal()"),a.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),a.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(a.transceiverRequest.kind,a.transceiverRequest.init)),a.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(a.candidate):this._pendingCandidates.push(a.candidate)),a.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(a)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(b=>{this._addIceCandidate(b)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(b=>{this.destroy(d(b,"ERR_SET_REMOTE_DESCRIPTION"))}),a.sdp||a.candidate||a.renegotiate||a.transceiverRequest||this.destroy(d(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(a){const b=new this._wrtc.RTCIceCandidate(a);this._pc.addIceCandidate(b).catch(g=>{!b.address||b.address.endsWith(".local")?m("Ignoring unsupported ICE candidate."):this.destroy(d(g,"ERR_ADD_ICE_CANDIDATE"))})}send(a){if(!this.destroying){if(this.destroyed)throw d(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(a)}}addTransceiver(a,b){if(!this.destroying){if(this.destroyed)throw d(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(a,b),this._needsNegotiation()}catch(g){this.destroy(d(g,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:a,init:b}})}}addStream(a){if(!this.destroying){if(this.destroyed)throw d(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),a.getTracks().forEach(b=>{this.addTrack(b,a)})}}addTrack(a,b){if(this.destroying)return;if(this.destroyed)throw d(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const g=this._senderMap.get(a)||new Map;let E=g.get(b);if(!E)E=this._pc.addTrack(a,b),g.set(b,E),this._senderMap.set(a,g),this._needsNegotiation();else throw E.removed?d(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):d(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(a,b,g){if(this.destroying)return;if(this.destroyed)throw d(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const E=this._senderMap.get(a),v=E?E.get(g):null;if(!v)throw d(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");b&&this._senderMap.set(b,E),v.replaceTrack==null?this.destroy(d(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):v.replaceTrack(b)}removeTrack(a,b){if(this.destroying)return;if(this.destroyed)throw d(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const g=this._senderMap.get(a),E=g?g.get(b):null;if(!E)throw d(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{E.removed=!0,this._pc.removeTrack(E)}catch(v){v.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(E):this.destroy(d(v,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(a){if(!this.destroying){if(this.destroyed)throw d(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),a.getTracks().forEach(b=>{this.removeTrack(b,a)})}}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,h(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw d(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(a){this._destroy(a,()=>{})}_destroy(a,b){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",a&&(a.message||a)),h(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",a&&(a.message||a)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(g){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(g){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,a&&this.emit("error",a),this.emit("close"),b()}))}_setupData(a){if(!a.channel)return this.destroy(d(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=a.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=R),this.channelName=this._channel.label,this._channel.onmessage=g=>{this._onChannelMessage(g)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=g=>{const E=g.error instanceof Error?g.error:new Error(`Datachannel error: ${g.message} ${g.filename}:${g.lineno}:${g.colno}`);this.destroy(d(E,"ERR_DATA_CHANNEL"))};let b=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(b&&this._onChannelClose(),b=!0):b=!1},5e3)}_read(){}_write(a,b,g){if(this.destroyed)return g(d(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(a)}catch(E){return this.destroy(d(E,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>R?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=g):g(null)}else this._debug("write before connect"),this._chunk=a,this._cb=g}_onFinish(){if(!this.destroyed){const a=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?a():this.once("connect",a)}}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(a=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(a.sdp=y(a.sdp)),a.sdp=this.sdpTransform(a.sdp);const b=()=>{if(!this.destroyed){const g=this._pc.localDescription||a;this._debug("signal"),this.emit("signal",{type:g.type,sdp:g.sdp})}};this._pc.setLocalDescription(a).then(()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?b():this.once("_iceComplete",b))}).catch(g=>{this.destroy(d(g,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(a=>{this.destroy(d(a,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(a=>{a.mid||!a.sender.track||a.requested||(a.requested=!0,this.addTransceiver(a.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(a=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(a.sdp=y(a.sdp)),a.sdp=this.sdpTransform(a.sdp);const b=()=>{if(!this.destroyed){const g=this._pc.localDescription||a;this._debug("signal"),this.emit("signal",{type:g.type,sdp:g.sdp}),this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(a).then(()=>{this.destroyed||(this.trickle||this._iceComplete?b():this.once("_iceComplete",b))}).catch(g=>{this.destroy(d(g,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(a=>{this.destroy(d(a,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(d(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const a=this._pc.iceConnectionState,b=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",a,b),this.emit("iceStateChange",a,b),(a==="connected"||a==="completed")&&(this._pcReady=!0,this._maybeReady()),a==="failed"&&this.destroy(d(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),a==="closed"&&this.destroy(d(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(a){const b=g=>(Object.prototype.toString.call(g.values)==="[object Array]"&&g.values.forEach(E=>{Object.assign(g,E)}),g);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(g=>{const E=[];g.forEach(v=>{E.push(b(v))}),a(null,E)},g=>a(g)):0<this._pc.getStats.length?this._pc.getStats(g=>{if(this.destroyed)return;const E=[];g.result().forEach(v=>{const A={};v.names().forEach(Y=>{A[Y]=v.stat(Y)}),A.id=v.id,A.type=v.type,A.timestamp=v.timestamp,E.push(b(A))}),a(null,E)},g=>a(g)):a(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const a=()=>{this.destroyed||this.getStats((b,g)=>{if(this.destroyed)return;b&&(g=[]);const E={},v={},A={};let Y=!1;g.forEach(j=>{(j.type==="remotecandidate"||j.type==="remote-candidate")&&(E[j.id]=j),(j.type==="localcandidate"||j.type==="local-candidate")&&(v[j.id]=j),(j.type==="candidatepair"||j.type==="candidate-pair")&&(A[j.id]=j)});const O=j=>{Y=!0;let q=v[j.localCandidateId];q&&(q.ip||q.address)?(this.localAddress=q.ip||q.address,this.localPort=+q.port):q&&q.ipAddress?(this.localAddress=q.ipAddress,this.localPort=+q.portNumber):typeof j.googLocalAddress=="string"&&(q=j.googLocalAddress.split(":"),this.localAddress=q[0],this.localPort=+q[1]),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let it=E[j.remoteCandidateId];it&&(it.ip||it.address)?(this.remoteAddress=it.ip||it.address,this.remotePort=+it.port):it&&it.ipAddress?(this.remoteAddress=it.ipAddress,this.remotePort=+it.portNumber):typeof j.googRemoteAddress=="string"&&(it=j.googRemoteAddress.split(":"),this.remoteAddress=it[0],this.remotePort=+it[1]),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(g.forEach(j=>{j.type==="transport"&&j.selectedCandidatePairId&&O(A[j.selectedCandidatePairId]),(j.type==="googCandidatePair"&&j.googActiveConnection==="true"||(j.type==="candidatepair"||j.type==="candidate-pair")&&j.selected)&&O(j)}),!Y&&(!Object.keys(A).length||Object.keys(v).length))return void setTimeout(a,100);if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(q){return this.destroy(d(q,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const j=this._cb;this._cb=null,j(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};a()}_onInterval(){this._cb&&this._channel&&!(this._channel.bufferedAmount>R)&&this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(a=>{this._pc.removeTrack(a),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(a){this.destroyed||(a.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:a.candidate.candidate,sdpMLineIndex:a.candidate.sdpMLineIndex,sdpMid:a.candidate.sdpMid}}):!a.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),a.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(a){if(this.destroyed)return;let b=a.data;b instanceof ArrayBuffer&&(b=T.from(b)),this.push(b)}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const a=this._cb;this._cb=null,a(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(a){this.destroyed||a.streams.forEach(b=>{this._debug("on track"),this.emit("track",a.track,b),this._remoteTracks.push({track:a.track,stream:b}),this._remoteStreams.some(g=>g.id===b.id)||(this._remoteStreams.push(b),h(()=>{this._debug("on stream"),this.emit("stream",b)}))})}_debug(){const a=[].slice.call(arguments);a[0]="["+this._id+"] "+a[0],x.apply(null,a)}}S.WEBRTC_SUPPORT=!!V(),S.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},S.channelConfig={},N.exports=S},{buffer:3,debug:4,"err-code":6,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/")})},"../../../node_modules/.pnpm/yjs@13.6.7/node_modules/yjs/dist/yjs.mjs":(Wt,kt,J)=>{"use strict";J.d(kt,{QW:()=>st,NG:()=>rt,D$:()=>c,gJ:()=>Bt,ay:()=>Pt});var pt=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/observable.js"),at=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/array.js"),ut=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/math.js"),L=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/map.js"),N=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/encoding.js"),y=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/decoding.js"),m=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/random.js"),x=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/promise.js"),V=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/buffer.js"),u=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/error.js"),_=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/binary.js"),h=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/function.js"),d=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/set.js"),T=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/logging.js"),R=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/logging.common.js");const S=(i,t)=>({[Symbol.iterator](){return this},next(){const e=i.next();return{value:e.done?void 0:t(e.value),done:e.done}}}),M=i=>({[Symbol.iterator](){return this},next:i}),a=(i,t)=>M(()=>{let e;do e=i.next();while(!e.done&&!t(e.value));return e}),b=(i,t)=>M(()=>{const{done:e,value:s}=i.next();return{done:e,value:e?void 0:t(s)}});var g=J("../../../node_modules/.pnpm/lib0@0.2.83/node_modules/lib0/object.js");class E extends null{constructor(t,e){super(),this.doc=t,this.awareness=e}}class v{constructor(t,e){this.clock=t,this.len=e}}class A{constructor(){this.clients=new Map}}const Y=(i,t,e)=>t.clients.forEach((s,o)=>{const l=i.doc.store.clients.get(o);for(let p=0;p<s.length;p++){const w=s[p];mn(i,l,w.clock,w.len,e)}}),O=(i,t)=>{let e=0,s=i.length-1;for(;e<=s;){const o=ut.GW((e+s)/2),l=i[o],p=l.clock;if(p<=t){if(t<p+l.len)return o;e=o+1}else s=o-1}return null},j=(i,t)=>{const e=i.clients.get(t.client);return e!==void 0&&O(e,t.clock)!==null},q=i=>{i.clients.forEach(t=>{t.sort((o,l)=>o.clock-l.clock);let e,s;for(e=1,s=1;e<t.length;e++){const o=t[s-1],l=t[e];o.clock+o.len>=l.clock?o.len=ut.Fp(o.len,l.clock+l.len-o.clock):(s<e&&(t[s]=l),s++)}t.length=s})},it=i=>{const t=new A;for(let e=0;e<i.length;e++)i[e].clients.forEach((s,o)=>{if(!t.clients.has(o)){const l=s.slice();for(let p=e+1;p<i.length;p++)at.s7(l,i[p].clients.get(o)||[]);t.clients.set(o,l)}});return q(t),t},bt=(i,t,e,s)=>{L.Yu(i.clients,t,()=>[]).push(new v(e,s))},Et=()=>new A,Tt=i=>{const t=Et();return i.clients.forEach((e,s)=>{const o=[];for(let l=0;l<e.length;l++){const p=e[l];if(p.deleted){const w=p.id.clock;let D=p.length;if(l+1<e.length)for(let F=e[l+1];l+1<e.length&&F.deleted;F=e[++l+1])D+=F.length;o.push(new v(w,D))}}o.length>0&&t.clients.set(s,o)}),t},At=(i,t)=>{N.uE(i.restEncoder,t.clients.size),at.Dp(t.clients.entries()).sort((e,s)=>s[0]-e[0]).forEach(([e,s])=>{i.resetDsCurVal(),N.uE(i.restEncoder,e);const o=s.length;N.uE(i.restEncoder,o);for(let l=0;l<o;l++){const p=s[l];i.writeDsClock(p.clock),i.writeDsLen(p.len)}})},Ut=i=>{const t=new A,e=y.yg(i.restDecoder);for(let s=0;s<e;s++){i.resetDsCurVal();const o=y.yg(i.restDecoder),l=y.yg(i.restDecoder);if(l>0){const p=L.Yu(t.clients,o,()=>[]);for(let w=0;w<l;w++)p.push(new v(i.readDsClock(),i.readDsLen()))}}return t},wt=(i,t,e)=>{const s=new A,o=y.yg(i.restDecoder);for(let l=0;l<o;l++){i.resetDsCurVal();const p=y.yg(i.restDecoder),w=y.yg(i.restDecoder),D=e.clients.get(p)||[],F=Kt(e,p);for(let B=0;B<w;B++){const P=i.readDsClock(),Q=P+i.readDsLen();if(P<F){F<Q&&bt(s,p,F,Q-F);let tt=ae(D,P),ft=D[tt];for(!ft.deleted&&ft.id.clock<P&&(D.splice(tt+1,0,$e(t,ft,P-ft.id.clock)),tt++);tt<D.length&&(ft=D[tt++],ft.id.clock<Q);)ft.deleted||(Q<ft.id.clock+ft.length&&D.splice(tt,0,$e(t,ft,Q-ft.id.clock)),ft.delete(t))}else bt(s,p,P,Q-P)}}if(s.clients.size>0){const l=new Ft;return N.uE(l.restEncoder,0),At(l,s),l.toUint8Array()}return null},Jt=(i,t)=>{if(i.clients.size!==t.clients.size)return!1;for(const[e,s]of i.clients.entries()){const o=t.clients.get(e);if(o===void 0||s.length!==o.length)return!1;for(let l=0;l<s.length;l++){const p=s[l],w=o[l];if(p.clock!==w.clock||p.len!==w.len)return!1}}return!0},$t=m.U7;class st extends pt.y{constructor({guid:t=m.k$(),collectionid:e=null,gc:s=!0,gcFilter:o=()=>!0,meta:l=null,autoLoad:p=!1,shouldLoad:w=!0}={}){super(),this.gc=s,this.gcFilter=o,this.clientID=$t(),this.guid=t,this.collectionid=e,this.share=new Map,this.store=new fn,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=w,this.autoLoad=p,this.meta=l,this.isLoaded=!1,this.isSynced=!1,this.whenLoaded=x.Ue(F=>{this.on("load",()=>{this.isLoaded=!0,F(this)})});const D=()=>x.Ue(F=>{const B=P=>{(P===void 0||P===!0)&&(this.off("sync",B),F())};this.on("sync",B)});this.on("sync",F=>{F===!1&&this.isSynced&&(this.whenSynced=D()),this.isSynced=F===void 0||F===!0,this.isLoaded||this.emit("load",[])}),this.whenSynced=D()}load(){const t=this._item;t!==null&&!this.shouldLoad&&Pt(t.parent.doc,e=>{e.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(at.Dp(this.subdocs).map(t=>t.guid))}transact(t,e=null){return Pt(this,t,e)}get(t,e=ne){const s=L.Yu(this.share,t,()=>{const l=new e;return l._integrate(this,null),l}),o=s.constructor;if(e!==ne&&o!==e)if(o===ne){const l=new e;l._map=s._map,s._map.forEach(p=>{for(;p!==null;p=p.left)p.parent=l}),l._start=s._start;for(let p=l._start;p!==null;p=p.right)p.parent=l;return l._length=s._length,this.share.set(t,l),l._integrate(this,null),l}else throw new Error(`Type with the name ${t} has already been defined with a different constructor`);return s}getArray(t=""){return this.get(t,me)}getText(t=""){return this.get(t,ke)}getMap(t=""){return this.get(t,ve)}getXmlFragment(t=""){return this.get(t,Ee)}toJSON(){const t={};return this.share.forEach((e,s)=>{t[s]=e.toJSON()}),t}destroy(){at.Dp(this.subdocs).forEach(e=>e.destroy());const t=this._item;if(t!==null){this._item=null;const e=t.content;e.doc=new st({guid:this.guid,...e.opts,shouldLoad:!1}),e.doc._item=t,Pt(t.parent.doc,s=>{const o=e.doc;t.deleted||s.subdocsAdded.add(o),s.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}on(t,e){super.on(t,e)}off(t,e){super.off(t,e)}}class et{constructor(t){this.restDecoder=t}resetDsCurVal(){}readDsClock(){return y.yg(this.restDecoder)}readDsLen(){return y.yg(this.restDecoder)}}class lt extends et{readLeftID(){return gt(y.yg(this.restDecoder),y.yg(this.restDecoder))}readRightID(){return gt(y.yg(this.restDecoder),y.yg(this.restDecoder))}readClient(){return y.yg(this.restDecoder)}readInfo(){return y.kj(this.restDecoder)}readString(){return y.kf(this.restDecoder)}readParentInfo(){return y.yg(this.restDecoder)===1}readTypeRef(){return y.yg(this.restDecoder)}readLen(){return y.yg(this.restDecoder)}readAny(){return y.v_(this.restDecoder)}readBuf(){return V.f9(y.HN(this.restDecoder))}readJSON(){return JSON.parse(y.kf(this.restDecoder))}readKey(){return y.kf(this.restDecoder)}}class yt{constructor(t){this.dsCurrVal=0,this.restDecoder=t}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=y.yg(this.restDecoder),this.dsCurrVal}readDsLen(){const t=y.yg(this.restDecoder)+1;return this.dsCurrVal+=t,t}}class _t extends yt{constructor(t){super(t),this.keys=[],y.yg(t),this.keyClockDecoder=new y.dD(y.HN(t)),this.clientDecoder=new y.UF(y.HN(t)),this.leftClockDecoder=new y.dD(y.HN(t)),this.rightClockDecoder=new y.dD(y.HN(t)),this.infoDecoder=new y.XW(y.HN(t),y.kj),this.stringDecoder=new y.sO(y.HN(t)),this.parentInfoDecoder=new y.XW(y.HN(t),y.kj),this.typeRefDecoder=new y.UF(y.HN(t)),this.lenDecoder=new y.UF(y.HN(t))}readLeftID(){return new nt(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new nt(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return y.v_(this.restDecoder)}readBuf(){return y.HN(this.restDecoder)}readJSON(){return y.v_(this.restDecoder)}readKey(){const t=this.keyClockDecoder.read();if(t<this.keys.length)return this.keys[t];{const e=this.stringDecoder.read();return this.keys.push(e),e}}}class Rt{constructor(){this.restEncoder=N.Mf()}toUint8Array(){return N._f(this.restEncoder)}resetDsCurVal(){}writeDsClock(t){N.uE(this.restEncoder,t)}writeDsLen(t){N.uE(this.restEncoder,t)}}class xt extends Rt{writeLeftID(t){N.uE(this.restEncoder,t.client),N.uE(this.restEncoder,t.clock)}writeRightID(t){N.uE(this.restEncoder,t.client),N.uE(this.restEncoder,t.clock)}writeClient(t){N.uE(this.restEncoder,t)}writeInfo(t){N.$F(this.restEncoder,t)}writeString(t){N.uw(this.restEncoder,t)}writeParentInfo(t){N.uE(this.restEncoder,t?1:0)}writeTypeRef(t){N.uE(this.restEncoder,t)}writeLen(t){N.uE(this.restEncoder,t)}writeAny(t){N.EM(this.restEncoder,t)}writeBuf(t){N.mP(this.restEncoder,t)}writeJSON(t){N.uw(this.restEncoder,JSON.stringify(t))}writeKey(t){N.uw(this.restEncoder,t)}}class Xt{constructor(){this.restEncoder=N.Mf(),this.dsCurrVal=0}toUint8Array(){return N._f(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(t){const e=t-this.dsCurrVal;this.dsCurrVal=t,N.uE(this.restEncoder,e)}writeDsLen(t){t===0&&u.zR(),N.uE(this.restEncoder,t-1),this.dsCurrVal+=t}}class Ft extends Xt{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new N.sX,this.clientEncoder=new N.HE,this.leftClockEncoder=new N.sX,this.rightClockEncoder=new N.sX,this.infoEncoder=new N.GF(N.$F),this.stringEncoder=new N.TS,this.parentInfoEncoder=new N.GF(N.$F),this.typeRefEncoder=new N.HE,this.lenEncoder=new N.HE}toUint8Array(){const t=N.Mf();return N.uE(t,0),N.mP(t,this.keyClockEncoder.toUint8Array()),N.mP(t,this.clientEncoder.toUint8Array()),N.mP(t,this.leftClockEncoder.toUint8Array()),N.mP(t,this.rightClockEncoder.toUint8Array()),N.mP(t,N._f(this.infoEncoder)),N.mP(t,this.stringEncoder.toUint8Array()),N.mP(t,N._f(this.parentInfoEncoder)),N.mP(t,this.typeRefEncoder.toUint8Array()),N.mP(t,this.lenEncoder.toUint8Array()),N.HK(t,N._f(this.restEncoder)),N._f(t)}writeLeftID(t){this.clientEncoder.write(t.client),this.leftClockEncoder.write(t.clock)}writeRightID(t){this.clientEncoder.write(t.client),this.rightClockEncoder.write(t.clock)}writeClient(t){this.clientEncoder.write(t)}writeInfo(t){this.infoEncoder.write(t)}writeString(t){this.stringEncoder.write(t)}writeParentInfo(t){this.parentInfoEncoder.write(t?1:0)}writeTypeRef(t){this.typeRefEncoder.write(t)}writeLen(t){this.lenEncoder.write(t)}writeAny(t){N.EM(this.restEncoder,t)}writeBuf(t){N.mP(this.restEncoder,t)}writeJSON(t){N.EM(this.restEncoder,t)}writeKey(t){const e=this.keyMap.get(t);e===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(t)):this.keyClockEncoder.write(e)}}const ee=(i,t,e,s)=>{s=ut.Fp(s,t[0].id.clock);const o=ae(t,s);N.uE(i.restEncoder,t.length-o),i.writeClient(e),N.uE(i.restEncoder,s);const l=t[o];l.write(i,s-l.id.clock);for(let p=o+1;p<t.length;p++)t[p].write(i,0)},te=(i,t,e)=>{const s=new Map;e.forEach((o,l)=>{Kt(t,l)>o&&s.set(l,o)}),Ue(t).forEach((o,l)=>{e.has(l)||s.set(l,0)}),N.uE(i.restEncoder,s.size),at.Dp(s.entries()).sort((o,l)=>l[0]-o[0]).forEach(([o,l])=>{ee(i,t.clients.get(o),o,l)})},W=(i,t)=>{const e=L.Ue(),s=y.yg(i.restDecoder);for(let o=0;o<s;o++){const l=y.yg(i.restDecoder),p=new Array(l),w=i.readClient();let D=y.yg(i.restDecoder);e.set(w,{i:0,refs:p});for(let F=0;F<l;F++){const B=i.readInfo();switch(_.kr&B){case 0:{const P=i.readLen();p[F]=new le(gt(w,D),P),D+=P;break}case 10:{const P=y.yg(i.restDecoder);p[F]=new oe(gt(w,D),P),D+=P;break}default:{const P=(B&(_.rc|_.x1))===0,Q=new Vt(gt(w,D),null,(B&_.x1)===_.x1?i.readLeftID():null,null,(B&_.rc)===_.rc?i.readRightID():null,P?i.readParentInfo()?t.get(i.readString()):i.readLeftID():null,P&&(B&_.cq)===_.cq?i.readString():null,Jn(i,B));p[F]=Q,D+=Q.length}}}}return e},ot=(i,t,e)=>{const s=[];let o=at.Dp(e.keys()).sort((tt,ft)=>tt-ft);if(o.length===0)return null;const l=()=>{if(o.length===0)return null;let tt=e.get(o[o.length-1]);for(;tt.refs.length===tt.i;)if(o.pop(),o.length>0)tt=e.get(o[o.length-1]);else return null;return tt};let p=l();if(p===null&&s.length===0)return null;const w=new fn,D=new Map,F=(tt,ft)=>{const It=D.get(tt);(It==null||It>ft)&&D.set(tt,ft)};let B=p.refs[p.i++];const P=new Map,Q=()=>{for(const tt of s){const ft=tt.id.client,It=e.get(ft);It?(It.i--,w.clients.set(ft,It.refs.slice(It.i)),e.delete(ft),It.i=0,It.refs=[]):w.clients.set(ft,[tt]),o=o.filter(Gt=>Gt!==ft)}s.length=0};for(;;){if(B.constructor!==oe){const ft=L.Yu(P,B.id.client,()=>Kt(t,B.id.client))-B.id.clock;if(ft<0)s.push(B),F(B.id.client,B.id.clock-1),Q();else{const It=B.getMissing(i,t);if(It!==null){s.push(B);const Gt=e.get(It)||{refs:[],i:0};if(Gt.refs.length===Gt.i)F(It,Kt(t,It)),Q();else{B=Gt.refs[Gt.i++];continue}}else(ft===0||ft<B.length)&&(B.integrate(i,ft),P.set(B.id.client,B.id.clock+B.length))}}if(s.length>0)B=s.pop();else if(p!==null&&p.i<p.refs.length)B=p.refs[p.i++];else{if(p=l(),p===null)break;B=p.refs[p.i++]}}if(w.clients.size>0){const tt=new Ft;return te(tt,w,new Map),N.uE(tt.restEncoder,0),{missing:D,update:tt.toUint8Array()}}return null},I=(i,t)=>te(i,t.doc.store,t.beforeState),G=(i,t,e,s=new _t(i))=>Pt(t,o=>{o.local=!1;let l=!1;const p=o.doc,w=p.store,D=W(s,p),F=ot(o,w,D),B=w.pendingStructs;if(B){for(const[Q,tt]of B.missing)if(tt<Kt(w,Q)){l=!0;break}if(F){for(const[Q,tt]of F.missing){const ft=B.missing.get(Q);(ft==null||ft>tt)&&B.missing.set(Q,tt)}B.update=je([B.update,F.update])}}else w.pendingStructs=F;const P=wt(s,o,w);if(w.pendingDs){const Q=new _t(y.l1(w.pendingDs));y.yg(Q.restDecoder);const tt=wt(Q,o,w);P&&tt?w.pendingDs=je([P,tt]):w.pendingDs=P||tt}else w.pendingDs=P;if(l){const Q=w.pendingStructs.update;w.pendingStructs=null,U(o.doc,Q)}},e,!1),C=(i,t,e)=>G(i,t,e,new lt(i)),U=(i,t,e,s=_t)=>{const o=y.l1(t);G(o,i,e,new s(o))},rt=(i,t,e)=>U(i,t,e,lt),n=(i,t,e=new Map)=>{te(i,t.store,e),At(i,Tt(t.store))},r=(i,t=new Uint8Array([0]),e=new Ft)=>{const s=K(t);n(e,i,s);const o=[e.toUint8Array()];if(i.store.pendingDs&&o.push(i.store.pendingDs),i.store.pendingStructs&&o.push(Cn(i.store.pendingStructs.update,t)),o.length>1){if(e.constructor===xt)return cr(o.map((l,p)=>p===0?l:dr(l)));if(e.constructor===Ft)return je(o)}return o[0]},c=(i,t)=>r(i,t,new xt),k=i=>{const t=new Map,e=y.yg(i.restDecoder);for(let s=0;s<e;s++){const o=y.yg(i.restDecoder),l=y.yg(i.restDecoder);t.set(o,l)}return t},K=i=>k(new et(y.l1(i))),z=(i,t)=>(N.uE(i.restEncoder,t.size),at.Dp(t.entries()).sort((e,s)=>s[0]-e[0]).forEach(([e,s])=>{N.uE(i.restEncoder,e),N.uE(i.restEncoder,s)}),i),ct=(i,t)=>z(i,Ue(t.store)),Ct=(i,t=new Xt)=>(i instanceof Map?z(t,i):ct(t,i),t.toUint8Array()),Bt=i=>Ct(i,new Rt);class Ot{constructor(){this.l=[]}}const Dt=()=>new Ot,Lt=(i,t)=>i.l.push(t),ie=(i,t)=>{const e=i.l,s=e.length;i.l=e.filter(o=>t!==o),s===i.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},X=(i,t,e)=>h.PP(i.l,[t,e]);class nt{constructor(t,e){this.client=t,this.clock=e}}const mt=(i,t)=>i===t||i!==null&&t!==null&&i.client===t.client&&i.clock===t.clock,gt=(i,t)=>new nt(i,t),jt=(i,t)=>{encoding.writeVarUint(i,t.client),encoding.writeVarUint(i,t.clock)},Zt=i=>gt(decoding.readVarUint(i),decoding.readVarUint(i)),Yt=i=>{for(const[t,e]of i.doc.share.entries())if(e===i)return t;throw u.zR()},ce=(i,t)=>{for(;t!==null;){if(t.parent===i)return!0;t=t.parent._item}return!1},Se=i=>{const t=[];let e=i._start;for(;e;)t.push(e),e=e.right;console.log("Children: ",t),console.log("Children content: ",t.filter(s=>!s.deleted).map(s=>s.content))};class hn{constructor(t,e=t.getMap("users")){const s=new Map;this.yusers=e,this.doc=t,this.clients=new Map,this.dss=s;const o=(l,p)=>{const w=l.get("ds"),D=l.get("ids"),F=B=>this.clients.set(B,p);w.observe(B=>{B.changes.added.forEach(P=>{P.content.getContent().forEach(Q=>{Q instanceof Uint8Array&&this.dss.set(p,it([this.dss.get(p)||Et(),Ut(new et(decoding.createDecoder(Q)))]))})})}),this.dss.set(p,it(w.map(B=>Ut(new et(decoding.createDecoder(B)))))),D.observe(B=>B.changes.added.forEach(P=>P.content.getContent().forEach(F))),D.forEach(F)};e.observe(l=>{l.keysChanged.forEach(p=>o(e.get(p),p))}),e.forEach(o)}setUserMapping(t,e,s,{filter:o=()=>!0}={}){const l=this.yusers;let p=l.get(s);p||(p=new ve,p.set("ids",new me),p.set("ds",new me),l.set(s,p)),p.get("ids").push([e]),l.observe(w=>{setTimeout(()=>{const D=l.get(s);if(D!==p){p=D,this.clients.forEach((P,Q)=>{s===P&&p.get("ids").push([Q])});const F=new Rt,B=this.dss.get(s);B&&(At(F,B),p.get("ds").push([F.toUint8Array()]))}},0)}),t.on("afterTransaction",w=>{setTimeout(()=>{const D=p.get("ds"),F=w.deleteSet;if(w.local&&F.clients.size>0&&o(w,F)){const B=new Rt;At(B,F),D.push([B.toUint8Array()])}})})}getUserByClientId(t){return this.clients.get(t)||null}getUserByDeletedId(t){for(const[e,s]of this.dss.entries())if(j(s,t))return e;return null}}class H{constructor(t,e,s,o=0){this.type=t,this.tname=e,this.item=s,this.assoc=o}}const $=i=>{const t={};return i.type&&(t.type=i.type),i.tname&&(t.tname=i.tname),i.item&&(t.item=i.item),i.assoc!=null&&(t.assoc=i.assoc),t},Z=i=>new H(i.type==null?null:gt(i.type.client,i.type.clock),i.tname||null,i.item==null?null:gt(i.item.client,i.item.clock),i.assoc==null?0:i.assoc);class ht{constructor(t,e,s=0){this.type=t,this.index=e,this.assoc=s}}const dt=(i,t,e=0)=>new ht(i,t,e),vt=(i,t,e)=>{let s=null,o=null;return i._item===null?o=Yt(i):s=gt(i._item.id.client,i._item.id.clock),new H(s,o,t,e)},St=(i,t,e=0)=>{let s=i._start;if(e<0){if(t===0)return vt(i,null,e);t--}for(;s!==null;){if(!s.deleted&&s.countable){if(s.length>t)return vt(i,gt(s.id.client,s.id.clock+t),e);t-=s.length}if(s.right===null&&e<0)return vt(i,s.lastId,e);s=s.right}return vt(i,null,e)},Mt=(i,t)=>{const{type:e,tname:s,item:o,assoc:l}=t;if(o!==null)encoding.writeVarUint(i,0),jt(i,o);else if(s!==null)encoding.writeUint8(i,1),encoding.writeVarString(i,s);else if(e!==null)encoding.writeUint8(i,2),jt(i,e);else throw error.unexpectedCase();return encoding.writeVarInt(i,l),i},Nt=i=>{const t=encoding.createEncoder();return Mt(t,i),encoding.toUint8Array(t)},Ht=i=>{let t=null,e=null,s=null;switch(decoding.readVarUint(i)){case 0:s=Zt(i);break;case 1:e=decoding.readVarString(i);break;case 2:t=Zt(i)}const o=decoding.hasContent(i)?decoding.readVarInt(i):0;return new H(t,e,s,o)},Qt=i=>Ht(decoding.createDecoder(i)),re=(i,t)=>{const e=t.store,s=i.item,o=i.type,l=i.tname,p=i.assoc;let w=null,D=0;if(s!==null){if(Kt(e,s.client)<=s.clock)return null;const F=an(e,s),B=F.item;if(!(B instanceof Vt))return null;if(w=B.parent,w._item===null||!w._item.deleted){D=B.deleted||!B.countable?0:F.diff+(p>=0?0:1);let P=B.left;for(;P!==null;)!P.deleted&&P.countable&&(D+=P.length),P=P.left}}else{if(l!==null)w=t.get(l);else if(o!==null){if(Kt(e,o.client)<=o.clock)return null;const{item:F}=an(e,o);if(F instanceof Vt&&F.content instanceof he)w=F.content.type;else return null}else throw error.unexpectedCase();p>=0?D=w._length:D=0}return dt(w,D,i.assoc)},fe=(i,t)=>i===t||i!==null&&t!==null&&i.tname===t.tname&&mt(i.item,t.item)&&mt(i.type,t.type)&&i.assoc===t.assoc;class de{constructor(t,e){this.ds=t,this.sv=e}}const Ie=(i,t)=>{const e=i.ds.clients,s=t.ds.clients,o=i.sv,l=t.sv;if(o.size!==l.size||e.size!==s.size)return!1;for(const[p,w]of o.entries())if(l.get(p)!==w)return!1;for(const[p,w]of e.entries()){const D=s.get(p)||[];if(w.length!==D.length)return!1;for(let F=0;F<w.length;F++){const B=w[F],P=D[F];if(B.clock!==P.clock||B.len!==P.len)return!1}}return!0},Je=(i,t=new Xt)=>(At(t,i.ds),z(t,i.sv),t.toUint8Array()),Xe=i=>Je(i,new Rt),tr=(i,t=new yt(decoding.createDecoder(i)))=>new de(Ut(t),k(t)),Qr=i=>tr(i,new et(decoding.createDecoder(i))),dn=(i,t)=>new de(i,t),ts=dn(Et(),new Map),es=i=>dn(Tt(i.store),Ue(i.store)),_e=(i,t)=>t===void 0?!i.deleted:t.sv.has(i.id.client)&&(t.sv.get(i.id.client)||0)>i.id.clock&&!j(t.ds,i.id),Ze=(i,t)=>{const e=L.Yu(i.meta,Ze,d.Ue),s=i.doc.store;e.has(t)||(t.sv.forEach((o,l)=>{o<Kt(s,l)&&se(i,gt(l,o))}),Y(i,t.ds,o=>{}),e.add(t))},ns=(i,t,e=new st)=>{if(i.gc)throw new Error("Garbage-collection must be disabled in `originDoc`!");const{sv:s,ds:o}=t,l=new Ft;return i.transact(p=>{let w=0;s.forEach(D=>{D>0&&w++}),encoding.writeVarUint(l.restEncoder,w);for(const[D,F]of s){if(F===0)continue;F<Kt(i.store,D)&&se(p,gt(D,F));const B=i.store.clients.get(D)||[],P=ae(B,F-1);encoding.writeVarUint(l.restEncoder,P+1),l.writeClient(D),encoding.writeVarUint(l.restEncoder,0);for(let Q=0;Q<=P;Q++)B[Q].write(l,0)}At(l,o)}),U(e,l.toUint8Array(),"snapshot"),e},er=(i,t,e=_t)=>{const s=new e(decoding.createDecoder(t)),o=new pe(s,!1);for(let p=o.curr;p!==null;p=o.next())if((i.sv.get(p.id.client)||0)<p.id.clock+p.length)return!1;const l=it([i.ds,Ut(s)]);return Jt(i.ds,l)},rs=(i,t)=>er(i,t,lt);class fn{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const Ue=i=>{const t=new Map;return i.clients.forEach((e,s)=>{const o=e[e.length-1];t.set(s,o.id.clock+o.length)}),t},Kt=(i,t)=>{const e=i.clients.get(t);if(e===void 0)return 0;const s=e[e.length-1];return s.id.clock+s.length},pn=(i,t)=>{let e=i.clients.get(t.id.client);if(e===void 0)e=[],i.clients.set(t.id.client,e);else{const s=e[e.length-1];if(s.id.clock+s.length!==t.id.clock)throw u.zR()}e.push(t)},ae=(i,t)=>{let e=0,s=i.length-1,o=i[s],l=o.id.clock;if(l===t)return s;let p=ut.GW(t/(l+o.length-1)*s);for(;e<=s;){if(o=i[p],l=o.id.clock,l<=t){if(t<l+o.length)return p;e=p+1}else s=p-1;p=ut.GW((e+s)/2)}throw u.zR()},xe=(i,t)=>{const e=i.clients.get(t.client);return e[ae(e,t.clock)]},qe=(i,t,e)=>{const s=ae(t,e),o=t[s];return o.id.clock<e&&o instanceof Vt?(t.splice(s+1,0,$e(i,o,e-o.id.clock)),s+1):s},se=(i,t)=>{const e=i.doc.store.clients.get(t.client);return e[qe(i,e,t.clock)]},gn=(i,t,e)=>{const s=t.clients.get(e.client),o=ae(s,e.clock),l=s[o];return e.clock!==l.id.clock+l.length-1&&l.constructor!==le&&s.splice(o+1,0,$e(i,l,e.clock-l.id.clock+1)),l},nr=(i,t,e)=>{const s=i.clients.get(t.id.client);s[ae(s,t.id.clock)]=e},mn=(i,t,e,s,o)=>{if(s===0)return;const l=e+s;let p=qe(i,t,e),w;do w=t[p++],l<w.id.clock+w.length&&qe(i,t,l),o(w);while(p<t.length&&t[p].id.clock<l)};class rr{constructor(t,e,s){this.doc=t,this.deleteSet=new A,this.beforeState=Ue(t.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=e,this.meta=new Map,this.local=s,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const yn=(i,t)=>t.deleteSet.clients.size===0&&!L.Yj(t.afterState,(e,s)=>t.beforeState.get(s)!==e)?!1:(q(t.deleteSet),I(i,t),At(i,t.deleteSet),!0),bn=(i,t,e)=>{const s=t._item;(s===null||s.id.clock<(i.beforeState.get(s.id.client)||0)&&!s.deleted)&&L.Yu(i.changed,t,d.Ue).add(e)},Be=(i,t)=>{let e=i[t],s=i[t-1],o=t;for(;o>0;e=s,s=i[--o-1]){if(s.deleted===e.deleted&&s.constructor===e.constructor&&s.mergeWith(e)){e instanceof Vt&&e.parentSub!==null&&e.parent._map.get(e.parentSub)===e&&e.parent._map.set(e.parentSub,s);continue}break}const l=t-o;return l&&i.splice(t+1-l,l),l},wn=(i,t,e)=>{for(const[s,o]of i.clients.entries()){const l=t.clients.get(s);for(let p=o.length-1;p>=0;p--){const w=o[p],D=w.clock+w.len;for(let F=ae(l,w.clock),B=l[F];F<l.length&&B.id.clock<D;B=l[++F]){const P=l[F];if(w.clock+w.len<=P.id.clock)break;P instanceof Vt&&P.deleted&&!P.keep&&e(P)&&P.gc(t,!1)}}}},_n=(i,t)=>{i.clients.forEach((e,s)=>{const o=t.clients.get(s);for(let l=e.length-1;l>=0;l--){const p=e[l],w=ut.VV(o.length-1,1+ae(o,p.clock+p.len-1));for(let D=w,F=o[D];D>0&&F.id.clock>=p.clock;F=o[D])D-=1+Be(o,D)}})},is=(i,t,e)=>{wn(i,t,e),_n(i,t)},vn=(i,t)=>{if(t<i.length){const e=i[t],s=e.doc,o=s.store,l=e.deleteSet,p=e._mergeStructs;try{q(l),e.afterState=Ue(e.doc.store),s.emit("beforeObserverCalls",[e,s]);const w=[];e.changed.forEach((D,F)=>w.push(()=>{(F._item===null||!F._item.deleted)&&F._callObserver(e,D)})),w.push(()=>{e.changedParentTypes.forEach((D,F)=>{F._dEH.l.length>0&&(F._item===null||!F._item.deleted)&&(D=D.filter(B=>B.target._item===null||!B.target._item.deleted),D.forEach(B=>{B.currentTarget=F,B._path=null}),D.sort((B,P)=>B.path.length-P.path.length),X(F._dEH,D,e))})}),w.push(()=>s.emit("afterTransaction",[e,s])),(0,h.PP)(w,[]),e._needFormattingCleanup&&kr(e)}finally{s.gc&&wn(l,o,s.gcFilter),_n(l,o),e.afterState.forEach((B,P)=>{const Q=e.beforeState.get(P)||0;if(Q!==B){const tt=o.clients.get(P),ft=ut.Fp(ae(tt,Q),1);for(let It=tt.length-1;It>=ft;)It-=1+Be(tt,It)}});for(let B=p.length-1;B>=0;B--){const{client:P,clock:Q}=p[B].id,tt=o.clients.get(P),ft=ae(tt,Q);ft+1<tt.length&&Be(tt,ft+1)>1||ft>0&&Be(tt,ft)}if(!e.local&&e.afterState.get(s.clientID)!==e.beforeState.get(s.clientID)&&(T.S0(R.ud,R.Pl,"[yjs] ",R.YW,R.hM,"Changed the client-id because another client seems to be using it."),s.clientID=$t()),s.emit("afterTransactionCleanup",[e,s]),s._observers.has("update")){const B=new xt;yn(B,e)&&s.emit("update",[B.toUint8Array(),e.origin,s,e])}if(s._observers.has("updateV2")){const B=new Ft;yn(B,e)&&s.emit("updateV2",[B.toUint8Array(),e.origin,s,e])}const{subdocsAdded:w,subdocsLoaded:D,subdocsRemoved:F}=e;(w.size>0||F.size>0||D.size>0)&&(w.forEach(B=>{B.clientID=s.clientID,B.collectionid==null&&(B.collectionid=s.collectionid),s.subdocs.add(B)}),F.forEach(B=>s.subdocs.delete(B)),s.emit("subdocs",[{loaded:D,added:w,removed:F},s,e]),F.forEach(B=>B.destroy())),i.length<=t+1?(s._transactionCleanups=[],s.emit("afterAllTransactions",[s,i])):vn(i,t+1)}}},Pt=(i,t,e=null,s=!0)=>{const o=i._transactionCleanups;let l=!1,p=null;i._transaction===null&&(l=!0,i._transaction=new rr(i,e,s),o.push(i._transaction),o.length===1&&i.emit("beforeAllTransactions",[i]),i.emit("beforeTransaction",[i._transaction,i]));try{p=t(i._transaction)}finally{if(l){const w=i._transaction===o[0];i._transaction=null,w&&vn(o,0)}}return p};class sr{constructor(t,e){this.insertions=e,this.deletions=t,this.meta=new Map}}const En=(i,t,e)=>{Y(i,e.deletions,s=>{s instanceof Vt&&t.scope.some(o=>ce(o,s))&&un(s,!1)})},Sn=(i,t,e)=>{let s=null,o=null;const l=i.doc,p=i.scope;if(Pt(l,w=>{for(;t.length>0&&s===null;){const D=l.store,F=t.pop(),B=new Set,P=[];let Q=!1;Y(w,F.insertions,tt=>{if(tt instanceof Vt){if(tt.redone!==null){let{item:ft,diff:It}=an(D,tt.id);It>0&&(ft=se(w,gt(ft.id.client,ft.id.clock+It))),tt=ft}!tt.deleted&&p.some(ft=>ce(ft,tt))&&P.push(tt)}}),Y(w,F.deletions,tt=>{tt instanceof Vt&&p.some(ft=>ce(ft,tt))&&!j(F.insertions,tt.id)&&B.add(tt)}),B.forEach(tt=>{Q=$n(w,tt,B,F.insertions,i.ignoreRemoteMapChanges,i)!==null||Q});for(let tt=P.length-1;tt>=0;tt--){const ft=P[tt];i.deleteFilter(ft)&&(ft.delete(w),Q=!0)}s=Q?F:null}w.changed.forEach((D,F)=>{D.has(null)&&F._searchMarker&&(F._searchMarker.length=0)}),o=w},i),s!=null){const w=o.changedParentTypes;i.emit("stack-item-popped",[{stackItem:s,type:e,changedParentTypes:w},i])}return s};class os extends null{constructor(t,{captureTimeout:e=500,captureTransaction:s=D=>!0,deleteFilter:o=()=>!0,trackedOrigins:l=new Set([null]),ignoreRemoteMapChanges:p=!1,doc:w=array.isArray(t)?t[0].doc:t.doc}={}){super(),this.scope=[],this.addToScope(t),this.deleteFilter=o,l.add(this),this.trackedOrigins=l,this.captureTransaction=s,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.doc=w,this.lastChange=0,this.ignoreRemoteMapChanges=p,this.captureTimeout=e,this.afterTransactionHandler=D=>{if(!this.captureTransaction(D)||!this.scope.some(Gt=>D.changedParentTypes.has(Gt))||!this.trackedOrigins.has(D.origin)&&(!D.origin||!this.trackedOrigins.has(D.origin.constructor)))return;const F=this.undoing,B=this.redoing,P=F?this.redoStack:this.undoStack;F?this.stopCapturing():B||this.clear(!1,!0);const Q=new A;D.afterState.forEach((Gt,zt)=>{const qn=D.beforeState.get(zt)||0,Qn=Gt-qn;Qn>0&&bt(Q,zt,qn,Qn)});const tt=time.getUnixTime();let ft=!1;if(this.lastChange>0&&tt-this.lastChange<this.captureTimeout&&P.length>0&&!F&&!B){const Gt=P[P.length-1];Gt.deletions=it([Gt.deletions,D.deleteSet]),Gt.insertions=it([Gt.insertions,Q])}else P.push(new sr(D.deleteSet,Q)),ft=!0;!F&&!B&&(this.lastChange=tt),Y(D,D.deleteSet,Gt=>{Gt instanceof Vt&&this.scope.some(zt=>ce(zt,Gt))&&un(Gt,!0)});const It=[{stackItem:P[P.length-1],origin:D.origin,type:F?"redo":"undo",changedParentTypes:D.changedParentTypes},this];ft?this.emit("stack-item-added",It):this.emit("stack-item-updated",It)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",()=>{this.destroy()})}addToScope(t){t=array.isArray(t)?t:[t],t.forEach(e=>{this.scope.every(s=>s!==e)&&this.scope.push(e)})}addTrackedOrigin(t){this.trackedOrigins.add(t)}removeTrackedOrigin(t){this.trackedOrigins.delete(t)}clear(t=!0,e=!0){(t&&this.canUndo()||e&&this.canRedo())&&this.doc.transact(s=>{t&&(this.undoStack.forEach(o=>En(s,this,o)),this.undoStack=[]),e&&(this.redoStack.forEach(o=>En(s,this,o)),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:t,redoStackCleared:e}])})}stopCapturing(){this.lastChange=0}undo(){this.undoing=!0;let t;try{t=Sn(this,this.undoStack,"undo")}finally{this.undoing=!1}return t}redo(){this.redoing=!0;let t;try{t=Sn(this,this.redoStack,"redo")}finally{this.redoing=!1}return t}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}}function*ir(i){const t=y.yg(i.restDecoder);for(let e=0;e<t;e++){const s=y.yg(i.restDecoder),o=i.readClient();let l=y.yg(i.restDecoder);for(let p=0;p<s;p++){const w=i.readInfo();if(w===10){const D=y.yg(i.restDecoder);yield new oe(gt(o,l),D),l+=D}else if(_.kr&w){const D=(w&(_.rc|_.x1))===0,F=new Vt(gt(o,l),null,(w&_.x1)===_.x1?i.readLeftID():null,null,(w&_.rc)===_.rc?i.readRightID():null,D?i.readParentInfo()?i.readString():i.readLeftID():null,D&&(w&_.cq)===_.cq?i.readString():null,Jn(i,w));yield F,l+=F.length}else{const D=i.readLen();yield new le(gt(o,l),D),l+=D}}}}class pe{constructor(t,e){this.gen=ir(t),this.curr=null,this.done=!1,this.filterSkips=e,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===oe);return this.curr}}const ls=i=>or(i,lt),or=(i,t=_t)=>{const e=[],s=new t(decoding.createDecoder(i)),o=new pe(s,!1);for(let p=o.curr;p!==null;p=o.next())e.push(p);logging.print("Structs: ",e);const l=Ut(s);logging.print("DeleteSet: ",l)},cs=i=>lr(i,lt),lr=(i,t=_t)=>{const e=[],s=new t(decoding.createDecoder(i)),o=new pe(s,!1);for(let l=o.curr;l!==null;l=o.next())e.push(l);return{structs:e,ds:Ut(s)}};class Qe{constructor(t){this.currClient=0,this.startClock=0,this.written=0,this.encoder=t,this.clientStructs=[]}}const cr=i=>je(i,lt,xt),ar=(i,t=Xt,e=_t)=>{const s=new t,o=new pe(new e(decoding.createDecoder(i)),!1);let l=o.curr;if(l!==null){let p=0,w=l.id.client,D=l.id.clock!==0,F=D?0:l.id.clock+l.length;for(;l!==null;l=o.next())w!==l.id.client&&(F!==0&&(p++,encoding.writeVarUint(s.restEncoder,w),encoding.writeVarUint(s.restEncoder,F)),w=l.id.client,F=0,D=l.id.clock!==0),l.constructor===oe&&(D=!0),D||(F=l.id.clock+l.length);F!==0&&(p++,encoding.writeVarUint(s.restEncoder,w),encoding.writeVarUint(s.restEncoder,F));const B=encoding.createEncoder();return encoding.writeVarUint(B,p),encoding.writeBinaryEncoder(B,s.restEncoder),s.restEncoder=B,s.toUint8Array()}else return encoding.writeVarUint(s.restEncoder,0),s.toUint8Array()},as=i=>ar(i,Rt,lt),ur=(i,t=_t)=>{const e=new Map,s=new Map,o=new pe(new t(decoding.createDecoder(i)),!1);let l=o.curr;if(l!==null){let p=l.id.client,w=l.id.clock;for(e.set(p,w);l!==null;l=o.next())p!==l.id.client&&(s.set(p,w),e.set(l.id.client,l.id.clock),p=l.id.client),w=l.id.clock+l.length;s.set(p,w)}return{from:e,to:s}},us=i=>ur(i,lt),hr=(i,t)=>{if(i.constructor===le){const{client:e,clock:s}=i.id;return new le(gt(e,s+t),i.length-t)}else if(i.constructor===oe){const{client:e,clock:s}=i.id;return new oe(gt(e,s+t),i.length-t)}else{const e=i,{client:s,clock:o}=e.id;return new Vt(gt(s,o+t),null,gt(s,o+t-1),null,e.rightOrigin,e.parent,e.parentSub,e.content.splice(t))}},je=(i,t=_t,e=Ft)=>{if(i.length===1)return i[0];const s=i.map(B=>new t(y.l1(B)));let o=s.map(B=>new pe(B,!0)),l=null;const p=new e,w=new Qe(p);for(;o=o.filter(Q=>Q.curr!==null),o.sort((Q,tt)=>{if(Q.curr.id.client===tt.curr.id.client){const ft=Q.curr.id.clock-tt.curr.id.clock;return ft===0?Q.curr.constructor===tt.curr.constructor?0:Q.curr.constructor===oe?1:-1:ft}else return tt.curr.id.client-Q.curr.id.client}),o.length!==0;){const B=o[0],P=B.curr.id.client;if(l!==null){let Q=B.curr,tt=!1;for(;Q!==null&&Q.id.clock+Q.length<=l.struct.id.clock+l.struct.length&&Q.id.client>=l.struct.id.client;)Q=B.next(),tt=!0;if(Q===null||Q.id.client!==P||tt&&Q.id.clock>l.struct.id.clock+l.struct.length)continue;if(P!==l.struct.id.client)ge(w,l.struct,l.offset),l={struct:Q,offset:0},B.next();else if(l.struct.id.clock+l.struct.length<Q.id.clock)if(l.struct.constructor===oe)l.struct.length=Q.id.clock+Q.length-l.struct.id.clock;else{ge(w,l.struct,l.offset);const ft=Q.id.clock-l.struct.id.clock-l.struct.length;l={struct:new oe(gt(P,l.struct.id.clock+l.struct.length),ft),offset:0}}else{const ft=l.struct.id.clock+l.struct.length-Q.id.clock;ft>0&&(l.struct.constructor===oe?l.struct.length-=ft:Q=hr(Q,ft)),l.struct.mergeWith(Q)||(ge(w,l.struct,l.offset),l={struct:Q,offset:0},B.next())}}else l={struct:B.curr,offset:0},B.next();for(let Q=B.curr;Q!==null&&Q.id.client===P&&Q.id.clock===l.struct.id.clock+l.struct.length&&Q.constructor!==oe;Q=B.next())ge(w,l.struct,l.offset),l={struct:Q,offset:0}}l!==null&&(ge(w,l.struct,l.offset),l=null),tn(w);const D=s.map(B=>Ut(B)),F=it(D);return At(p,F),p.toUint8Array()},Cn=(i,t,e=_t,s=Ft)=>{const o=K(t),l=new s,p=new Qe(l),w=new e(y.l1(i)),D=new pe(w,!1);for(;D.curr;){const B=D.curr,P=B.id.client,Q=o.get(P)||0;if(D.curr.constructor===oe){D.next();continue}if(B.id.clock+B.length>Q)for(ge(p,B,ut.Fp(Q-B.id.clock,0)),D.next();D.curr&&D.curr.id.client===P;)ge(p,D.curr,0),D.next();else for(;D.curr&&D.curr.id.client===P&&D.curr.id.clock+D.curr.length<=Q;)D.next()}tn(p);const F=Ut(w);return At(l,F),l.toUint8Array()},hs=(i,t)=>Cn(i,t,lt,xt),kn=i=>{i.written>0&&(i.clientStructs.push({written:i.written,restEncoder:N._f(i.encoder.restEncoder)}),i.encoder.restEncoder=N.Mf(),i.written=0)},ge=(i,t,e)=>{i.written>0&&i.currClient!==t.id.client&&kn(i),i.written===0&&(i.currClient=t.id.client,i.encoder.writeClient(t.id.client),N.uE(i.encoder.restEncoder,t.id.clock+e)),t.write(i.encoder,e),i.written++},tn=i=>{kn(i);const t=i.encoder.restEncoder;N.uE(t,i.clientStructs.length);for(let e=0;e<i.clientStructs.length;e++){const s=i.clientStructs[e];N.uE(t,s.written),N.HK(t,s.restEncoder)}},Fe=(i,t,e,s)=>{const o=new e(y.l1(i)),l=new pe(o,!1),p=new s,w=new Qe(p);for(let F=l.curr;F!==null;F=l.next())ge(w,t(F),0);tn(w);const D=Ut(o);return At(p,D),p.toUint8Array()},Tn=({formatting:i=!0,subdocs:t=!0,yxml:e=!0}={})=>{let s=0;const o=map.create(),l=map.create(),p=map.create(),w=map.create();return w.set(null,null),D=>{switch(D.constructor){case le:case oe:return D;case Vt:{const F=D,B=F.content;switch(B.constructor){case De:break;case he:{if(e){const P=B.type;P instanceof Te&&(P.nodeName=map.setIfUndefined(l,P.nodeName,()=>"node-"+s)),P instanceof Me&&(P.hookName=map.setIfUndefined(l,P.hookName,()=>"hook-"+s))}break}case we:{const P=B;P.arr=P.arr.map(()=>s);break}case Re:{const P=B;P.content=new Uint8Array([s]);break}case Ae:{const P=B;t&&(P.opts={},P.doc.guid=s+"");break}case be:{const P=B;P.embed={};break}case qt:{const P=B;i&&(P.key=map.setIfUndefined(p,P.key,()=>s+""),P.value=map.setIfUndefined(w,P.value,()=>({i:s})));break}case Ne:{const P=B;P.arr=P.arr.map(()=>s);break}case ue:{const P=B;P.str=string.repeat(s%10+"",P.str.length);break}default:error.unexpectedCase()}return F.parentSub&&(F.parentSub=map.setIfUndefined(o,F.parentSub,()=>s+"")),s++,D}default:error.unexpectedCase()}}},ds=(i,t)=>Fe(i,Tn(t),lt,xt),fs=(i,t)=>Fe(i,Tn(t),_t,Ft),ps=i=>Fe(i,f.id,lt,Ft),dr=i=>Fe(i,h.id,_t,xt),Rn="You must not compute changes after the event-handler fired.";class Pe{constructor(t,e){this.target=t,this.currentTarget=t,this.transaction=e,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=fr(this.currentTarget,this.target))}deletes(t){return j(this.transaction.deleteSet,t.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw u.Ue(Rn);const t=new Map,e=this.target;this.transaction.changed.get(e).forEach(o=>{if(o!==null){const l=e._map.get(o);let p,w;if(this.adds(l)){let D=l.left;for(;D!==null&&this.adds(D);)D=D.left;if(this.deletes(l))if(D!==null&&this.deletes(D))p="delete",w=at.Z$(D.content.getContent());else return;else D!==null&&this.deletes(D)?(p="update",w=at.Z$(D.content.getContent())):(p="add",w=void 0)}else if(this.deletes(l))p="delete",w=at.Z$(l.content.getContent());else return;t.set(o,{action:p,oldValue:w})}}),this._keys=t}return this._keys}get delta(){return this.changes.delta}adds(t){return t.id.clock>=(this.transaction.beforeState.get(t.id.client)||0)}get changes(){let t=this._changes;if(t===null){if(this.transaction.doc._transactionCleanups.length===0)throw u.Ue(Rn);const e=this.target,s=d.Ue(),o=d.Ue(),l=[];if(t={added:s,deleted:o,delta:l,keys:this.keys},this.transaction.changed.get(e).has(null)){let w=null;const D=()=>{w&&l.push(w)};for(let F=e._start;F!==null;F=F.right)F.deleted?this.deletes(F)&&!this.adds(F)&&((w===null||w.delete===void 0)&&(D(),w={delete:0}),w.delete+=F.length,o.add(F)):this.adds(F)?((w===null||w.insert===void 0)&&(D(),w={insert:[]}),w.insert=w.insert.concat(F.content.getContent()),s.add(F)):((w===null||w.retain===void 0)&&(D(),w={retain:0}),w.retain+=F.length);w!==null&&w.retain===void 0&&D()}this._changes=t}return t}}const fr=(i,t)=>{const e=[];for(;t._item!==null&&t!==i;){if(t._item.parentSub!==null)e.unshift(t._item.parentSub);else{let s=0,o=t._item.parent._start;for(;o!==t._item&&o!==null;)o.deleted||s++,o=o.right;e.unshift(s)}t=t._item.parent}return e},Dn=80;let en=0;class pr{constructor(t,e){t.marker=!0,this.p=t,this.index=e,this.timestamp=en++}}const gr=i=>{i.timestamp=en++},An=(i,t,e)=>{i.p.marker=!1,i.p=t,t.marker=!0,i.index=e,i.timestamp=en++},mr=(i,t,e)=>{if(i.length>=Dn){const s=i.reduce((o,l)=>o.timestamp<l.timestamp?o:l);return An(s,t,e),s}else{const s=new pr(t,e);return i.push(s),s}},Ve=(i,t)=>{if(i._start===null||t===0||i._searchMarker===null)return null;const e=i._searchMarker.length===0?null:i._searchMarker.reduce((l,p)=>ut.Wn(t-l.index)<ut.Wn(t-p.index)?l:p);let s=i._start,o=0;for(e!==null&&(s=e.p,o=e.index,gr(e));s.right!==null&&o<t;){if(!s.deleted&&s.countable){if(t<o+s.length)break;o+=s.length}s=s.right}for(;s.left!==null&&o>t;)s=s.left,!s.deleted&&s.countable&&(o-=s.length);for(;s.left!==null&&s.left.id.client===s.id.client&&s.left.id.clock+s.left.length===s.id.clock;)s=s.left,!s.deleted&&s.countable&&(o-=s.length);return e!==null&&ut.Wn(e.index-o)<s.parent.length/Dn?(An(e,s,o),e):mr(i._searchMarker,s,o)},Oe=(i,t,e)=>{for(let s=i.length-1;s>=0;s--){const o=i[s];if(e>0){let l=o.p;for(l.marker=!1;l&&(l.deleted||!l.countable);)l=l.left,l&&!l.deleted&&l.countable&&(o.index-=l.length);if(l===null||l.marker===!0){i.splice(s,1);continue}o.p=l,l.marker=!0}(t<o.index||e>0&&t===o.index)&&(o.index=ut.Fp(t,o.index+e))}},gs=i=>{let t=i._start;const e=[];for(;t;)e.push(t),t=t.right;return e},We=(i,t,e)=>{const s=i,o=t.changedParentTypes;for(;L.Yu(o,i,()=>[]).push(e),i._item!==null;)i=i._item.parent;X(s._eH,e,t)};class ne{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=Dt(),this._dEH=Dt(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(t,e){this.doc=t,this._item=e}_copy(){throw u.Nw()}clone(){throw u.Nw()}_write(t){}get _first(){let t=this._start;for(;t!==null&&t.deleted;)t=t.right;return t}_callObserver(t,e){!t.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(t){Lt(this._eH,t)}observeDeep(t){Lt(this._dEH,t)}unobserve(t){ie(this._eH,t)}unobserveDeep(t){ie(this._dEH,t)}toJSON(){}}const In=(i,t,e)=>{t<0&&(t=i._length+t),e<0&&(e=i._length+e);let s=e-t;const o=[];let l=i._start;for(;l!==null&&s>0;){if(l.countable&&!l.deleted){const p=l.content.getContent();if(p.length<=t)t-=p.length;else{for(let w=t;w<p.length&&s>0;w++)o.push(p[w]),s--;t=0}}l=l.right}return o},Un=i=>{const t=[];let e=i._start;for(;e!==null;){if(e.countable&&!e.deleted){const s=e.content.getContent();for(let o=0;o<s.length;o++)t.push(s[o])}e=e.right}return t},ms=(i,t)=>{const e=[];let s=i._start;for(;s!==null;){if(s.countable&&_e(s,t)){const o=s.content.getContent();for(let l=0;l<o.length;l++)e.push(o[l])}s=s.right}return e},Le=(i,t)=>{let e=0,s=i._start;for(;s!==null;){if(s.countable&&!s.deleted){const o=s.content.getContent();for(let l=0;l<o.length;l++)t(o[l],e++,i)}s=s.right}},On=(i,t)=>{const e=[];return Le(i,(s,o)=>{e.push(t(s,o,i))}),e},yr=i=>{let t=i._start,e=null,s=0;return{[Symbol.iterator](){return this},next:()=>{if(e===null){for(;t!==null&&t.deleted;)t=t.right;if(t===null)return{done:!0,value:void 0};e=t.content.getContent(),s=0,t=t.right}const o=e[s++];return e.length<=s&&(e=null),{done:!1,value:o}}}},Ln=(i,t)=>{const e=Ve(i,t);let s=i._start;for(e!==null&&(s=e.p,t-=e.index);s!==null;s=s.right)if(!s.deleted&&s.countable){if(t<s.length)return s.content.getContent()[t];t-=s.length}},He=(i,t,e,s)=>{let o=e;const l=i.doc,p=l.clientID,w=l.store,D=e===null?t._start:e.right;let F=[];const B=()=>{F.length>0&&(o=new Vt(gt(p,Kt(w,p)),o,o&&o.lastId,D,D&&D.id,t,null,new we(F)),o.integrate(i,0),F=[])};s.forEach(P=>{if(P===null)F.push(P);else switch(P.constructor){case Number:case Object:case Boolean:case Array:case String:F.push(P);break;default:switch(B(),P.constructor){case Uint8Array:case ArrayBuffer:o=new Vt(gt(p,Kt(w,p)),o,o&&o.lastId,D,D&&D.id,t,null,new Re(new Uint8Array(P))),o.integrate(i,0);break;case st:o=new Vt(gt(p,Kt(w,p)),o,o&&o.lastId,D,D&&D.id,t,null,new Ae(P)),o.integrate(i,0);break;default:if(P instanceof ne)o=new Vt(gt(p,Kt(w,p)),o,o&&o.lastId,D,D&&D.id,t,null,new he(P)),o.integrate(i,0);else throw new Error("Unexpected content type in insert operation")}}}),B()},Mn=u.Ue("Length exceeded!"),Nn=(i,t,e,s)=>{if(e>t._length)throw Mn;if(e===0)return t._searchMarker&&Oe(t._searchMarker,e,s.length),He(i,t,null,s);const o=e,l=Ve(t,e);let p=t._start;for(l!==null&&(p=l.p,e-=l.index,e===0&&(p=p.prev,e+=p&&p.countable&&!p.deleted?p.length:0));p!==null;p=p.right)if(!p.deleted&&p.countable){if(e<=p.length){e<p.length&&se(i,gt(p.id.client,p.id.clock+e));break}e-=p.length}return t._searchMarker&&Oe(t._searchMarker,o,s.length),He(i,t,p,s)},br=(i,t,e)=>{let o=(t._searchMarker||[]).reduce((l,p)=>p.index>l.index?p:l,{index:0,p:t._start}).p;if(o)for(;o.right;)o=o.right;return He(i,t,o,e)},xn=(i,t,e,s)=>{if(s===0)return;const o=e,l=s,p=Ve(t,e);let w=t._start;for(p!==null&&(w=p.p,e-=p.index);w!==null&&e>0;w=w.right)!w.deleted&&w.countable&&(e<w.length&&se(i,gt(w.id.client,w.id.clock+e)),e-=w.length);for(;s>0&&w!==null;)w.deleted||(s<w.length&&se(i,gt(w.id.client,w.id.clock+s)),w.delete(i),s-=w.length),w=w.right;if(s>0)throw Mn;t._searchMarker&&Oe(t._searchMarker,o,-l+s)},Ye=(i,t,e)=>{const s=t._map.get(e);s!==void 0&&s.delete(i)},nn=(i,t,e,s)=>{const o=t._map.get(e)||null,l=i.doc,p=l.clientID;let w;if(s==null)w=new we([s]);else switch(s.constructor){case Number:case Object:case Boolean:case Array:case String:w=new we([s]);break;case Uint8Array:w=new Re(s);break;case st:w=new Ae(s);break;default:if(s instanceof ne)w=new he(s);else throw new Error("Unexpected content type")}new Vt(gt(p,Kt(l.store,p)),o,o&&o.lastId,null,null,t,e,w).integrate(i,0)},rn=(i,t)=>{const e=i._map.get(t);return e!==void 0&&!e.deleted?e.content.getContent()[e.length-1]:void 0},Bn=i=>{const t={};return i._map.forEach((e,s)=>{e.deleted||(t[s]=e.content.getContent()[e.length-1])}),t},jn=(i,t)=>{const e=i._map.get(t);return e!==void 0&&!e.deleted},ys=(i,t,e)=>{let s=i._map.get(t)||null;for(;s!==null&&(!e.sv.has(s.id.client)||s.id.clock>=(e.sv.get(s.id.client)||0));)s=s.left;return s!==null&&_e(s,e)?s.content.getContent()[s.length-1]:void 0},Ge=i=>a(i.entries(),t=>!t[1].deleted);class wr extends Pe{constructor(t,e){super(t,e),this._transaction=e}}class me extends ne{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(t){const e=new me;return e.push(t),e}_integrate(t,e){super._integrate(t,e),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new me}clone(){const t=new me;return t.insert(0,this.toArray().map(e=>e instanceof ne?e.clone():e)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}_callObserver(t,e){super._callObserver(t,e),We(this,t,new wr(this,t))}insert(t,e){this.doc!==null?Pt(this.doc,s=>{Nn(s,this,t,e)}):this._prelimContent.splice(t,0,...e)}push(t){this.doc!==null?Pt(this.doc,e=>{br(e,this,t)}):this._prelimContent.push(...t)}unshift(t){this.insert(0,t)}delete(t,e=1){this.doc!==null?Pt(this.doc,s=>{xn(s,this,t,e)}):this._prelimContent.splice(t,e)}get(t){return Ln(this,t)}toArray(){return Un(this)}slice(t=0,e=this.length){return In(this,t,e)}toJSON(){return this.map(t=>t instanceof ne?t.toJSON():t)}map(t){return On(this,t)}forEach(t){Le(this,t)}[Symbol.iterator](){return yr(this)}_write(t){t.writeTypeRef(Hr)}}const _r=i=>new me;class vr extends Pe{constructor(t,e,s){super(t,e),this.keysChanged=s}}class ve extends ne{constructor(t){super(),this._prelimContent=null,t===void 0?this._prelimContent=new Map:this._prelimContent=new Map(t)}_integrate(t,e){super._integrate(t,e),this._prelimContent.forEach((s,o)=>{this.set(o,s)}),this._prelimContent=null}_copy(){return new ve}clone(){const t=new ve;return this.forEach((e,s)=>{t.set(s,e instanceof ne?e.clone():e)}),t}_callObserver(t,e){We(this,t,new vr(this,t,e))}toJSON(){const t={};return this._map.forEach((e,s)=>{if(!e.deleted){const o=e.content.getContent()[e.length-1];t[s]=o instanceof ne?o.toJSON():o}}),t}get size(){return[...Ge(this._map)].length}keys(){return b(Ge(this._map),t=>t[0])}values(){return b(Ge(this._map),t=>t[1].content.getContent()[t[1].length-1])}entries(){return b(Ge(this._map),t=>[t[0],t[1].content.getContent()[t[1].length-1]])}forEach(t){this._map.forEach((e,s)=>{e.deleted||t(e.content.getContent()[e.length-1],s,this)})}[Symbol.iterator](){return this.entries()}delete(t){this.doc!==null?Pt(this.doc,e=>{Ye(e,this,t)}):this._prelimContent.delete(t)}set(t,e){return this.doc!==null?Pt(this.doc,s=>{nn(s,this,t,e)}):this._prelimContent.set(t,e),e}get(t){return rn(this,t)}has(t){return jn(this,t)}clear(){this.doc!==null?Pt(this.doc,t=>{this.forEach(function(e,s,o){Ye(t,o,s)})}):this._prelimContent.clear()}_write(t){t.writeTypeRef(Yr)}}const Er=i=>new ve,ye=(i,t)=>i===t||typeof i=="object"&&typeof t=="object"&&i&&t&&g.$m(i,t);class sn{constructor(t,e,s,o){this.left=t,this.right=e,this.index=s,this.currentAttributes=o}forward(){switch(this.right===null&&u.zR(),this.right.content.constructor){case qt:this.right.deleted||Ce(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const Fn=(i,t,e)=>{for(;t.right!==null&&e>0;){switch(t.right.content.constructor){case qt:t.right.deleted||Ce(t.currentAttributes,t.right.content);break;default:t.right.deleted||(e<t.right.length&&se(i,gt(t.right.id.client,t.right.id.clock+e)),t.index+=t.right.length,e-=t.right.length);break}t.left=t.right,t.right=t.right.right}return t},Ke=(i,t,e)=>{const s=new Map,o=Ve(t,e);if(o){const l=new sn(o.p.left,o.p,o.index,s);return Fn(i,l,e-o.index)}else{const l=new sn(null,t._start,0,s);return Fn(i,l,e)}},Pn=(i,t,e,s)=>{for(;e.right!==null&&(e.right.deleted===!0||e.right.content.constructor===qt&&ye(s.get(e.right.content.key),e.right.content.value));)e.right.deleted||s.delete(e.right.content.key),e.forward();const o=i.doc,l=o.clientID;s.forEach((p,w)=>{const D=e.left,F=e.right,B=new Vt(gt(l,Kt(o.store,l)),D,D&&D.lastId,F,F&&F.id,t,null,new qt(w,p));B.integrate(i,0),e.right=B,e.forward()})},Ce=(i,t)=>{const{key:e,value:s}=t;s===null?i.delete(e):i.set(e,s)},Vn=(i,t)=>{for(;i.right!==null;){if(!(i.right.deleted||i.right.content.constructor===qt&&ye(t[i.right.content.key]||null,i.right.content.value)))break;i.forward()}},Wn=(i,t,e,s)=>{const o=i.doc,l=o.clientID,p=new Map;for(const w in s){const D=s[w],F=e.currentAttributes.get(w)||null;if(!ye(F,D)){p.set(w,F);const{left:B,right:P}=e;e.right=new Vt(gt(l,Kt(o.store,l)),B,B&&B.lastId,P,P&&P.id,t,null,new qt(w,D)),e.right.integrate(i,0),e.forward()}}return p},on=(i,t,e,s,o)=>{e.currentAttributes.forEach((Q,tt)=>{o[tt]===void 0&&(o[tt]=null)});const l=i.doc,p=l.clientID;Vn(e,o);const w=Wn(i,t,e,o),D=s.constructor===String?new ue(s):s instanceof ne?new he(s):new be(s);let{left:F,right:B,index:P}=e;t._searchMarker&&Oe(t._searchMarker,e.index,D.getLength()),B=new Vt(gt(p,Kt(l.store,p)),F,F&&F.lastId,B,B&&B.id,t,null,D),B.integrate(i,0),e.right=B,e.index=P,e.forward(),Pn(i,t,e,w)},Hn=(i,t,e,s,o)=>{const l=i.doc,p=l.clientID;Vn(e,o);const w=Wn(i,t,e,o);t:for(;e.right!==null&&(s>0||w.size>0&&(e.right.deleted||e.right.content.constructor===qt));){if(!e.right.deleted)switch(e.right.content.constructor){case qt:{const{key:D,value:F}=e.right.content,B=o[D];if(B!==void 0){if(ye(B,F))w.delete(D);else{if(s===0)break t;w.set(D,F)}e.right.delete(i)}else e.currentAttributes.set(D,F);break}default:s<e.right.length&&se(i,gt(e.right.id.client,e.right.id.clock+s)),s-=e.right.length;break}e.forward()}if(s>0){let D="";for(;s>0;s--)D+=`
`;e.right=new Vt(gt(p,Kt(l.store,p)),e.left,e.left&&e.left.lastId,e.right,e.right&&e.right.id,t,null,new ue(D)),e.right.integrate(i,0),e.forward()}Pn(i,t,e,w)},Yn=(i,t,e,s,o)=>{let l=t;const p=L.Ue();for(;l&&(!l.countable||l.deleted);){if(!l.deleted&&l.content.constructor===qt){const F=l.content;p.set(F.key,F)}l=l.right}let w=0,D=!1;for(;t!==l;){if(e===t&&(D=!0),!t.deleted){const F=t.content;switch(F.constructor){case qt:{const{key:B,value:P}=F,Q=s.get(B)||null;(p.get(B)!==F||Q===P)&&(t.delete(i),w++,!D&&(o.get(B)||null)===P&&Q!==P&&(Q===null?o.delete(B):o.set(B,Q))),!D&&!t.deleted&&Ce(o,F);break}}}t=t.right}return w},Sr=(i,t)=>{for(;t&&t.right&&(t.right.deleted||!t.right.countable);)t=t.right;const e=new Set;for(;t&&(t.deleted||!t.countable);){if(!t.deleted&&t.content.constructor===qt){const s=t.content.key;e.has(s)?t.delete(i):e.add(s)}t=t.left}},Cr=i=>{let t=0;return Pt(i.doc,e=>{let s=i._start,o=i._start,l=L.Ue();const p=L.JG(l);for(;o;){if(o.deleted===!1)switch(o.content.constructor){case qt:Ce(p,o.content);break;default:t+=Yn(e,s,o,l,p),l=L.JG(p),s=o;break}o=o.right}}),t},kr=i=>{const t=new Set,e=i.doc;for(const[s,o]of i.afterState.entries()){const l=i.beforeState.get(s)||0;o!==l&&mn(i,e.store.clients.get(s),l,o,p=>{!p.deleted&&p.content.constructor===qt&&p.constructor!==le&&t.add(p.parent)})}Pt(e,s=>{Y(i,i.deleteSet,o=>{if(o instanceof le||!o.parent._hasFormatting||t.has(o.parent))return;const l=o.parent;o.content.constructor===qt?t.add(l):Sr(s,o)});for(const o of t)Cr(o)})},Gn=(i,t,e)=>{const s=e,o=L.JG(t.currentAttributes),l=t.right;for(;e>0&&t.right!==null;){if(t.right.deleted===!1)switch(t.right.content.constructor){case he:case be:case ue:e<t.right.length&&se(i,gt(t.right.id.client,t.right.id.clock+e)),e-=t.right.length,t.right.delete(i);break}t.forward()}l&&Yn(i,l,t.right,o,t.currentAttributes);const p=(t.left||t.right).parent;return p._searchMarker&&Oe(p._searchMarker,t.index,-s+e),t};class Tr extends Pe{constructor(t,e,s){super(t,e),this.childListChanged=!1,this.keysChanged=new Set,s.forEach(o=>{o===null?this.childListChanged=!0:this.keysChanged.add(o)})}get changes(){if(this._changes===null){const t={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=t}return this._changes}get delta(){if(this._delta===null){const t=this.target.doc,e=[];Pt(t,s=>{const o=new Map,l=new Map;let p=this.target._start,w=null;const D={};let F="",B=0,P=0;const Q=()=>{if(w!==null){let tt=null;switch(w){case"delete":P>0&&(tt={delete:P}),P=0;break;case"insert":(typeof F=="object"||F.length>0)&&(tt={insert:F},o.size>0&&(tt.attributes={},o.forEach((ft,It)=>{ft!==null&&(tt.attributes[It]=ft)}))),F="";break;case"retain":B>0&&(tt={retain:B},g.xb(D)||(tt.attributes=g.f0({},D))),B=0;break}tt&&e.push(tt),w=null}};for(;p!==null;){switch(p.content.constructor){case he:case be:this.adds(p)?this.deletes(p)||(Q(),w="insert",F=p.content.getContent()[0],Q()):this.deletes(p)?(w!=="delete"&&(Q(),w="delete"),P+=1):p.deleted||(w!=="retain"&&(Q(),w="retain"),B+=1);break;case ue:this.adds(p)?this.deletes(p)||(w!=="insert"&&(Q(),w="insert"),F+=p.content.str):this.deletes(p)?(w!=="delete"&&(Q(),w="delete"),P+=p.length):p.deleted||(w!=="retain"&&(Q(),w="retain"),B+=p.length);break;case qt:{const{key:tt,value:ft}=p.content;if(this.adds(p)){if(!this.deletes(p)){const It=o.get(tt)||null;ye(It,ft)?ft!==null&&p.delete(s):(w==="retain"&&Q(),ye(ft,l.get(tt)||null)?delete D[tt]:D[tt]=ft)}}else if(this.deletes(p)){l.set(tt,ft);const It=o.get(tt)||null;ye(It,ft)||(w==="retain"&&Q(),D[tt]=It)}else if(!p.deleted){l.set(tt,ft);const It=D[tt];It!==void 0&&(ye(It,ft)?It!==null&&p.delete(s):(w==="retain"&&Q(),ft===null?delete D[tt]:D[tt]=ft))}p.deleted||(w==="insert"&&Q(),Ce(o,p.content));break}}p=p.right}for(Q();e.length>0;){const tt=e[e.length-1];if(tt.retain!==void 0&&tt.attributes===void 0)e.pop();else break}}),this._delta=e}return this._delta}}class ke extends ne{constructor(t){super(),this._pending=t!==void 0?[()=>this.insert(0,t)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this._length}_integrate(t,e){super._integrate(t,e);try{this._pending.forEach(s=>s())}catch(s){console.error(s)}this._pending=null}_copy(){return new ke}clone(){const t=new ke;return t.applyDelta(this.toDelta()),t}_callObserver(t,e){super._callObserver(t,e);const s=new Tr(this,t,e);We(this,t,s),!t.local&&this._hasFormatting&&(t._needFormattingCleanup=!0)}toString(){let t="",e=this._start;for(;e!==null;)!e.deleted&&e.countable&&e.content.constructor===ue&&(t+=e.content.str),e=e.right;return t}toJSON(){return this.toString()}applyDelta(t,{sanitize:e=!0}={}){this.doc!==null?Pt(this.doc,s=>{const o=new sn(null,this._start,0,new Map);for(let l=0;l<t.length;l++){const p=t[l];if(p.insert!==void 0){const w=!e&&typeof p.insert=="string"&&l===t.length-1&&o.right===null&&p.insert.slice(-1)===`
`?p.insert.slice(0,-1):p.insert;(typeof w!="string"||w.length>0)&&on(s,this,o,w,p.attributes||{})}else p.retain!==void 0?Hn(s,this,o,p.retain,p.attributes||{}):p.delete!==void 0&&Gn(s,o,p.delete)}}):this._pending.push(()=>this.applyDelta(t))}toDelta(t,e,s){const o=[],l=new Map,p=this.doc;let w="",D=this._start;function F(){if(w.length>0){const P={};let Q=!1;l.forEach((ft,It)=>{Q=!0,P[It]=ft});const tt={insert:w};Q&&(tt.attributes=P),o.push(tt),w=""}}const B=()=>{for(;D!==null;){if(_e(D,t)||e!==void 0&&_e(D,e))switch(D.content.constructor){case ue:{const P=l.get("ychange");t!==void 0&&!_e(D,t)?(P===void 0||P.user!==D.id.client||P.type!=="removed")&&(F(),l.set("ychange",s?s("removed",D.id):{type:"removed"})):e!==void 0&&!_e(D,e)?(P===void 0||P.user!==D.id.client||P.type!=="added")&&(F(),l.set("ychange",s?s("added",D.id):{type:"added"})):P!==void 0&&(F(),l.delete("ychange")),w+=D.content.str;break}case he:case be:{F();const P={insert:D.content.getContent()[0]};if(l.size>0){const Q={};P.attributes=Q,l.forEach((tt,ft)=>{Q[ft]=tt})}o.push(P);break}case qt:_e(D,t)&&(F(),Ce(l,D.content));break}D=D.right}F()};return t||e?Pt(p,P=>{t&&Ze(P,t),e&&Ze(P,e),B()},"cleanup"):B(),o}insert(t,e,s){if(e.length<=0)return;const o=this.doc;o!==null?Pt(o,l=>{const p=Ke(l,this,t);s||(s={},p.currentAttributes.forEach((w,D)=>{s[D]=w})),on(l,this,p,e,s)}):this._pending.push(()=>this.insert(t,e,s))}insertEmbed(t,e,s={}){const o=this.doc;o!==null?Pt(o,l=>{const p=Ke(l,this,t);on(l,this,p,e,s)}):this._pending.push(()=>this.insertEmbed(t,e,s))}delete(t,e){if(e===0)return;const s=this.doc;s!==null?Pt(s,o=>{Gn(o,Ke(o,this,t),e)}):this._pending.push(()=>this.delete(t,e))}format(t,e,s){if(e===0)return;const o=this.doc;o!==null?Pt(o,l=>{const p=Ke(l,this,t);p.right!==null&&Hn(l,this,p,e,s)}):this._pending.push(()=>this.format(t,e,s))}removeAttribute(t){this.doc!==null?Pt(this.doc,e=>{Ye(e,this,t)}):this._pending.push(()=>this.removeAttribute(t))}setAttribute(t,e){this.doc!==null?Pt(this.doc,s=>{nn(s,this,t,e)}):this._pending.push(()=>this.setAttribute(t,e))}getAttribute(t){return rn(this,t)}getAttributes(){return Bn(this)}_write(t){t.writeTypeRef(Gr)}}const Rr=i=>new ke;class ln{constructor(t,e=()=>!0){this._filter=e,this._root=t,this._currentNode=t._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let t=this._currentNode,e=t&&t.content&&t.content.type;if(t!==null&&(!this._firstCall||t.deleted||!this._filter(e)))do if(e=t.content.type,!t.deleted&&(e.constructor===Te||e.constructor===Ee)&&e._start!==null)t=e._start;else for(;t!==null;)if(t.right!==null){t=t.right;break}else t.parent===this._root?t=null:t=t.parent._item;while(t!==null&&(t.deleted||!this._filter(t.content.type)));return this._firstCall=!1,t===null?{value:void 0,done:!0}:(this._currentNode=t,{value:t.content.type,done:!1})}}class Ee extends ne{constructor(){super(),this._prelimContent=[]}get firstChild(){const t=this._first;return t?t.content.getContent()[0]:null}_integrate(t,e){super._integrate(t,e),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Ee}clone(){const t=new Ee;return t.insert(0,this.toArray().map(e=>e instanceof ne?e.clone():e)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(t){return new ln(this,t)}querySelector(t){t=t.toUpperCase();const s=new ln(this,o=>o.nodeName&&o.nodeName.toUpperCase()===t).next();return s.done?null:s.value}querySelectorAll(t){return t=t.toUpperCase(),at.Dp(new ln(this,e=>e.nodeName&&e.nodeName.toUpperCase()===t))}_callObserver(t,e){We(this,t,new Ir(this,e,t))}toString(){return On(this,t=>t.toString()).join("")}toJSON(){return this.toString()}toDOM(t=document,e={},s){const o=t.createDocumentFragment();return s!==void 0&&s._createAssociation(o,this),Le(this,l=>{o.insertBefore(l.toDOM(t,e,s),null)}),o}insert(t,e){this.doc!==null?Pt(this.doc,s=>{Nn(s,this,t,e)}):this._prelimContent.splice(t,0,...e)}insertAfter(t,e){if(this.doc!==null)Pt(this.doc,s=>{const o=t&&t instanceof ne?t._item:t;He(s,this,o,e)});else{const s=this._prelimContent,o=t===null?0:s.findIndex(l=>l===t)+1;if(o===0&&t!==null)throw u.Ue("Reference item not found");s.splice(o,0,...e)}}delete(t,e=1){this.doc!==null?Pt(this.doc,s=>{xn(s,this,t,e)}):this._prelimContent.splice(t,e)}toArray(){return Un(this)}push(t){this.insert(this.length,t)}unshift(t){this.insert(0,t)}get(t){return Ln(this,t)}slice(t=0,e=this.length){return In(this,t,e)}forEach(t){Le(this,t)}_write(t){t.writeTypeRef(zr)}}const Dr=i=>new Ee;class Te extends Ee{constructor(t="UNDEFINED"){super(),this.nodeName=t,this._prelimAttrs=new Map}get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_integrate(t,e){super._integrate(t,e),this._prelimAttrs.forEach((s,o)=>{this.setAttribute(o,s)}),this._prelimAttrs=null}_copy(){return new Te(this.nodeName)}clone(){const t=new Te(this.nodeName),e=this.getAttributes();return g.Ed(e,(s,o)=>{typeof s=="string"&&t.setAttribute(o,s)}),t.insert(0,this.toArray().map(s=>s instanceof ne?s.clone():s)),t}toString(){const t=this.getAttributes(),e=[],s=[];for(const w in t)s.push(w);s.sort();const o=s.length;for(let w=0;w<o;w++){const D=s[w];e.push(D+'="'+t[D]+'"')}const l=this.nodeName.toLocaleLowerCase(),p=e.length>0?" "+e.join(" "):"";return`<${l}${p}>${super.toString()}</${l}>`}removeAttribute(t){this.doc!==null?Pt(this.doc,e=>{Ye(e,this,t)}):this._prelimAttrs.delete(t)}setAttribute(t,e){this.doc!==null?Pt(this.doc,s=>{nn(s,this,t,e)}):this._prelimAttrs.set(t,e)}getAttribute(t){return rn(this,t)}hasAttribute(t){return jn(this,t)}getAttributes(){return Bn(this)}toDOM(t=document,e={},s){const o=t.createElement(this.nodeName),l=this.getAttributes();for(const p in l){const w=l[p];typeof w=="string"&&o.setAttribute(p,w)}return Le(this,p=>{o.appendChild(p.toDOM(t,e,s))}),s!==void 0&&s._createAssociation(o,this),o}_write(t){t.writeTypeRef(Kr),t.writeKey(this.nodeName)}}const Ar=i=>new Te(i.readKey());class Ir extends Pe{constructor(t,e,s){super(t,s),this.childListChanged=!1,this.attributesChanged=new Set,e.forEach(o=>{o===null?this.childListChanged=!0:this.attributesChanged.add(o)})}}class Me extends ve{constructor(t){super(),this.hookName=t}_copy(){return new Me(this.hookName)}clone(){const t=new Me(this.hookName);return this.forEach((e,s)=>{t.set(s,e)}),t}toDOM(t=document,e={},s){const o=e[this.hookName];let l;return o!==void 0?l=o.createDom(this):l=document.createElement(this.hookName),l.setAttribute("data-yjs-hook",this.hookName),s!==void 0&&s._createAssociation(l,this),l}_write(t){t.writeTypeRef($r),t.writeKey(this.hookName)}}const Ur=i=>new Me(i.readKey());class ze extends ke{get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_copy(){return new ze}clone(){const t=new ze;return t.applyDelta(this.toDelta()),t}toDOM(t=document,e,s){const o=t.createTextNode(this.toString());return s!==void 0&&s._createAssociation(o,this),o}toString(){return this.toDelta().map(t=>{const e=[];for(const o in t.attributes){const l=[];for(const p in t.attributes[o])l.push({key:p,value:t.attributes[o][p]});l.sort((p,w)=>p.key<w.key?-1:1),e.push({nodeName:o,attrs:l})}e.sort((o,l)=>o.nodeName<l.nodeName?-1:1);let s="";for(let o=0;o<e.length;o++){const l=e[o];s+=`<${l.nodeName}`;for(let p=0;p<l.attrs.length;p++){const w=l.attrs[p];s+=` ${w.key}="${w.value}"`}s+=">"}s+=t.insert;for(let o=e.length-1;o>=0;o--)s+=`</${e[o].nodeName}>`;return s}).join("")}toJSON(){return this.toString()}_write(t){t.writeTypeRef(Jr)}}const Or=i=>new ze;class cn{constructor(t,e){this.id=t,this.length=e}get deleted(){throw u.Nw()}mergeWith(t){return!1}write(t,e,s){throw u.Nw()}integrate(t,e){throw u.Nw()}}const Lr=0;class le extends cn{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,e){e>0&&(this.id.clock+=e,this.length-=e),pn(t.doc.store,this)}write(t,e){t.writeInfo(Lr),t.writeLen(this.length-e)}getMissing(t,e){return null}}class Re{constructor(t){this.content=t}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new Re(this.content)}splice(t){throw u.Nw()}mergeWith(t){return!1}integrate(t,e){}delete(t){}gc(t){}write(t,e){t.writeBuf(this.content)}getRef(){return 3}}const Mr=i=>new Re(i.readBuf());class De{constructor(t){this.len=t}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new De(this.len)}splice(t){const e=new De(this.len-t);return this.len=t,e}mergeWith(t){return this.len+=t.len,!0}integrate(t,e){bt(t.deleteSet,e.id.client,e.id.clock,this.len),e.markDeleted()}delete(t){}gc(t){}write(t,e){t.writeLen(this.len-e)}getRef(){return 1}}const Nr=i=>new De(i.readLen()),Kn=(i,t)=>new st({guid:i,...t,shouldLoad:t.shouldLoad||t.autoLoad||!1});class Ae{constructor(t){t._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=t;const e={};this.opts=e,t.gc||(e.gc=!1),t.autoLoad&&(e.autoLoad=!0),t.meta!==null&&(e.meta=t.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new Ae(Kn(this.doc.guid,this.opts))}splice(t){throw u.Nw()}mergeWith(t){return!1}integrate(t,e){this.doc._item=e,t.subdocsAdded.add(this.doc),this.doc.shouldLoad&&t.subdocsLoaded.add(this.doc)}delete(t){t.subdocsAdded.has(this.doc)?t.subdocsAdded.delete(this.doc):t.subdocsRemoved.add(this.doc)}gc(t){}write(t,e){t.writeString(this.doc.guid),t.writeAny(this.opts)}getRef(){return 9}}const xr=i=>new Ae(Kn(i.readString(),i.readAny()));class be{constructor(t){this.embed=t}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new be(this.embed)}splice(t){throw u.Nw()}mergeWith(t){return!1}integrate(t,e){}delete(t){}gc(t){}write(t,e){t.writeJSON(this.embed)}getRef(){return 5}}const Br=i=>new be(i.readJSON());class qt{constructor(t,e){this.key=t,this.value=e}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new qt(this.key,this.value)}splice(t){throw u.Nw()}mergeWith(t){return!1}integrate(t,e){const s=e.parent;s._searchMarker=null,s._hasFormatting=!0}delete(t){}gc(t){}write(t,e){t.writeKey(this.key),t.writeJSON(this.value)}getRef(){return 6}}const jr=i=>new qt(i.readKey(),i.readJSON());class Ne{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Ne(this.arr)}splice(t){const e=new Ne(this.arr.slice(t));return this.arr=this.arr.slice(0,t),e}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){const s=this.arr.length;t.writeLen(s-e);for(let o=e;o<s;o++){const l=this.arr[o];t.writeString(l===void 0?"undefined":JSON.stringify(l))}}getRef(){return 2}}const Fr=i=>{const t=i.readLen(),e=[];for(let s=0;s<t;s++){const o=i.readString();o==="undefined"?e.push(void 0):e.push(JSON.parse(o))}return new Ne(e)};class we{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new we(this.arr)}splice(t){const e=new we(this.arr.slice(t));return this.arr=this.arr.slice(0,t),e}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){const s=this.arr.length;t.writeLen(s-e);for(let o=e;o<s;o++){const l=this.arr[o];t.writeAny(l)}}getRef(){return 8}}const Pr=i=>{const t=i.readLen(),e=[];for(let s=0;s<t;s++)e.push(i.readAny());return new we(e)};class ue{constructor(t){this.str=t}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new ue(this.str)}splice(t){const e=new ue(this.str.slice(t));this.str=this.str.slice(0,t);const s=this.str.charCodeAt(t-1);return s>=55296&&s<=56319&&(this.str=this.str.slice(0,t-1)+"\uFFFD",e.str="\uFFFD"+e.str.slice(1)),e}mergeWith(t){return this.str+=t.str,!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){t.writeString(e===0?this.str:this.str.slice(e))}getRef(){return 4}}const Vr=i=>new ue(i.readString()),Wr=[_r,Er,Rr,Ar,Dr,Ur,Or],Hr=0,Yr=1,Gr=2,Kr=3,zr=4,$r=5,Jr=6;class he{constructor(t){this.type=t}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new he(this.type._copy())}splice(t){throw u.Nw()}mergeWith(t){return!1}integrate(t,e){this.type._integrate(t.doc,e)}delete(t){let e=this.type._start;for(;e!==null;)e.deleted?e.id.clock<(t.beforeState.get(e.id.client)||0)&&t._mergeStructs.push(e):e.delete(t),e=e.right;this.type._map.forEach(s=>{s.deleted?s.id.clock<(t.beforeState.get(s.id.client)||0)&&t._mergeStructs.push(s):s.delete(t)}),t.changed.delete(this.type)}gc(t){let e=this.type._start;for(;e!==null;)e.gc(t,!0),e=e.right;this.type._start=null,this.type._map.forEach(s=>{for(;s!==null;)s.gc(t,!0),s=s.left}),this.type._map=new Map}write(t,e){this.type._write(t)}getRef(){return 7}}const Xr=i=>new he(Wr[i.readTypeRef()](i)),an=(i,t)=>{let e=t,s=0,o;do s>0&&(e=gt(e.client,e.clock+s)),o=xe(i,e),s=e.clock-o.id.clock,e=o.redone;while(e!==null&&o instanceof Vt);return{item:o,diff:s}},un=(i,t)=>{for(;i!==null&&i.keep!==t;)i.keep=t,i=i.parent._item},$e=(i,t,e)=>{const{client:s,clock:o}=t.id,l=new Vt(gt(s,o+e),t,gt(s,o+e-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(e));return t.deleted&&l.markDeleted(),t.keep&&(l.keep=!0),t.redone!==null&&(l.redone=gt(t.redone.client,t.redone.clock+e)),t.right=l,l.right!==null&&(l.right.left=l),i._mergeStructs.push(l),l.parentSub!==null&&l.right===null&&l.parent._map.set(l.parentSub,l),t.length=e,l},zn=(i,t)=>array.some(i,e=>j(e.deletions,t)),$n=(i,t,e,s,o,l)=>{const p=i.doc,w=p.store,D=p.clientID,F=t.redone;if(F!==null)return se(i,F);let B=t.parent._item,P=null,Q;if(B!==null&&B.deleted===!0){if(B.redone===null&&(!e.has(B)||$n(i,B,e,s,o,l)===null))return null;for(;B.redone!==null;)B=se(i,B.redone)}const tt=B===null?t.parent:B.content.type;if(t.parentSub===null){for(P=t.left,Q=t;P!==null;){let zt=P;for(;zt!==null&&zt.parent._item!==B;)zt=zt.redone===null?null:se(i,zt.redone);if(zt!==null&&zt.parent._item===B){P=zt;break}P=P.left}for(;Q!==null;){let zt=Q;for(;zt!==null&&zt.parent._item!==B;)zt=zt.redone===null?null:se(i,zt.redone);if(zt!==null&&zt.parent._item===B){Q=zt;break}Q=Q.right}}else if(Q=null,t.right&&!o){for(P=t;P!==null&&P.right!==null&&(P.right.redone||j(s,P.right.id)||zn(l.undoStack,P.right.id)||zn(l.redoStack,P.right.id));)for(P=P.right;P.redone;)P=se(i,P.redone);if(P&&P.right!==null)return null}else P=tt._map.get(t.parentSub)||null;const ft=Kt(w,D),It=gt(D,ft),Gt=new Vt(It,P,P&&P.lastId,Q,Q&&Q.id,tt,t.parentSub,t.content.copy());return t.redone=It,un(Gt,!0),Gt.integrate(i,0),Gt};class Vt extends cn{constructor(t,e,s,o,l,p,w,D){super(t,D.getLength()),this.origin=s,this.left=e,this.right=o,this.rightOrigin=l,this.parent=p,this.parentSub=w,this.redone=null,this.content=D,this.info=this.content.isCountable()?_.Qn:0}set marker(t){(this.info&_.Ko)>0!==t&&(this.info^=_.Ko)}get marker(){return(this.info&_.Ko)>0}get keep(){return(this.info&_.Vw)>0}set keep(t){this.keep!==t&&(this.info^=_.Vw)}get countable(){return(this.info&_.Qn)>0}get deleted(){return(this.info&_.CY)>0}set deleted(t){this.deleted!==t&&(this.info^=_.CY)}markDeleted(){this.info|=_.CY}getMissing(t,e){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=Kt(e,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=Kt(e,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===nt&&this.id.client!==this.parent.client&&this.parent.clock>=Kt(e,this.parent.client))return this.parent.client;if(this.origin&&(this.left=gn(t,e,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=se(t,this.rightOrigin),this.rightOrigin=this.right.id),(this.left&&this.left.constructor===le||this.right&&this.right.constructor===le)&&(this.parent=null),!this.parent)this.left&&this.left.constructor===Vt&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===Vt&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===nt){const s=xe(e,this.parent);s.constructor===le?this.parent=null:this.parent=s.content.type}return null}integrate(t,e){if(e>0&&(this.id.clock+=e,this.left=gn(t,t.doc.store,gt(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(e),this.length-=e),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let s=this.left,o;if(s!==null)o=s.right;else if(this.parentSub!==null)for(o=this.parent._map.get(this.parentSub)||null;o!==null&&o.left!==null;)o=o.left;else o=this.parent._start;const l=new Set,p=new Set;for(;o!==null&&o!==this.right;){if(p.add(o),l.add(o),mt(this.origin,o.origin)){if(o.id.client<this.id.client)s=o,l.clear();else if(mt(this.rightOrigin,o.rightOrigin))break}else if(o.origin!==null&&p.has(xe(t.doc.store,o.origin)))l.has(xe(t.doc.store,o.origin))||(s=o,l.clear());else break;o=o.right}this.left=s}if(this.left!==null){const s=this.left.right;this.right=s,this.left.right=this}else{let s;if(this.parentSub!==null)for(s=this.parent._map.get(this.parentSub)||null;s!==null&&s.left!==null;)s=s.left;else s=this.parent._start,this.parent._start=this;this.right=s}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(t)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),pn(t.doc.store,this),this.content.integrate(t,this),bn(t,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(t)}else new le(this.id,this.length).integrate(t,0)}get next(){let t=this.right;for(;t!==null&&t.deleted;)t=t.right;return t}get prev(){let t=this.left;for(;t!==null&&t.deleted;)t=t.left;return t}get lastId(){return this.length===1?this.id:gt(this.id.client,this.id.clock+this.length-1)}mergeWith(t){if(this.constructor===t.constructor&&mt(t.origin,this.lastId)&&this.right===t&&mt(this.rightOrigin,t.rightOrigin)&&this.id.client===t.id.client&&this.id.clock+this.length===t.id.clock&&this.deleted===t.deleted&&this.redone===null&&t.redone===null&&this.content.constructor===t.content.constructor&&this.content.mergeWith(t.content)){const e=this.parent._searchMarker;return e&&e.forEach(s=>{s.p===t&&(s.p=this,!this.deleted&&this.countable&&(s.index-=this.length))}),t.keep&&(this.keep=!0),this.right=t.right,this.right!==null&&(this.right.left=this),this.length+=t.length,!0}return!1}delete(t){if(!this.deleted){const e=this.parent;this.countable&&this.parentSub===null&&(e._length-=this.length),this.markDeleted(),bt(t.deleteSet,this.id.client,this.id.clock,this.length),bn(t,e,this.parentSub),this.content.delete(t)}}gc(t,e){if(!this.deleted)throw u.zR();this.content.gc(t),e?nr(t,this,new le(this.id,this.length)):this.content=new De(this.length)}write(t,e){const s=e>0?gt(this.id.client,this.id.clock+e-1):this.origin,o=this.rightOrigin,l=this.parentSub,p=this.content.getRef()&_.kr|(s===null?0:_.x1)|(o===null?0:_.rc)|(l===null?0:_.cq);if(t.writeInfo(p),s!==null&&t.writeLeftID(s),o!==null&&t.writeRightID(o),s===null&&o===null){const w=this.parent;if(w._item!==void 0){const D=w._item;if(D===null){const F=Yt(w);t.writeParentInfo(!0),t.writeString(F)}else t.writeParentInfo(!1),t.writeLeftID(D.id)}else w.constructor===String?(t.writeParentInfo(!0),t.writeString(w)):w.constructor===nt?(t.writeParentInfo(!1),t.writeLeftID(w)):u.zR();l!==null&&t.writeString(l)}this.content.write(t,e)}}const Jn=(i,t)=>Zr[t&_.kr](i),Zr=[()=>{u.zR()},Nr,Fr,Mr,Vr,Br,jr,Xr,Pr,xr,()=>{u.zR()}],qr=10;class oe extends cn{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,e){u.zR()}write(t,e){t.writeInfo(qr),N.uE(t.restEncoder,this.length-e)}getMissing(t,e){return null}}const Xn=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof J.g!="undefined"?J.g:{},Zn="__ $YJS$ __";Xn[Zn]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438"),Xn[Zn]=!0}}]);})();
