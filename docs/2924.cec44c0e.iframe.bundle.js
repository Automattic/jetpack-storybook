(()=>{(self.webpackChunk_automattic_jetpack_storybook=self.webpackChunk_automattic_jetpack_storybook||[]).push([[2924],{"../../../node_modules/.pnpm/@wordpress+compose@6.21.0_react@18.2.0/node_modules/@wordpress/compose/build-module/hooks/use-focusable-iframe/index.js":(Ft,kt,$)=>{"use strict";$.d(kt,{Z:()=>ct});var ft=$("../../../node_modules/.pnpm/@wordpress+compose@6.21.0_react@18.2.0/node_modules/@wordpress/compose/build-module/hooks/use-ref-effect/index.js");function ct(){return(0,ft.Z)(ut=>{const{ownerDocument:M}=ut;if(!M)return;const{defaultView:D}=M;if(!D)return;function y(){M&&M.activeElement===ut&&ut.focus()}return D.addEventListener("blur",y),()=>{D.removeEventListener("blur",y)}},[])}},"../../../node_modules/.pnpm/@wordpress+sync@0.6.0/node_modules/@wordpress/sync/build-module/connect-indexdb.js":(Ft,kt,$)=>{"use strict";$.d(kt,{D:()=>$t});var ft=$("../../../node_modules/.pnpm/yjs@13.6.8/node_modules/yjs/dist/yjs.mjs"),ct=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/promise.js"),ut=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/error.js");const M=st=>ct.Ue((et,lt)=>{st.onerror=yt=>lt(new Error(yt.target.error)),st.onsuccess=yt=>et(yt.target.result)}),D=(st,et)=>ct.Ue((lt,yt)=>{const _t=indexedDB.open(st);_t.onupgradeneeded=Rt=>et(Rt.target.result),_t.onerror=Rt=>yt(ut.Ue(Rt.target.error)),_t.onsuccess=Rt=>{const xt=Rt.target.result;xt.onversionchange=()=>{xt.close()},typeof addEventListener!="undefined"&&addEventListener("unload",()=>xt.close()),lt(xt)}}),y=st=>M(indexedDB.deleteDatabase(st)),g=(st,et)=>et.forEach(lt=>st.createObjectStore.apply(st,lt)),U=(st,et,lt="readwrite")=>{const yt=st.transaction(et,lt);return et.map(_t=>Y(yt,_t))},x=(st,et)=>M(st.count(et)),a=(st,et)=>M(st.get(et)),b=(st,et)=>M(st.delete(et)),h=(st,et,lt)=>M(st.put(et,lt)),d=(st,et,lt)=>M(st.add(et,lt)),T=(st,et)=>M(st.add(et)),R=(st,et,lt)=>M(st.getAll(et,lt)),S=(st,et,lt)=>M(st.getAllKeys(et,lt)),B=(st,et,lt)=>{let yt=null;return I(st,et,_t=>(yt=_t,!1),lt).then(()=>yt)},u=(st,et=null)=>B(st,et,"prev"),w=(st,et=null)=>B(st,et,"next"),m=(st,et,lt)=>promise.all([S(st,et,lt),R(st,et,lt)]).then(([yt,_t])=>yt.map((Rt,xt)=>({k:Rt,v:_t[xt]}))),E=(st,et)=>ct.Ue((lt,yt)=>{st.onerror=yt,st.onsuccess=async _t=>{const Rt=_t.target.result;if(Rt===null||await et(Rt)===!1)return lt();Rt.continue()}}),v=(st,et,lt,yt="next")=>E(st.openCursor(et,yt),_t=>lt(_t.value,_t.key)),I=(st,et,lt,yt="next")=>E(st.openKeyCursor(et,yt),_t=>lt(_t.key)),Y=(st,et)=>st.objectStore(et),N=(st,et,lt,yt)=>IDBKeyRange.bound(st,et,lt,yt),P=(st,et)=>IDBKeyRange.upperBound(st,et),q=(st,et)=>IDBKeyRange.lowerBound(st,et);var it=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/observable.js");const bt="custom",Et="updates",Tt=500,At=(st,et=()=>{},lt=()=>{})=>{const[yt]=U(st.db,[Et]);return R(yt,q(st._dbref,!1)).then(_t=>{st._destroyed||(et(yt),ft.ay(st.doc,()=>{_t.forEach(Rt=>ft.NG(st.doc,Rt))},st,!1),lt(yt))}).then(()=>u(yt).then(_t=>{st._dbref=_t+1})).then(()=>x(yt).then(_t=>{st._dbsize=_t})).then(()=>yt)},Ut=(st,et=!0)=>At(st).then(lt=>{(et||st._dbsize>=Tt)&&T(lt,ft.D$(st.doc)).then(()=>b(lt,P(st._dbref,!0))).then(()=>x(lt).then(yt=>{st._dbsize=yt}))}),wt=st=>idb.deleteDB(st);class Jt extends it.y{constructor(et,lt){super(),this.doc=lt,this.name=et,this._dbref=0,this._dbsize=0,this._destroyed=!1,this.db=null,this.synced=!1,this._db=D(et,yt=>g(yt,[["updates",{autoIncrement:!0}],["custom"]])),this.whenSynced=ct.Ue(yt=>this.on("synced",()=>yt(this))),this._db.then(yt=>{this.db=yt,At(this,xt=>T(xt,ft.D$(lt)),()=>{if(this._destroyed)return this;this.synced=!0,this.emit("synced",[this])})}),this._storeTimeout=1e3,this._storeTimeoutId=null,this._storeUpdate=(yt,_t)=>{if(this.db&&_t!==this){const[Rt]=U(this.db,[Et]);T(Rt,yt),++this._dbsize>=Tt&&(this._storeTimeoutId!==null&&clearTimeout(this._storeTimeoutId),this._storeTimeoutId=setTimeout(()=>{Ut(this,!1),this._storeTimeoutId=null},this._storeTimeout))}},lt.on("update",this._storeUpdate),this.destroy=this.destroy.bind(this),lt.on("destroy",this.destroy)}destroy(){return this._storeTimeoutId&&clearTimeout(this._storeTimeoutId),this.doc.off("update",this._storeUpdate),this.doc.off("destroy",this.destroy),this._destroyed=!0,this._db.then(et=>{et.close()})}clearData(){return this.destroy().then(()=>{y(this.name)})}get(et){return this._db.then(lt=>{const[yt]=U(lt,[bt],"readonly");return a(yt,et)})}set(et,lt){return this._db.then(yt=>{const[_t]=U(yt,[bt]);return h(_t,lt,et)})}del(et){return this._db.then(lt=>{const[yt]=U(lt,[bt]);return b(yt,et)})}}function $t(st,et,lt){const yt=`${et}-${st}`,_t=new Jt(yt,lt);return new Promise(Rt=>{_t.on("synced",()=>{Rt(()=>_t.destroy())})})}},"../../../node_modules/.pnpm/@wordpress+sync@0.6.0/node_modules/@wordpress/sync/build-module/connect-webrtc.js":(Ft,kt,$)=>{"use strict";$.d(kt,{o:()=>hn});var ft=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/observable.js"),ct=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/time.js"),ut=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/math.js");const M=1200,D=2500,y=3e4,g=H=>{if(H.shouldConnect&&H.ws===null){const J=new WebSocket(H.url),Z=H.binaryType;let ht=null;Z&&(J.binaryType=Z),H.ws=J,H.connecting=!0,H.connected=!1,J.onmessage=St=>{H.lastMessageReceived=ct.ZG();const Mt=St.data,Nt=typeof Mt=="string"?JSON.parse(Mt):Mt;Nt&&Nt.type==="pong"&&(clearTimeout(ht),ht=setTimeout(vt,y/2)),H.emit("message",[Nt,H])};const dt=St=>{H.ws!==null&&(H.ws=null,H.connecting=!1,H.connected?(H.connected=!1,H.emit("disconnect",[{type:"disconnect",error:St},H])):H.unsuccessfulReconnects++,setTimeout(g,ut.VV(ut.mv(H.unsuccessfulReconnects+1)*M,D),H)),clearTimeout(ht)},vt=()=>{H.ws===J&&H.send({type:"ping"})};J.onclose=()=>dt(null),J.onerror=St=>dt(St),J.onopen=()=>{H.lastMessageReceived=ct.ZG(),H.connecting=!1,H.connected=!0,H.unsuccessfulReconnects=0,H.emit("connect",[{type:"connect"},H]),ht=setTimeout(vt,y/2)}}};class U extends ft.y{constructor(J,{binaryType:Z}={}){super(),this.url=J,this.ws=null,this.binaryType=Z||null,this.connected=!1,this.connecting=!1,this.unsuccessfulReconnects=0,this.lastMessageReceived=0,this.shouldConnect=!0,this._checkInterval=setInterval(()=>{this.connected&&y<ct.ZG()-this.lastMessageReceived&&this.ws.close()},y/2),g(this)}send(J){this.ws&&this.ws.send(JSON.stringify(J))}destroy(){clearInterval(this._checkInterval),this.disconnect(),super.destroy()}disconnect(){this.shouldConnect=!1,this.ws!==null&&this.ws.close()}connect(){this.shouldConnect=!0,!this.connected&&this.ws===null&&g(this)}}var x=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/map.js"),a=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/error.js"),b=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/random.js"),h=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/encoding.js"),d=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/decoding.js"),T=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/logging.js"),R=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/logging.common.js"),S=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/promise.js"),B=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/set.js"),u=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/buffer.js"),w=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/storage.js");const m=new Map;class E{constructor(J){this.room=J,this.onmessage=null,this._onChange=Z=>Z.key===J&&this.onmessage!==null&&this.onmessage({data:u.Gh(Z.newValue||"")}),w.z2(this._onChange)}postMessage(J){w.XN.setItem(this.room,u.s3(u.eh(J)))}close(){w.F(this._onChange)}}const v=typeof BroadcastChannel=="undefined"?E:BroadcastChannel,I=H=>x.Yu(m,H,()=>{const J=B.Ue(),Z=new v(H);return Z.onmessage=ht=>J.forEach(dt=>dt(ht.data,"broadcastchannel")),{bc:Z,subs:J}}),Y=(H,J)=>(I(H).subs.add(J),J),N=(H,J)=>{const Z=I(H),ht=Z.subs.delete(J);return ht&&Z.subs.size===0&&(Z.bc.close(),m.delete(H)),ht},P=(H,J,Z=null)=>{const ht=I(H);ht.bc.postMessage(J),ht.subs.forEach(dt=>dt(J,Z))},q=()=>{let H=!0;return(J,Z)=>{if(H){H=!1;try{J()}finally{H=!0}}else Z!==void 0&&Z()}};var it=$("../../../node_modules/.pnpm/simple-peer@9.11.1/node_modules/simple-peer/simplepeer.min.js"),bt=$.n(it),Et=$("../../../node_modules/.pnpm/yjs@13.6.8/node_modules/yjs/dist/yjs.mjs");const Tt=0,At=1,Ut=2,wt=(H,J)=>{h.uE(H,Tt);const Z=Et.gJ(J);h.mP(H,Z)},Jt=(H,J,Z)=>{h.uE(H,At),h.mP(H,Et.D$(J,Z))},$t=(H,J,Z)=>Jt(J,Z,d.HN(H)),st=(H,J,Z)=>{try{Et.NG(J,d.HN(H),Z)}catch(ht){console.error("Caught error while handling a Yjs update",ht)}},et=(H,J)=>{h.uE(H,Ut),h.mP(H,J)},lt=st,yt=(H,J,Z,ht)=>{const dt=d.yg(H);switch(dt){case Tt:$t(H,J,Z);break;case At:st(H,Z,ht);break;case Ut:lt(H,Z,ht);break;default:throw new Error("Unknown message type")}return dt};var _t=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/function.js");const Rt=3e4;class xt extends ft.y{constructor(J){super(),this.doc=J,this.clientID=J.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{const Z=ct.ZG();this.getLocalState()!==null&&Rt/2<=Z-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const ht=[];this.meta.forEach((dt,vt)=>{vt!==this.clientID&&Rt<=Z-dt.lastUpdated&&this.states.has(vt)&&ht.push(vt)}),ht.length>0&&Xt(this,ht,"timeout")},ut.GW(Rt/10)),J.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(J){const Z=this.clientID,ht=this.meta.get(Z),dt=ht===void 0?0:ht.clock+1,vt=this.states.get(Z);J===null?this.states.delete(Z):this.states.set(Z,J),this.meta.set(Z,{clock:dt,lastUpdated:ct.ZG()});const St=[],Mt=[],Nt=[],Ht=[];J===null?Ht.push(Z):vt==null?J!=null&&St.push(Z):(Mt.push(Z),_t.Hi(vt,J)||Nt.push(Z)),(St.length>0||Nt.length>0||Ht.length>0)&&this.emit("change",[{added:St,updated:Nt,removed:Ht},"local"]),this.emit("update",[{added:St,updated:Mt,removed:Ht},"local"])}setLocalStateField(J,Z){const ht=this.getLocalState();ht!==null&&this.setLocalState({...ht,[J]:Z})}getStates(){return this.states}}const Xt=(H,J,Z)=>{const ht=[];for(let dt=0;dt<J.length;dt++){const vt=J[dt];if(H.states.has(vt)){if(H.states.delete(vt),vt===H.clientID){const St=H.meta.get(vt);H.meta.set(vt,{clock:St.clock+1,lastUpdated:ct.ZG()})}ht.push(vt)}}ht.length>0&&(H.emit("change",[{added:[],updated:[],removed:ht},Z]),H.emit("update",[{added:[],updated:[],removed:ht},Z]))},Pt=(H,J,Z=H.states)=>{const ht=J.length,dt=h.Mf();h.uE(dt,ht);for(let vt=0;vt<ht;vt++){const St=J[vt],Mt=Z.get(St)||null,Nt=H.meta.get(St).clock;h.uE(dt,St),h.uE(dt,Nt),h.uw(dt,JSON.stringify(Mt))}return h._f(dt)},ee=(H,J)=>{const Z=decoding.createDecoder(H),ht=encoding.createEncoder(),dt=decoding.readVarUint(Z);encoding.writeVarUint(ht,dt);for(let vt=0;vt<dt;vt++){const St=decoding.readVarUint(Z),Mt=decoding.readVarUint(Z),Nt=JSON.parse(decoding.readVarString(Z)),Ht=J(Nt);encoding.writeVarUint(ht,St),encoding.writeVarUint(ht,Mt),encoding.writeVarString(ht,JSON.stringify(Ht))}return encoding.toUint8Array(ht)},te=(H,J,Z)=>{const ht=d.l1(J),dt=ct.ZG(),vt=[],St=[],Mt=[],Nt=[],Ht=d.yg(ht);for(let Qt=0;Qt<Ht;Qt++){const re=d.yg(ht);let fe=d.yg(ht);const de=JSON.parse(d.kf(ht)),Ie=H.meta.get(re),Je=H.states.get(re),Xe=Ie===void 0?0:Ie.clock;(Xe<fe||Xe===fe&&de===null&&H.states.has(re))&&(de===null?re===H.clientID&&H.getLocalState()!=null?fe++:H.states.delete(re):H.states.set(re,de),H.meta.set(re,{clock:fe,lastUpdated:dt}),Ie===void 0&&de!==null?vt.push(re):Ie!==void 0&&de===null?Nt.push(re):de!==null&&(_t.Hi(de,Je)||Mt.push(re),St.push(re)))}(vt.length>0||Mt.length>0||Nt.length>0)&&H.emit("change",[{added:vt,updated:Mt,removed:Nt},Z]),(vt.length>0||St.length>0||Nt.length>0)&&H.emit("update",[{added:vt,updated:St,removed:Nt},Z])};var W=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/string.js");const ot=(H,J)=>{const Z=W.lz(H).buffer,ht=W.lz(J).buffer;return crypto.subtle.importKey("raw",Z,"PBKDF2",!1,["deriveKey"]).then(dt=>crypto.subtle.deriveKey({name:"PBKDF2",salt:ht,iterations:1e5,hash:"SHA-256"},dt,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]))},O=(H,J)=>{if(!J)return S.DB(H);const Z=crypto.getRandomValues(new Uint8Array(12));return crypto.subtle.encrypt({name:"AES-GCM",iv:Z},J,H).then(ht=>{const dt=h.Mf();return h.uw(dt,"AES-GCM"),h.mP(dt,Z),h.mP(dt,new Uint8Array(ht)),h._f(dt)})},G=(H,J)=>{const Z=h.Mf();return h.EM(Z,H),O(h._f(Z),J)},C=(H,J)=>{if(!J)return S.DB(H);const Z=d.l1(H);d.kf(Z)!=="AES-GCM"&&S.d1(a.Ue("Unknown encryption algorithm"));const dt=d.HN(Z),vt=d.HN(Z);return crypto.subtle.decrypt({name:"AES-GCM",iv:dt},J,vt).then(St=>new Uint8Array(St))},L=(H,J)=>C(H,J).then(Z=>d.v_(d.l1(new Uint8Array(Z))));var rt=$("../../../node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js");const n=T.YX("y-webrtc"),r=0,c=3,k=1,K=4,z=new Map,at=new Map,Ct=H=>{let J=!0;H.webrtcConns.forEach(Z=>{Z.synced||(J=!1)}),(!J&&H.synced||J&&!H.synced)&&(H.synced=J,H.provider.emit("synced",[{synced:J}]),n("synced ",R.Pl,H.name,R.YW," with all peers"))},Bt=(H,J,Z)=>{const ht=d.l1(J),dt=h.Mf(),vt=d.yg(ht);if(H===void 0)return null;const St=H.awareness,Mt=H.doc;let Nt=!1;switch(vt){case r:{h.uE(dt,r);const Ht=yt(ht,dt,Mt,H);Ht===At&&!H.synced&&Z(),Ht===Tt&&(Nt=!0);break}case c:h.uE(dt,k),h.mP(dt,Pt(St,Array.from(St.getStates().keys()))),Nt=!0;break;case k:te(St,d.HN(ht),H);break;case K:{const Ht=d.kj(ht)===1,Qt=d.kf(ht);if(Qt!==H.peerId&&(H.bcConns.has(Qt)&&!Ht||!H.bcConns.has(Qt)&&Ht)){const re=[],fe=[];Ht?(H.bcConns.add(Qt),fe.push(Qt)):(H.bcConns.delete(Qt),re.push(Qt)),H.provider.emit("peers",[{added:fe,removed:re,webrtcPeers:Array.from(H.webrtcConns.keys()),bcPeers:Array.from(H.bcConns)}]),gt(H)}break}default:return console.error("Unable to compute message"),dt}return Nt?dt:null},Ot=(H,J)=>{const Z=H.room;return n("received message from ",R.Pl,H.remotePeerId,R.s7," (",Z.name,")",R.YW,R.WO),Bt(Z,J,()=>{H.synced=!0,n("synced ",R.Pl,Z.name,R.YW," with ",R.Pl,H.remotePeerId),Ct(Z)})},Dt=(H,J)=>{n("send message to ",R.Pl,H.remotePeerId,R.YW,R.s7," (",H.room.name,")",R.WO);try{H.peer.send(h._f(J))}catch(Z){}},Lt=(H,J)=>{n("broadcast message in ",R.Pl,H.name,R.YW),H.webrtcConns.forEach(Z=>{try{Z.peer.send(J)}catch(ht){}})};class ie{constructor(J,Z,ht,dt){n("establishing connection to ",R.Pl,ht),this.room=dt,this.remotePeerId=ht,this.closed=!1,this.connected=!1,this.synced=!1,this.peer=new(bt())({initiator:Z,...dt.provider.peerOpts}),this.peer.on("signal",vt=>{Yt(J,dt,{to:ht,from:dt.peerId,type:"signal",signal:vt})}),this.peer.on("connect",()=>{n("connected to ",R.Pl,ht),this.connected=!0;const St=dt.provider.doc,Mt=dt.awareness,Nt=h.Mf();h.uE(Nt,r),wt(Nt,St),Dt(this,Nt);const Ht=Mt.getStates();if(Ht.size>0){const Qt=h.Mf();h.uE(Qt,k),h.mP(Qt,Pt(Mt,Array.from(Ht.keys()))),Dt(this,Qt)}}),this.peer.on("close",()=>{this.connected=!1,this.closed=!0,dt.webrtcConns.has(this.remotePeerId)&&(dt.webrtcConns.delete(this.remotePeerId),dt.provider.emit("peers",[{removed:[this.remotePeerId],added:[],webrtcPeers:Array.from(dt.webrtcConns.keys()),bcPeers:Array.from(dt.bcConns)}])),Ct(dt),this.peer.destroy(),n("closed connection to ",R.Pl,ht),mt(dt)}),this.peer.on("error",vt=>{n("Error in connection to ",R.Pl,ht,": ",vt),mt(dt)}),this.peer.on("data",vt=>{const St=Ot(this,vt);St!==null&&Dt(this,St)})}destroy(){this.peer.destroy()}}const X=(H,J)=>O(J,H.key).then(Z=>H.mux(()=>P(H.name,Z))),nt=(H,J)=>{H.bcconnected&&X(H,J),Lt(H,J)},mt=H=>{z.forEach(J=>{J.connected&&(J.send({type:"subscribe",topics:[H.name]}),H.webrtcConns.size<H.provider.maxConns&&Yt(J,H,{type:"announce",from:H.peerId}))})},gt=H=>{if(H.provider.filterBcConns){const J=h.Mf();h.uE(J,K),h.$F(J,1),h.uw(J,H.peerId),X(H,h._f(J))}};class jt{constructor(J,Z,ht,dt){this.peerId=b.k$(),this.doc=J,this.awareness=Z.awareness,this.provider=Z,this.synced=!1,this.name=ht,this.key=dt,this.webrtcConns=new Map,this.bcConns=new Set,this.mux=q(),this.bcconnected=!1,this._bcSubscriber=vt=>C(new Uint8Array(vt),dt).then(St=>this.mux(()=>{const Mt=Bt(this,St,()=>{});Mt&&X(this,h._f(Mt))})),this._docUpdateHandler=(vt,St)=>{const Mt=h.Mf();h.uE(Mt,r),et(Mt,vt),nt(this,h._f(Mt))},this._awarenessUpdateHandler=({added:vt,updated:St,removed:Mt},Nt)=>{const Ht=vt.concat(St).concat(Mt),Qt=h.Mf();h.uE(Qt,k),h.mP(Qt,Pt(this.awareness,Ht)),nt(this,h._f(Qt))},this._beforeUnloadHandler=()=>{Xt(this.awareness,[J.clientID],"window unload"),at.forEach(vt=>{vt.disconnect()})},typeof window!="undefined"?window.addEventListener("beforeunload",this._beforeUnloadHandler):typeof rt!="undefined"&&rt.on("exit",this._beforeUnloadHandler)}connect(){this.doc.on("update",this._docUpdateHandler),this.awareness.on("update",this._awarenessUpdateHandler),mt(this);const J=this.name;Y(J,this._bcSubscriber),this.bcconnected=!0,gt(this);const Z=h.Mf();h.uE(Z,r),wt(Z,this.doc),X(this,h._f(Z));const ht=h.Mf();h.uE(ht,r),Jt(ht,this.doc),X(this,h._f(ht));const dt=h.Mf();h.uE(dt,c),X(this,h._f(dt));const vt=h.Mf();h.uE(vt,k),h.mP(vt,Pt(this.awareness,[this.doc.clientID])),X(this,h._f(vt))}disconnect(){z.forEach(Z=>{Z.connected&&Z.send({type:"unsubscribe",topics:[this.name]})}),Xt(this.awareness,[this.doc.clientID],"disconnect");const J=h.Mf();h.uE(J,K),h.$F(J,0),h.uw(J,this.peerId),X(this,h._f(J)),N(this.name,this._bcSubscriber),this.bcconnected=!1,this.doc.off("update",this._docUpdateHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.webrtcConns.forEach(Z=>Z.destroy())}destroy(){this.disconnect(),typeof window!="undefined"?window.removeEventListener("beforeunload",this._beforeUnloadHandler):typeof rt!="undefined"&&rt.off("exit",this._beforeUnloadHandler)}}const Zt=(H,J,Z,ht)=>{if(at.has(Z))throw a.Ue(`A Yjs Doc connected to room "${Z}" already exists!`);const dt=new jt(H,J,Z,ht);return at.set(Z,dt),dt},Yt=(H,J,Z)=>{J.key?G(Z,J.key).then(ht=>{H.send({type:"publish",topic:J.name,data:u.s3(ht)})}):H.send({type:"publish",topic:J.name,data:Z})};class ce extends U{constructor(J){super(J),this.providers=new Set,this.on("connect",()=>{n(`connected (${J})`);const Z=Array.from(at.keys());this.send({type:"subscribe",topics:Z}),at.forEach(ht=>Yt(this,ht,{type:"announce",from:ht.peerId}))}),this.on("message",Z=>{switch(Z.type){case"publish":{const ht=Z.topic,dt=at.get(ht);if(dt==null||typeof ht!="string")return;const vt=St=>{const Mt=dt.webrtcConns,Nt=dt.peerId;if(St==null||St.from===Nt||St.to!==void 0&&St.to!==Nt||dt.bcConns.has(St.from))return;const Ht=Mt.has(St.from)?()=>{}:()=>dt.provider.emit("peers",[{removed:[],added:[St.from],webrtcPeers:Array.from(dt.webrtcConns.keys()),bcPeers:Array.from(dt.bcConns)}]);switch(St.type){case"announce":Mt.size<dt.provider.maxConns&&(x.Yu(Mt,St.from,()=>new ie(this,!0,St.from,dt)),Ht());break;case"signal":St.to===Nt&&(x.Yu(Mt,St.from,()=>new ie(this,!1,St.from,dt)).peer.signal(St.signal),Ht());break}};dt.key?typeof Z.data=="string"&&L(u.Gh(Z.data),dt.key).then(vt):vt(Z.data)}}}),this.on("disconnect",()=>n(`disconnect (${J})`))}}class Se extends ft.y{constructor(J,Z,{signaling:ht=["wss://y-webrtc-eu.fly.dev"],password:dt=null,awareness:vt=new xt(Z),maxConns:St=20+ut.GW(b.TN()*15),filterBcConns:Mt=!0,peerOpts:Nt={}}={}){super(),this.roomName=J,this.doc=Z,this.filterBcConns=Mt,this.awareness=vt,this.shouldConnect=!1,this.signalingUrls=ht,this.signalingConns=[],this.maxConns=St,this.peerOpts=Nt,this.key=dt?ot(dt,J):S.DB(null),this.room=null,this.key.then(Ht=>{this.room=Zt(Z,this,J,Ht),this.shouldConnect?this.room.connect():this.room.disconnect()}),this.connect(),this.destroy=this.destroy.bind(this),Z.on("destroy",this.destroy)}get connected(){return this.room!==null&&this.shouldConnect}connect(){this.shouldConnect=!0,this.signalingUrls.forEach(J=>{const Z=x.Yu(z,J,()=>new ce(J));this.signalingConns.push(Z),Z.providers.add(this)}),this.room&&this.room.connect()}disconnect(){this.shouldConnect=!1,this.signalingConns.forEach(J=>{J.providers.delete(this),J.providers.size===0&&(J.destroy(),z.delete(J.url))}),this.room&&this.room.disconnect()}destroy(){this.doc.off("destroy",this.destroy),this.key.then(()=>{this.room.destroy(),at.delete(this.roomName)}),super.destroy()}}function hn(H,J,Z){const ht=`${J}-${H}`;return new Se(ht,Z,{password:window.__experimentalCollaborativeEditingSecret}),Promise.resolve(()=>!0)}},"../../../node_modules/.pnpm/@wordpress+sync@0.6.0/node_modules/@wordpress/sync/build-module/provider.js":(Ft,kt,$)=>{"use strict";$.d(kt,{G:()=>ct});var ft=$("../../../node_modules/.pnpm/yjs@13.6.8/node_modules/yjs/dist/yjs.mjs");const ct=(ut,M)=>{const D={},y={},g={};function U(h,d){D[h]=d}async function x(h,d,T){const R=new ft.QW;g[h]=g[h]||{},g[h][d]=R;const S=()=>{const w=D[h].fromCRDTDoc(R);T(w)};R.on("update",S);const B=await ut(d,h,R);M&&await M(d,h,R);const u=D[h].fetch;u&&u(d).then(w=>{R.transact(()=>{D[h].applyChangesToDoc(R,w)})}),y[h]=y[h]||{},y[h][d]=()=>{B(),R.off("update",S)}}async function a(h,d,T){const R=g[h][d];if(!R)throw"Error doc "+h+" "+d+" not found";R.transact(()=>{D[h].applyChangesToDoc(R,T)})}async function b(h,d){var T;(T=y==null?void 0:y[h])!=null&&T[d]&&y[h][d]()}return{register:U,bootstrap:x,update:a,discard:b}}},"../../../node_modules/.pnpm/@wordpress+undo-manager@0.4.0/node_modules/@wordpress/undo-manager/build-module/index.js":(Ft,kt,$)=>{"use strict";$.d(kt,{U:()=>M});var ft=$("../../../node_modules/.pnpm/@wordpress+is-shallow-equal@4.44.0/node_modules/@wordpress/is-shallow-equal/build-module/index.js");function ct(D,y){const g={...D};return Object.entries(y).forEach(([U,x])=>{g[U]?g[U]={...g[U],to:x.to}:g[U]=x}),g}const ut=(D,y)=>{const g=D==null?void 0:D.findIndex(({id:x})=>typeof x=="string"?x===y.id:(0,ft.ZP)(x,y.id)),U=[...D];return g!==-1?U[g]={id:y.id,changes:ct(U[g].changes,y.changes)}:U.push(y),U};function M(){let D=[],y=[],g=0;const U=()=>{D=D.slice(0,g||void 0),g=0},x=()=>{var b;const h=D.length===0?0:D.length-1;let d=(b=D[h])!==null&&b!==void 0?b:[];y.forEach(T=>{d=ut(d,T)}),y=[],D[h]=d},a=b=>!b.filter(({changes:d})=>Object.values(d).some(({from:T,to:R})=>typeof T!="function"&&typeof R!="function"&&!(0,ft.ZP)(T,R))).length;return{addRecord(b,h=!1){const d=!b||a(b);if(h){if(d)return;b.forEach(T=>{y=ut(y,T)})}else{if(U(),y.length&&x(),d)return;D.push(b)}},undo(){y.length&&(U(),x());const b=D[D.length-1+g];if(b)return g-=1,b},redo(){const b=D[D.length+g];if(b)return g+=1,b},hasUndo(){return!!D[D.length-1+g]},hasRedo(){return!!D[D.length+g]}}}},"../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/array.js":(Ft,kt,$)=>{"use strict";$.d(kt,{Dp:()=>D,Z$:()=>ft,kJ:()=>h,s7:()=>M});const ft=S=>S[S.length-1],ct=()=>[],ut=S=>S.slice(),M=(S,B)=>{for(let u=0;u<B.length;u++)S.push(B[u])},D=Array.from,y=(S,B)=>{for(let u=0;u<S.length;u++)if(!B(S[u],u,S))return!1;return!0},g=(S,B)=>{for(let u=0;u<S.length;u++)if(B(S[u],u,S))return!0;return!1},U=(S,B)=>S.length===B.length&&y(S,(u,w)=>u===B[w]),x=S=>b(S,[],(B,u)=>B.concat(u)),a=(S,B)=>{const u=new Array(S);for(let w=0;w<S;w++)u[w]=B(w,u);return u},b=(S,B,u)=>S.reduce(u,B),h=Array.isArray,d=S=>D(set.from(S)),T=(S,B)=>{const u=set.create(),w=[];for(let m=0;m<S.length;m++){const E=S[m],v=B(E);u.has(v)||(u.add(v),w.push(E))}return w},R=(S,B)=>{const u=Array(S.length);for(let w=0;w<S.length;w++)u[w]=B(S[w],w,S);return u}},"../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/binary.js":(Ft,kt,$)=>{"use strict";$.d(kt,{$2:()=>lt,CY:()=>ut,Ko:()=>M,Qn:()=>ct,RP:()=>Ot,Tg:()=>Dt,Vw:()=>ft,cq:()=>y,jS:()=>yt,kr:()=>et,rc:()=>g,x1:()=>U});const ft=1,ct=2,ut=4,M=8,D=16,y=32,g=64,U=128,x=256,a=512,b=1024,h=2048,d=4096,T=8192,R=16384,S=32768,B=65536,u=1<<17,w=1<<18,m=1<<19,E=1<<20,v=1<<21,I=1<<22,Y=1<<23,N=1<<24,P=1<<25,q=1<<26,it=1<<27,bt=1<<28,Et=1<<29,Tt=1<<30,At=null,Ut=0,wt=1,Jt=3,$t=7,st=15,et=31,lt=63,yt=127,_t=255,Rt=511,xt=1023,Xt=2047,Pt=4095,ee=8191,te=16383,W=32767,ot=65535,O=u-1,G=w-1,C=m-1,L=E-1,rt=v-1,n=I-1,r=Y-1,c=N-1,k=P-1,K=q-1,z=it-1,at=bt-1,Ct=Et-1,Bt=Tt-1,Ot=2147483647,Dt=4294967295},"../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/buffer.js":(Ft,kt,$)=>{"use strict";$.d(kt,{Gh:()=>b,Te:()=>M,eh:()=>D,f9:()=>S,s3:()=>a});var ft=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/string.js"),ct=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/environment.js");const ut=m=>new Uint8Array(m),M=(m,E,v)=>new Uint8Array(m,E,v),D=m=>new Uint8Array(m),y=m=>{let E="";for(let v=0;v<m.byteLength;v++)E+=ft.IK(m[v]);return btoa(E)},g=m=>Buffer.from(m.buffer,m.byteOffset,m.byteLength).toString("base64"),U=m=>{const E=atob(m),v=ut(E.length);for(let I=0;I<E.length;I++)v[I]=E.charCodeAt(I);return v},x=m=>{const E=Buffer.from(m,"base64");return new Uint8Array(E.buffer,E.byteOffset,E.byteLength)},a=ct.jU?y:g,b=ct.jU?U:x,h=m=>a(m).replaceAll("+","-").replaceAll("/","_").replaceAll("=",""),d=m=>b(m.replaceAll("-","+").replaceAll("_","/")),T=m=>array.map(m,E=>E.toString(16).padStart(2,"0")).join(""),R=m=>{const E=m.length,v=new Uint8Array(math.ceil(E/2));for(let I=0;I<E;I+=2)v[v.length-I/2-1]=Number.parseInt(m.slice(E-I-2,E-I),16);return v},S=m=>{const E=ut(m.byteLength);return E.set(m),E},B=m=>{const E=encoding.createEncoder();return encoding.writeAny(E,m),encoding.toUint8Array(E)},u=m=>decoding.readAny(decoding.createDecoder(m)),w=(m,E)=>{if(E===0)return m;m=new Uint8Array(m),m[0]<<=E;for(let v=1;v<m.length;v++)m[v-1]|=m[v]>>>8-E,m[v]<<=E;return m}},"../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/decoding.js":(Ft,kt,$)=>{"use strict";$.d(kt,{HN:()=>T,UF:()=>Xt,XW:()=>_t,dD:()=>ee,kf:()=>Et,kj:()=>B,l1:()=>a,sO:()=>te,v_:()=>yt,yg:()=>Y});var ft=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/buffer.js"),ct=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/binary.js"),ut=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/math.js"),M=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/number.js"),D=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/string.js"),y=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/error.js");const g=y.Ue("Unexpected end of array"),U=y.Ue("Integer out of Range");class x{constructor(ot){this.arr=ot,this.pos=0}}const a=W=>new x(W),b=W=>W.pos!==W.arr.length,h=(W,ot=W.pos)=>{const O=a(W.arr);return O.pos=ot,O},d=(W,ot)=>{const O=ft.Te(W.arr.buffer,W.pos+W.arr.byteOffset,ot);return W.pos+=ot,O},T=W=>d(W,Y(W)),R=W=>d(W,W.arr.length-W.pos),S=W=>W.pos++,B=W=>W.arr[W.pos++],u=W=>{const ot=W.arr[W.pos]+(W.arr[W.pos+1]<<8);return W.pos+=2,ot},w=W=>{const ot=W.arr[W.pos]+(W.arr[W.pos+1]<<8)+(W.arr[W.pos+2]<<16)+(W.arr[W.pos+3]<<24)>>>0;return W.pos+=4,ot},m=W=>{const ot=W.arr[W.pos+3]+(W.arr[W.pos+2]<<8)+(W.arr[W.pos+1]<<16)+(W.arr[W.pos]<<24)>>>0;return W.pos+=4,ot},E=W=>W.arr[W.pos],v=W=>W.arr[W.pos]+(W.arr[W.pos+1]<<8),I=W=>W.arr[W.pos]+(W.arr[W.pos+1]<<8)+(W.arr[W.pos+2]<<16)+(W.arr[W.pos+3]<<24)>>>0,Y=W=>{let ot=0,O=1;const G=W.arr.length;for(;W.pos<G;){const C=W.arr[W.pos++];if(ot=ot+(C&ct.jS)*O,O*=128,C<ct.x1)return ot;if(ot>M.YM)throw U}throw g},N=W=>{let ot=W.arr[W.pos++],O=ot&ct.$2,G=64;const C=(ot&ct.rc)>0?-1:1;if(!(ot&ct.x1))return C*O;const L=W.arr.length;for(;W.pos<L;){if(ot=W.arr[W.pos++],O=O+(ot&ct.jS)*G,G*=128,ot<ct.x1)return C*O;if(O>M.YM)throw U}throw g},P=W=>{const ot=W.pos,O=Y(W);return W.pos=ot,O},q=W=>{const ot=W.pos,O=N(W);return W.pos=ot,O},it=W=>{let ot=Y(W);if(ot===0)return"";{let O=String.fromCodePoint(B(W));if(--ot<100)for(;ot--;)O+=String.fromCodePoint(B(W));else for(;ot>0;){const G=ot<1e4?ot:1e4,C=W.arr.subarray(W.pos,W.pos+G);W.pos+=G,O+=String.fromCodePoint.apply(null,C),ot-=G}return decodeURIComponent(escape(O))}},bt=W=>D.CO.decode(T(W)),Et=D.CO?bt:it,Tt=W=>{const ot=encoding.createEncoder();let O;for(;;){if(O=B(W),O===0)return encoding.toUint8Array(ot);O===1&&(O=B(W)),encoding.write(ot,O)}},At=W=>string.decodeUtf8(Tt(W)),Ut=W=>{const ot=W.pos,O=Et(W);return W.pos=ot,O},wt=(W,ot)=>{const O=new DataView(W.arr.buffer,W.arr.byteOffset+W.pos,ot);return W.pos+=ot,O},Jt=W=>wt(W,4).getFloat32(0,!1),$t=W=>wt(W,8).getFloat64(0,!1),st=W=>wt(W,8).getBigInt64(0,!1),et=W=>wt(W,8).getBigUint64(0,!1),lt=[W=>{},W=>null,N,Jt,$t,st,W=>!1,W=>!0,Et,W=>{const ot=Y(W),O={};for(let G=0;G<ot;G++){const C=Et(W);O[C]=yt(W)}return O},W=>{const ot=Y(W),O=[];for(let G=0;G<ot;G++)O.push(yt(W));return O},T],yt=W=>lt[127-B(W)](W);class _t extends x{constructor(ot,O){super(ot),this.reader=O,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),b(this)?this.count=Y(this)+1:this.count=-1),this.count--,this.s}}class Rt extends null{constructor(ot,O){super(ot),this.s=O}read(){return this.s+=N(this),this.s}}class xt extends null{constructor(ot,O){super(ot),this.s=O,this.count=0}read(){return this.count===0&&(this.s+=N(this),b(this)?this.count=Y(this)+1:this.count=-1),this.count--,this.s}}class Xt extends x{constructor(ot){super(ot),this.s=0,this.count=0}read(){if(this.count===0){this.s=N(this);const ot=ut.GR(this.s);this.count=1,ot&&(this.s=-this.s,this.count=Y(this)+2)}return this.count--,this.s}}class Pt extends null{constructor(ot){super(ot),this.s=0,this.count=0}read(){if(this.count===0){this.s=N(this);const ot=math.isNegativeZero(this.s);this.count=1,ot&&(this.s=-this.s,this.count=Y(this)+2)}return this.count--,this.s++}}class ee extends x{constructor(ot){super(ot),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const ot=N(this),O=ot&1;this.diff=ut.GW(ot/2),this.count=1,O&&(this.count=Y(this)+2)}return this.s+=this.diff,this.count--,this.s}}class te{constructor(ot){this.decoder=new Xt(ot),this.str=Et(this.decoder),this.spos=0}read(){const ot=this.spos+this.decoder.read(),O=this.str.slice(this.spos,ot);return this.spos=ot,O}}},"../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/encoding.js":(Ft,kt,$)=>{"use strict";$.d(kt,{$F:()=>S,EM:()=>Rt,GF:()=>xt,HE:()=>te,HK:()=>Ut,Mf:()=>U,TS:()=>G,_f:()=>h,mP:()=>wt,sX:()=>O,uE:()=>I,uw:()=>bt});var ft=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/buffer.js"),ct=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/math.js"),ut=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/number.js"),M=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/binary.js"),D=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/string.js"),y=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/array.js");class g{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const U=()=>new g,x=C=>{const L=U();return C(L),h(L)},a=C=>{let L=C.cpos;for(let rt=0;rt<C.bufs.length;rt++)L+=C.bufs[rt].length;return L},b=C=>C.cpos>0||C.bufs.length>0,h=C=>{const L=new Uint8Array(a(C));let rt=0;for(let n=0;n<C.bufs.length;n++){const r=C.bufs[n];L.set(r,rt),rt+=r.length}return L.set(ft.Te(C.cbuf.buffer,0,C.cpos),rt),L},d=(C,L)=>{const rt=C.cbuf.length;rt-C.cpos<L&&(C.bufs.push(ft.Te(C.cbuf.buffer,0,C.cpos)),C.cbuf=new Uint8Array(ct.Fp(rt,L)*2),C.cpos=0)},T=(C,L)=>{const rt=C.cbuf.length;C.cpos===rt&&(C.bufs.push(C.cbuf),C.cbuf=new Uint8Array(rt*2),C.cpos=0),C.cbuf[C.cpos++]=L},R=(C,L,rt)=>{let n=null;for(let r=0;r<C.bufs.length&&n===null;r++){const c=C.bufs[r];L<c.length?n=c:L-=c.length}n===null&&(n=C.cbuf),n[L]=rt},S=T,B=null,u=(C,L)=>{T(C,L&binary.BITS8),T(C,L>>>8&binary.BITS8)},w=(C,L,rt)=>{R(C,L,rt&binary.BITS8),R(C,L+1,rt>>>8&binary.BITS8)},m=(C,L)=>{for(let rt=0;rt<4;rt++)T(C,L&binary.BITS8),L>>>=8},E=(C,L)=>{for(let rt=3;rt>=0;rt--)T(C,L>>>8*rt&binary.BITS8)},v=(C,L,rt)=>{for(let n=0;n<4;n++)R(C,L+n,rt&binary.BITS8),rt>>>=8},I=(C,L)=>{for(;L>M.jS;)T(C,M.x1|M.jS&L),L=ct.GW(L/128);T(C,M.jS&L)},Y=(C,L)=>{const rt=ct.GR(L);for(rt&&(L=-L),T(C,(L>M.$2?M.x1:0)|(rt?M.rc:0)|M.$2&L),L=ct.GW(L/64);L>0;)T(C,(L>M.jS?M.x1:0)|M.jS&L),L=ct.GW(L/128)},N=new Uint8Array(3e4),P=N.length/3,q=(C,L)=>{if(L.length<P){const rt=D.YZ.encodeInto(L,N).written||0;I(C,rt);for(let n=0;n<rt;n++)T(C,N[n])}else wt(C,D.lz(L))},it=(C,L)=>{const rt=unescape(encodeURIComponent(L)),n=rt.length;I(C,n);for(let r=0;r<n;r++)T(C,rt.codePointAt(r))},bt=D.YZ&&D.YZ.encodeInto?q:it,Et=(C,L)=>Tt(C,string.encodeUtf8(L)),Tt=(C,L)=>{for(let rt=0;rt<L.length;rt++){const n=L[rt];(n===0||n===1)&&T(C,1),T(C,L[rt])}T(C,0)},At=(C,L)=>Ut(C,h(L)),Ut=(C,L)=>{const rt=C.cbuf.length,n=C.cpos,r=ct.VV(rt-n,L.length),c=L.length-r;C.cbuf.set(L.subarray(0,r),n),C.cpos+=r,c>0&&(C.bufs.push(C.cbuf),C.cbuf=new Uint8Array(ct.Fp(rt*2,c)),C.cbuf.set(L.subarray(r)),C.cpos=c)},wt=(C,L)=>{I(C,L.byteLength),Ut(C,L)},Jt=(C,L)=>{d(C,L);const rt=new DataView(C.cbuf.buffer,C.cpos,L);return C.cpos+=L,rt},$t=(C,L)=>Jt(C,4).setFloat32(0,L,!1),st=(C,L)=>Jt(C,8).setFloat64(0,L,!1),et=(C,L)=>Jt(C,8).setBigInt64(0,L,!1),lt=(C,L)=>Jt(C,8).setBigUint64(0,L,!1),yt=new DataView(new ArrayBuffer(4)),_t=C=>(yt.setFloat32(0,C),yt.getFloat32(0)===C),Rt=(C,L)=>{switch(typeof L){case"string":T(C,119),bt(C,L);break;case"number":ut.U(L)&&ct.Wn(L)<=M.RP?(T(C,125),Y(C,L)):_t(L)?(T(C,124),$t(C,L)):(T(C,123),st(C,L));break;case"bigint":T(C,122),et(C,L);break;case"object":if(L===null)T(C,126);else if(y.kJ(L)){T(C,117),I(C,L.length);for(let rt=0;rt<L.length;rt++)Rt(C,L[rt])}else if(L instanceof Uint8Array)T(C,116),wt(C,L);else{T(C,118);const rt=Object.keys(L);I(C,rt.length);for(let n=0;n<rt.length;n++){const r=rt[n];bt(C,r),Rt(C,L[r])}}break;case"boolean":T(C,L?120:121);break;default:T(C,127)}};class xt extends g{constructor(L){super(),this.w=L,this.s=null,this.count=0}write(L){this.s===L?this.count++:(this.count>0&&I(this,this.count-1),this.count=1,this.w(this,L),this.s=L)}}class Xt extends null{constructor(L){super(),this.s=L}write(L){Y(this,L-this.s),this.s=L}}class Pt extends null{constructor(L){super(),this.s=L,this.count=0}write(L){this.s===L&&this.count>0?this.count++:(this.count>0&&I(this,this.count-1),this.count=1,Y(this,L-this.s),this.s=L)}}const ee=C=>{C.count>0&&(Y(C.encoder,C.count===1?C.s:-C.s),C.count>1&&I(C.encoder,C.count-2))};class te{constructor(){this.encoder=new g,this.s=0,this.count=0}write(L){this.s===L?this.count++:(ee(this),this.count=1,this.s=L)}toUint8Array(){return ee(this),h(this.encoder)}}class W{constructor(){this.encoder=new g,this.s=0,this.count=0}write(L){this.s+this.count===L?this.count++:(ee(this),this.count=1,this.s=L)}toUint8Array(){return ee(this),h(this.encoder)}}const ot=C=>{if(C.count>0){const L=C.diff*2+(C.count===1?0:1);Y(C.encoder,L),C.count>1&&I(C.encoder,C.count-2)}};class O{constructor(){this.encoder=new g,this.s=0,this.count=0,this.diff=0}write(L){this.diff===L-this.s?(this.s=L,this.count++):(ot(this),this.count=1,this.diff=L-this.s,this.s=L)}toUint8Array(){return ot(this),h(this.encoder)}}class G{constructor(){this.sarr=[],this.s="",this.lensE=new te}write(L){this.s+=L,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(L.length)}toUint8Array(){const L=new g;return this.sarr.push(this.s),this.s="",bt(L,this.sarr.join("")),Ut(L,this.lensE.toUint8Array()),h(L)}}},"../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/environment.js":(Ft,kt,$)=>{"use strict";$.d(kt,{E0:()=>R,jU:()=>U,hH:()=>m});var ft=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/map.js"),ct=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/string.js");const ut=E=>E===void 0?null:E;var M=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/storage.js"),D=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/function.js"),y=$("../../../node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js");const g=typeof y!="undefined"&&y.release&&/node|io\.js/.test(y.release.name),U=typeof window!="undefined"&&typeof document!="undefined"&&!g,x=typeof navigator!="undefined"?/Mac/.test(navigator.platform):!1;let a;const b=[],h=()=>{if(a===void 0)if(g){a=ft.Ue();const E=y.argv;let v=null;for(let I=0;I<E.length;I++){const Y=E[I];Y[0]==="-"?(v!==null&&a.set(v,""),v=Y):v!==null?(a.set(v,Y),v=null):b.push(Y)}v!==null&&a.set(v,"")}else typeof location=="object"?(a=ft.Ue(),(location.search||"?").slice(1).split("&").forEach(E=>{if(E.length!==0){const[v,I]=E.split("=");a.set(`--${ct.NF(v,"-")}`,I),a.set(`-${ct.NF(v,"-")}`,I)}})):a=ft.Ue();return a},d=E=>h().has(E),T=(E,v)=>h().get(E)||v,R=E=>ut(g?y.env[E.toUpperCase()]:M.XN.getItem(E)),S=E=>h().get("--"+E)||R(E),u=(E=>d("--"+E)||R(E)!==null)("production"),w=g&&D.gB(y.env.FORCE_COLOR,["true","1","2"]),m=!d("no-colors")&&(!g||y.stdout.isTTY||w)&&(!g||d("color")||w||R("COLORTERM")!==null||(R("TERM")||"").includes("color"))},"../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/error.js":(Ft,kt,$)=>{"use strict";$.d(kt,{Nw:()=>ct,Ue:()=>ft,zR:()=>ut});const ft=M=>new Error(M),ct=()=>{throw ft("Method unimplemented")},ut=()=>{throw ft("Unexpected case")}},"../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/function.js":(Ft,kt,$)=>{"use strict";$.d(kt,{Hi:()=>x,PP:()=>ut,WY:()=>M,gB:()=>a,id:()=>y});var ft=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/array.js"),ct=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/object.js");const ut=(S,B,u=0)=>{try{for(;u<S.length;u++)S[u](...B)}finally{u<S.length&&ut(S,B,u+1)}},M=()=>{},D=S=>S(),y=S=>S,g=(S,B)=>S===B,U=(S,B)=>S===B||S!=null&&B!=null&&S.constructor===B.constructor&&(array.isArray(S)&&array.equalFlat(S,B)||typeof S=="object"&&object.equalFlat(S,B)),x=(S,B)=>{if(S==null||B==null)return g(S,B);if(S.constructor!==B.constructor)return!1;if(S===B)return!0;switch(S.constructor){case ArrayBuffer:S=new Uint8Array(S),B=new Uint8Array(B);case Uint8Array:{if(S.byteLength!==B.byteLength)return!1;for(let u=0;u<S.length;u++)if(S[u]!==B[u])return!1;break}case Set:{if(S.size!==B.size)return!1;for(const u of S)if(!B.has(u))return!1;break}case Map:{if(S.size!==B.size)return!1;for(const u of S.keys())if(!B.has(u)||!x(S.get(u),B.get(u)))return!1;break}case Object:if(ct.kE(S)!==ct.kE(B))return!1;for(const u in S)if(!ct.l$(S,u)||!x(S[u],B[u]))return!1;break;case Array:if(S.length!==B.length)return!1;for(let u=0;u<S.length;u++)if(!x(S[u],B[u]))return!1;break;default:return!1}return!0},a=(S,B)=>B.includes(S),b=ft.kJ,h=S=>S&&S.constructor===String,d=S=>S!=null&&S.constructor===Number,T=(S,B)=>S&&S.constructor===B,R=S=>B=>B&&B.constructor===S},"../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/logging.common.js":(Ft,kt,$)=>{"use strict";$.d(kt,{Ej:()=>U,Pl:()=>y,ZA:()=>a,s7:()=>x,ud:()=>d,Wd:()=>h,hM:()=>b,YW:()=>g,WO:()=>T,_X:()=>R,YX:()=>w});const ft=Symbol,ct=m=>typeof m=="symbol";var ut=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/time.js"),M=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/environment.js"),D=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/function.js");const y=ft(),g=ft(),U=ft(),x=ft(),a=ft(),b=ft(),h=ft(),d=ft(),T=ft(),R=m=>{const E=[],v=[];let I=0;for(;I<m.length;I++){const Y=m[I];Y.constructor===String||Y.constructor===Number?E.push(Y):Y.constructor===Object&&v.push(JSON.stringify(Y))}return v},S=[a,h,d,U];let B=0,u=ut.ZG();const w=(m,E)=>{const v=S[B],I=M.E0("log"),Y=I!==null&&(I==="*"||I==="true"||new RegExp(I,"gi").test(E));return B=(B+1)%S.length,E+=": ",Y?(...N)=>{const P=ut.ZG(),q=P-u;u=P,m(v,E,T,...N.map(it=>typeof it=="string"||typeof it=="symbol"?it:JSON.stringify(it)),v," +"+q+"ms")}:D.WY}},"../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/logging.js":(Ft,kt,$)=>{"use strict";$.d(kt,{YX:()=>ie,S0:()=>C});var ft=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/environment.js"),ct=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/set.js");class ut{constructor(nt,mt){this.left=nt,this.right=mt}}const M=(X,nt)=>new ut(X,nt),D=(X,nt)=>new ut(nt,X),y=(X,nt)=>X.forEach(mt=>nt(mt.left,mt.right)),g=(X,nt)=>X.map(mt=>nt(mt.left,mt.right));var U=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/map.js");const x=typeof document!="undefined"?document:{},a=X=>x.createElement(X),b=()=>x.createDocumentFragment(),h=X=>x.createTextNode(X),d=typeof DOMParser!="undefined"?new DOMParser:null,T=(X,nt,mt)=>X.dispatchEvent(new CustomEvent(nt,mt)),R=(X,nt)=>(pair.forEach(nt,(mt,gt)=>{gt===!1?X.removeAttribute(mt):gt===!0?X.setAttribute(mt,""):X.setAttribute(mt,gt)}),X),S=(X,nt)=>(nt.forEach((mt,gt)=>{X.setAttribute(gt,mt)}),X),B=X=>{const nt=b();for(let mt=0;mt<X.length;mt++)et(nt,X[mt]);return nt},u=(X,nt)=>(et(X,B(nt)),X),w=X=>X.remove(),m=(X,nt,mt)=>X.addEventListener(nt,mt),E=(X,nt,mt)=>X.removeEventListener(nt,mt),v=(X,nt)=>(pair.forEach(nt,(mt,gt)=>m(X,mt,gt)),X),I=(X,nt)=>(pair.forEach(nt,(mt,gt)=>E(X,mt,gt)),X),Y=(X,nt=[],mt=[])=>u(R(a(X),nt),mt),N=(X,nt)=>{const mt=a("canvas");return mt.height=nt,mt.width=X,mt},P=null,q=X=>`${X.left}:${X.right};`,it=X=>X.map(q).join(""),bt=X=>U.UI(X,(nt,mt)=>`${mt}:${nt};`).join(""),Et=(X,nt)=>X.querySelector(nt),Tt=(X,nt)=>X.querySelectorAll(nt),At=X=>x.getElementById(X),Ut=X=>d.parseFromString(`<html><body>${X}</body></html>`,"text/html").body,wt=X=>B(Ut(X).childNodes),Jt=X=>Ut(X).firstElementChild,$t=(X,nt)=>X.replaceWith(nt),st=(X,nt,mt)=>X.insertBefore(nt,mt),et=(X,nt)=>X.appendChild(nt),lt=x.ELEMENT_NODE,yt=x.TEXT_NODE,_t=x.CDATA_SECTION_NODE,Rt=x.COMMENT_NODE,xt=x.DOCUMENT_NODE,Xt=x.DOCUMENT_TYPE_NODE,Pt=x.DOCUMENT_FRAGMENT_NODE,ee=(X,nt)=>X.nodeType===nt,te=(X,nt)=>{let mt=nt.parentNode;for(;mt&&mt!==X;)mt=mt.parentNode;return mt===X};var W=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/logging.common.js");const ot={[W.Pl]:M("font-weight","bold"),[W.YW]:M("font-weight","normal"),[W.Ej]:M("color","blue"),[W.ZA]:M("color","green"),[W.s7]:M("color","grey"),[W.hM]:M("color","red"),[W.Wd]:M("color","purple"),[W.ud]:M("color","orange"),[W.WO]:M("color","black")},O=X=>{const nt=[],mt=[],gt=U.Ue();let jt=[],Zt=0;for(;Zt<X.length;Zt++){const Yt=X[Zt],ce=ot[Yt];if(ce!==void 0)gt.set(ce.left,ce.right);else if(Yt.constructor===String||Yt.constructor===Number){const Se=bt(gt);Zt>0||Se.length>0?(nt.push("%c"+Yt),mt.push(Se)):nt.push(Yt)}else break}for(Zt>0&&(jt=mt,jt.unshift(nt.join("")));Zt<X.length;Zt++){const Yt=X[Zt];Yt instanceof Symbol||jt.push(Yt)}return jt},G=ft.hH?O:W._X,C=(...X)=>{console.log(...G(X)),Ct.forEach(nt=>nt.print(X))},L=(...X)=>{console.warn(...G(X)),X.unshift(common.ORANGE),Ct.forEach(nt=>nt.print(X))},rt=X=>{console.error(X),Ct.forEach(nt=>nt.printError(X))},n=(X,nt)=>{env.isBrowser&&console.log("%c                      ",`font-size: ${nt}px; background-size: contain; background-repeat: no-repeat; background-image: url(${X})`),Ct.forEach(mt=>mt.printImg(X,nt))},r=(X,nt)=>n(`data:image/gif;base64,${X}`,nt),c=(...X)=>{console.group(...G(X)),Ct.forEach(nt=>nt.group(X))},k=(...X)=>{console.groupCollapsed(...G(X)),Ct.forEach(nt=>nt.groupCollapsed(X))},K=()=>{console.groupEnd(),Ct.forEach(X=>X.groupEnd())},z=X=>Ct.forEach(nt=>nt.printDom(X())),at=(X,nt)=>n(X.toDataURL(),nt),Ct=ct.Ue(),Bt=X=>{const nt=[],mt=new Map;let gt=0;for(;gt<X.length;gt++){const jt=X[gt],Zt=ot[jt];if(Zt!==void 0)mt.set(Zt.left,Zt.right);else if(jt.constructor===String||jt.constructor===Number){const Yt=dom.element("span",[pair.create("style",dom.mapToStyleString(mt))],[dom.text(jt.toString())]);Yt.innerHTML===""&&(Yt.innerHTML="&nbsp;"),nt.push(Yt)}else break}for(;gt<X.length;gt++){let jt=X[gt];jt instanceof Symbol||(jt.constructor!==String&&jt.constructor!==Number&&(jt=" "+json.stringify(jt)+" "),nt.push(dom.element("span",[],[dom.text(jt)])))}return nt},Ot="font-family:monospace;border-bottom:1px solid #e2e2e2;padding:2px;";class Dt{constructor(nt){this.dom=nt,this.ccontainer=this.dom,this.depth=0,Ct.add(this)}group(nt,mt=!1){eventloop.enqueue(()=>{const gt=dom.element("span",[pair.create("hidden",mt),pair.create("style","color:grey;font-size:120%;")],[dom.text("\u25BC")]),jt=dom.element("span",[pair.create("hidden",!mt),pair.create("style","color:grey;font-size:125%;")],[dom.text("\u25B6")]),Zt=dom.element("div",[pair.create("style",`${Ot};padding-left:${this.depth*10}px`)],[gt,jt,dom.text(" ")].concat(Bt(nt))),Yt=dom.element("div",[pair.create("hidden",mt)]),ce=dom.element("div",[],[Zt,Yt]);dom.append(this.ccontainer,[ce]),this.ccontainer=Yt,this.depth++,dom.addEventListener(Zt,"click",Se=>{Yt.toggleAttribute("hidden"),gt.toggleAttribute("hidden"),jt.toggleAttribute("hidden")})})}groupCollapsed(nt){this.group(nt,!0)}groupEnd(){eventloop.enqueue(()=>{this.depth>0&&(this.depth--,this.ccontainer=this.ccontainer.parentElement.parentElement)})}print(nt){eventloop.enqueue(()=>{dom.append(this.ccontainer,[dom.element("div",[pair.create("style",`${Ot};padding-left:${this.depth*10}px`)],Bt(nt))])})}printError(nt){this.print([common.RED,common.BOLD,nt.toString()])}printImg(nt,mt){eventloop.enqueue(()=>{dom.append(this.ccontainer,[dom.element("img",[pair.create("src",nt),pair.create("height",`${math.round(mt*1.5)}px`)])])})}printDom(nt){eventloop.enqueue(()=>{dom.append(this.ccontainer,[nt])})}destroy(){eventloop.enqueue(()=>{Ct.delete(this)})}}const Lt=X=>new Dt(X),ie=X=>W.YX(C,X)},"../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/map.js":(Ft,kt,$)=>{"use strict";$.d(kt,{JG:()=>ct,UI:()=>M,Ue:()=>ft,Yj:()=>D,Yu:()=>ut});const ft=()=>new Map,ct=g=>{const U=ft();return g.forEach((x,a)=>{U.set(a,x)}),U},ut=(g,U,x)=>{let a=g.get(U);return a===void 0&&g.set(U,a=x()),a},M=(g,U)=>{const x=[];for(const[a,b]of g)x.push(U(b,a));return x},D=(g,U)=>{for(const[x,a]of g)if(U(a,x))return!0;return!1},y=(g,U)=>{for(const[x,a]of g)if(!U(a,x))return!1;return!0}},"../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/math.js":(Ft,kt,$)=>{"use strict";$.d(kt,{Fp:()=>h,GR:()=>B,GW:()=>ft,VV:()=>b,Wn:()=>ut,mv:()=>y});const ft=Math.floor,ct=Math.ceil,ut=Math.abs,M=Math.imul,D=Math.round,y=Math.log10,g=Math.log2,U=Math.log,x=Math.sqrt,a=(u,w)=>u+w,b=(u,w)=>u<w?u:w,h=(u,w)=>u>w?u:w,d=Number.isNaN,T=Math.pow,R=u=>Math.pow(10,u),S=Math.sign,B=u=>u!==0?u<0:1/u<0},"../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/number.js":(Ft,kt,$)=>{"use strict";$.d(kt,{U:()=>U,YM:()=>ut});var ft=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/math.js"),ct=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/binary.js");const ut=Number.MAX_SAFE_INTEGER,M=Number.MIN_SAFE_INTEGER,D=null,y=ct.RP,g=ct.Tg,U=Number.isInteger||(h=>typeof h=="number"&&isFinite(h)&&ft.GW(h)===h),x=Number.isNaN,a=Number.parseInt,b=h=>{h&=binary.BITS32;let d=0;for(;h;)h&=h-1,d++;return d}},"../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/object.js":(Ft,kt,$)=>{"use strict";$.d(kt,{$m:()=>b,Ed:()=>M,f0:()=>ct,kE:()=>y,l$:()=>a,xb:()=>U});const ft=()=>Object.create(null),ct=Object.assign,ut=Object.keys,M=(h,d)=>{for(const T in h)d(h[T],T)},D=(h,d)=>{const T=[];for(const R in h)T.push(d(h[R],R));return T},y=h=>ut(h).length,g=(h,d)=>{for(const T in h)if(d(h[T],T))return!0;return!1},U=h=>{for(const d in h)return!1;return!0},x=(h,d)=>{for(const T in h)if(!d(h[T],T))return!1;return!0},a=(h,d)=>Object.prototype.hasOwnProperty.call(h,d),b=(h,d)=>h===d||y(h)===y(d)&&x(h,(T,R)=>(T!==void 0||a(d,R))&&d[R]===T)},"../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/observable.js":(Ft,kt,$)=>{"use strict";$.d(kt,{y:()=>D});var ft=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/map.js"),ct=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/set.js"),ut=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/array.js");class M{constructor(){this._observers=map.create()}on(g,U){return map.setIfUndefined(this._observers,g,set.create).add(U),U}once(g,U){const x=(...a)=>{this.off(g,x),U(...a)};this.on(g,x)}off(g,U){const x=this._observers.get(g);x!==void 0&&(x.delete(U),x.size===0&&this._observers.delete(g))}emit(g,U){return array.from((this._observers.get(g)||map.create()).values()).forEach(x=>x(...U))}destroy(){this._observers=map.create()}}class D{constructor(){this._observers=ft.Ue()}on(g,U){ft.Yu(this._observers,g,ct.Ue).add(U)}once(g,U){const x=(...a)=>{this.off(g,x),U(...a)};this.on(g,x)}off(g,U){const x=this._observers.get(g);x!==void 0&&(x.delete(U),x.size===0&&this._observers.delete(g))}emit(g,U){return ut.Dp((this._observers.get(g)||ft.Ue()).values()).forEach(x=>x(...U))}destroy(){this._observers=ft.Ue()}}},"../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/promise.js":(Ft,kt,$)=>{"use strict";$.d(kt,{DB:()=>D,Ue:()=>ft,d1:()=>M});const ft=a=>new Promise(a),ct=a=>new Promise(a),ut=Promise.all.bind(Promise),M=a=>Promise.reject(a),D=a=>Promise.resolve(a),y=a=>Promise.resolve(a),g=(a,b,h=10)=>ft((d,T)=>{const R=time.getUnixTime(),S=a>0,u=setInterval(()=>{b()?(clearInterval(u),d()):S&&time.getUnixTime()-R>a&&(clearInterval(u),T(new Error("Timeout")))},h)}),U=a=>ft((b,h)=>setTimeout(b,a)),x=a=>a instanceof Promise||a&&a.then&&a.catch&&a.finally},"../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/random.js":(Ft,kt,$)=>{"use strict";$.d(kt,{TN:()=>ut,U7:()=>M,k$:()=>U});const ft=crypto.subtle,ct=crypto.getRandomValues.bind(crypto),ut=Math.random,M=()=>ct(new Uint32Array(1))[0],D=()=>{const x=getRandomValues(new Uint32Array(8));return(x[0]&binary.BITS21)*(binary.BITS32+1)+(x[1]>>>0)},y=x=>x[math.floor(ut()*x.length)],g=[1e7]+-1e3+-4e3+-8e3+-1e11,U=()=>g.replace(/[018]/g,x=>(x^M()&15>>x/4).toString(16))},"../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/set.js":(Ft,kt,$)=>{"use strict";$.d(kt,{Ue:()=>ft});const ft=()=>new Set,ct=D=>Array.from(D),ut=D=>D.values().next().value||void 0,M=D=>new Set(D)},"../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/storage.js":(Ft,kt,$)=>{"use strict";$.d(kt,{F:()=>y,XN:()=>M,z2:()=>D});class ft{constructor(){this.map=new Map}setItem(U,x){this.map.set(U,x)}getItem(U){return this.map.get(U)}}let ct=new ft,ut=!0;try{typeof localStorage!="undefined"&&(ct=localStorage,ut=!1)}catch(g){}const M=ct,D=g=>ut||addEventListener("storage",g),y=g=>ut||removeEventListener("storage",g)},"../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/string.js":(Ft,kt,$)=>{"use strict";$.d(kt,{CO:()=>R,IK:()=>ft,NF:()=>U,YZ:()=>b,lz:()=>d});const ft=String.fromCharCode,ct=String.fromCodePoint,ut=ft(65535),M=m=>m.toLowerCase(),D=/^\s*/g,y=m=>m.replace(D,""),g=/([A-Z])/g,U=(m,E)=>y(m.replace(g,v=>`${E}${M(v)}`)),x=m=>unescape(encodeURIComponent(m)).length,a=m=>{const E=unescape(encodeURIComponent(m)),v=E.length,I=new Uint8Array(v);for(let Y=0;Y<v;Y++)I[Y]=E.codePointAt(Y);return I},b=typeof TextEncoder!="undefined"?new TextEncoder:null,d=b?m=>b.encode(m):a,T=m=>{let E=m.length,v="",I=0;for(;E>0;){const Y=E<1e4?E:1e4,N=m.subarray(I,I+Y);I+=Y,v+=String.fromCodePoint.apply(null,N),E-=Y}return decodeURIComponent(escape(v))};let R=typeof TextDecoder=="undefined"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});R&&R.decode(new Uint8Array).length===1&&(R=null);const S=m=>R.decode(m),B=null,u=(m,E,v,I="")=>m.slice(0,E)+I+m.slice(E+v),w=(m,E)=>array.unfold(E,()=>m).join("")},"../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/time.js":(Ft,kt,$)=>{"use strict";$.d(kt,{ZG:()=>ct});const ft=()=>new Date,ct=Date.now,ut=M=>{if(M<6e4){const x=metric.prefix(M,-1);return math.round(x.n*100)/100+x.prefix+"s"}M=math.floor(M/1e3);const D=M%60,y=math.floor(M/60)%60,g=math.floor(M/3600)%24,U=math.floor(M/86400);return U>0?U+"d"+(g>0||y>30?" "+(y>30?g+1:g)+"h":""):g>0?g+"h"+(y>0||D>30?" "+(D>30?y+1:y)+"min":""):y+"min"+(D>0?" "+D+"s":"")}},"../../../node_modules/.pnpm/simple-peer@9.11.1/node_modules/simple-peer/simplepeer.min.js":(Ft,kt,$)=>{(function(ft){if(!0)Ft.exports=ft();else var ct})(function(){var ft=Math.floor,ct=Math.abs,ut=Math.pow;return function(){function M(D,y,g){function U(b,h){if(!y[b]){if(!D[b]){var d=void 0;if(!h&&d)return require(b,!0);if(x)return x(b,!0);var T=new Error("Cannot find module '"+b+"'");throw T.code="MODULE_NOT_FOUND",T}var R=y[b]={exports:{}};D[b][0].call(R.exports,function(S){var B=D[b][1][S];return U(B||S)},R,R.exports,M,D,y,g)}return y[b].exports}for(var x=void 0,a=0;a<g.length;a++)U(g[a]);return U}return M}()({1:[function(M,D,y){"use strict";function g(w){var m=w.length;if(0<m%4)throw new Error("Invalid string. Length must be a multiple of 4");var E=w.indexOf("=");E===-1&&(E=m);var v=E===m?0:4-E%4;return[E,v]}function U(w,m,E){return 3*(m+E)/4-E}function x(w){var m,E,v=g(w),I=v[0],Y=v[1],N=new R(U(w,I,Y)),P=0,q=0<Y?I-4:I;for(E=0;E<q;E+=4)m=T[w.charCodeAt(E)]<<18|T[w.charCodeAt(E+1)]<<12|T[w.charCodeAt(E+2)]<<6|T[w.charCodeAt(E+3)],N[P++]=255&m>>16,N[P++]=255&m>>8,N[P++]=255&m;return Y===2&&(m=T[w.charCodeAt(E)]<<2|T[w.charCodeAt(E+1)]>>4,N[P++]=255&m),Y===1&&(m=T[w.charCodeAt(E)]<<10|T[w.charCodeAt(E+1)]<<4|T[w.charCodeAt(E+2)]>>2,N[P++]=255&m>>8,N[P++]=255&m),N}function a(w){return d[63&w>>18]+d[63&w>>12]+d[63&w>>6]+d[63&w]}function b(w,m,E){for(var v,I=[],Y=m;Y<E;Y+=3)v=(16711680&w[Y]<<16)+(65280&w[Y+1]<<8)+(255&w[Y+2]),I.push(a(v));return I.join("")}function h(w){for(var m,E=w.length,v=E%3,I=[],Y=16383,N=0,P=E-v;N<P;N+=Y)I.push(b(w,N,N+Y>P?P:N+Y));return v===1?(m=w[E-1],I.push(d[m>>2]+d[63&m<<4]+"==")):v===2&&(m=(w[E-2]<<8)+w[E-1],I.push(d[m>>10]+d[63&m>>4]+d[63&m<<2]+"=")),I.join("")}y.byteLength=function(w){var m=g(w),E=m[0],v=m[1];return 3*(E+v)/4-v},y.toByteArray=x,y.fromByteArray=h;for(var d=[],T=[],R=typeof Uint8Array=="undefined"?Array:Uint8Array,S="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",B=0,u=S.length;B<u;++B)d[B]=S[B],T[S.charCodeAt(B)]=B;T[45]=62,T[95]=63},{}],2:[function(){},{}],3:[function(M,D,y){(function(){(function(){/*!
* The buffer module from node.js, for the browser.
*
* @author   Feross Aboukhadijeh <https://feross.org>
* @license  MIT
*/"use strict";var g=String.fromCharCode,U=Math.min;function x(n){if(2147483647<n)throw new RangeError('The value "'+n+'" is invalid for option "size"');var r=new Uint8Array(n);return r.__proto__=a.prototype,r}function a(n,r,c){if(typeof n=="number"){if(typeof r=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return T(n)}return b(n,r,c)}function b(n,r,c){if(typeof n=="string")return R(n,r);if(ArrayBuffer.isView(n))return S(n);if(n==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof n);if(O(n,ArrayBuffer)||n&&O(n.buffer,ArrayBuffer))return B(n,r,c);if(typeof n=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var k=n.valueOf&&n.valueOf();if(k!=null&&k!==n)return a.from(k,r,c);var K=u(n);if(K)return K;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof n[Symbol.toPrimitive]=="function")return a.from(n[Symbol.toPrimitive]("string"),r,c);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof n)}function h(n){if(typeof n!="number")throw new TypeError('"size" argument must be of type number');if(0>n)throw new RangeError('The value "'+n+'" is invalid for option "size"')}function d(n,r,c){return h(n),0>=n||r===void 0?x(n):typeof c=="string"?x(n).fill(r,c):x(n).fill(r)}function T(n){return h(n),x(0>n?0:0|w(n))}function R(n,r){if((typeof r!="string"||r==="")&&(r="utf8"),!a.isEncoding(r))throw new TypeError("Unknown encoding: "+r);var c=0|m(n,r),k=x(c),K=k.write(n,r);return K!==c&&(k=k.slice(0,K)),k}function S(n){for(var r=0>n.length?0:0|w(n.length),c=x(r),k=0;k<r;k+=1)c[k]=255&n[k];return c}function B(n,r,c){if(0>r||n.byteLength<r)throw new RangeError('"offset" is outside of buffer bounds');if(n.byteLength<r+(c||0))throw new RangeError('"length" is outside of buffer bounds');var k;return k=r===void 0&&c===void 0?new Uint8Array(n):c===void 0?new Uint8Array(n,r):new Uint8Array(n,r,c),k.__proto__=a.prototype,k}function u(n){if(a.isBuffer(n)){var r=0|w(n.length),c=x(r);return c.length===0||n.copy(c,0,0,r),c}return n.length===void 0?n.type==="Buffer"&&Array.isArray(n.data)?S(n.data):void 0:typeof n.length!="number"||G(n.length)?x(0):S(n)}function w(n){if(n>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|n}function m(n,r){if(a.isBuffer(n))return n.length;if(ArrayBuffer.isView(n)||O(n,ArrayBuffer))return n.byteLength;if(typeof n!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof n);var c=n.length,k=2<arguments.length&&arguments[2]===!0;if(!k&&c===0)return 0;for(var K=!1;;)switch(r){case"ascii":case"latin1":case"binary":return c;case"utf8":case"utf-8":return Pt(n).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*c;case"hex":return c>>>1;case"base64":return W(n).length;default:if(K)return k?-1:Pt(n).length;r=(""+r).toLowerCase(),K=!0}}function E(n,r,c){var k=!1;if((r===void 0||0>r)&&(r=0),r>this.length||((c===void 0||c>this.length)&&(c=this.length),0>=c)||(c>>>=0,r>>>=0,c<=r))return"";for(n||(n="utf8");;)switch(n){case"hex":return $t(this,r,c);case"utf8":case"utf-8":return At(this,r,c);case"ascii":return wt(this,r,c);case"latin1":case"binary":return Jt(this,r,c);case"base64":return Tt(this,r,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return st(this,r,c);default:if(k)throw new TypeError("Unknown encoding: "+n);n=(n+"").toLowerCase(),k=!0}}function v(n,r,c){var k=n[r];n[r]=n[c],n[c]=k}function I(n,r,c,k,K){if(n.length===0)return-1;if(typeof c=="string"?(k=c,c=0):2147483647<c?c=2147483647:-2147483648>c&&(c=-2147483648),c=+c,G(c)&&(c=K?0:n.length-1),0>c&&(c=n.length+c),c>=n.length){if(K)return-1;c=n.length-1}else if(0>c)if(K)c=0;else return-1;if(typeof r=="string"&&(r=a.from(r,k)),a.isBuffer(r))return r.length===0?-1:Y(n,r,c,k,K);if(typeof r=="number")return r&=255,typeof Uint8Array.prototype.indexOf=="function"?K?Uint8Array.prototype.indexOf.call(n,r,c):Uint8Array.prototype.lastIndexOf.call(n,r,c):Y(n,[r],c,k,K);throw new TypeError("val must be string, number or Buffer")}function Y(n,r,c,k,K){function z(X,nt){return at===1?X[nt]:X.readUInt16BE(nt*at)}var at=1,Ct=n.length,Bt=r.length;if(k!==void 0&&(k=(k+"").toLowerCase(),k==="ucs2"||k==="ucs-2"||k==="utf16le"||k==="utf-16le")){if(2>n.length||2>r.length)return-1;at=2,Ct/=2,Bt/=2,c/=2}var Ot;if(K){var Dt=-1;for(Ot=c;Ot<Ct;Ot++)if(z(n,Ot)!==z(r,Dt===-1?0:Ot-Dt))Dt!==-1&&(Ot-=Ot-Dt),Dt=-1;else if(Dt===-1&&(Dt=Ot),Ot-Dt+1===Bt)return Dt*at}else for(c+Bt>Ct&&(c=Ct-Bt),Ot=c;0<=Ot;Ot--){for(var Lt=!0,ie=0;ie<Bt;ie++)if(z(n,Ot+ie)!==z(r,ie)){Lt=!1;break}if(Lt)return Ot}return-1}function N(n,r,c,k){c=+c||0;var K=n.length-c;k?(k=+k,k>K&&(k=K)):k=K;var z=r.length;k>z/2&&(k=z/2);for(var at,Ct=0;Ct<k;++Ct){if(at=parseInt(r.substr(2*Ct,2),16),G(at))return Ct;n[c+Ct]=at}return Ct}function P(n,r,c,k){return ot(Pt(r,n.length-c),n,c,k)}function q(n,r,c,k){return ot(ee(r),n,c,k)}function it(n,r,c,k){return q(n,r,c,k)}function bt(n,r,c,k){return ot(W(r),n,c,k)}function Et(n,r,c,k){return ot(te(r,n.length-c),n,c,k)}function Tt(n,r,c){return r===0&&c===n.length?C.fromByteArray(n):C.fromByteArray(n.slice(r,c))}function At(n,r,c){c=U(n.length,c);for(var k=[],K=r;K<c;){var z=n[K],at=null,Ct=239<z?4:223<z?3:191<z?2:1;if(K+Ct<=c){var Bt,Ot,Dt,Lt;Ct===1?128>z&&(at=z):Ct===2?(Bt=n[K+1],(192&Bt)==128&&(Lt=(31&z)<<6|63&Bt,127<Lt&&(at=Lt))):Ct===3?(Bt=n[K+1],Ot=n[K+2],(192&Bt)==128&&(192&Ot)==128&&(Lt=(15&z)<<12|(63&Bt)<<6|63&Ot,2047<Lt&&(55296>Lt||57343<Lt)&&(at=Lt))):Ct===4&&(Bt=n[K+1],Ot=n[K+2],Dt=n[K+3],(192&Bt)==128&&(192&Ot)==128&&(192&Dt)==128&&(Lt=(15&z)<<18|(63&Bt)<<12|(63&Ot)<<6|63&Dt,65535<Lt&&1114112>Lt&&(at=Lt)))}at===null?(at=65533,Ct=1):65535<at&&(at-=65536,k.push(55296|1023&at>>>10),at=56320|1023&at),k.push(at),K+=Ct}return Ut(k)}function Ut(n){var r=n.length;if(r<=4096)return g.apply(String,n);for(var c="",k=0;k<r;)c+=g.apply(String,n.slice(k,k+=4096));return c}function wt(n,r,c){var k="";c=U(n.length,c);for(var K=r;K<c;++K)k+=g(127&n[K]);return k}function Jt(n,r,c){var k="";c=U(n.length,c);for(var K=r;K<c;++K)k+=g(n[K]);return k}function $t(n,r,c){var k=n.length;(!r||0>r)&&(r=0),(!c||0>c||c>k)&&(c=k);for(var K="",z=r;z<c;++z)K+=Xt(n[z]);return K}function st(n,r,c){for(var k=n.slice(r,c),K="",z=0;z<k.length;z+=2)K+=g(k[z]+256*k[z+1]);return K}function et(n,r,c){if(n%1!=0||0>n)throw new RangeError("offset is not uint");if(n+r>c)throw new RangeError("Trying to access beyond buffer length")}function lt(n,r,c,k,K,z){if(!a.isBuffer(n))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>K||r<z)throw new RangeError('"value" argument is out of bounds');if(c+k>n.length)throw new RangeError("Index out of range")}function yt(n,r,c,k){if(c+k>n.length)throw new RangeError("Index out of range");if(0>c)throw new RangeError("Index out of range")}function _t(n,r,c,k,K){return r=+r,c>>>=0,K||yt(n,r,c,4,34028234663852886e22,-34028234663852886e22),L.write(n,r,c,k,23,4),c+4}function Rt(n,r,c,k,K){return r=+r,c>>>=0,K||yt(n,r,c,8,17976931348623157e292,-17976931348623157e292),L.write(n,r,c,k,52,8),c+8}function xt(n){if(n=n.split("=")[0],n=n.trim().replace(rt,""),2>n.length)return"";for(;n.length%4!=0;)n+="=";return n}function Xt(n){return 16>n?"0"+n.toString(16):n.toString(16)}function Pt(n,r){r=r||1/0;for(var c,k=n.length,K=null,z=[],at=0;at<k;++at){if(c=n.charCodeAt(at),55295<c&&57344>c){if(!K){if(56319<c){-1<(r-=3)&&z.push(239,191,189);continue}else if(at+1===k){-1<(r-=3)&&z.push(239,191,189);continue}K=c;continue}if(56320>c){-1<(r-=3)&&z.push(239,191,189),K=c;continue}c=(K-55296<<10|c-56320)+65536}else K&&-1<(r-=3)&&z.push(239,191,189);if(K=null,128>c){if(0>(r-=1))break;z.push(c)}else if(2048>c){if(0>(r-=2))break;z.push(192|c>>6,128|63&c)}else if(65536>c){if(0>(r-=3))break;z.push(224|c>>12,128|63&c>>6,128|63&c)}else if(1114112>c){if(0>(r-=4))break;z.push(240|c>>18,128|63&c>>12,128|63&c>>6,128|63&c)}else throw new Error("Invalid code point")}return z}function ee(n){for(var r=[],c=0;c<n.length;++c)r.push(255&n.charCodeAt(c));return r}function te(n,r){for(var c,k,K,z=[],at=0;at<n.length&&!(0>(r-=2));++at)c=n.charCodeAt(at),k=c>>8,K=c%256,z.push(K),z.push(k);return z}function W(n){return C.toByteArray(xt(n))}function ot(n,r,c,k){for(var K=0;K<k&&!(K+c>=r.length||K>=n.length);++K)r[K+c]=n[K];return K}function O(n,r){return n instanceof r||n!=null&&n.constructor!=null&&n.constructor.name!=null&&n.constructor.name===r.name}function G(n){return n!==n}var C=M("base64-js"),L=M("ieee754");y.Buffer=a,y.SlowBuffer=function(n){return+n!=n&&(n=0),a.alloc(+n)},y.INSPECT_MAX_BYTES=50,y.kMaxLength=2147483647,a.TYPED_ARRAY_SUPPORT=function(){try{var n=new Uint8Array(1);return n.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},n.foo()===42}catch(r){return!1}}(),a.TYPED_ARRAY_SUPPORT||typeof console=="undefined"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){return a.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){return a.isBuffer(this)?this.byteOffset:void 0}}),typeof Symbol!="undefined"&&Symbol.species!=null&&a[Symbol.species]===a&&Object.defineProperty(a,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),a.poolSize=8192,a.from=function(n,r,c){return b(n,r,c)},a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array,a.alloc=function(n,r,c){return d(n,r,c)},a.allocUnsafe=function(n){return T(n)},a.allocUnsafeSlow=function(n){return T(n)},a.isBuffer=function(n){return n!=null&&n._isBuffer===!0&&n!==a.prototype},a.compare=function(n,r){if(O(n,Uint8Array)&&(n=a.from(n,n.offset,n.byteLength)),O(r,Uint8Array)&&(r=a.from(r,r.offset,r.byteLength)),!a.isBuffer(n)||!a.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(n===r)return 0;for(var c=n.length,k=r.length,K=0,z=U(c,k);K<z;++K)if(n[K]!==r[K]){c=n[K],k=r[K];break}return c<k?-1:k<c?1:0},a.isEncoding=function(n){switch((n+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(n,r){if(!Array.isArray(n))throw new TypeError('"list" argument must be an Array of Buffers');if(n.length===0)return a.alloc(0);var c;if(r===void 0)for(r=0,c=0;c<n.length;++c)r+=n[c].length;var k=a.allocUnsafe(r),K=0;for(c=0;c<n.length;++c){var z=n[c];if(O(z,Uint8Array)&&(z=a.from(z)),!a.isBuffer(z))throw new TypeError('"list" argument must be an Array of Buffers');z.copy(k,K),K+=z.length}return k},a.byteLength=m,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var n=this.length;if(n%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<n;r+=2)v(this,r,r+1);return this},a.prototype.swap32=function(){var n=this.length;if(n%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<n;r+=4)v(this,r,r+3),v(this,r+1,r+2);return this},a.prototype.swap64=function(){var n=this.length;if(n%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<n;r+=8)v(this,r,r+7),v(this,r+1,r+6),v(this,r+2,r+5),v(this,r+3,r+4);return this},a.prototype.toString=function(){var n=this.length;return n===0?"":arguments.length===0?At(this,0,n):E.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(n){if(!a.isBuffer(n))throw new TypeError("Argument must be a Buffer");return this===n||a.compare(this,n)===0},a.prototype.inspect=function(){var n="",r=y.INSPECT_MAX_BYTES;return n=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(n+=" ... "),"<Buffer "+n+">"},a.prototype.compare=function(n,r,c,k,K){if(O(n,Uint8Array)&&(n=a.from(n,n.offset,n.byteLength)),!a.isBuffer(n))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof n);if(r===void 0&&(r=0),c===void 0&&(c=n?n.length:0),k===void 0&&(k=0),K===void 0&&(K=this.length),0>r||c>n.length||0>k||K>this.length)throw new RangeError("out of range index");if(k>=K&&r>=c)return 0;if(k>=K)return-1;if(r>=c)return 1;if(r>>>=0,c>>>=0,k>>>=0,K>>>=0,this===n)return 0;for(var z=K-k,at=c-r,Ct=U(z,at),Bt=this.slice(k,K),Ot=n.slice(r,c),Dt=0;Dt<Ct;++Dt)if(Bt[Dt]!==Ot[Dt]){z=Bt[Dt],at=Ot[Dt];break}return z<at?-1:at<z?1:0},a.prototype.includes=function(n,r,c){return this.indexOf(n,r,c)!==-1},a.prototype.indexOf=function(n,r,c){return I(this,n,r,c,!0)},a.prototype.lastIndexOf=function(n,r,c){return I(this,n,r,c,!1)},a.prototype.write=function(n,r,c,k){if(r===void 0)k="utf8",c=this.length,r=0;else if(c===void 0&&typeof r=="string")k=r,c=this.length,r=0;else if(isFinite(r))r>>>=0,isFinite(c)?(c>>>=0,k===void 0&&(k="utf8")):(k=c,c=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var K=this.length-r;if((c===void 0||c>K)&&(c=K),0<n.length&&(0>c||0>r)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");k||(k="utf8");for(var z=!1;;)switch(k){case"hex":return N(this,n,r,c);case"utf8":case"utf-8":return P(this,n,r,c);case"ascii":return q(this,n,r,c);case"latin1":case"binary":return it(this,n,r,c);case"base64":return bt(this,n,r,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Et(this,n,r,c);default:if(z)throw new TypeError("Unknown encoding: "+k);k=(""+k).toLowerCase(),z=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},a.prototype.slice=function(n,r){var c=this.length;n=~~n,r=r===void 0?c:~~r,0>n?(n+=c,0>n&&(n=0)):n>c&&(n=c),0>r?(r+=c,0>r&&(r=0)):r>c&&(r=c),r<n&&(r=n);var k=this.subarray(n,r);return k.__proto__=a.prototype,k},a.prototype.readUIntLE=function(n,r,c){n>>>=0,r>>>=0,c||et(n,r,this.length);for(var k=this[n],K=1,z=0;++z<r&&(K*=256);)k+=this[n+z]*K;return k},a.prototype.readUIntBE=function(n,r,c){n>>>=0,r>>>=0,c||et(n,r,this.length);for(var k=this[n+--r],K=1;0<r&&(K*=256);)k+=this[n+--r]*K;return k},a.prototype.readUInt8=function(n,r){return n>>>=0,r||et(n,1,this.length),this[n]},a.prototype.readUInt16LE=function(n,r){return n>>>=0,r||et(n,2,this.length),this[n]|this[n+1]<<8},a.prototype.readUInt16BE=function(n,r){return n>>>=0,r||et(n,2,this.length),this[n]<<8|this[n+1]},a.prototype.readUInt32LE=function(n,r){return n>>>=0,r||et(n,4,this.length),(this[n]|this[n+1]<<8|this[n+2]<<16)+16777216*this[n+3]},a.prototype.readUInt32BE=function(n,r){return n>>>=0,r||et(n,4,this.length),16777216*this[n]+(this[n+1]<<16|this[n+2]<<8|this[n+3])},a.prototype.readIntLE=function(n,r,c){n>>>=0,r>>>=0,c||et(n,r,this.length);for(var k=this[n],K=1,z=0;++z<r&&(K*=256);)k+=this[n+z]*K;return K*=128,k>=K&&(k-=ut(2,8*r)),k},a.prototype.readIntBE=function(n,r,c){n>>>=0,r>>>=0,c||et(n,r,this.length);for(var k=r,K=1,z=this[n+--k];0<k&&(K*=256);)z+=this[n+--k]*K;return K*=128,z>=K&&(z-=ut(2,8*r)),z},a.prototype.readInt8=function(n,r){return n>>>=0,r||et(n,1,this.length),128&this[n]?-1*(255-this[n]+1):this[n]},a.prototype.readInt16LE=function(n,r){n>>>=0,r||et(n,2,this.length);var c=this[n]|this[n+1]<<8;return 32768&c?4294901760|c:c},a.prototype.readInt16BE=function(n,r){n>>>=0,r||et(n,2,this.length);var c=this[n+1]|this[n]<<8;return 32768&c?4294901760|c:c},a.prototype.readInt32LE=function(n,r){return n>>>=0,r||et(n,4,this.length),this[n]|this[n+1]<<8|this[n+2]<<16|this[n+3]<<24},a.prototype.readInt32BE=function(n,r){return n>>>=0,r||et(n,4,this.length),this[n]<<24|this[n+1]<<16|this[n+2]<<8|this[n+3]},a.prototype.readFloatLE=function(n,r){return n>>>=0,r||et(n,4,this.length),L.read(this,n,!0,23,4)},a.prototype.readFloatBE=function(n,r){return n>>>=0,r||et(n,4,this.length),L.read(this,n,!1,23,4)},a.prototype.readDoubleLE=function(n,r){return n>>>=0,r||et(n,8,this.length),L.read(this,n,!0,52,8)},a.prototype.readDoubleBE=function(n,r){return n>>>=0,r||et(n,8,this.length),L.read(this,n,!1,52,8)},a.prototype.writeUIntLE=function(n,r,c,k){if(n=+n,r>>>=0,c>>>=0,!k){var K=ut(2,8*c)-1;lt(this,n,r,c,K,0)}var z=1,at=0;for(this[r]=255&n;++at<c&&(z*=256);)this[r+at]=255&n/z;return r+c},a.prototype.writeUIntBE=function(n,r,c,k){if(n=+n,r>>>=0,c>>>=0,!k){var K=ut(2,8*c)-1;lt(this,n,r,c,K,0)}var z=c-1,at=1;for(this[r+z]=255&n;0<=--z&&(at*=256);)this[r+z]=255&n/at;return r+c},a.prototype.writeUInt8=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,1,255,0),this[r]=255&n,r+1},a.prototype.writeUInt16LE=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,2,65535,0),this[r]=255&n,this[r+1]=n>>>8,r+2},a.prototype.writeUInt16BE=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,2,65535,0),this[r]=n>>>8,this[r+1]=255&n,r+2},a.prototype.writeUInt32LE=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,4,4294967295,0),this[r+3]=n>>>24,this[r+2]=n>>>16,this[r+1]=n>>>8,this[r]=255&n,r+4},a.prototype.writeUInt32BE=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,4,4294967295,0),this[r]=n>>>24,this[r+1]=n>>>16,this[r+2]=n>>>8,this[r+3]=255&n,r+4},a.prototype.writeIntLE=function(n,r,c,k){if(n=+n,r>>>=0,!k){var K=ut(2,8*c-1);lt(this,n,r,c,K-1,-K)}var z=0,at=1,Ct=0;for(this[r]=255&n;++z<c&&(at*=256);)0>n&&Ct===0&&this[r+z-1]!==0&&(Ct=1),this[r+z]=255&(n/at>>0)-Ct;return r+c},a.prototype.writeIntBE=function(n,r,c,k){if(n=+n,r>>>=0,!k){var K=ut(2,8*c-1);lt(this,n,r,c,K-1,-K)}var z=c-1,at=1,Ct=0;for(this[r+z]=255&n;0<=--z&&(at*=256);)0>n&&Ct===0&&this[r+z+1]!==0&&(Ct=1),this[r+z]=255&(n/at>>0)-Ct;return r+c},a.prototype.writeInt8=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,1,127,-128),0>n&&(n=255+n+1),this[r]=255&n,r+1},a.prototype.writeInt16LE=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,2,32767,-32768),this[r]=255&n,this[r+1]=n>>>8,r+2},a.prototype.writeInt16BE=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,2,32767,-32768),this[r]=n>>>8,this[r+1]=255&n,r+2},a.prototype.writeInt32LE=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,4,2147483647,-2147483648),this[r]=255&n,this[r+1]=n>>>8,this[r+2]=n>>>16,this[r+3]=n>>>24,r+4},a.prototype.writeInt32BE=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,4,2147483647,-2147483648),0>n&&(n=4294967295+n+1),this[r]=n>>>24,this[r+1]=n>>>16,this[r+2]=n>>>8,this[r+3]=255&n,r+4},a.prototype.writeFloatLE=function(n,r,c){return _t(this,n,r,!0,c)},a.prototype.writeFloatBE=function(n,r,c){return _t(this,n,r,!1,c)},a.prototype.writeDoubleLE=function(n,r,c){return Rt(this,n,r,!0,c)},a.prototype.writeDoubleBE=function(n,r,c){return Rt(this,n,r,!1,c)},a.prototype.copy=function(n,r,c,k){if(!a.isBuffer(n))throw new TypeError("argument should be a Buffer");if(c||(c=0),k||k===0||(k=this.length),r>=n.length&&(r=n.length),r||(r=0),0<k&&k<c&&(k=c),k===c||n.length===0||this.length===0)return 0;if(0>r)throw new RangeError("targetStart out of bounds");if(0>c||c>=this.length)throw new RangeError("Index out of range");if(0>k)throw new RangeError("sourceEnd out of bounds");k>this.length&&(k=this.length),n.length-r<k-c&&(k=n.length-r+c);var K=k-c;if(this===n&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(r,c,k);else if(this===n&&c<r&&r<k)for(var z=K-1;0<=z;--z)n[z+r]=this[z+c];else Uint8Array.prototype.set.call(n,this.subarray(c,k),r);return K},a.prototype.fill=function(n,r,c,k){if(typeof n=="string"){if(typeof r=="string"?(k=r,r=0,c=this.length):typeof c=="string"&&(k=c,c=this.length),k!==void 0&&typeof k!="string")throw new TypeError("encoding must be a string");if(typeof k=="string"&&!a.isEncoding(k))throw new TypeError("Unknown encoding: "+k);if(n.length===1){var K=n.charCodeAt(0);(k==="utf8"&&128>K||k==="latin1")&&(n=K)}}else typeof n=="number"&&(n&=255);if(0>r||this.length<r||this.length<c)throw new RangeError("Out of range index");if(c<=r)return this;r>>>=0,c=c===void 0?this.length:c>>>0,n||(n=0);var z;if(typeof n=="number")for(z=r;z<c;++z)this[z]=n;else{var at=a.isBuffer(n)?n:a.from(n,k),Ct=at.length;if(Ct===0)throw new TypeError('The value "'+n+'" is invalid for argument "value"');for(z=0;z<c-r;++z)this[z+r]=at[z%Ct]}return this};var rt=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,M("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:9}],4:[function(M,D,y){(function(g){(function(){function U(){let a;try{a=y.storage.getItem("debug")}catch(b){}return!a&&typeof g!="undefined"&&"env"in g&&(a=g.env.DEBUG),a}y.formatArgs=function(a){if(a[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+a[0]+(this.useColors?"%c ":" ")+"+"+D.exports.humanize(this.diff),!this.useColors)return;const b="color: "+this.color;a.splice(1,0,b,"color: inherit");let h=0,d=0;a[0].replace(/%[a-zA-Z%]/g,T=>{T==="%%"||(h++,T==="%c"&&(d=h))}),a.splice(d,0,b)},y.save=function(a){try{a?y.storage.setItem("debug",a):y.storage.removeItem("debug")}catch(b){}},y.load=U,y.useColors=function(){return!!(typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))||!(typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},y.storage=function(){try{return localStorage}catch(a){}}(),y.destroy=(()=>{let a=!1;return()=>{a||(a=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),y.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],y.log=console.debug||console.log||(()=>{}),D.exports=M("./common")(y);const{formatters:x}=D.exports;x.j=function(a){try{return JSON.stringify(a)}catch(b){return"[UnexpectedJSONParseError]: "+b.message}}}).call(this)}).call(this,M("_process"))},{"./common":5,_process:12}],5:[function(M,D){D.exports=function(y){function g(a){function b(...T){if(!b.enabled)return;const R=b,S=+new Date,B=S-(h||S);R.diff=B,R.prev=h,R.curr=S,h=S,T[0]=g.coerce(T[0]),typeof T[0]!="string"&&T.unshift("%O");let u=0;T[0]=T[0].replace(/%([a-zA-Z%])/g,(m,E)=>{if(m==="%%")return"%";u++;const v=g.formatters[E];if(typeof v=="function"){const I=T[u];m=v.call(R,I),T.splice(u,1),u--}return m}),g.formatArgs.call(R,T),(R.log||g.log).apply(R,T)}let h,d=null;return b.namespace=a,b.useColors=g.useColors(),b.color=g.selectColor(a),b.extend=U,b.destroy=g.destroy,Object.defineProperty(b,"enabled",{enumerable:!0,configurable:!1,get:()=>d===null?g.enabled(a):d,set:T=>{d=T}}),typeof g.init=="function"&&g.init(b),b}function U(a,b){const h=g(this.namespace+(typeof b=="undefined"?":":b)+a);return h.log=this.log,h}function x(a){return a.toString().substring(2,a.toString().length-2).replace(/\.\*\?$/,"*")}return g.debug=g,g.default=g,g.coerce=function(a){return a instanceof Error?a.stack||a.message:a},g.disable=function(){const a=[...g.names.map(x),...g.skips.map(x).map(b=>"-"+b)].join(",");return g.enable(""),a},g.enable=function(a){g.save(a),g.names=[],g.skips=[];let b;const h=(typeof a=="string"?a:"").split(/[\s,]+/),d=h.length;for(b=0;b<d;b++)h[b]&&(a=h[b].replace(/\*/g,".*?"),a[0]==="-"?g.skips.push(new RegExp("^"+a.substr(1)+"$")):g.names.push(new RegExp("^"+a+"$")))},g.enabled=function(a){if(a[a.length-1]==="*")return!0;let b,h;for(b=0,h=g.skips.length;b<h;b++)if(g.skips[b].test(a))return!1;for(b=0,h=g.names.length;b<h;b++)if(g.names[b].test(a))return!0;return!1},g.humanize=M("ms"),g.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(y).forEach(a=>{g[a]=y[a]}),g.names=[],g.skips=[],g.formatters={},g.selectColor=function(a){let b=0;for(let h=0;h<a.length;h++)b=(b<<5)-b+a.charCodeAt(h),b|=0;return g.colors[ct(b)%g.colors.length]},g.enable(g.load()),g}},{ms:11}],6:[function(M,D){"use strict";function y(g,U){for(const x in U)Object.defineProperty(g,x,{value:U[x],enumerable:!0,configurable:!0});return g}D.exports=function(g,U,x){if(!g||typeof g=="string")throw new TypeError("Please pass an Error to err-code");x||(x={}),typeof U=="object"&&(x=U,U=""),U&&(x.code=U);try{return y(g,x)}catch(a){x.message=g.message,x.stack=g.stack;const b=function(){};return b.prototype=Object.create(Object.getPrototypeOf(g)),y(new b,x)}}},{}],7:[function(M,D){"use strict";function y(N){console&&console.warn&&console.warn(N)}function g(){g.init.call(this)}function U(N){if(typeof N!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof N)}function x(N){return N._maxListeners===void 0?g.defaultMaxListeners:N._maxListeners}function a(N,P,q,it){var bt,Et,Tt;if(U(q),Et=N._events,Et===void 0?(Et=N._events=Object.create(null),N._eventsCount=0):(Et.newListener!==void 0&&(N.emit("newListener",P,q.listener?q.listener:q),Et=N._events),Tt=Et[P]),Tt===void 0)Tt=Et[P]=q,++N._eventsCount;else if(typeof Tt=="function"?Tt=Et[P]=it?[q,Tt]:[Tt,q]:it?Tt.unshift(q):Tt.push(q),bt=x(N),0<bt&&Tt.length>bt&&!Tt.warned){Tt.warned=!0;var At=new Error("Possible EventEmitter memory leak detected. "+Tt.length+" "+(P+" listeners added. Use emitter.setMaxListeners() to increase limit"));At.name="MaxListenersExceededWarning",At.emitter=N,At.type=P,At.count=Tt.length,y(At)}return N}function b(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(N,P,q){var it={fired:!1,wrapFn:void 0,target:N,type:P,listener:q},bt=b.bind(it);return bt.listener=q,it.wrapFn=bt,bt}function d(N,P,q){var it=N._events;if(it===void 0)return[];var bt=it[P];return bt===void 0?[]:typeof bt=="function"?q?[bt.listener||bt]:[bt]:q?B(bt):R(bt,bt.length)}function T(N){var P=this._events;if(P!==void 0){var q=P[N];if(typeof q=="function")return 1;if(q!==void 0)return q.length}return 0}function R(N,P){for(var q=Array(P),it=0;it<P;++it)q[it]=N[it];return q}function S(N,P){for(;P+1<N.length;P++)N[P]=N[P+1];N.pop()}function B(N){for(var P=Array(N.length),q=0;q<P.length;++q)P[q]=N[q].listener||N[q];return P}function u(N,P,q){typeof N.on=="function"&&w(N,"error",P,q)}function w(N,P,q,it){if(typeof N.on=="function")it.once?N.once(P,q):N.on(P,q);else if(typeof N.addEventListener=="function")N.addEventListener(P,function bt(Et){it.once&&N.removeEventListener(P,bt),q(Et)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof N)}var m,E=typeof Reflect=="object"?Reflect:null,v=E&&typeof E.apply=="function"?E.apply:function(N,P,q){return Function.prototype.apply.call(N,P,q)};m=E&&typeof E.ownKeys=="function"?E.ownKeys:Object.getOwnPropertySymbols?function(N){return Object.getOwnPropertyNames(N).concat(Object.getOwnPropertySymbols(N))}:function(N){return Object.getOwnPropertyNames(N)};var I=Number.isNaN||function(N){return N!==N};D.exports=g,D.exports.once=function(N,P){return new Promise(function(q,it){function bt(Tt){N.removeListener(P,Et),it(Tt)}function Et(){typeof N.removeListener=="function"&&N.removeListener("error",bt),q([].slice.call(arguments))}w(N,P,Et,{once:!0}),P!=="error"&&u(N,bt,{once:!0})})},g.EventEmitter=g,g.prototype._events=void 0,g.prototype._eventsCount=0,g.prototype._maxListeners=void 0;var Y=10;Object.defineProperty(g,"defaultMaxListeners",{enumerable:!0,get:function(){return Y},set:function(N){if(typeof N!="number"||0>N||I(N))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+N+".");Y=N}}),g.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},g.prototype.setMaxListeners=function(N){if(typeof N!="number"||0>N||I(N))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+N+".");return this._maxListeners=N,this},g.prototype.getMaxListeners=function(){return x(this)},g.prototype.emit=function(N){for(var P=[],q=1;q<arguments.length;q++)P.push(arguments[q]);var it=N==="error",bt=this._events;if(bt!==void 0)it=it&&bt.error===void 0;else if(!it)return!1;if(it){var Et;if(0<P.length&&(Et=P[0]),Et instanceof Error)throw Et;var Tt=new Error("Unhandled error."+(Et?" ("+Et.message+")":""));throw Tt.context=Et,Tt}var At=bt[N];if(At===void 0)return!1;if(typeof At=="function")v(At,this,P);else for(var Ut=At.length,wt=R(At,Ut),q=0;q<Ut;++q)v(wt[q],this,P);return!0},g.prototype.addListener=function(N,P){return a(this,N,P,!1)},g.prototype.on=g.prototype.addListener,g.prototype.prependListener=function(N,P){return a(this,N,P,!0)},g.prototype.once=function(N,P){return U(P),this.on(N,h(this,N,P)),this},g.prototype.prependOnceListener=function(N,P){return U(P),this.prependListener(N,h(this,N,P)),this},g.prototype.removeListener=function(N,P){var q,it,bt,Et,Tt;if(U(P),it=this._events,it===void 0)return this;if(q=it[N],q===void 0)return this;if(q===P||q.listener===P)--this._eventsCount==0?this._events=Object.create(null):(delete it[N],it.removeListener&&this.emit("removeListener",N,q.listener||P));else if(typeof q!="function"){for(bt=-1,Et=q.length-1;0<=Et;Et--)if(q[Et]===P||q[Et].listener===P){Tt=q[Et].listener,bt=Et;break}if(0>bt)return this;bt===0?q.shift():S(q,bt),q.length===1&&(it[N]=q[0]),it.removeListener!==void 0&&this.emit("removeListener",N,Tt||P)}return this},g.prototype.off=g.prototype.removeListener,g.prototype.removeAllListeners=function(N){var P,q,it;if(q=this._events,q===void 0)return this;if(q.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):q[N]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete q[N]),this;if(arguments.length===0){var bt,Et=Object.keys(q);for(it=0;it<Et.length;++it)bt=Et[it],bt!=="removeListener"&&this.removeAllListeners(bt);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(P=q[N],typeof P=="function")this.removeListener(N,P);else if(P!==void 0)for(it=P.length-1;0<=it;it--)this.removeListener(N,P[it]);return this},g.prototype.listeners=function(N){return d(this,N,!0)},g.prototype.rawListeners=function(N){return d(this,N,!1)},g.listenerCount=function(N,P){return typeof N.listenerCount=="function"?N.listenerCount(P):T.call(N,P)},g.prototype.listenerCount=T,g.prototype.eventNames=function(){return 0<this._eventsCount?m(this._events):[]}},{}],8:[function(M,D){D.exports=function(){if(typeof globalThis=="undefined")return null;var y={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return y.RTCPeerConnection?y:null}},{}],9:[function(M,D,y){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */y.read=function(g,U,x,a,b){var h,d,T=8*b-a-1,R=(1<<T)-1,S=R>>1,B=-7,u=x?b-1:0,w=x?-1:1,m=g[U+u];for(u+=w,h=m&(1<<-B)-1,m>>=-B,B+=T;0<B;h=256*h+g[U+u],u+=w,B-=8);for(d=h&(1<<-B)-1,h>>=-B,B+=a;0<B;d=256*d+g[U+u],u+=w,B-=8);if(h===0)h=1-S;else{if(h===R)return d?NaN:(m?-1:1)*(1/0);d+=ut(2,a),h-=S}return(m?-1:1)*d*ut(2,h-a)},y.write=function(g,U,x,a,b,h){var d,T,R,S=Math.LN2,B=Math.log,u=8*h-b-1,w=(1<<u)-1,m=w>>1,E=b===23?ut(2,-24)-ut(2,-77):0,v=a?0:h-1,I=a?1:-1,Y=0>U||U===0&&0>1/U?1:0;for(U=ct(U),isNaN(U)||U===1/0?(T=isNaN(U)?1:0,d=w):(d=ft(B(U)/S),1>U*(R=ut(2,-d))&&(d--,R*=2),U+=1<=d+m?E/R:E*ut(2,1-m),2<=U*R&&(d++,R/=2),d+m>=w?(T=0,d=w):1<=d+m?(T=(U*R-1)*ut(2,b),d+=m):(T=U*ut(2,m-1)*ut(2,b),d=0));8<=b;g[x+v]=255&T,v+=I,T/=256,b-=8);for(d=d<<b|T,u+=b;0<u;g[x+v]=255&d,v+=I,d/=256,u-=8);g[x+v-I]|=128*Y}},{}],10:[function(M,D){D.exports=typeof Object.create=="function"?function(y,g){g&&(y.super_=g,y.prototype=Object.create(g.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}))}:function(y,g){if(g){y.super_=g;var U=function(){};U.prototype=g.prototype,y.prototype=new U,y.prototype.constructor=y}}},{}],11:[function(M,D){var y=Math.round;function g(h){if(h+="",!(100<h.length)){var d=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(h);if(d){var T=parseFloat(d[1]),R=(d[2]||"ms").toLowerCase();return R==="years"||R==="year"||R==="yrs"||R==="yr"||R==="y"?315576e5*T:R==="weeks"||R==="week"||R==="w"?6048e5*T:R==="days"||R==="day"||R==="d"?864e5*T:R==="hours"||R==="hour"||R==="hrs"||R==="hr"||R==="h"?36e5*T:R==="minutes"||R==="minute"||R==="mins"||R==="min"||R==="m"?6e4*T:R==="seconds"||R==="second"||R==="secs"||R==="sec"||R==="s"?1e3*T:R==="milliseconds"||R==="millisecond"||R==="msecs"||R==="msec"||R==="ms"?T:void 0}}}function U(h){var d=ct(h);return 864e5<=d?y(h/864e5)+"d":36e5<=d?y(h/36e5)+"h":6e4<=d?y(h/6e4)+"m":1e3<=d?y(h/1e3)+"s":h+"ms"}function x(h){var d=ct(h);return 864e5<=d?a(h,d,864e5,"day"):36e5<=d?a(h,d,36e5,"hour"):6e4<=d?a(h,d,6e4,"minute"):1e3<=d?a(h,d,1e3,"second"):h+" ms"}function a(h,d,T,R){return y(h/T)+" "+R+(d>=1.5*T?"s":"")}var b=24*(60*6e4);D.exports=function(h,d){d=d||{};var T=typeof h;if(T=="string"&&0<h.length)return g(h);if(T==="number"&&isFinite(h))return d.long?x(h):U(h);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(h))}},{}],12:[function(M,D){function y(){throw new Error("setTimeout has not been defined")}function g(){throw new Error("clearTimeout has not been defined")}function U(E){if(T===setTimeout)return setTimeout(E,0);if((T===y||!T)&&setTimeout)return T=setTimeout,setTimeout(E,0);try{return T(E,0)}catch(v){try{return T.call(null,E,0)}catch(I){return T.call(this,E,0)}}}function x(E){if(R===clearTimeout)return clearTimeout(E);if((R===g||!R)&&clearTimeout)return R=clearTimeout,clearTimeout(E);try{return R(E)}catch(v){try{return R.call(null,E)}catch(I){return R.call(this,E)}}}function a(){w&&B&&(w=!1,B.length?u=B.concat(u):m=-1,u.length&&b())}function b(){if(!w){var E=U(a);w=!0;for(var v=u.length;v;){for(B=u,u=[];++m<v;)B&&B[m].run();m=-1,v=u.length}B=null,w=!1,x(E)}}function h(E,v){this.fun=E,this.array=v}function d(){}var T,R,S=D.exports={};(function(){try{T=typeof setTimeout=="function"?setTimeout:y}catch(E){T=y}try{R=typeof clearTimeout=="function"?clearTimeout:g}catch(E){R=g}})();var B,u=[],w=!1,m=-1;S.nextTick=function(E){var v=Array(arguments.length-1);if(1<arguments.length)for(var I=1;I<arguments.length;I++)v[I-1]=arguments[I];u.push(new h(E,v)),u.length!==1||w||U(b)},h.prototype.run=function(){this.fun.apply(null,this.array)},S.title="browser",S.browser=!0,S.env={},S.argv=[],S.version="",S.versions={},S.on=d,S.addListener=d,S.once=d,S.off=d,S.removeListener=d,S.removeAllListeners=d,S.emit=d,S.prependListener=d,S.prependOnceListener=d,S.listeners=function(){return[]},S.binding=function(){throw new Error("process.binding is not supported")},S.cwd=function(){return"/"},S.chdir=function(){throw new Error("process.chdir is not supported")},S.umask=function(){return 0}},{}],13:[function(M,D){(function(y){(function(){/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let g;D.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window=="undefined"?y:window):U=>(g||(g=Promise.resolve())).then(U).catch(x=>setTimeout(()=>{throw x},0))}).call(this)}).call(this,typeof $.g=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:$.g)},{}],14:[function(M,D){(function(y,g){(function(){"use strict";var U=M("safe-buffer").Buffer,x=g.crypto||g.msCrypto;D.exports=x&&x.getRandomValues?function(a,b){if(a>4294967295)throw new RangeError("requested too many random bytes");var h=U.allocUnsafe(a);if(0<a)if(65536<a)for(var d=0;d<a;d+=65536)x.getRandomValues(h.slice(d,d+65536));else x.getRandomValues(h);return typeof b=="function"?y.nextTick(function(){b(null,h)}):h}:function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,M("_process"),typeof $.g=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:$.g)},{_process:12,"safe-buffer":30}],15:[function(M,D){"use strict";function y(d,T){d.prototype=Object.create(T.prototype),d.prototype.constructor=d,d.__proto__=T}function g(d,T,R){function S(u,w,m){return typeof T=="string"?T:T(u,w,m)}R||(R=Error);var B=function(u){function w(m,E,v){return u.call(this,S(m,E,v))||this}return y(w,u),w}(R);B.prototype.name=R.name,B.prototype.code=d,h[d]=B}function U(d,T){if(Array.isArray(d)){var R=d.length;return d=d.map(function(S){return S+""}),2<R?"one of ".concat(T," ").concat(d.slice(0,R-1).join(", "),", or ")+d[R-1]:R===2?"one of ".concat(T," ").concat(d[0]," or ").concat(d[1]):"of ".concat(T," ").concat(d[0])}return"of ".concat(T," ").concat(d+"")}function x(d,T,R){return d.substr(!R||0>R?0:+R,T.length)===T}function a(d,T,R){return(R===void 0||R>d.length)&&(R=d.length),d.substring(R-T.length,R)===T}function b(d,T,R){return typeof R!="number"&&(R=0),!(R+T.length>d.length)&&d.indexOf(T,R)!==-1}var h={};g("ERR_INVALID_OPT_VALUE",function(d,T){return'The value "'+T+'" is invalid for option "'+d+'"'},TypeError),g("ERR_INVALID_ARG_TYPE",function(d,T,R){var S;typeof T=="string"&&x(T,"not ")?(S="must not be",T=T.replace(/^not /,"")):S="must be";var B;if(a(d," argument"))B="The ".concat(d," ").concat(S," ").concat(U(T,"type"));else{var u=b(d,".")?"property":"argument";B='The "'.concat(d,'" ').concat(u," ").concat(S," ").concat(U(T,"type"))}return B+=". Received type ".concat(typeof R),B},TypeError),g("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),g("ERR_METHOD_NOT_IMPLEMENTED",function(d){return"The "+d+" method is not implemented"}),g("ERR_STREAM_PREMATURE_CLOSE","Premature close"),g("ERR_STREAM_DESTROYED",function(d){return"Cannot call "+d+" after a stream was destroyed"}),g("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),g("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),g("ERR_STREAM_WRITE_AFTER_END","write after end"),g("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),g("ERR_UNKNOWN_ENCODING",function(d){return"Unknown encoding: "+d},TypeError),g("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),D.exports.codes=h},{}],16:[function(M,D){(function(y){(function(){"use strict";function g(S){return this instanceof g?(b.call(this,S),h.call(this,S),this.allowHalfOpen=!0,void(S&&(S.readable===!1&&(this.readable=!1),S.writable===!1&&(this.writable=!1),S.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",U))))):new g(S)}function U(){this._writableState.ended||y.nextTick(x,this)}function x(S){S.end()}var a=Object.keys||function(S){var B=[];for(var u in S)B.push(u);return B};D.exports=g;var b=M("./_stream_readable"),h=M("./_stream_writable");M("inherits")(g,b);for(var d,T=a(h.prototype),R=0;R<T.length;R++)d=T[R],g.prototype[d]||(g.prototype[d]=h.prototype[d]);Object.defineProperty(g.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(g.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(g.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(g.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(S){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=S,this._writableState.destroyed=S)}})}).call(this)}).call(this,M("_process"))},{"./_stream_readable":18,"./_stream_writable":20,_process:12,inherits:10}],17:[function(M,D){"use strict";function y(U){return this instanceof y?void g.call(this,U):new y(U)}D.exports=y;var g=M("./_stream_transform");M("inherits")(y,g),y.prototype._transform=function(U,x,a){a(null,U)}},{"./_stream_transform":19,inherits:10}],18:[function(M,D){(function(y,g){(function(){"use strict";function U(n){return et.from(n)}function x(n){return et.isBuffer(n)||n instanceof lt}function a(n,r,c){return typeof n.prependListener=="function"?n.prependListener(r,c):void(n._events&&n._events[r]?Array.isArray(n._events[r])?n._events[r].unshift(c):n._events[r]=[c,n._events[r]]:n.on(r,c))}function b(n,r,c){Ut=Ut||M("./_stream_duplex"),n=n||{},typeof c!="boolean"&&(c=r instanceof Ut),this.objectMode=!!n.objectMode,c&&(this.objectMode=this.objectMode||!!n.readableObjectMode),this.highWaterMark=te(this,n,"readableHighWaterMark",c),this.buffer=new Xt,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=n.emitClose!==!1,this.autoDestroy=!!n.autoDestroy,this.destroyed=!1,this.defaultEncoding=n.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,n.encoding&&(!_t&&(_t=M("string_decoder/").StringDecoder),this.decoder=new _t(n.encoding),this.encoding=n.encoding)}function h(n){if(Ut=Ut||M("./_stream_duplex"),!(this instanceof h))return new h(n);var r=this instanceof Ut;this._readableState=new b(n,this,r),this.readable=!0,n&&(typeof n.read=="function"&&(this._read=n.read),typeof n.destroy=="function"&&(this._destroy=n.destroy)),st.call(this)}function d(n,r,c,k,K){wt("readableAddChunk",r);var z=n._readableState;if(r===null)z.reading=!1,u(n,z);else{var at;if(K||(at=R(z,r)),at)L(n,at);else if(!(z.objectMode||r&&0<r.length))k||(z.reading=!1,E(n,z));else if(typeof r=="string"||z.objectMode||Object.getPrototypeOf(r)===et.prototype||(r=U(r)),k)z.endEmitted?L(n,new C):T(n,z,r,!0);else if(z.ended)L(n,new O);else{if(z.destroyed)return!1;z.reading=!1,z.decoder&&!c?(r=z.decoder.write(r),z.objectMode||r.length!==0?T(n,z,r,!1):E(n,z)):T(n,z,r,!1)}}return!z.ended&&(z.length<z.highWaterMark||z.length===0)}function T(n,r,c,k){r.flowing&&r.length===0&&!r.sync?(r.awaitDrain=0,n.emit("data",c)):(r.length+=r.objectMode?1:c.length,k?r.buffer.unshift(c):r.buffer.push(c),r.needReadable&&w(n)),E(n,r)}function R(n,r){var c;return x(r)||typeof r=="string"||r===void 0||n.objectMode||(c=new ot("chunk",["string","Buffer","Uint8Array"],r)),c}function S(n){return 1073741824<=n?n=1073741824:(n--,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n++),n}function B(n,r){return 0>=n||r.length===0&&r.ended?0:r.objectMode?1:n===n?(n>r.highWaterMark&&(r.highWaterMark=S(n)),n<=r.length?n:r.ended?r.length:(r.needReadable=!0,0)):r.flowing&&r.length?r.buffer.head.data.length:r.length}function u(n,r){if(wt("onEofChunk"),!r.ended){if(r.decoder){var c=r.decoder.end();c&&c.length&&(r.buffer.push(c),r.length+=r.objectMode?1:c.length)}r.ended=!0,r.sync?w(n):(r.needReadable=!1,!r.emittedReadable&&(r.emittedReadable=!0,m(n)))}}function w(n){var r=n._readableState;wt("emitReadable",r.needReadable,r.emittedReadable),r.needReadable=!1,r.emittedReadable||(wt("emitReadable",r.flowing),r.emittedReadable=!0,y.nextTick(m,n))}function m(n){var r=n._readableState;wt("emitReadable_",r.destroyed,r.length,r.ended),!r.destroyed&&(r.length||r.ended)&&(n.emit("readable"),r.emittedReadable=!1),r.needReadable=!r.flowing&&!r.ended&&r.length<=r.highWaterMark,it(n)}function E(n,r){r.readingMore||(r.readingMore=!0,y.nextTick(v,n,r))}function v(n,r){for(;!r.reading&&!r.ended&&(r.length<r.highWaterMark||r.flowing&&r.length===0);){var c=r.length;if(wt("maybeReadMore read 0"),n.read(0),c===r.length)break}r.readingMore=!1}function I(n){return function(){var r=n._readableState;wt("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,r.awaitDrain===0&&$t(n,"data")&&(r.flowing=!0,it(n))}}function Y(n){var r=n._readableState;r.readableListening=0<n.listenerCount("readable"),r.resumeScheduled&&!r.paused?r.flowing=!0:0<n.listenerCount("data")&&n.resume()}function N(n){wt("readable nexttick read 0"),n.read(0)}function P(n,r){r.resumeScheduled||(r.resumeScheduled=!0,y.nextTick(q,n,r))}function q(n,r){wt("resume",r.reading),r.reading||n.read(0),r.resumeScheduled=!1,n.emit("resume"),it(n),r.flowing&&!r.reading&&n.read(0)}function it(n){var r=n._readableState;for(wt("flow",r.flowing);r.flowing&&n.read()!==null;);}function bt(n,r){if(r.length===0)return null;var c;return r.objectMode?c=r.buffer.shift():!n||n>=r.length?(c=r.decoder?r.buffer.join(""):r.buffer.length===1?r.buffer.first():r.buffer.concat(r.length),r.buffer.clear()):c=r.buffer.consume(n,r.decoder),c}function Et(n){var r=n._readableState;wt("endReadable",r.endEmitted),r.endEmitted||(r.ended=!0,y.nextTick(Tt,r,n))}function Tt(n,r){if(wt("endReadableNT",n.endEmitted,n.length),!n.endEmitted&&n.length===0&&(n.endEmitted=!0,r.readable=!1,r.emit("end"),n.autoDestroy)){var c=r._writableState;(!c||c.autoDestroy&&c.finished)&&r.destroy()}}function At(n,r){for(var c=0,k=n.length;c<k;c++)if(n[c]===r)return c;return-1}D.exports=h;var Ut;h.ReadableState=b;var wt,Jt=M("events").EventEmitter,$t=function(n,r){return n.listeners(r).length},st=M("./internal/streams/stream"),et=M("buffer").Buffer,lt=g.Uint8Array||function(){},yt=M("util");wt=yt&&yt.debuglog?yt.debuglog("stream"):function(){};var _t,Rt,xt,Xt=M("./internal/streams/buffer_list"),Pt=M("./internal/streams/destroy"),ee=M("./internal/streams/state"),te=ee.getHighWaterMark,W=M("../errors").codes,ot=W.ERR_INVALID_ARG_TYPE,O=W.ERR_STREAM_PUSH_AFTER_EOF,G=W.ERR_METHOD_NOT_IMPLEMENTED,C=W.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;M("inherits")(h,st);var L=Pt.errorOrDestroy,rt=["error","close","destroy","pause","resume"];Object.defineProperty(h.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(n){this._readableState&&(this._readableState.destroyed=n)}}),h.prototype.destroy=Pt.destroy,h.prototype._undestroy=Pt.undestroy,h.prototype._destroy=function(n,r){r(n)},h.prototype.push=function(n,r){var c,k=this._readableState;return k.objectMode?c=!0:typeof n=="string"&&(r=r||k.defaultEncoding,r!==k.encoding&&(n=et.from(n,r),r=""),c=!0),d(this,n,r,!1,c)},h.prototype.unshift=function(n){return d(this,n,null,!0,!1)},h.prototype.isPaused=function(){return this._readableState.flowing===!1},h.prototype.setEncoding=function(n){_t||(_t=M("string_decoder/").StringDecoder);var r=new _t(n);this._readableState.decoder=r,this._readableState.encoding=this._readableState.decoder.encoding;for(var c=this._readableState.buffer.head,k="";c!==null;)k+=r.write(c.data),c=c.next;return this._readableState.buffer.clear(),k!==""&&this._readableState.buffer.push(k),this._readableState.length=k.length,this},h.prototype.read=function(n){wt("read",n),n=parseInt(n,10);var r=this._readableState,c=n;if(n!==0&&(r.emittedReadable=!1),n===0&&r.needReadable&&((r.highWaterMark===0?0<r.length:r.length>=r.highWaterMark)||r.ended))return wt("read: emitReadable",r.length,r.ended),r.length===0&&r.ended?Et(this):w(this),null;if(n=B(n,r),n===0&&r.ended)return r.length===0&&Et(this),null;var k=r.needReadable;wt("need readable",k),(r.length===0||r.length-n<r.highWaterMark)&&(k=!0,wt("length less than watermark",k)),r.ended||r.reading?(k=!1,wt("reading or ended",k)):k&&(wt("do read"),r.reading=!0,r.sync=!0,r.length===0&&(r.needReadable=!0),this._read(r.highWaterMark),r.sync=!1,!r.reading&&(n=B(c,r)));var K;return K=0<n?bt(n,r):null,K===null?(r.needReadable=r.length<=r.highWaterMark,n=0):(r.length-=n,r.awaitDrain=0),r.length===0&&(!r.ended&&(r.needReadable=!0),c!==n&&r.ended&&Et(this)),K!==null&&this.emit("data",K),K},h.prototype._read=function(){L(this,new G("_read()"))},h.prototype.pipe=function(n,r){function c(gt,jt){wt("onunpipe"),gt===Dt&&jt&&jt.hasUnpiped===!1&&(jt.hasUnpiped=!0,K())}function k(){wt("onend"),n.end()}function K(){wt("cleanup"),n.removeListener("close",Ct),n.removeListener("finish",Bt),n.removeListener("drain",nt),n.removeListener("error",at),n.removeListener("unpipe",c),Dt.removeListener("end",k),Dt.removeListener("end",Ot),Dt.removeListener("data",z),mt=!0,Lt.awaitDrain&&(!n._writableState||n._writableState.needDrain)&&nt()}function z(gt){wt("ondata");var jt=n.write(gt);wt("dest.write",jt),jt===!1&&((Lt.pipesCount===1&&Lt.pipes===n||1<Lt.pipesCount&&At(Lt.pipes,n)!==-1)&&!mt&&(wt("false write response, pause",Lt.awaitDrain),Lt.awaitDrain++),Dt.pause())}function at(gt){wt("onerror",gt),Ot(),n.removeListener("error",at),$t(n,"error")===0&&L(n,gt)}function Ct(){n.removeListener("finish",Bt),Ot()}function Bt(){wt("onfinish"),n.removeListener("close",Ct),Ot()}function Ot(){wt("unpipe"),Dt.unpipe(n)}var Dt=this,Lt=this._readableState;switch(Lt.pipesCount){case 0:Lt.pipes=n;break;case 1:Lt.pipes=[Lt.pipes,n];break;default:Lt.pipes.push(n)}Lt.pipesCount+=1,wt("pipe count=%d opts=%j",Lt.pipesCount,r);var ie=(!r||r.end!==!1)&&n!==y.stdout&&n!==y.stderr,X=ie?k:Ot;Lt.endEmitted?y.nextTick(X):Dt.once("end",X),n.on("unpipe",c);var nt=I(Dt);n.on("drain",nt);var mt=!1;return Dt.on("data",z),a(n,"error",at),n.once("close",Ct),n.once("finish",Bt),n.emit("pipe",Dt),Lt.flowing||(wt("pipe resume"),Dt.resume()),n},h.prototype.unpipe=function(n){var r=this._readableState,c={hasUnpiped:!1};if(r.pipesCount===0)return this;if(r.pipesCount===1)return n&&n!==r.pipes?this:(n||(n=r.pipes),r.pipes=null,r.pipesCount=0,r.flowing=!1,n&&n.emit("unpipe",this,c),this);if(!n){var k=r.pipes,K=r.pipesCount;r.pipes=null,r.pipesCount=0,r.flowing=!1;for(var z=0;z<K;z++)k[z].emit("unpipe",this,{hasUnpiped:!1});return this}var at=At(r.pipes,n);return at===-1?this:(r.pipes.splice(at,1),r.pipesCount-=1,r.pipesCount===1&&(r.pipes=r.pipes[0]),n.emit("unpipe",this,c),this)},h.prototype.on=function(n,r){var c=st.prototype.on.call(this,n,r),k=this._readableState;return n==="data"?(k.readableListening=0<this.listenerCount("readable"),k.flowing!==!1&&this.resume()):n=="readable"&&!k.endEmitted&&!k.readableListening&&(k.readableListening=k.needReadable=!0,k.flowing=!1,k.emittedReadable=!1,wt("on readable",k.length,k.reading),k.length?w(this):!k.reading&&y.nextTick(N,this)),c},h.prototype.addListener=h.prototype.on,h.prototype.removeListener=function(n,r){var c=st.prototype.removeListener.call(this,n,r);return n==="readable"&&y.nextTick(Y,this),c},h.prototype.removeAllListeners=function(n){var r=st.prototype.removeAllListeners.apply(this,arguments);return(n==="readable"||n===void 0)&&y.nextTick(Y,this),r},h.prototype.resume=function(){var n=this._readableState;return n.flowing||(wt("resume"),n.flowing=!n.readableListening,P(this,n)),n.paused=!1,this},h.prototype.pause=function(){return wt("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(wt("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},h.prototype.wrap=function(n){var r=this,c=this._readableState,k=!1;for(var K in n.on("end",function(){if(wt("wrapped end"),c.decoder&&!c.ended){var at=c.decoder.end();at&&at.length&&r.push(at)}r.push(null)}),n.on("data",function(at){if(wt("wrapped data"),c.decoder&&(at=c.decoder.write(at)),!(c.objectMode&&at==null)&&(c.objectMode||at&&at.length)){var Ct=r.push(at);Ct||(k=!0,n.pause())}}),n)this[K]===void 0&&typeof n[K]=="function"&&(this[K]=function(at){return function(){return n[at].apply(n,arguments)}}(K));for(var z=0;z<rt.length;z++)n.on(rt[z],this.emit.bind(this,rt[z]));return this._read=function(at){wt("wrapped _read",at),k&&(k=!1,n.resume())},this},typeof Symbol=="function"&&(h.prototype[Symbol.asyncIterator]=function(){return Rt===void 0&&(Rt=M("./internal/streams/async_iterator")),Rt(this)}),Object.defineProperty(h.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(h.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(h.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(n){this._readableState&&(this._readableState.flowing=n)}}),h._fromList=bt,Object.defineProperty(h.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(h.from=function(n,r){return xt===void 0&&(xt=M("./internal/streams/from")),xt(h,n,r)})}).call(this)}).call(this,M("_process"),typeof $.g=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:$.g)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,events:7,inherits:10,"string_decoder/":31,util:2}],19:[function(M,D){"use strict";function y(S,B){var u=this._transformState;u.transforming=!1;var w=u.writecb;if(w===null)return this.emit("error",new h);u.writechunk=null,u.writecb=null,B!=null&&this.push(B),w(S);var m=this._readableState;m.reading=!1,(m.needReadable||m.length<m.highWaterMark)&&this._read(m.highWaterMark)}function g(S){return this instanceof g?(R.call(this,S),this._transformState={afterTransform:y.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,S&&(typeof S.transform=="function"&&(this._transform=S.transform),typeof S.flush=="function"&&(this._flush=S.flush)),void this.on("prefinish",U)):new g(S)}function U(){var S=this;typeof this._flush!="function"||this._readableState.destroyed?x(this,null,null):this._flush(function(B,u){x(S,B,u)})}function x(S,B,u){if(B)return S.emit("error",B);if(u!=null&&S.push(u),S._writableState.length)throw new T;if(S._transformState.transforming)throw new d;return S.push(null)}D.exports=g;var a=M("../errors").codes,b=a.ERR_METHOD_NOT_IMPLEMENTED,h=a.ERR_MULTIPLE_CALLBACK,d=a.ERR_TRANSFORM_ALREADY_TRANSFORMING,T=a.ERR_TRANSFORM_WITH_LENGTH_0,R=M("./_stream_duplex");M("inherits")(g,R),g.prototype.push=function(S,B){return this._transformState.needTransform=!1,R.prototype.push.call(this,S,B)},g.prototype._transform=function(S,B,u){u(new b("_transform()"))},g.prototype._write=function(S,B,u){var w=this._transformState;if(w.writecb=u,w.writechunk=S,w.writeencoding=B,!w.transforming){var m=this._readableState;(w.needTransform||m.needReadable||m.length<m.highWaterMark)&&this._read(m.highWaterMark)}},g.prototype._read=function(){var S=this._transformState;S.writechunk===null||S.transforming?S.needTransform=!0:(S.transforming=!0,this._transform(S.writechunk,S.writeencoding,S.afterTransform))},g.prototype._destroy=function(S,B){R.prototype._destroy.call(this,S,function(u){B(u)})}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(M,D){(function(y,g){(function(){"use strict";function U(O){var G=this;this.next=null,this.entry=null,this.finish=function(){Et(G,O)}}function x(O){return wt.from(O)}function a(O){return wt.isBuffer(O)||O instanceof Jt}function b(){}function h(O,G,C){Tt=Tt||M("./_stream_duplex"),O=O||{},typeof C!="boolean"&&(C=G instanceof Tt),this.objectMode=!!O.objectMode,C&&(this.objectMode=this.objectMode||!!O.writableObjectMode),this.highWaterMark=et(this,O,"writableHighWaterMark",C),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var L=O.decodeStrings===!1;this.decodeStrings=!L,this.defaultEncoding=O.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(rt){E(G,rt)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=O.emitClose!==!1,this.autoDestroy=!!O.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new U(this)}function d(O){Tt=Tt||M("./_stream_duplex");var G=this instanceof Tt;return G||ot.call(d,this)?(this._writableState=new h(O,this,G),this.writable=!0,O&&(typeof O.write=="function"&&(this._write=O.write),typeof O.writev=="function"&&(this._writev=O.writev),typeof O.destroy=="function"&&(this._destroy=O.destroy),typeof O.final=="function"&&(this._final=O.final)),void Ut.call(this)):new d(O)}function T(O,G){var C=new ee;W(O,C),y.nextTick(G,C)}function R(O,G,C,L){var rt;return C===null?rt=new Pt:typeof C!="string"&&!G.objectMode&&(rt=new yt("chunk",["string","Buffer"],C)),!rt||(W(O,rt),y.nextTick(L,rt),!1)}function S(O,G,C){return O.objectMode||O.decodeStrings===!1||typeof G!="string"||(G=wt.from(G,C)),G}function B(O,G,C,L,rt,n){if(!C){var r=S(G,L,rt);L!==r&&(C=!0,rt="buffer",L=r)}var c=G.objectMode?1:L.length;G.length+=c;var k=G.length<G.highWaterMark;if(k||(G.needDrain=!0),G.writing||G.corked){var K=G.lastBufferedRequest;G.lastBufferedRequest={chunk:L,encoding:rt,isBuf:C,callback:n,next:null},K?K.next=G.lastBufferedRequest:G.bufferedRequest=G.lastBufferedRequest,G.bufferedRequestCount+=1}else u(O,G,!1,c,L,rt,n);return k}function u(O,G,C,L,rt,n,r){G.writelen=L,G.writecb=r,G.writing=!0,G.sync=!0,G.destroyed?G.onwrite(new Xt("write")):C?O._writev(rt,G.onwrite):O._write(rt,n,G.onwrite),G.sync=!1}function w(O,G,C,L,rt){--G.pendingcb,C?(y.nextTick(rt,L),y.nextTick(it,O,G),O._writableState.errorEmitted=!0,W(O,L)):(rt(L),O._writableState.errorEmitted=!0,W(O,L),it(O,G))}function m(O){O.writing=!1,O.writecb=null,O.length-=O.writelen,O.writelen=0}function E(O,G){var C=O._writableState,L=C.sync,rt=C.writecb;if(typeof rt!="function")throw new Rt;if(m(C),G)w(O,C,L,G,rt);else{var n=N(C)||O.destroyed;n||C.corked||C.bufferProcessing||!C.bufferedRequest||Y(O,C),L?y.nextTick(v,O,C,n,rt):v(O,C,n,rt)}}function v(O,G,C,L){C||I(O,G),G.pendingcb--,L(),it(O,G)}function I(O,G){G.length===0&&G.needDrain&&(G.needDrain=!1,O.emit("drain"))}function Y(O,G){G.bufferProcessing=!0;var C=G.bufferedRequest;if(O._writev&&C&&C.next){var L=G.bufferedRequestCount,rt=Array(L),n=G.corkedRequestsFree;n.entry=C;for(var r=0,c=!0;C;)rt[r]=C,C.isBuf||(c=!1),C=C.next,r+=1;rt.allBuffers=c,u(O,G,!0,G.length,rt,"",n.finish),G.pendingcb++,G.lastBufferedRequest=null,n.next?(G.corkedRequestsFree=n.next,n.next=null):G.corkedRequestsFree=new U(G),G.bufferedRequestCount=0}else{for(;C;){var k=C.chunk,K=C.encoding,z=C.callback,at=G.objectMode?1:k.length;if(u(O,G,!1,at,k,K,z),C=C.next,G.bufferedRequestCount--,G.writing)break}C===null&&(G.lastBufferedRequest=null)}G.bufferedRequest=C,G.bufferProcessing=!1}function N(O){return O.ending&&O.length===0&&O.bufferedRequest===null&&!O.finished&&!O.writing}function P(O,G){O._final(function(C){G.pendingcb--,C&&W(O,C),G.prefinished=!0,O.emit("prefinish"),it(O,G)})}function q(O,G){G.prefinished||G.finalCalled||(typeof O._final!="function"||G.destroyed?(G.prefinished=!0,O.emit("prefinish")):(G.pendingcb++,G.finalCalled=!0,y.nextTick(P,O,G)))}function it(O,G){var C=N(G);if(C&&(q(O,G),G.pendingcb===0&&(G.finished=!0,O.emit("finish"),G.autoDestroy))){var L=O._readableState;(!L||L.autoDestroy&&L.endEmitted)&&O.destroy()}return C}function bt(O,G,C){G.ending=!0,it(O,G),C&&(G.finished?y.nextTick(C):O.once("finish",C)),G.ended=!0,O.writable=!1}function Et(O,G,C){var L=O.entry;for(O.entry=null;L;){var rt=L.callback;G.pendingcb--,rt(C),L=L.next}G.corkedRequestsFree.next=O}D.exports=d;var Tt;d.WritableState=h;var At={deprecate:M("util-deprecate")},Ut=M("./internal/streams/stream"),wt=M("buffer").Buffer,Jt=g.Uint8Array||function(){},$t=M("./internal/streams/destroy"),st=M("./internal/streams/state"),et=st.getHighWaterMark,lt=M("../errors").codes,yt=lt.ERR_INVALID_ARG_TYPE,_t=lt.ERR_METHOD_NOT_IMPLEMENTED,Rt=lt.ERR_MULTIPLE_CALLBACK,xt=lt.ERR_STREAM_CANNOT_PIPE,Xt=lt.ERR_STREAM_DESTROYED,Pt=lt.ERR_STREAM_NULL_VALUES,ee=lt.ERR_STREAM_WRITE_AFTER_END,te=lt.ERR_UNKNOWN_ENCODING,W=$t.errorOrDestroy;M("inherits")(d,Ut),h.prototype.getBuffer=function(){for(var O=this.bufferedRequest,G=[];O;)G.push(O),O=O.next;return G},function(){try{Object.defineProperty(h.prototype,"buffer",{get:At.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(O){}}();var ot;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(ot=Function.prototype[Symbol.hasInstance],Object.defineProperty(d,Symbol.hasInstance,{value:function(O){return!!ot.call(this,O)||this===d&&O&&O._writableState instanceof h}})):ot=function(O){return O instanceof this},d.prototype.pipe=function(){W(this,new xt)},d.prototype.write=function(O,G,C){var L=this._writableState,rt=!1,n=!L.objectMode&&a(O);return n&&!wt.isBuffer(O)&&(O=x(O)),typeof G=="function"&&(C=G,G=null),n?G="buffer":!G&&(G=L.defaultEncoding),typeof C!="function"&&(C=b),L.ending?T(this,C):(n||R(this,L,O,C))&&(L.pendingcb++,rt=B(this,L,n,O,G,C)),rt},d.prototype.cork=function(){this._writableState.corked++},d.prototype.uncork=function(){var O=this._writableState;O.corked&&(O.corked--,!O.writing&&!O.corked&&!O.bufferProcessing&&O.bufferedRequest&&Y(this,O))},d.prototype.setDefaultEncoding=function(O){if(typeof O=="string"&&(O=O.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((O+"").toLowerCase())))throw new te(O);return this._writableState.defaultEncoding=O,this},Object.defineProperty(d.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),d.prototype._write=function(O,G,C){C(new _t("_write()"))},d.prototype._writev=null,d.prototype.end=function(O,G,C){var L=this._writableState;return typeof O=="function"?(C=O,O=null,G=null):typeof G=="function"&&(C=G,G=null),O!=null&&this.write(O,G),L.corked&&(L.corked=1,this.uncork()),L.ending||bt(this,L,C),this},Object.defineProperty(d.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(d.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(O){this._writableState&&(this._writableState.destroyed=O)}}),d.prototype.destroy=$t.destroy,d.prototype._undestroy=$t.undestroy,d.prototype._destroy=function(O,G){G(O)}}).call(this)}).call(this,M("_process"),typeof $.g=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:$.g)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,inherits:10,"util-deprecate":32}],21:[function(M,D){(function(y){(function(){"use strict";function g(I,Y,N){return Y in I?Object.defineProperty(I,Y,{value:N,enumerable:!0,configurable:!0,writable:!0}):I[Y]=N,I}function U(I,Y){return{value:I,done:Y}}function x(I){var Y=I[T];if(Y!==null){var N=I[m].read();N!==null&&(I[u]=null,I[T]=null,I[R]=null,Y(U(N,!1)))}}function a(I){y.nextTick(x,I)}function b(I,Y){return function(N,P){I.then(function(){return Y[B]?void N(U(void 0,!0)):void Y[w](N,P)},P)}}var h,d=M("./end-of-stream"),T=Symbol("lastResolve"),R=Symbol("lastReject"),S=Symbol("error"),B=Symbol("ended"),u=Symbol("lastPromise"),w=Symbol("handlePromise"),m=Symbol("stream"),E=Object.getPrototypeOf(function(){}),v=Object.setPrototypeOf((h={get stream(){return this[m]},next:function(){var I=this,Y=this[S];if(Y!==null)return Promise.reject(Y);if(this[B])return Promise.resolve(U(void 0,!0));if(this[m].destroyed)return new Promise(function(it,bt){y.nextTick(function(){I[S]?bt(I[S]):it(U(void 0,!0))})});var N,P=this[u];if(P)N=new Promise(b(P,this));else{var q=this[m].read();if(q!==null)return Promise.resolve(U(q,!1));N=new Promise(this[w])}return this[u]=N,N}},g(h,Symbol.asyncIterator,function(){return this}),g(h,"return",function(){var I=this;return new Promise(function(Y,N){I[m].destroy(null,function(P){return P?void N(P):void Y(U(void 0,!0))})})}),h),E);D.exports=function(I){var Y,N=Object.create(v,(Y={},g(Y,m,{value:I,writable:!0}),g(Y,T,{value:null,writable:!0}),g(Y,R,{value:null,writable:!0}),g(Y,S,{value:null,writable:!0}),g(Y,B,{value:I._readableState.endEmitted,writable:!0}),g(Y,w,{value:function(P,q){var it=N[m].read();it?(N[u]=null,N[T]=null,N[R]=null,P(U(it,!1))):(N[T]=P,N[R]=q)},writable:!0}),Y));return N[u]=null,d(I,function(P){if(P&&P.code!=="ERR_STREAM_PREMATURE_CLOSE"){var q=N[R];return q!==null&&(N[u]=null,N[T]=null,N[R]=null,q(P)),void(N[S]=P)}var it=N[T];it!==null&&(N[u]=null,N[T]=null,N[R]=null,it(U(void 0,!0))),N[B]=!0}),I.on("readable",a.bind(null,N)),N}}).call(this)}).call(this,M("_process"))},{"./end-of-stream":24,_process:12}],22:[function(M,D){"use strict";function y(u,w){var m=Object.keys(u);if(Object.getOwnPropertySymbols){var E=Object.getOwnPropertySymbols(u);w&&(E=E.filter(function(v){return Object.getOwnPropertyDescriptor(u,v).enumerable})),m.push.apply(m,E)}return m}function g(u){for(var w,m=1;m<arguments.length;m++)w=arguments[m]==null?{}:arguments[m],m%2?y(Object(w),!0).forEach(function(E){U(u,E,w[E])}):Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(w)):y(Object(w)).forEach(function(E){Object.defineProperty(u,E,Object.getOwnPropertyDescriptor(w,E))});return u}function U(u,w,m){return w in u?Object.defineProperty(u,w,{value:m,enumerable:!0,configurable:!0,writable:!0}):u[w]=m,u}function x(u,w){if(!(u instanceof w))throw new TypeError("Cannot call a class as a function")}function a(u,w){for(var m,E=0;E<w.length;E++)m=w[E],m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(u,m.key,m)}function b(u,w,m){return w&&a(u.prototype,w),m&&a(u,m),u}function h(u,w,m){T.prototype.copy.call(u,w,m)}var d=M("buffer"),T=d.Buffer,R=M("util"),S=R.inspect,B=S&&S.custom||"inspect";D.exports=function(){function u(){x(this,u),this.head=null,this.tail=null,this.length=0}return b(u,[{key:"push",value:function(w){var m={data:w,next:null};0<this.length?this.tail.next=m:this.head=m,this.tail=m,++this.length}},{key:"unshift",value:function(w){var m={data:w,next:this.head};this.length===0&&(this.tail=m),this.head=m,++this.length}},{key:"shift",value:function(){if(this.length!==0){var w=this.head.data;return this.head=this.length===1?this.tail=null:this.head.next,--this.length,w}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(w){if(this.length===0)return"";for(var m=this.head,E=""+m.data;m=m.next;)E+=w+m.data;return E}},{key:"concat",value:function(w){if(this.length===0)return T.alloc(0);for(var m=T.allocUnsafe(w>>>0),E=this.head,v=0;E;)h(E.data,m,v),v+=E.data.length,E=E.next;return m}},{key:"consume",value:function(w,m){var E;return w<this.head.data.length?(E=this.head.data.slice(0,w),this.head.data=this.head.data.slice(w)):w===this.head.data.length?E=this.shift():E=m?this._getString(w):this._getBuffer(w),E}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(w){var m=this.head,E=1,v=m.data;for(w-=v.length;m=m.next;){var I=m.data,Y=w>I.length?I.length:w;if(v+=Y===I.length?I:I.slice(0,w),w-=Y,w===0){Y===I.length?(++E,this.head=m.next?m.next:this.tail=null):(this.head=m,m.data=I.slice(Y));break}++E}return this.length-=E,v}},{key:"_getBuffer",value:function(w){var m=T.allocUnsafe(w),E=this.head,v=1;for(E.data.copy(m),w-=E.data.length;E=E.next;){var I=E.data,Y=w>I.length?I.length:w;if(I.copy(m,m.length-w,0,Y),w-=Y,w===0){Y===I.length?(++v,this.head=E.next?E.next:this.tail=null):(this.head=E,E.data=I.slice(Y));break}++v}return this.length-=v,m}},{key:B,value:function(w,m){return S(this,g({},m,{depth:0,customInspect:!1}))}}]),u}()},{buffer:3,util:2}],23:[function(M,D){(function(y){(function(){"use strict";function g(a,b){x(a,b),U(a)}function U(a){a._writableState&&!a._writableState.emitClose||a._readableState&&!a._readableState.emitClose||a.emit("close")}function x(a,b){a.emit("error",b)}D.exports={destroy:function(a,b){var h=this,d=this._readableState&&this._readableState.destroyed,T=this._writableState&&this._writableState.destroyed;return d||T?(b?b(a):a&&(this._writableState?!this._writableState.errorEmitted&&(this._writableState.errorEmitted=!0,y.nextTick(x,this,a)):y.nextTick(x,this,a)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(a||null,function(R){!b&&R?h._writableState?h._writableState.errorEmitted?y.nextTick(U,h):(h._writableState.errorEmitted=!0,y.nextTick(g,h,R)):y.nextTick(g,h,R):b?(y.nextTick(U,h),b(R)):y.nextTick(U,h)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(a,b){var h=a._readableState,d=a._writableState;h&&h.autoDestroy||d&&d.autoDestroy?a.destroy(b):a.emit("error",b)}}}).call(this)}).call(this,M("_process"))},{_process:12}],24:[function(M,D){"use strict";function y(b){var h=!1;return function(){if(!h){h=!0;for(var d=arguments.length,T=Array(d),R=0;R<d;R++)T[R]=arguments[R];b.apply(this,T)}}}function g(){}function U(b){return b.setHeader&&typeof b.abort=="function"}function x(b,h,d){if(typeof h=="function")return x(b,null,h);h||(h={}),d=y(d||g);var T=h.readable||h.readable!==!1&&b.readable,R=h.writable||h.writable!==!1&&b.writable,S=function(){b.writable||u()},B=b._writableState&&b._writableState.finished,u=function(){R=!1,B=!0,T||d.call(b)},w=b._readableState&&b._readableState.endEmitted,m=function(){T=!1,w=!0,R||d.call(b)},E=function(Y){d.call(b,Y)},v=function(){var Y;return T&&!w?(b._readableState&&b._readableState.ended||(Y=new a),d.call(b,Y)):R&&!B?(b._writableState&&b._writableState.ended||(Y=new a),d.call(b,Y)):void 0},I=function(){b.req.on("finish",u)};return U(b)?(b.on("complete",u),b.on("abort",v),b.req?I():b.on("request",I)):R&&!b._writableState&&(b.on("end",S),b.on("close",S)),b.on("end",m),b.on("finish",u),h.error!==!1&&b.on("error",E),b.on("close",v),function(){b.removeListener("complete",u),b.removeListener("abort",v),b.removeListener("request",I),b.req&&b.req.removeListener("finish",u),b.removeListener("end",S),b.removeListener("close",S),b.removeListener("finish",u),b.removeListener("end",m),b.removeListener("error",E),b.removeListener("close",v)}}var a=M("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;D.exports=x},{"../../../errors":15}],25:[function(M,D){D.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],26:[function(M,D){"use strict";function y(B){var u=!1;return function(){u||(u=!0,B.apply(void 0,arguments))}}function g(B){if(B)throw B}function U(B){return B.setHeader&&typeof B.abort=="function"}function x(B,u,w,m){m=y(m);var E=!1;B.on("close",function(){E=!0}),d===void 0&&(d=M("./end-of-stream")),d(B,{readable:u,writable:w},function(I){return I?m(I):(E=!0,void m())});var v=!1;return function(I){if(!E)return v?void 0:(v=!0,U(B)?B.abort():typeof B.destroy=="function"?B.destroy():void m(I||new S("pipe")))}}function a(B){B()}function b(B,u){return B.pipe(u)}function h(B){return B.length&&typeof B[B.length-1]=="function"?B.pop():g}var d,T=M("../../../errors").codes,R=T.ERR_MISSING_ARGS,S=T.ERR_STREAM_DESTROYED;D.exports=function(){for(var B=arguments.length,u=Array(B),w=0;w<B;w++)u[w]=arguments[w];var m=h(u);if(Array.isArray(u[0])&&(u=u[0]),2>u.length)throw new R("streams");var E,v=u.map(function(I,Y){var N=Y<u.length-1;return x(I,N,0<Y,function(P){E||(E=P),P&&v.forEach(a),N||(v.forEach(a),m(E))})});return u.reduce(b)}},{"../../../errors":15,"./end-of-stream":24}],27:[function(M,D){"use strict";function y(U,x,a){return U.highWaterMark==null?x?U[a]:null:U.highWaterMark}var g=M("../../../errors").codes.ERR_INVALID_OPT_VALUE;D.exports={getHighWaterMark:function(U,x,a,b){var h=y(x,b,a);if(h!=null){if(!(isFinite(h)&&ft(h)===h)||0>h){var d=b?a:"highWaterMark";throw new g(d,h)}return ft(h)}return U.objectMode?16:16384}}},{"../../../errors":15}],28:[function(M,D){D.exports=M("events").EventEmitter},{events:7}],29:[function(M,D,y){y=D.exports=M("./lib/_stream_readable.js"),y.Stream=y,y.Readable=y,y.Writable=M("./lib/_stream_writable.js"),y.Duplex=M("./lib/_stream_duplex.js"),y.Transform=M("./lib/_stream_transform.js"),y.PassThrough=M("./lib/_stream_passthrough.js"),y.finished=M("./lib/internal/streams/end-of-stream.js"),y.pipeline=M("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],30:[function(M,D,y){function g(b,h){for(var d in b)h[d]=b[d]}function U(b,h,d){return a(b,h,d)}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var x=M("buffer"),a=x.Buffer;a.from&&a.alloc&&a.allocUnsafe&&a.allocUnsafeSlow?D.exports=x:(g(x,y),y.Buffer=U),U.prototype=Object.create(a.prototype),g(a,U),U.from=function(b,h,d){if(typeof b=="number")throw new TypeError("Argument must not be a number");return a(b,h,d)},U.alloc=function(b,h,d){if(typeof b!="number")throw new TypeError("Argument must be a number");var T=a(b);return h===void 0?T.fill(0):typeof d=="string"?T.fill(h,d):T.fill(h),T},U.allocUnsafe=function(b){if(typeof b!="number")throw new TypeError("Argument must be a number");return a(b)},U.allocUnsafeSlow=function(b){if(typeof b!="number")throw new TypeError("Argument must be a number");return x.SlowBuffer(b)}},{buffer:3}],31:[function(M,D,y){"use strict";function g(v){if(!v)return"utf8";for(var I;;)switch(v){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return v;default:if(I)return;v=(""+v).toLowerCase(),I=!0}}function U(v){var I=g(v);if(typeof I!="string"&&(m.isEncoding===E||!E(v)))throw new Error("Unknown encoding: "+v);return I||v}function x(v){this.encoding=U(v);var I;switch(this.encoding){case"utf16le":this.text=T,this.end=R,I=4;break;case"utf8":this.fillLast=d,I=4;break;case"base64":this.text=S,this.end=B,I=3;break;default:return this.write=u,void(this.end=w)}this.lastNeed=0,this.lastTotal=0,this.lastChar=m.allocUnsafe(I)}function a(v){return 127>=v?0:v>>5==6?2:v>>4==14?3:v>>3==30?4:v>>6==2?-1:-2}function b(v,I,Y){var N=I.length-1;if(N<Y)return 0;var P=a(I[N]);return 0<=P?(0<P&&(v.lastNeed=P-1),P):--N<Y||P===-2?0:(P=a(I[N]),0<=P?(0<P&&(v.lastNeed=P-2),P):--N<Y||P===-2?0:(P=a(I[N]),0<=P?(0<P&&(P===2?P=0:v.lastNeed=P-3),P):0))}function h(v,I){if((192&I[0])!=128)return v.lastNeed=0,"\uFFFD";if(1<v.lastNeed&&1<I.length){if((192&I[1])!=128)return v.lastNeed=1,"\uFFFD";if(2<v.lastNeed&&2<I.length&&(192&I[2])!=128)return v.lastNeed=2,"\uFFFD"}}function d(v){var I=this.lastTotal-this.lastNeed,Y=h(this,v,I);return Y===void 0?this.lastNeed<=v.length?(v.copy(this.lastChar,I,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(v.copy(this.lastChar,I,0,v.length),void(this.lastNeed-=v.length)):Y}function T(v,I){if((v.length-I)%2==0){var Y=v.toString("utf16le",I);if(Y){var N=Y.charCodeAt(Y.length-1);if(55296<=N&&56319>=N)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=v[v.length-2],this.lastChar[1]=v[v.length-1],Y.slice(0,-1)}return Y}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=v[v.length-1],v.toString("utf16le",I,v.length-1)}function R(v){var I=v&&v.length?this.write(v):"";if(this.lastNeed){var Y=this.lastTotal-this.lastNeed;return I+this.lastChar.toString("utf16le",0,Y)}return I}function S(v,I){var Y=(v.length-I)%3;return Y==0?v.toString("base64",I):(this.lastNeed=3-Y,this.lastTotal=3,Y==1?this.lastChar[0]=v[v.length-1]:(this.lastChar[0]=v[v.length-2],this.lastChar[1]=v[v.length-1]),v.toString("base64",I,v.length-Y))}function B(v){var I=v&&v.length?this.write(v):"";return this.lastNeed?I+this.lastChar.toString("base64",0,3-this.lastNeed):I}function u(v){return v.toString(this.encoding)}function w(v){return v&&v.length?this.write(v):""}var m=M("safe-buffer").Buffer,E=m.isEncoding||function(v){switch(v=""+v,v&&v.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};y.StringDecoder=x,x.prototype.write=function(v){if(v.length===0)return"";var I,Y;if(this.lastNeed){if(I=this.fillLast(v),I===void 0)return"";Y=this.lastNeed,this.lastNeed=0}else Y=0;return Y<v.length?I?I+this.text(v,Y):this.text(v,Y):I||""},x.prototype.end=function(v){var I=v&&v.length?this.write(v):"";return this.lastNeed?I+"\uFFFD":I},x.prototype.text=function(v,I){var Y=b(this,v,I);if(!this.lastNeed)return v.toString("utf8",I);this.lastTotal=Y;var N=v.length-(Y-this.lastNeed);return v.copy(this.lastChar,0,N),v.toString("utf8",I,N)},x.prototype.fillLast=function(v){return this.lastNeed<=v.length?(v.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(v.copy(this.lastChar,this.lastTotal-this.lastNeed,0,v.length),void(this.lastNeed-=v.length))}},{"safe-buffer":30}],32:[function(M,D){(function(y){(function(){function g(U){try{if(!y.localStorage)return!1}catch(a){return!1}var x=y.localStorage[U];return x!=null&&(x+"").toLowerCase()==="true"}D.exports=function(U,x){function a(){if(!b){if(g("throwDeprecation"))throw new Error(x);g("traceDeprecation")?console.trace(x):console.warn(x),b=!0}return U.apply(this,arguments)}if(g("noDeprecation"))return U;var b=!1;return a}}).call(this)}).call(this,typeof $.g=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:$.g)},{}],"/":[function(M,D){function y(B){return B.replace(/a=ice-options:trickle\s\n/g,"")}function g(B){console.warn(B)}/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */const U=M("debug")("simple-peer"),x=M("get-browser-rtc"),a=M("randombytes"),b=M("readable-stream"),h=M("queue-microtask"),d=M("err-code"),{Buffer:T}=M("buffer"),R=65536;class S extends b.Duplex{constructor(u){if(u=Object.assign({allowHalfOpen:!1},u),super(u),this._id=a(4).toString("hex").slice(0,7),this._debug("new peer %o",u),this.channelName=u.initiator?u.channelName||a(20).toString("hex"):null,this.initiator=u.initiator||!1,this.channelConfig=u.channelConfig||S.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},S.config,u.config),this.offerOptions=u.offerOptions||{},this.answerOptions=u.answerOptions||{},this.sdpTransform=u.sdpTransform||(w=>w),this.streams=u.streams||(u.stream?[u.stream]:[]),this.trickle=u.trickle===void 0||u.trickle,this.allowHalfTrickle=u.allowHalfTrickle!==void 0&&u.allowHalfTrickle,this.iceCompleteTimeout=u.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=u.wrtc&&typeof u.wrtc=="object"?u.wrtc:x(),!this._wrtc)throw d(typeof window=="undefined"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(w){return void this.destroy(d(w,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=w=>{this._onIceCandidate(w)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(w=>{this.destroy(d(w,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=w=>{this._setupData(w)},this.streams&&this.streams.forEach(w=>{this.addStream(w)}),this._pc.ontrack=w=>{this._onTrack(w)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(u){if(!this.destroying){if(this.destroyed)throw d(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof u=="string")try{u=JSON.parse(u)}catch(w){u={}}this._debug("signal()"),u.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),u.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(u.transceiverRequest.kind,u.transceiverRequest.init)),u.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(u.candidate):this._pendingCandidates.push(u.candidate)),u.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(u)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(w=>{this._addIceCandidate(w)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(w=>{this.destroy(d(w,"ERR_SET_REMOTE_DESCRIPTION"))}),u.sdp||u.candidate||u.renegotiate||u.transceiverRequest||this.destroy(d(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(u){const w=new this._wrtc.RTCIceCandidate(u);this._pc.addIceCandidate(w).catch(m=>{!w.address||w.address.endsWith(".local")?g("Ignoring unsupported ICE candidate."):this.destroy(d(m,"ERR_ADD_ICE_CANDIDATE"))})}send(u){if(!this.destroying){if(this.destroyed)throw d(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(u)}}addTransceiver(u,w){if(!this.destroying){if(this.destroyed)throw d(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(u,w),this._needsNegotiation()}catch(m){this.destroy(d(m,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:u,init:w}})}}addStream(u){if(!this.destroying){if(this.destroyed)throw d(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),u.getTracks().forEach(w=>{this.addTrack(w,u)})}}addTrack(u,w){if(this.destroying)return;if(this.destroyed)throw d(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const m=this._senderMap.get(u)||new Map;let E=m.get(w);if(!E)E=this._pc.addTrack(u,w),m.set(w,E),this._senderMap.set(u,m),this._needsNegotiation();else throw E.removed?d(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):d(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(u,w,m){if(this.destroying)return;if(this.destroyed)throw d(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const E=this._senderMap.get(u),v=E?E.get(m):null;if(!v)throw d(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");w&&this._senderMap.set(w,E),v.replaceTrack==null?this.destroy(d(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):v.replaceTrack(w)}removeTrack(u,w){if(this.destroying)return;if(this.destroyed)throw d(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const m=this._senderMap.get(u),E=m?m.get(w):null;if(!E)throw d(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{E.removed=!0,this._pc.removeTrack(E)}catch(v){v.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(E):this.destroy(d(v,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(u){if(!this.destroying){if(this.destroyed)throw d(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),u.getTracks().forEach(w=>{this.removeTrack(w,u)})}}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,h(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw d(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(u){this._destroy(u,()=>{})}_destroy(u,w){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",u&&(u.message||u)),h(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",u&&(u.message||u)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(m){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(m){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,u&&this.emit("error",u),this.emit("close"),w()}))}_setupData(u){if(!u.channel)return this.destroy(d(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=u.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=R),this.channelName=this._channel.label,this._channel.onmessage=m=>{this._onChannelMessage(m)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=m=>{const E=m.error instanceof Error?m.error:new Error(`Datachannel error: ${m.message} ${m.filename}:${m.lineno}:${m.colno}`);this.destroy(d(E,"ERR_DATA_CHANNEL"))};let w=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(w&&this._onChannelClose(),w=!0):w=!1},5e3)}_read(){}_write(u,w,m){if(this.destroyed)return m(d(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(u)}catch(E){return this.destroy(d(E,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>R?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=m):m(null)}else this._debug("write before connect"),this._chunk=u,this._cb=m}_onFinish(){if(!this.destroyed){const u=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?u():this.once("connect",u)}}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(u=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(u.sdp=y(u.sdp)),u.sdp=this.sdpTransform(u.sdp);const w=()=>{if(!this.destroyed){const m=this._pc.localDescription||u;this._debug("signal"),this.emit("signal",{type:m.type,sdp:m.sdp})}};this._pc.setLocalDescription(u).then(()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?w():this.once("_iceComplete",w))}).catch(m=>{this.destroy(d(m,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(u=>{this.destroy(d(u,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(u=>{u.mid||!u.sender.track||u.requested||(u.requested=!0,this.addTransceiver(u.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(u=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(u.sdp=y(u.sdp)),u.sdp=this.sdpTransform(u.sdp);const w=()=>{if(!this.destroyed){const m=this._pc.localDescription||u;this._debug("signal"),this.emit("signal",{type:m.type,sdp:m.sdp}),this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(u).then(()=>{this.destroyed||(this.trickle||this._iceComplete?w():this.once("_iceComplete",w))}).catch(m=>{this.destroy(d(m,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(u=>{this.destroy(d(u,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(d(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const u=this._pc.iceConnectionState,w=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",u,w),this.emit("iceStateChange",u,w),(u==="connected"||u==="completed")&&(this._pcReady=!0,this._maybeReady()),u==="failed"&&this.destroy(d(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),u==="closed"&&this.destroy(d(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(u){const w=m=>(Object.prototype.toString.call(m.values)==="[object Array]"&&m.values.forEach(E=>{Object.assign(m,E)}),m);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(m=>{const E=[];m.forEach(v=>{E.push(w(v))}),u(null,E)},m=>u(m)):0<this._pc.getStats.length?this._pc.getStats(m=>{if(this.destroyed)return;const E=[];m.result().forEach(v=>{const I={};v.names().forEach(Y=>{I[Y]=v.stat(Y)}),I.id=v.id,I.type=v.type,I.timestamp=v.timestamp,E.push(w(I))}),u(null,E)},m=>u(m)):u(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const u=()=>{this.destroyed||this.getStats((w,m)=>{if(this.destroyed)return;w&&(m=[]);const E={},v={},I={};let Y=!1;m.forEach(P=>{(P.type==="remotecandidate"||P.type==="remote-candidate")&&(E[P.id]=P),(P.type==="localcandidate"||P.type==="local-candidate")&&(v[P.id]=P),(P.type==="candidatepair"||P.type==="candidate-pair")&&(I[P.id]=P)});const N=P=>{Y=!0;let q=v[P.localCandidateId];q&&(q.ip||q.address)?(this.localAddress=q.ip||q.address,this.localPort=+q.port):q&&q.ipAddress?(this.localAddress=q.ipAddress,this.localPort=+q.portNumber):typeof P.googLocalAddress=="string"&&(q=P.googLocalAddress.split(":"),this.localAddress=q[0],this.localPort=+q[1]),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let it=E[P.remoteCandidateId];it&&(it.ip||it.address)?(this.remoteAddress=it.ip||it.address,this.remotePort=+it.port):it&&it.ipAddress?(this.remoteAddress=it.ipAddress,this.remotePort=+it.portNumber):typeof P.googRemoteAddress=="string"&&(it=P.googRemoteAddress.split(":"),this.remoteAddress=it[0],this.remotePort=+it[1]),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(m.forEach(P=>{P.type==="transport"&&P.selectedCandidatePairId&&N(I[P.selectedCandidatePairId]),(P.type==="googCandidatePair"&&P.googActiveConnection==="true"||(P.type==="candidatepair"||P.type==="candidate-pair")&&P.selected)&&N(P)}),!Y&&(!Object.keys(I).length||Object.keys(v).length))return void setTimeout(u,100);if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(q){return this.destroy(d(q,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const P=this._cb;this._cb=null,P(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};u()}_onInterval(){this._cb&&this._channel&&!(this._channel.bufferedAmount>R)&&this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(u=>{this._pc.removeTrack(u),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(u){this.destroyed||(u.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:u.candidate.candidate,sdpMLineIndex:u.candidate.sdpMLineIndex,sdpMid:u.candidate.sdpMid}}):!u.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),u.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(u){if(this.destroyed)return;let w=u.data;w instanceof ArrayBuffer&&(w=T.from(w)),this.push(w)}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const u=this._cb;this._cb=null,u(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(u){this.destroyed||u.streams.forEach(w=>{this._debug("on track"),this.emit("track",u.track,w),this._remoteTracks.push({track:u.track,stream:w}),this._remoteStreams.some(m=>m.id===w.id)||(this._remoteStreams.push(w),h(()=>{this._debug("on stream"),this.emit("stream",w)}))})}_debug(){const u=[].slice.call(arguments);u[0]="["+this._id+"] "+u[0],U.apply(null,u)}}S.WEBRTC_SUPPORT=!!x(),S.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},S.channelConfig={},D.exports=S},{buffer:3,debug:4,"err-code":6,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/")})},"../../../node_modules/.pnpm/yjs@13.6.8/node_modules/yjs/dist/yjs.mjs":(Ft,kt,$)=>{"use strict";$.d(kt,{QW:()=>st,NG:()=>rt,D$:()=>c,gJ:()=>Bt,ay:()=>Vt});var ft=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/observable.js"),ct=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/array.js"),ut=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/math.js"),M=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/map.js"),D=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/encoding.js"),y=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/decoding.js"),g=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/random.js"),U=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/promise.js"),x=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/buffer.js"),a=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/error.js"),b=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/binary.js"),h=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/function.js"),d=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/set.js"),T=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/logging.js"),R=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/logging.common.js");const S=(i,t)=>({[Symbol.iterator](){return this},next(){const e=i.next();return{value:e.done?void 0:t(e.value),done:e.done}}}),B=i=>({[Symbol.iterator](){return this},next:i}),u=(i,t)=>B(()=>{let e;do e=i.next();while(!e.done&&!t(e.value));return e}),w=(i,t)=>B(()=>{const{done:e,value:s}=i.next();return{done:e,value:e?void 0:t(s)}});var m=$("../../../node_modules/.pnpm/lib0@0.2.86/node_modules/lib0/object.js");class E extends null{constructor(t,e){super(),this.doc=t,this.awareness=e}}class v{constructor(t,e){this.clock=t,this.len=e}}class I{constructor(){this.clients=new Map}}const Y=(i,t,e)=>t.clients.forEach((s,o)=>{const l=i.doc.store.clients.get(o);for(let p=0;p<s.length;p++){const _=s[p];mn(i,l,_.clock,_.len,e)}}),N=(i,t)=>{let e=0,s=i.length-1;for(;e<=s;){const o=ut.GW((e+s)/2),l=i[o],p=l.clock;if(p<=t){if(t<p+l.len)return o;e=o+1}else s=o-1}return null},P=(i,t)=>{const e=i.clients.get(t.client);return e!==void 0&&N(e,t.clock)!==null},q=i=>{i.clients.forEach(t=>{t.sort((o,l)=>o.clock-l.clock);let e,s;for(e=1,s=1;e<t.length;e++){const o=t[s-1],l=t[e];o.clock+o.len>=l.clock?o.len=ut.Fp(o.len,l.clock+l.len-o.clock):(s<e&&(t[s]=l),s++)}t.length=s})},it=i=>{const t=new I;for(let e=0;e<i.length;e++)i[e].clients.forEach((s,o)=>{if(!t.clients.has(o)){const l=s.slice();for(let p=e+1;p<i.length;p++)ct.s7(l,i[p].clients.get(o)||[]);t.clients.set(o,l)}});return q(t),t},bt=(i,t,e,s)=>{M.Yu(i.clients,t,()=>[]).push(new v(e,s))},Et=()=>new I,Tt=i=>{const t=Et();return i.clients.forEach((e,s)=>{const o=[];for(let l=0;l<e.length;l++){const p=e[l];if(p.deleted){const _=p.id.clock;let A=p.length;if(l+1<e.length)for(let F=e[l+1];l+1<e.length&&F.deleted;F=e[++l+1])A+=F.length;o.push(new v(_,A))}}o.length>0&&t.clients.set(s,o)}),t},At=(i,t)=>{D.uE(i.restEncoder,t.clients.size),ct.Dp(t.clients.entries()).sort((e,s)=>s[0]-e[0]).forEach(([e,s])=>{i.resetDsCurVal(),D.uE(i.restEncoder,e);const o=s.length;D.uE(i.restEncoder,o);for(let l=0;l<o;l++){const p=s[l];i.writeDsClock(p.clock),i.writeDsLen(p.len)}})},Ut=i=>{const t=new I,e=y.yg(i.restDecoder);for(let s=0;s<e;s++){i.resetDsCurVal();const o=y.yg(i.restDecoder),l=y.yg(i.restDecoder);if(l>0){const p=M.Yu(t.clients,o,()=>[]);for(let _=0;_<l;_++)p.push(new v(i.readDsClock(),i.readDsLen()))}}return t},wt=(i,t,e)=>{const s=new I,o=y.yg(i.restDecoder);for(let l=0;l<o;l++){i.resetDsCurVal();const p=y.yg(i.restDecoder),_=y.yg(i.restDecoder),A=e.clients.get(p)||[],F=Kt(e,p);for(let j=0;j<_;j++){const V=i.readDsClock(),Q=V+i.readDsLen();if(V<F){F<Q&&bt(s,p,F,Q-F);let tt=ae(A,V),pt=A[tt];for(!pt.deleted&&pt.id.clock<V&&(A.splice(tt+1,0,$e(t,pt,V-pt.id.clock)),tt++);tt<A.length&&(pt=A[tt++],pt.id.clock<Q);)pt.deleted||(Q<pt.id.clock+pt.length&&A.splice(tt,0,$e(t,pt,Q-pt.id.clock)),pt.delete(t))}else bt(s,p,V,Q-V)}}if(s.clients.size>0){const l=new Pt;return D.uE(l.restEncoder,0),At(l,s),l.toUint8Array()}return null},Jt=(i,t)=>{if(i.clients.size!==t.clients.size)return!1;for(const[e,s]of i.clients.entries()){const o=t.clients.get(e);if(o===void 0||s.length!==o.length)return!1;for(let l=0;l<s.length;l++){const p=s[l],_=o[l];if(p.clock!==_.clock||p.len!==_.len)return!1}}return!0},$t=g.U7;class st extends ft.y{constructor({guid:t=g.k$(),collectionid:e=null,gc:s=!0,gcFilter:o=()=>!0,meta:l=null,autoLoad:p=!1,shouldLoad:_=!0}={}){super(),this.gc=s,this.gcFilter=o,this.clientID=$t(),this.guid=t,this.collectionid=e,this.share=new Map,this.store=new fn,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=_,this.autoLoad=p,this.meta=l,this.isLoaded=!1,this.isSynced=!1,this.whenLoaded=U.Ue(F=>{this.on("load",()=>{this.isLoaded=!0,F(this)})});const A=()=>U.Ue(F=>{const j=V=>{(V===void 0||V===!0)&&(this.off("sync",j),F())};this.on("sync",j)});this.on("sync",F=>{F===!1&&this.isSynced&&(this.whenSynced=A()),this.isSynced=F===void 0||F===!0,this.isLoaded||this.emit("load",[])}),this.whenSynced=A()}load(){const t=this._item;t!==null&&!this.shouldLoad&&Vt(t.parent.doc,e=>{e.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(ct.Dp(this.subdocs).map(t=>t.guid))}transact(t,e=null){return Vt(this,t,e)}get(t,e=ne){const s=M.Yu(this.share,t,()=>{const l=new e;return l._integrate(this,null),l}),o=s.constructor;if(e!==ne&&o!==e)if(o===ne){const l=new e;l._map=s._map,s._map.forEach(p=>{for(;p!==null;p=p.left)p.parent=l}),l._start=s._start;for(let p=l._start;p!==null;p=p.right)p.parent=l;return l._length=s._length,this.share.set(t,l),l._integrate(this,null),l}else throw new Error(`Type with the name ${t} has already been defined with a different constructor`);return s}getArray(t=""){return this.get(t,me)}getText(t=""){return this.get(t,ke)}getMap(t=""){return this.get(t,ve)}getXmlFragment(t=""){return this.get(t,Ee)}toJSON(){const t={};return this.share.forEach((e,s)=>{t[s]=e.toJSON()}),t}destroy(){ct.Dp(this.subdocs).forEach(e=>e.destroy());const t=this._item;if(t!==null){this._item=null;const e=t.content;e.doc=new st({guid:this.guid,...e.opts,shouldLoad:!1}),e.doc._item=t,Vt(t.parent.doc,s=>{const o=e.doc;t.deleted||s.subdocsAdded.add(o),s.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}on(t,e){super.on(t,e)}off(t,e){super.off(t,e)}}class et{constructor(t){this.restDecoder=t}resetDsCurVal(){}readDsClock(){return y.yg(this.restDecoder)}readDsLen(){return y.yg(this.restDecoder)}}class lt extends et{readLeftID(){return gt(y.yg(this.restDecoder),y.yg(this.restDecoder))}readRightID(){return gt(y.yg(this.restDecoder),y.yg(this.restDecoder))}readClient(){return y.yg(this.restDecoder)}readInfo(){return y.kj(this.restDecoder)}readString(){return y.kf(this.restDecoder)}readParentInfo(){return y.yg(this.restDecoder)===1}readTypeRef(){return y.yg(this.restDecoder)}readLen(){return y.yg(this.restDecoder)}readAny(){return y.v_(this.restDecoder)}readBuf(){return x.f9(y.HN(this.restDecoder))}readJSON(){return JSON.parse(y.kf(this.restDecoder))}readKey(){return y.kf(this.restDecoder)}}class yt{constructor(t){this.dsCurrVal=0,this.restDecoder=t}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=y.yg(this.restDecoder),this.dsCurrVal}readDsLen(){const t=y.yg(this.restDecoder)+1;return this.dsCurrVal+=t,t}}class _t extends yt{constructor(t){super(t),this.keys=[],y.yg(t),this.keyClockDecoder=new y.dD(y.HN(t)),this.clientDecoder=new y.UF(y.HN(t)),this.leftClockDecoder=new y.dD(y.HN(t)),this.rightClockDecoder=new y.dD(y.HN(t)),this.infoDecoder=new y.XW(y.HN(t),y.kj),this.stringDecoder=new y.sO(y.HN(t)),this.parentInfoDecoder=new y.XW(y.HN(t),y.kj),this.typeRefDecoder=new y.UF(y.HN(t)),this.lenDecoder=new y.UF(y.HN(t))}readLeftID(){return new nt(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new nt(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return y.v_(this.restDecoder)}readBuf(){return y.HN(this.restDecoder)}readJSON(){return y.v_(this.restDecoder)}readKey(){const t=this.keyClockDecoder.read();if(t<this.keys.length)return this.keys[t];{const e=this.stringDecoder.read();return this.keys.push(e),e}}}class Rt{constructor(){this.restEncoder=D.Mf()}toUint8Array(){return D._f(this.restEncoder)}resetDsCurVal(){}writeDsClock(t){D.uE(this.restEncoder,t)}writeDsLen(t){D.uE(this.restEncoder,t)}}class xt extends Rt{writeLeftID(t){D.uE(this.restEncoder,t.client),D.uE(this.restEncoder,t.clock)}writeRightID(t){D.uE(this.restEncoder,t.client),D.uE(this.restEncoder,t.clock)}writeClient(t){D.uE(this.restEncoder,t)}writeInfo(t){D.$F(this.restEncoder,t)}writeString(t){D.uw(this.restEncoder,t)}writeParentInfo(t){D.uE(this.restEncoder,t?1:0)}writeTypeRef(t){D.uE(this.restEncoder,t)}writeLen(t){D.uE(this.restEncoder,t)}writeAny(t){D.EM(this.restEncoder,t)}writeBuf(t){D.mP(this.restEncoder,t)}writeJSON(t){D.uw(this.restEncoder,JSON.stringify(t))}writeKey(t){D.uw(this.restEncoder,t)}}class Xt{constructor(){this.restEncoder=D.Mf(),this.dsCurrVal=0}toUint8Array(){return D._f(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(t){const e=t-this.dsCurrVal;this.dsCurrVal=t,D.uE(this.restEncoder,e)}writeDsLen(t){t===0&&a.zR(),D.uE(this.restEncoder,t-1),this.dsCurrVal+=t}}class Pt extends Xt{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new D.sX,this.clientEncoder=new D.HE,this.leftClockEncoder=new D.sX,this.rightClockEncoder=new D.sX,this.infoEncoder=new D.GF(D.$F),this.stringEncoder=new D.TS,this.parentInfoEncoder=new D.GF(D.$F),this.typeRefEncoder=new D.HE,this.lenEncoder=new D.HE}toUint8Array(){const t=D.Mf();return D.uE(t,0),D.mP(t,this.keyClockEncoder.toUint8Array()),D.mP(t,this.clientEncoder.toUint8Array()),D.mP(t,this.leftClockEncoder.toUint8Array()),D.mP(t,this.rightClockEncoder.toUint8Array()),D.mP(t,D._f(this.infoEncoder)),D.mP(t,this.stringEncoder.toUint8Array()),D.mP(t,D._f(this.parentInfoEncoder)),D.mP(t,this.typeRefEncoder.toUint8Array()),D.mP(t,this.lenEncoder.toUint8Array()),D.HK(t,D._f(this.restEncoder)),D._f(t)}writeLeftID(t){this.clientEncoder.write(t.client),this.leftClockEncoder.write(t.clock)}writeRightID(t){this.clientEncoder.write(t.client),this.rightClockEncoder.write(t.clock)}writeClient(t){this.clientEncoder.write(t)}writeInfo(t){this.infoEncoder.write(t)}writeString(t){this.stringEncoder.write(t)}writeParentInfo(t){this.parentInfoEncoder.write(t?1:0)}writeTypeRef(t){this.typeRefEncoder.write(t)}writeLen(t){this.lenEncoder.write(t)}writeAny(t){D.EM(this.restEncoder,t)}writeBuf(t){D.mP(this.restEncoder,t)}writeJSON(t){D.EM(this.restEncoder,t)}writeKey(t){const e=this.keyMap.get(t);e===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(t)):this.keyClockEncoder.write(e)}}const ee=(i,t,e,s)=>{s=ut.Fp(s,t[0].id.clock);const o=ae(t,s);D.uE(i.restEncoder,t.length-o),i.writeClient(e),D.uE(i.restEncoder,s);const l=t[o];l.write(i,s-l.id.clock);for(let p=o+1;p<t.length;p++)t[p].write(i,0)},te=(i,t,e)=>{const s=new Map;e.forEach((o,l)=>{Kt(t,l)>o&&s.set(l,o)}),Ue(t).forEach((o,l)=>{e.has(l)||s.set(l,0)}),D.uE(i.restEncoder,s.size),ct.Dp(s.entries()).sort((o,l)=>l[0]-o[0]).forEach(([o,l])=>{ee(i,t.clients.get(o),o,l)})},W=(i,t)=>{const e=M.Ue(),s=y.yg(i.restDecoder);for(let o=0;o<s;o++){const l=y.yg(i.restDecoder),p=new Array(l),_=i.readClient();let A=y.yg(i.restDecoder);e.set(_,{i:0,refs:p});for(let F=0;F<l;F++){const j=i.readInfo();switch(b.kr&j){case 0:{const V=i.readLen();p[F]=new le(gt(_,A),V),A+=V;break}case 10:{const V=y.yg(i.restDecoder);p[F]=new oe(gt(_,A),V),A+=V;break}default:{const V=(j&(b.rc|b.x1))===0,Q=new Wt(gt(_,A),null,(j&b.x1)===b.x1?i.readLeftID():null,null,(j&b.rc)===b.rc?i.readRightID():null,V?i.readParentInfo()?t.get(i.readString()):i.readLeftID():null,V&&(j&b.cq)===b.cq?i.readString():null,Jn(i,j));p[F]=Q,A+=Q.length}}}}return e},ot=(i,t,e)=>{const s=[];let o=ct.Dp(e.keys()).sort((tt,pt)=>tt-pt);if(o.length===0)return null;const l=()=>{if(o.length===0)return null;let tt=e.get(o[o.length-1]);for(;tt.refs.length===tt.i;)if(o.pop(),o.length>0)tt=e.get(o[o.length-1]);else return null;return tt};let p=l();if(p===null&&s.length===0)return null;const _=new fn,A=new Map,F=(tt,pt)=>{const It=A.get(tt);(It==null||It>pt)&&A.set(tt,pt)};let j=p.refs[p.i++];const V=new Map,Q=()=>{for(const tt of s){const pt=tt.id.client,It=e.get(pt);It?(It.i--,_.clients.set(pt,It.refs.slice(It.i)),e.delete(pt),It.i=0,It.refs=[]):_.clients.set(pt,[tt]),o=o.filter(Gt=>Gt!==pt)}s.length=0};for(;;){if(j.constructor!==oe){const pt=M.Yu(V,j.id.client,()=>Kt(t,j.id.client))-j.id.clock;if(pt<0)s.push(j),F(j.id.client,j.id.clock-1),Q();else{const It=j.getMissing(i,t);if(It!==null){s.push(j);const Gt=e.get(It)||{refs:[],i:0};if(Gt.refs.length===Gt.i)F(It,Kt(t,It)),Q();else{j=Gt.refs[Gt.i++];continue}}else(pt===0||pt<j.length)&&(j.integrate(i,pt),V.set(j.id.client,j.id.clock+j.length))}}if(s.length>0)j=s.pop();else if(p!==null&&p.i<p.refs.length)j=p.refs[p.i++];else{if(p=l(),p===null)break;j=p.refs[p.i++]}}if(_.clients.size>0){const tt=new Pt;return te(tt,_,new Map),D.uE(tt.restEncoder,0),{missing:A,update:tt.toUint8Array()}}return null},O=(i,t)=>te(i,t.doc.store,t.beforeState),G=(i,t,e,s=new _t(i))=>Vt(t,o=>{o.local=!1;let l=!1;const p=o.doc,_=p.store,A=W(s,p),F=ot(o,_,A),j=_.pendingStructs;if(j){for(const[Q,tt]of j.missing)if(tt<Kt(_,Q)){l=!0;break}if(F){for(const[Q,tt]of F.missing){const pt=j.missing.get(Q);(pt==null||pt>tt)&&j.missing.set(Q,tt)}j.update=je([j.update,F.update])}}else _.pendingStructs=F;const V=wt(s,o,_);if(_.pendingDs){const Q=new _t(y.l1(_.pendingDs));y.yg(Q.restDecoder);const tt=wt(Q,o,_);V&&tt?_.pendingDs=je([V,tt]):_.pendingDs=V||tt}else _.pendingDs=V;if(l){const Q=_.pendingStructs.update;_.pendingStructs=null,L(o.doc,Q)}},e,!1),C=(i,t,e)=>G(i,t,e,new lt(i)),L=(i,t,e,s=_t)=>{const o=y.l1(t);G(o,i,e,new s(o))},rt=(i,t,e)=>L(i,t,e,lt),n=(i,t,e=new Map)=>{te(i,t.store,e),At(i,Tt(t.store))},r=(i,t=new Uint8Array([0]),e=new Pt)=>{const s=K(t);n(e,i,s);const o=[e.toUint8Array()];if(i.store.pendingDs&&o.push(i.store.pendingDs),i.store.pendingStructs&&o.push(Cn(i.store.pendingStructs.update,t)),o.length>1){if(e.constructor===xt)return cr(o.map((l,p)=>p===0?l:dr(l)));if(e.constructor===Pt)return je(o)}return o[0]},c=(i,t)=>r(i,t,new xt),k=i=>{const t=new Map,e=y.yg(i.restDecoder);for(let s=0;s<e;s++){const o=y.yg(i.restDecoder),l=y.yg(i.restDecoder);t.set(o,l)}return t},K=i=>k(new et(y.l1(i))),z=(i,t)=>(D.uE(i.restEncoder,t.size),ct.Dp(t.entries()).sort((e,s)=>s[0]-e[0]).forEach(([e,s])=>{D.uE(i.restEncoder,e),D.uE(i.restEncoder,s)}),i),at=(i,t)=>z(i,Ue(t.store)),Ct=(i,t=new Xt)=>(i instanceof Map?z(t,i):at(t,i),t.toUint8Array()),Bt=i=>Ct(i,new Rt);class Ot{constructor(){this.l=[]}}const Dt=()=>new Ot,Lt=(i,t)=>i.l.push(t),ie=(i,t)=>{const e=i.l,s=e.length;i.l=e.filter(o=>t!==o),s===i.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},X=(i,t,e)=>h.PP(i.l,[t,e]);class nt{constructor(t,e){this.client=t,this.clock=e}}const mt=(i,t)=>i===t||i!==null&&t!==null&&i.client===t.client&&i.clock===t.clock,gt=(i,t)=>new nt(i,t),jt=(i,t)=>{encoding.writeVarUint(i,t.client),encoding.writeVarUint(i,t.clock)},Zt=i=>gt(decoding.readVarUint(i),decoding.readVarUint(i)),Yt=i=>{for(const[t,e]of i.doc.share.entries())if(e===i)return t;throw a.zR()},ce=(i,t)=>{for(;t!==null;){if(t.parent===i)return!0;t=t.parent._item}return!1},Se=i=>{const t=[];let e=i._start;for(;e;)t.push(e),e=e.right;console.log("Children: ",t),console.log("Children content: ",t.filter(s=>!s.deleted).map(s=>s.content))};class hn{constructor(t,e=t.getMap("users")){const s=new Map;this.yusers=e,this.doc=t,this.clients=new Map,this.dss=s;const o=(l,p)=>{const _=l.get("ds"),A=l.get("ids"),F=j=>this.clients.set(j,p);_.observe(j=>{j.changes.added.forEach(V=>{V.content.getContent().forEach(Q=>{Q instanceof Uint8Array&&this.dss.set(p,it([this.dss.get(p)||Et(),Ut(new et(decoding.createDecoder(Q)))]))})})}),this.dss.set(p,it(_.map(j=>Ut(new et(decoding.createDecoder(j)))))),A.observe(j=>j.changes.added.forEach(V=>V.content.getContent().forEach(F))),A.forEach(F)};e.observe(l=>{l.keysChanged.forEach(p=>o(e.get(p),p))}),e.forEach(o)}setUserMapping(t,e,s,{filter:o=()=>!0}={}){const l=this.yusers;let p=l.get(s);p||(p=new ve,p.set("ids",new me),p.set("ds",new me),l.set(s,p)),p.get("ids").push([e]),l.observe(_=>{setTimeout(()=>{const A=l.get(s);if(A!==p){p=A,this.clients.forEach((V,Q)=>{s===V&&p.get("ids").push([Q])});const F=new Rt,j=this.dss.get(s);j&&(At(F,j),p.get("ds").push([F.toUint8Array()]))}},0)}),t.on("afterTransaction",_=>{setTimeout(()=>{const A=p.get("ds"),F=_.deleteSet;if(_.local&&F.clients.size>0&&o(_,F)){const j=new Rt;At(j,F),A.push([j.toUint8Array()])}})})}getUserByClientId(t){return this.clients.get(t)||null}getUserByDeletedId(t){for(const[e,s]of this.dss.entries())if(P(s,t))return e;return null}}class H{constructor(t,e,s,o=0){this.type=t,this.tname=e,this.item=s,this.assoc=o}}const J=i=>{const t={};return i.type&&(t.type=i.type),i.tname&&(t.tname=i.tname),i.item&&(t.item=i.item),i.assoc!=null&&(t.assoc=i.assoc),t},Z=i=>new H(i.type==null?null:gt(i.type.client,i.type.clock),i.tname||null,i.item==null?null:gt(i.item.client,i.item.clock),i.assoc==null?0:i.assoc);class ht{constructor(t,e,s=0){this.type=t,this.index=e,this.assoc=s}}const dt=(i,t,e=0)=>new ht(i,t,e),vt=(i,t,e)=>{let s=null,o=null;return i._item===null?o=Yt(i):s=gt(i._item.id.client,i._item.id.clock),new H(s,o,t,e)},St=(i,t,e=0)=>{let s=i._start;if(e<0){if(t===0)return vt(i,null,e);t--}for(;s!==null;){if(!s.deleted&&s.countable){if(s.length>t)return vt(i,gt(s.id.client,s.id.clock+t),e);t-=s.length}if(s.right===null&&e<0)return vt(i,s.lastId,e);s=s.right}return vt(i,null,e)},Mt=(i,t)=>{const{type:e,tname:s,item:o,assoc:l}=t;if(o!==null)encoding.writeVarUint(i,0),jt(i,o);else if(s!==null)encoding.writeUint8(i,1),encoding.writeVarString(i,s);else if(e!==null)encoding.writeUint8(i,2),jt(i,e);else throw error.unexpectedCase();return encoding.writeVarInt(i,l),i},Nt=i=>{const t=encoding.createEncoder();return Mt(t,i),encoding.toUint8Array(t)},Ht=i=>{let t=null,e=null,s=null;switch(decoding.readVarUint(i)){case 0:s=Zt(i);break;case 1:e=decoding.readVarString(i);break;case 2:t=Zt(i)}const o=decoding.hasContent(i)?decoding.readVarInt(i):0;return new H(t,e,s,o)},Qt=i=>Ht(decoding.createDecoder(i)),re=(i,t)=>{const e=t.store,s=i.item,o=i.type,l=i.tname,p=i.assoc;let _=null,A=0;if(s!==null){if(Kt(e,s.client)<=s.clock)return null;const F=an(e,s),j=F.item;if(!(j instanceof Wt))return null;if(_=j.parent,_._item===null||!_._item.deleted){A=j.deleted||!j.countable?0:F.diff+(p>=0?0:1);let V=j.left;for(;V!==null;)!V.deleted&&V.countable&&(A+=V.length),V=V.left}}else{if(l!==null)_=t.get(l);else if(o!==null){if(Kt(e,o.client)<=o.clock)return null;const{item:F}=an(e,o);if(F instanceof Wt&&F.content instanceof he)_=F.content.type;else return null}else throw error.unexpectedCase();p>=0?A=_._length:A=0}return dt(_,A,i.assoc)},fe=(i,t)=>i===t||i!==null&&t!==null&&i.tname===t.tname&&mt(i.item,t.item)&&mt(i.type,t.type)&&i.assoc===t.assoc;class de{constructor(t,e){this.ds=t,this.sv=e}}const Ie=(i,t)=>{const e=i.ds.clients,s=t.ds.clients,o=i.sv,l=t.sv;if(o.size!==l.size||e.size!==s.size)return!1;for(const[p,_]of o.entries())if(l.get(p)!==_)return!1;for(const[p,_]of e.entries()){const A=s.get(p)||[];if(_.length!==A.length)return!1;for(let F=0;F<_.length;F++){const j=_[F],V=A[F];if(j.clock!==V.clock||j.len!==V.len)return!1}}return!0},Je=(i,t=new Xt)=>(At(t,i.ds),z(t,i.sv),t.toUint8Array()),Xe=i=>Je(i,new Rt),tr=(i,t=new yt(decoding.createDecoder(i)))=>new de(Ut(t),k(t)),Qr=i=>tr(i,new et(decoding.createDecoder(i))),dn=(i,t)=>new de(i,t),ts=dn(Et(),new Map),es=i=>dn(Tt(i.store),Ue(i.store)),_e=(i,t)=>t===void 0?!i.deleted:t.sv.has(i.id.client)&&(t.sv.get(i.id.client)||0)>i.id.clock&&!P(t.ds,i.id),Ze=(i,t)=>{const e=M.Yu(i.meta,Ze,d.Ue),s=i.doc.store;e.has(t)||(t.sv.forEach((o,l)=>{o<Kt(s,l)&&se(i,gt(l,o))}),Y(i,t.ds,o=>{}),e.add(t))},ns=(i,t,e=new st)=>{if(i.gc)throw new Error("Garbage-collection must be disabled in `originDoc`!");const{sv:s,ds:o}=t,l=new Pt;return i.transact(p=>{let _=0;s.forEach(A=>{A>0&&_++}),encoding.writeVarUint(l.restEncoder,_);for(const[A,F]of s){if(F===0)continue;F<Kt(i.store,A)&&se(p,gt(A,F));const j=i.store.clients.get(A)||[],V=ae(j,F-1);encoding.writeVarUint(l.restEncoder,V+1),l.writeClient(A),encoding.writeVarUint(l.restEncoder,0);for(let Q=0;Q<=V;Q++)j[Q].write(l,0)}At(l,o)}),L(e,l.toUint8Array(),"snapshot"),e},er=(i,t,e=_t)=>{const s=new e(decoding.createDecoder(t)),o=new pe(s,!1);for(let p=o.curr;p!==null;p=o.next())if((i.sv.get(p.id.client)||0)<p.id.clock+p.length)return!1;const l=it([i.ds,Ut(s)]);return Jt(i.ds,l)},rs=(i,t)=>er(i,t,lt);class fn{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const Ue=i=>{const t=new Map;return i.clients.forEach((e,s)=>{const o=e[e.length-1];t.set(s,o.id.clock+o.length)}),t},Kt=(i,t)=>{const e=i.clients.get(t);if(e===void 0)return 0;const s=e[e.length-1];return s.id.clock+s.length},pn=(i,t)=>{let e=i.clients.get(t.id.client);if(e===void 0)e=[],i.clients.set(t.id.client,e);else{const s=e[e.length-1];if(s.id.clock+s.length!==t.id.clock)throw a.zR()}e.push(t)},ae=(i,t)=>{let e=0,s=i.length-1,o=i[s],l=o.id.clock;if(l===t)return s;let p=ut.GW(t/(l+o.length-1)*s);for(;e<=s;){if(o=i[p],l=o.id.clock,l<=t){if(t<l+o.length)return p;e=p+1}else s=p-1;p=ut.GW((e+s)/2)}throw a.zR()},xe=(i,t)=>{const e=i.clients.get(t.client);return e[ae(e,t.clock)]},qe=(i,t,e)=>{const s=ae(t,e),o=t[s];return o.id.clock<e&&o instanceof Wt?(t.splice(s+1,0,$e(i,o,e-o.id.clock)),s+1):s},se=(i,t)=>{const e=i.doc.store.clients.get(t.client);return e[qe(i,e,t.clock)]},gn=(i,t,e)=>{const s=t.clients.get(e.client),o=ae(s,e.clock),l=s[o];return e.clock!==l.id.clock+l.length-1&&l.constructor!==le&&s.splice(o+1,0,$e(i,l,e.clock-l.id.clock+1)),l},nr=(i,t,e)=>{const s=i.clients.get(t.id.client);s[ae(s,t.id.clock)]=e},mn=(i,t,e,s,o)=>{if(s===0)return;const l=e+s;let p=qe(i,t,e),_;do _=t[p++],l<_.id.clock+_.length&&qe(i,t,l),o(_);while(p<t.length&&t[p].id.clock<l)};class rr{constructor(t,e,s){this.doc=t,this.deleteSet=new I,this.beforeState=Ue(t.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=e,this.meta=new Map,this.local=s,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const yn=(i,t)=>t.deleteSet.clients.size===0&&!M.Yj(t.afterState,(e,s)=>t.beforeState.get(s)!==e)?!1:(q(t.deleteSet),O(i,t),At(i,t.deleteSet),!0),bn=(i,t,e)=>{const s=t._item;(s===null||s.id.clock<(i.beforeState.get(s.id.client)||0)&&!s.deleted)&&M.Yu(i.changed,t,d.Ue).add(e)},Be=(i,t)=>{let e=i[t],s=i[t-1],o=t;for(;o>0;e=s,s=i[--o-1]){if(s.deleted===e.deleted&&s.constructor===e.constructor&&s.mergeWith(e)){e instanceof Wt&&e.parentSub!==null&&e.parent._map.get(e.parentSub)===e&&e.parent._map.set(e.parentSub,s);continue}break}const l=t-o;return l&&i.splice(t+1-l,l),l},wn=(i,t,e)=>{for(const[s,o]of i.clients.entries()){const l=t.clients.get(s);for(let p=o.length-1;p>=0;p--){const _=o[p],A=_.clock+_.len;for(let F=ae(l,_.clock),j=l[F];F<l.length&&j.id.clock<A;j=l[++F]){const V=l[F];if(_.clock+_.len<=V.id.clock)break;V instanceof Wt&&V.deleted&&!V.keep&&e(V)&&V.gc(t,!1)}}}},_n=(i,t)=>{i.clients.forEach((e,s)=>{const o=t.clients.get(s);for(let l=e.length-1;l>=0;l--){const p=e[l],_=ut.VV(o.length-1,1+ae(o,p.clock+p.len-1));for(let A=_,F=o[A];A>0&&F.id.clock>=p.clock;F=o[A])A-=1+Be(o,A)}})},is=(i,t,e)=>{wn(i,t,e),_n(i,t)},vn=(i,t)=>{if(t<i.length){const e=i[t],s=e.doc,o=s.store,l=e.deleteSet,p=e._mergeStructs;try{q(l),e.afterState=Ue(e.doc.store),s.emit("beforeObserverCalls",[e,s]);const _=[];e.changed.forEach((A,F)=>_.push(()=>{(F._item===null||!F._item.deleted)&&F._callObserver(e,A)})),_.push(()=>{e.changedParentTypes.forEach((A,F)=>{F._dEH.l.length>0&&(F._item===null||!F._item.deleted)&&(A=A.filter(j=>j.target._item===null||!j.target._item.deleted),A.forEach(j=>{j.currentTarget=F,j._path=null}),A.sort((j,V)=>j.path.length-V.path.length),X(F._dEH,A,e))})}),_.push(()=>s.emit("afterTransaction",[e,s])),(0,h.PP)(_,[]),e._needFormattingCleanup&&kr(e)}finally{s.gc&&wn(l,o,s.gcFilter),_n(l,o),e.afterState.forEach((j,V)=>{const Q=e.beforeState.get(V)||0;if(Q!==j){const tt=o.clients.get(V),pt=ut.Fp(ae(tt,Q),1);for(let It=tt.length-1;It>=pt;)It-=1+Be(tt,It)}});for(let j=p.length-1;j>=0;j--){const{client:V,clock:Q}=p[j].id,tt=o.clients.get(V),pt=ae(tt,Q);pt+1<tt.length&&Be(tt,pt+1)>1||pt>0&&Be(tt,pt)}if(!e.local&&e.afterState.get(s.clientID)!==e.beforeState.get(s.clientID)&&(T.S0(R.ud,R.Pl,"[yjs] ",R.YW,R.hM,"Changed the client-id because another client seems to be using it."),s.clientID=$t()),s.emit("afterTransactionCleanup",[e,s]),s._observers.has("update")){const j=new xt;yn(j,e)&&s.emit("update",[j.toUint8Array(),e.origin,s,e])}if(s._observers.has("updateV2")){const j=new Pt;yn(j,e)&&s.emit("updateV2",[j.toUint8Array(),e.origin,s,e])}const{subdocsAdded:_,subdocsLoaded:A,subdocsRemoved:F}=e;(_.size>0||F.size>0||A.size>0)&&(_.forEach(j=>{j.clientID=s.clientID,j.collectionid==null&&(j.collectionid=s.collectionid),s.subdocs.add(j)}),F.forEach(j=>s.subdocs.delete(j)),s.emit("subdocs",[{loaded:A,added:_,removed:F},s,e]),F.forEach(j=>j.destroy())),i.length<=t+1?(s._transactionCleanups=[],s.emit("afterAllTransactions",[s,i])):vn(i,t+1)}}},Vt=(i,t,e=null,s=!0)=>{const o=i._transactionCleanups;let l=!1,p=null;i._transaction===null&&(l=!0,i._transaction=new rr(i,e,s),o.push(i._transaction),o.length===1&&i.emit("beforeAllTransactions",[i]),i.emit("beforeTransaction",[i._transaction,i]));try{p=t(i._transaction)}finally{if(l){const _=i._transaction===o[0];i._transaction=null,_&&vn(o,0)}}return p};class sr{constructor(t,e){this.insertions=e,this.deletions=t,this.meta=new Map}}const En=(i,t,e)=>{Y(i,e.deletions,s=>{s instanceof Wt&&t.scope.some(o=>ce(o,s))&&un(s,!1)})},Sn=(i,t,e)=>{let s=null,o=null;const l=i.doc,p=i.scope;if(Vt(l,_=>{for(;t.length>0&&s===null;){const A=l.store,F=t.pop(),j=new Set,V=[];let Q=!1;Y(_,F.insertions,tt=>{if(tt instanceof Wt){if(tt.redone!==null){let{item:pt,diff:It}=an(A,tt.id);It>0&&(pt=se(_,gt(pt.id.client,pt.id.clock+It))),tt=pt}!tt.deleted&&p.some(pt=>ce(pt,tt))&&V.push(tt)}}),Y(_,F.deletions,tt=>{tt instanceof Wt&&p.some(pt=>ce(pt,tt))&&!P(F.insertions,tt.id)&&j.add(tt)}),j.forEach(tt=>{Q=$n(_,tt,j,F.insertions,i.ignoreRemoteMapChanges,i)!==null||Q});for(let tt=V.length-1;tt>=0;tt--){const pt=V[tt];i.deleteFilter(pt)&&(pt.delete(_),Q=!0)}s=Q?F:null}_.changed.forEach((A,F)=>{A.has(null)&&F._searchMarker&&(F._searchMarker.length=0)}),o=_},i),s!=null){const _=o.changedParentTypes;i.emit("stack-item-popped",[{stackItem:s,type:e,changedParentTypes:_},i])}return s};class os extends null{constructor(t,{captureTimeout:e=500,captureTransaction:s=A=>!0,deleteFilter:o=()=>!0,trackedOrigins:l=new Set([null]),ignoreRemoteMapChanges:p=!1,doc:_=array.isArray(t)?t[0].doc:t.doc}={}){super(),this.scope=[],this.doc=_,this.addToScope(t),this.deleteFilter=o,l.add(this),this.trackedOrigins=l,this.captureTransaction=s,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.lastChange=0,this.ignoreRemoteMapChanges=p,this.captureTimeout=e,this.afterTransactionHandler=A=>{if(!this.captureTransaction(A)||!this.scope.some(Gt=>A.changedParentTypes.has(Gt))||!this.trackedOrigins.has(A.origin)&&(!A.origin||!this.trackedOrigins.has(A.origin.constructor)))return;const F=this.undoing,j=this.redoing,V=F?this.redoStack:this.undoStack;F?this.stopCapturing():j||this.clear(!1,!0);const Q=new I;A.afterState.forEach((Gt,zt)=>{const qn=A.beforeState.get(zt)||0,Qn=Gt-qn;Qn>0&&bt(Q,zt,qn,Qn)});const tt=time.getUnixTime();let pt=!1;if(this.lastChange>0&&tt-this.lastChange<this.captureTimeout&&V.length>0&&!F&&!j){const Gt=V[V.length-1];Gt.deletions=it([Gt.deletions,A.deleteSet]),Gt.insertions=it([Gt.insertions,Q])}else V.push(new sr(A.deleteSet,Q)),pt=!0;!F&&!j&&(this.lastChange=tt),Y(A,A.deleteSet,Gt=>{Gt instanceof Wt&&this.scope.some(zt=>ce(zt,Gt))&&un(Gt,!0)});const It=[{stackItem:V[V.length-1],origin:A.origin,type:F?"redo":"undo",changedParentTypes:A.changedParentTypes},this];pt?this.emit("stack-item-added",It):this.emit("stack-item-updated",It)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",()=>{this.destroy()})}addToScope(t){t=array.isArray(t)?t:[t],t.forEach(e=>{this.scope.every(s=>s!==e)&&(e.doc!==this.doc&&logging.warn("[yjs#509] Not same Y.Doc"),this.scope.push(e))})}addTrackedOrigin(t){this.trackedOrigins.add(t)}removeTrackedOrigin(t){this.trackedOrigins.delete(t)}clear(t=!0,e=!0){(t&&this.canUndo()||e&&this.canRedo())&&this.doc.transact(s=>{t&&(this.undoStack.forEach(o=>En(s,this,o)),this.undoStack=[]),e&&(this.redoStack.forEach(o=>En(s,this,o)),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:t,redoStackCleared:e}])})}stopCapturing(){this.lastChange=0}undo(){this.undoing=!0;let t;try{t=Sn(this,this.undoStack,"undo")}finally{this.undoing=!1}return t}redo(){this.redoing=!0;let t;try{t=Sn(this,this.redoStack,"redo")}finally{this.redoing=!1}return t}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}}function*ir(i){const t=y.yg(i.restDecoder);for(let e=0;e<t;e++){const s=y.yg(i.restDecoder),o=i.readClient();let l=y.yg(i.restDecoder);for(let p=0;p<s;p++){const _=i.readInfo();if(_===10){const A=y.yg(i.restDecoder);yield new oe(gt(o,l),A),l+=A}else if(b.kr&_){const A=(_&(b.rc|b.x1))===0,F=new Wt(gt(o,l),null,(_&b.x1)===b.x1?i.readLeftID():null,null,(_&b.rc)===b.rc?i.readRightID():null,A?i.readParentInfo()?i.readString():i.readLeftID():null,A&&(_&b.cq)===b.cq?i.readString():null,Jn(i,_));yield F,l+=F.length}else{const A=i.readLen();yield new le(gt(o,l),A),l+=A}}}}class pe{constructor(t,e){this.gen=ir(t),this.curr=null,this.done=!1,this.filterSkips=e,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===oe);return this.curr}}const ls=i=>or(i,lt),or=(i,t=_t)=>{const e=[],s=new t(decoding.createDecoder(i)),o=new pe(s,!1);for(let p=o.curr;p!==null;p=o.next())e.push(p);logging.print("Structs: ",e);const l=Ut(s);logging.print("DeleteSet: ",l)},cs=i=>lr(i,lt),lr=(i,t=_t)=>{const e=[],s=new t(decoding.createDecoder(i)),o=new pe(s,!1);for(let l=o.curr;l!==null;l=o.next())e.push(l);return{structs:e,ds:Ut(s)}};class Qe{constructor(t){this.currClient=0,this.startClock=0,this.written=0,this.encoder=t,this.clientStructs=[]}}const cr=i=>je(i,lt,xt),ar=(i,t=Xt,e=_t)=>{const s=new t,o=new pe(new e(decoding.createDecoder(i)),!1);let l=o.curr;if(l!==null){let p=0,_=l.id.client,A=l.id.clock!==0,F=A?0:l.id.clock+l.length;for(;l!==null;l=o.next())_!==l.id.client&&(F!==0&&(p++,encoding.writeVarUint(s.restEncoder,_),encoding.writeVarUint(s.restEncoder,F)),_=l.id.client,F=0,A=l.id.clock!==0),l.constructor===oe&&(A=!0),A||(F=l.id.clock+l.length);F!==0&&(p++,encoding.writeVarUint(s.restEncoder,_),encoding.writeVarUint(s.restEncoder,F));const j=encoding.createEncoder();return encoding.writeVarUint(j,p),encoding.writeBinaryEncoder(j,s.restEncoder),s.restEncoder=j,s.toUint8Array()}else return encoding.writeVarUint(s.restEncoder,0),s.toUint8Array()},as=i=>ar(i,Rt,lt),ur=(i,t=_t)=>{const e=new Map,s=new Map,o=new pe(new t(decoding.createDecoder(i)),!1);let l=o.curr;if(l!==null){let p=l.id.client,_=l.id.clock;for(e.set(p,_);l!==null;l=o.next())p!==l.id.client&&(s.set(p,_),e.set(l.id.client,l.id.clock),p=l.id.client),_=l.id.clock+l.length;s.set(p,_)}return{from:e,to:s}},us=i=>ur(i,lt),hr=(i,t)=>{if(i.constructor===le){const{client:e,clock:s}=i.id;return new le(gt(e,s+t),i.length-t)}else if(i.constructor===oe){const{client:e,clock:s}=i.id;return new oe(gt(e,s+t),i.length-t)}else{const e=i,{client:s,clock:o}=e.id;return new Wt(gt(s,o+t),null,gt(s,o+t-1),null,e.rightOrigin,e.parent,e.parentSub,e.content.splice(t))}},je=(i,t=_t,e=Pt)=>{if(i.length===1)return i[0];const s=i.map(j=>new t(y.l1(j)));let o=s.map(j=>new pe(j,!0)),l=null;const p=new e,_=new Qe(p);for(;o=o.filter(Q=>Q.curr!==null),o.sort((Q,tt)=>{if(Q.curr.id.client===tt.curr.id.client){const pt=Q.curr.id.clock-tt.curr.id.clock;return pt===0?Q.curr.constructor===tt.curr.constructor?0:Q.curr.constructor===oe?1:-1:pt}else return tt.curr.id.client-Q.curr.id.client}),o.length!==0;){const j=o[0],V=j.curr.id.client;if(l!==null){let Q=j.curr,tt=!1;for(;Q!==null&&Q.id.clock+Q.length<=l.struct.id.clock+l.struct.length&&Q.id.client>=l.struct.id.client;)Q=j.next(),tt=!0;if(Q===null||Q.id.client!==V||tt&&Q.id.clock>l.struct.id.clock+l.struct.length)continue;if(V!==l.struct.id.client)ge(_,l.struct,l.offset),l={struct:Q,offset:0},j.next();else if(l.struct.id.clock+l.struct.length<Q.id.clock)if(l.struct.constructor===oe)l.struct.length=Q.id.clock+Q.length-l.struct.id.clock;else{ge(_,l.struct,l.offset);const pt=Q.id.clock-l.struct.id.clock-l.struct.length;l={struct:new oe(gt(V,l.struct.id.clock+l.struct.length),pt),offset:0}}else{const pt=l.struct.id.clock+l.struct.length-Q.id.clock;pt>0&&(l.struct.constructor===oe?l.struct.length-=pt:Q=hr(Q,pt)),l.struct.mergeWith(Q)||(ge(_,l.struct,l.offset),l={struct:Q,offset:0},j.next())}}else l={struct:j.curr,offset:0},j.next();for(let Q=j.curr;Q!==null&&Q.id.client===V&&Q.id.clock===l.struct.id.clock+l.struct.length&&Q.constructor!==oe;Q=j.next())ge(_,l.struct,l.offset),l={struct:Q,offset:0}}l!==null&&(ge(_,l.struct,l.offset),l=null),tn(_);const A=s.map(j=>Ut(j)),F=it(A);return At(p,F),p.toUint8Array()},Cn=(i,t,e=_t,s=Pt)=>{const o=K(t),l=new s,p=new Qe(l),_=new e(y.l1(i)),A=new pe(_,!1);for(;A.curr;){const j=A.curr,V=j.id.client,Q=o.get(V)||0;if(A.curr.constructor===oe){A.next();continue}if(j.id.clock+j.length>Q)for(ge(p,j,ut.Fp(Q-j.id.clock,0)),A.next();A.curr&&A.curr.id.client===V;)ge(p,A.curr,0),A.next();else for(;A.curr&&A.curr.id.client===V&&A.curr.id.clock+A.curr.length<=Q;)A.next()}tn(p);const F=Ut(_);return At(l,F),l.toUint8Array()},hs=(i,t)=>Cn(i,t,lt,xt),kn=i=>{i.written>0&&(i.clientStructs.push({written:i.written,restEncoder:D._f(i.encoder.restEncoder)}),i.encoder.restEncoder=D.Mf(),i.written=0)},ge=(i,t,e)=>{i.written>0&&i.currClient!==t.id.client&&kn(i),i.written===0&&(i.currClient=t.id.client,i.encoder.writeClient(t.id.client),D.uE(i.encoder.restEncoder,t.id.clock+e)),t.write(i.encoder,e),i.written++},tn=i=>{kn(i);const t=i.encoder.restEncoder;D.uE(t,i.clientStructs.length);for(let e=0;e<i.clientStructs.length;e++){const s=i.clientStructs[e];D.uE(t,s.written),D.HK(t,s.restEncoder)}},Pe=(i,t,e,s)=>{const o=new e(y.l1(i)),l=new pe(o,!1),p=new s,_=new Qe(p);for(let F=l.curr;F!==null;F=l.next())ge(_,t(F),0);tn(_);const A=Ut(o);return At(p,A),p.toUint8Array()},Tn=({formatting:i=!0,subdocs:t=!0,yxml:e=!0}={})=>{let s=0;const o=map.create(),l=map.create(),p=map.create(),_=map.create();return _.set(null,null),A=>{switch(A.constructor){case le:case oe:return A;case Wt:{const F=A,j=F.content;switch(j.constructor){case De:break;case he:{if(e){const V=j.type;V instanceof Te&&(V.nodeName=map.setIfUndefined(l,V.nodeName,()=>"node-"+s)),V instanceof Me&&(V.hookName=map.setIfUndefined(l,V.hookName,()=>"hook-"+s))}break}case we:{const V=j;V.arr=V.arr.map(()=>s);break}case Re:{const V=j;V.content=new Uint8Array([s]);break}case Ae:{const V=j;t&&(V.opts={},V.doc.guid=s+"");break}case be:{const V=j;V.embed={};break}case qt:{const V=j;i&&(V.key=map.setIfUndefined(p,V.key,()=>s+""),V.value=map.setIfUndefined(_,V.value,()=>({i:s})));break}case Ne:{const V=j;V.arr=V.arr.map(()=>s);break}case ue:{const V=j;V.str=string.repeat(s%10+"",V.str.length);break}default:error.unexpectedCase()}return F.parentSub&&(F.parentSub=map.setIfUndefined(o,F.parentSub,()=>s+"")),s++,A}default:error.unexpectedCase()}}},ds=(i,t)=>Pe(i,Tn(t),lt,xt),fs=(i,t)=>Pe(i,Tn(t),_t,Pt),ps=i=>Pe(i,f.id,lt,Pt),dr=i=>Pe(i,h.id,_t,xt),Rn="You must not compute changes after the event-handler fired.";class Fe{constructor(t,e){this.target=t,this.currentTarget=t,this.transaction=e,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=fr(this.currentTarget,this.target))}deletes(t){return P(this.transaction.deleteSet,t.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw a.Ue(Rn);const t=new Map,e=this.target;this.transaction.changed.get(e).forEach(o=>{if(o!==null){const l=e._map.get(o);let p,_;if(this.adds(l)){let A=l.left;for(;A!==null&&this.adds(A);)A=A.left;if(this.deletes(l))if(A!==null&&this.deletes(A))p="delete",_=ct.Z$(A.content.getContent());else return;else A!==null&&this.deletes(A)?(p="update",_=ct.Z$(A.content.getContent())):(p="add",_=void 0)}else if(this.deletes(l))p="delete",_=ct.Z$(l.content.getContent());else return;t.set(o,{action:p,oldValue:_})}}),this._keys=t}return this._keys}get delta(){return this.changes.delta}adds(t){return t.id.clock>=(this.transaction.beforeState.get(t.id.client)||0)}get changes(){let t=this._changes;if(t===null){if(this.transaction.doc._transactionCleanups.length===0)throw a.Ue(Rn);const e=this.target,s=d.Ue(),o=d.Ue(),l=[];if(t={added:s,deleted:o,delta:l,keys:this.keys},this.transaction.changed.get(e).has(null)){let _=null;const A=()=>{_&&l.push(_)};for(let F=e._start;F!==null;F=F.right)F.deleted?this.deletes(F)&&!this.adds(F)&&((_===null||_.delete===void 0)&&(A(),_={delete:0}),_.delete+=F.length,o.add(F)):this.adds(F)?((_===null||_.insert===void 0)&&(A(),_={insert:[]}),_.insert=_.insert.concat(F.content.getContent()),s.add(F)):((_===null||_.retain===void 0)&&(A(),_={retain:0}),_.retain+=F.length);_!==null&&_.retain===void 0&&A()}this._changes=t}return t}}const fr=(i,t)=>{const e=[];for(;t._item!==null&&t!==i;){if(t._item.parentSub!==null)e.unshift(t._item.parentSub);else{let s=0,o=t._item.parent._start;for(;o!==t._item&&o!==null;)o.deleted||s++,o=o.right;e.unshift(s)}t=t._item.parent}return e},Dn=80;let en=0;class pr{constructor(t,e){t.marker=!0,this.p=t,this.index=e,this.timestamp=en++}}const gr=i=>{i.timestamp=en++},An=(i,t,e)=>{i.p.marker=!1,i.p=t,t.marker=!0,i.index=e,i.timestamp=en++},mr=(i,t,e)=>{if(i.length>=Dn){const s=i.reduce((o,l)=>o.timestamp<l.timestamp?o:l);return An(s,t,e),s}else{const s=new pr(t,e);return i.push(s),s}},Ve=(i,t)=>{if(i._start===null||t===0||i._searchMarker===null)return null;const e=i._searchMarker.length===0?null:i._searchMarker.reduce((l,p)=>ut.Wn(t-l.index)<ut.Wn(t-p.index)?l:p);let s=i._start,o=0;for(e!==null&&(s=e.p,o=e.index,gr(e));s.right!==null&&o<t;){if(!s.deleted&&s.countable){if(t<o+s.length)break;o+=s.length}s=s.right}for(;s.left!==null&&o>t;)s=s.left,!s.deleted&&s.countable&&(o-=s.length);for(;s.left!==null&&s.left.id.client===s.id.client&&s.left.id.clock+s.left.length===s.id.clock;)s=s.left,!s.deleted&&s.countable&&(o-=s.length);return e!==null&&ut.Wn(e.index-o)<s.parent.length/Dn?(An(e,s,o),e):mr(i._searchMarker,s,o)},Oe=(i,t,e)=>{for(let s=i.length-1;s>=0;s--){const o=i[s];if(e>0){let l=o.p;for(l.marker=!1;l&&(l.deleted||!l.countable);)l=l.left,l&&!l.deleted&&l.countable&&(o.index-=l.length);if(l===null||l.marker===!0){i.splice(s,1);continue}o.p=l,l.marker=!0}(t<o.index||e>0&&t===o.index)&&(o.index=ut.Fp(t,o.index+e))}},gs=i=>{let t=i._start;const e=[];for(;t;)e.push(t),t=t.right;return e},We=(i,t,e)=>{const s=i,o=t.changedParentTypes;for(;M.Yu(o,i,()=>[]).push(e),i._item!==null;)i=i._item.parent;X(s._eH,e,t)};class ne{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=Dt(),this._dEH=Dt(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(t,e){this.doc=t,this._item=e}_copy(){throw a.Nw()}clone(){throw a.Nw()}_write(t){}get _first(){let t=this._start;for(;t!==null&&t.deleted;)t=t.right;return t}_callObserver(t,e){!t.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(t){Lt(this._eH,t)}observeDeep(t){Lt(this._dEH,t)}unobserve(t){ie(this._eH,t)}unobserveDeep(t){ie(this._dEH,t)}toJSON(){}}const In=(i,t,e)=>{t<0&&(t=i._length+t),e<0&&(e=i._length+e);let s=e-t;const o=[];let l=i._start;for(;l!==null&&s>0;){if(l.countable&&!l.deleted){const p=l.content.getContent();if(p.length<=t)t-=p.length;else{for(let _=t;_<p.length&&s>0;_++)o.push(p[_]),s--;t=0}}l=l.right}return o},Un=i=>{const t=[];let e=i._start;for(;e!==null;){if(e.countable&&!e.deleted){const s=e.content.getContent();for(let o=0;o<s.length;o++)t.push(s[o])}e=e.right}return t},ms=(i,t)=>{const e=[];let s=i._start;for(;s!==null;){if(s.countable&&_e(s,t)){const o=s.content.getContent();for(let l=0;l<o.length;l++)e.push(o[l])}s=s.right}return e},Le=(i,t)=>{let e=0,s=i._start;for(;s!==null;){if(s.countable&&!s.deleted){const o=s.content.getContent();for(let l=0;l<o.length;l++)t(o[l],e++,i)}s=s.right}},On=(i,t)=>{const e=[];return Le(i,(s,o)=>{e.push(t(s,o,i))}),e},yr=i=>{let t=i._start,e=null,s=0;return{[Symbol.iterator](){return this},next:()=>{if(e===null){for(;t!==null&&t.deleted;)t=t.right;if(t===null)return{done:!0,value:void 0};e=t.content.getContent(),s=0,t=t.right}const o=e[s++];return e.length<=s&&(e=null),{done:!1,value:o}}}},Ln=(i,t)=>{const e=Ve(i,t);let s=i._start;for(e!==null&&(s=e.p,t-=e.index);s!==null;s=s.right)if(!s.deleted&&s.countable){if(t<s.length)return s.content.getContent()[t];t-=s.length}},He=(i,t,e,s)=>{let o=e;const l=i.doc,p=l.clientID,_=l.store,A=e===null?t._start:e.right;let F=[];const j=()=>{F.length>0&&(o=new Wt(gt(p,Kt(_,p)),o,o&&o.lastId,A,A&&A.id,t,null,new we(F)),o.integrate(i,0),F=[])};s.forEach(V=>{if(V===null)F.push(V);else switch(V.constructor){case Number:case Object:case Boolean:case Array:case String:F.push(V);break;default:switch(j(),V.constructor){case Uint8Array:case ArrayBuffer:o=new Wt(gt(p,Kt(_,p)),o,o&&o.lastId,A,A&&A.id,t,null,new Re(new Uint8Array(V))),o.integrate(i,0);break;case st:o=new Wt(gt(p,Kt(_,p)),o,o&&o.lastId,A,A&&A.id,t,null,new Ae(V)),o.integrate(i,0);break;default:if(V instanceof ne)o=new Wt(gt(p,Kt(_,p)),o,o&&o.lastId,A,A&&A.id,t,null,new he(V)),o.integrate(i,0);else throw new Error("Unexpected content type in insert operation")}}}),j()},Mn=()=>a.Ue("Length exceeded!"),Nn=(i,t,e,s)=>{if(e>t._length)throw Mn();if(e===0)return t._searchMarker&&Oe(t._searchMarker,e,s.length),He(i,t,null,s);const o=e,l=Ve(t,e);let p=t._start;for(l!==null&&(p=l.p,e-=l.index,e===0&&(p=p.prev,e+=p&&p.countable&&!p.deleted?p.length:0));p!==null;p=p.right)if(!p.deleted&&p.countable){if(e<=p.length){e<p.length&&se(i,gt(p.id.client,p.id.clock+e));break}e-=p.length}return t._searchMarker&&Oe(t._searchMarker,o,s.length),He(i,t,p,s)},br=(i,t,e)=>{let o=(t._searchMarker||[]).reduce((l,p)=>p.index>l.index?p:l,{index:0,p:t._start}).p;if(o)for(;o.right;)o=o.right;return He(i,t,o,e)},xn=(i,t,e,s)=>{if(s===0)return;const o=e,l=s,p=Ve(t,e);let _=t._start;for(p!==null&&(_=p.p,e-=p.index);_!==null&&e>0;_=_.right)!_.deleted&&_.countable&&(e<_.length&&se(i,gt(_.id.client,_.id.clock+e)),e-=_.length);for(;s>0&&_!==null;)_.deleted||(s<_.length&&se(i,gt(_.id.client,_.id.clock+s)),_.delete(i),s-=_.length),_=_.right;if(s>0)throw Mn();t._searchMarker&&Oe(t._searchMarker,o,-l+s)},Ye=(i,t,e)=>{const s=t._map.get(e);s!==void 0&&s.delete(i)},nn=(i,t,e,s)=>{const o=t._map.get(e)||null,l=i.doc,p=l.clientID;let _;if(s==null)_=new we([s]);else switch(s.constructor){case Number:case Object:case Boolean:case Array:case String:_=new we([s]);break;case Uint8Array:_=new Re(s);break;case st:_=new Ae(s);break;default:if(s instanceof ne)_=new he(s);else throw new Error("Unexpected content type")}new Wt(gt(p,Kt(l.store,p)),o,o&&o.lastId,null,null,t,e,_).integrate(i,0)},rn=(i,t)=>{const e=i._map.get(t);return e!==void 0&&!e.deleted?e.content.getContent()[e.length-1]:void 0},Bn=i=>{const t={};return i._map.forEach((e,s)=>{e.deleted||(t[s]=e.content.getContent()[e.length-1])}),t},jn=(i,t)=>{const e=i._map.get(t);return e!==void 0&&!e.deleted},ys=(i,t,e)=>{let s=i._map.get(t)||null;for(;s!==null&&(!e.sv.has(s.id.client)||s.id.clock>=(e.sv.get(s.id.client)||0));)s=s.left;return s!==null&&_e(s,e)?s.content.getContent()[s.length-1]:void 0},Ge=i=>u(i.entries(),t=>!t[1].deleted);class wr extends Fe{constructor(t,e){super(t,e),this._transaction=e}}class me extends ne{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(t){const e=new me;return e.push(t),e}_integrate(t,e){super._integrate(t,e),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new me}clone(){const t=new me;return t.insert(0,this.toArray().map(e=>e instanceof ne?e.clone():e)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}_callObserver(t,e){super._callObserver(t,e),We(this,t,new wr(this,t))}insert(t,e){this.doc!==null?Vt(this.doc,s=>{Nn(s,this,t,e)}):this._prelimContent.splice(t,0,...e)}push(t){this.doc!==null?Vt(this.doc,e=>{br(e,this,t)}):this._prelimContent.push(...t)}unshift(t){this.insert(0,t)}delete(t,e=1){this.doc!==null?Vt(this.doc,s=>{xn(s,this,t,e)}):this._prelimContent.splice(t,e)}get(t){return Ln(this,t)}toArray(){return Un(this)}slice(t=0,e=this.length){return In(this,t,e)}toJSON(){return this.map(t=>t instanceof ne?t.toJSON():t)}map(t){return On(this,t)}forEach(t){Le(this,t)}[Symbol.iterator](){return yr(this)}_write(t){t.writeTypeRef(Hr)}}const _r=i=>new me;class vr extends Fe{constructor(t,e,s){super(t,e),this.keysChanged=s}}class ve extends ne{constructor(t){super(),this._prelimContent=null,t===void 0?this._prelimContent=new Map:this._prelimContent=new Map(t)}_integrate(t,e){super._integrate(t,e),this._prelimContent.forEach((s,o)=>{this.set(o,s)}),this._prelimContent=null}_copy(){return new ve}clone(){const t=new ve;return this.forEach((e,s)=>{t.set(s,e instanceof ne?e.clone():e)}),t}_callObserver(t,e){We(this,t,new vr(this,t,e))}toJSON(){const t={};return this._map.forEach((e,s)=>{if(!e.deleted){const o=e.content.getContent()[e.length-1];t[s]=o instanceof ne?o.toJSON():o}}),t}get size(){return[...Ge(this._map)].length}keys(){return w(Ge(this._map),t=>t[0])}values(){return w(Ge(this._map),t=>t[1].content.getContent()[t[1].length-1])}entries(){return w(Ge(this._map),t=>[t[0],t[1].content.getContent()[t[1].length-1]])}forEach(t){this._map.forEach((e,s)=>{e.deleted||t(e.content.getContent()[e.length-1],s,this)})}[Symbol.iterator](){return this.entries()}delete(t){this.doc!==null?Vt(this.doc,e=>{Ye(e,this,t)}):this._prelimContent.delete(t)}set(t,e){return this.doc!==null?Vt(this.doc,s=>{nn(s,this,t,e)}):this._prelimContent.set(t,e),e}get(t){return rn(this,t)}has(t){return jn(this,t)}clear(){this.doc!==null?Vt(this.doc,t=>{this.forEach(function(e,s,o){Ye(t,o,s)})}):this._prelimContent.clear()}_write(t){t.writeTypeRef(Yr)}}const Er=i=>new ve,ye=(i,t)=>i===t||typeof i=="object"&&typeof t=="object"&&i&&t&&m.$m(i,t);class sn{constructor(t,e,s,o){this.left=t,this.right=e,this.index=s,this.currentAttributes=o}forward(){switch(this.right===null&&a.zR(),this.right.content.constructor){case qt:this.right.deleted||Ce(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const Pn=(i,t,e)=>{for(;t.right!==null&&e>0;){switch(t.right.content.constructor){case qt:t.right.deleted||Ce(t.currentAttributes,t.right.content);break;default:t.right.deleted||(e<t.right.length&&se(i,gt(t.right.id.client,t.right.id.clock+e)),t.index+=t.right.length,e-=t.right.length);break}t.left=t.right,t.right=t.right.right}return t},Ke=(i,t,e)=>{const s=new Map,o=Ve(t,e);if(o){const l=new sn(o.p.left,o.p,o.index,s);return Pn(i,l,e-o.index)}else{const l=new sn(null,t._start,0,s);return Pn(i,l,e)}},Fn=(i,t,e,s)=>{for(;e.right!==null&&(e.right.deleted===!0||e.right.content.constructor===qt&&ye(s.get(e.right.content.key),e.right.content.value));)e.right.deleted||s.delete(e.right.content.key),e.forward();const o=i.doc,l=o.clientID;s.forEach((p,_)=>{const A=e.left,F=e.right,j=new Wt(gt(l,Kt(o.store,l)),A,A&&A.lastId,F,F&&F.id,t,null,new qt(_,p));j.integrate(i,0),e.right=j,e.forward()})},Ce=(i,t)=>{const{key:e,value:s}=t;s===null?i.delete(e):i.set(e,s)},Vn=(i,t)=>{for(;i.right!==null;){if(!(i.right.deleted||i.right.content.constructor===qt&&ye(t[i.right.content.key]||null,i.right.content.value)))break;i.forward()}},Wn=(i,t,e,s)=>{const o=i.doc,l=o.clientID,p=new Map;for(const _ in s){const A=s[_],F=e.currentAttributes.get(_)||null;if(!ye(F,A)){p.set(_,F);const{left:j,right:V}=e;e.right=new Wt(gt(l,Kt(o.store,l)),j,j&&j.lastId,V,V&&V.id,t,null,new qt(_,A)),e.right.integrate(i,0),e.forward()}}return p},on=(i,t,e,s,o)=>{e.currentAttributes.forEach((Q,tt)=>{o[tt]===void 0&&(o[tt]=null)});const l=i.doc,p=l.clientID;Vn(e,o);const _=Wn(i,t,e,o),A=s.constructor===String?new ue(s):s instanceof ne?new he(s):new be(s);let{left:F,right:j,index:V}=e;t._searchMarker&&Oe(t._searchMarker,e.index,A.getLength()),j=new Wt(gt(p,Kt(l.store,p)),F,F&&F.lastId,j,j&&j.id,t,null,A),j.integrate(i,0),e.right=j,e.index=V,e.forward(),Fn(i,t,e,_)},Hn=(i,t,e,s,o)=>{const l=i.doc,p=l.clientID;Vn(e,o);const _=Wn(i,t,e,o);t:for(;e.right!==null&&(s>0||_.size>0&&(e.right.deleted||e.right.content.constructor===qt));){if(!e.right.deleted)switch(e.right.content.constructor){case qt:{const{key:A,value:F}=e.right.content,j=o[A];if(j!==void 0){if(ye(j,F))_.delete(A);else{if(s===0)break t;_.set(A,F)}e.right.delete(i)}else e.currentAttributes.set(A,F);break}default:s<e.right.length&&se(i,gt(e.right.id.client,e.right.id.clock+s)),s-=e.right.length;break}e.forward()}if(s>0){let A="";for(;s>0;s--)A+=`
`;e.right=new Wt(gt(p,Kt(l.store,p)),e.left,e.left&&e.left.lastId,e.right,e.right&&e.right.id,t,null,new ue(A)),e.right.integrate(i,0),e.forward()}Fn(i,t,e,_)},Yn=(i,t,e,s,o)=>{let l=t;const p=M.Ue();for(;l&&(!l.countable||l.deleted);){if(!l.deleted&&l.content.constructor===qt){const F=l.content;p.set(F.key,F)}l=l.right}let _=0,A=!1;for(;t!==l;){if(e===t&&(A=!0),!t.deleted){const F=t.content;switch(F.constructor){case qt:{const{key:j,value:V}=F,Q=s.get(j)||null;(p.get(j)!==F||Q===V)&&(t.delete(i),_++,!A&&(o.get(j)||null)===V&&Q!==V&&(Q===null?o.delete(j):o.set(j,Q))),!A&&!t.deleted&&Ce(o,F);break}}}t=t.right}return _},Sr=(i,t)=>{for(;t&&t.right&&(t.right.deleted||!t.right.countable);)t=t.right;const e=new Set;for(;t&&(t.deleted||!t.countable);){if(!t.deleted&&t.content.constructor===qt){const s=t.content.key;e.has(s)?t.delete(i):e.add(s)}t=t.left}},Cr=i=>{let t=0;return Vt(i.doc,e=>{let s=i._start,o=i._start,l=M.Ue();const p=M.JG(l);for(;o;){if(o.deleted===!1)switch(o.content.constructor){case qt:Ce(p,o.content);break;default:t+=Yn(e,s,o,l,p),l=M.JG(p),s=o;break}o=o.right}}),t},kr=i=>{const t=new Set,e=i.doc;for(const[s,o]of i.afterState.entries()){const l=i.beforeState.get(s)||0;o!==l&&mn(i,e.store.clients.get(s),l,o,p=>{!p.deleted&&p.content.constructor===qt&&p.constructor!==le&&t.add(p.parent)})}Vt(e,s=>{Y(i,i.deleteSet,o=>{if(o instanceof le||!o.parent._hasFormatting||t.has(o.parent))return;const l=o.parent;o.content.constructor===qt?t.add(l):Sr(s,o)});for(const o of t)Cr(o)})},Gn=(i,t,e)=>{const s=e,o=M.JG(t.currentAttributes),l=t.right;for(;e>0&&t.right!==null;){if(t.right.deleted===!1)switch(t.right.content.constructor){case he:case be:case ue:e<t.right.length&&se(i,gt(t.right.id.client,t.right.id.clock+e)),e-=t.right.length,t.right.delete(i);break}t.forward()}l&&Yn(i,l,t.right,o,t.currentAttributes);const p=(t.left||t.right).parent;return p._searchMarker&&Oe(p._searchMarker,t.index,-s+e),t};class Tr extends Fe{constructor(t,e,s){super(t,e),this.childListChanged=!1,this.keysChanged=new Set,s.forEach(o=>{o===null?this.childListChanged=!0:this.keysChanged.add(o)})}get changes(){if(this._changes===null){const t={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=t}return this._changes}get delta(){if(this._delta===null){const t=this.target.doc,e=[];Vt(t,s=>{const o=new Map,l=new Map;let p=this.target._start,_=null;const A={};let F="",j=0,V=0;const Q=()=>{if(_!==null){let tt=null;switch(_){case"delete":V>0&&(tt={delete:V}),V=0;break;case"insert":(typeof F=="object"||F.length>0)&&(tt={insert:F},o.size>0&&(tt.attributes={},o.forEach((pt,It)=>{pt!==null&&(tt.attributes[It]=pt)}))),F="";break;case"retain":j>0&&(tt={retain:j},m.xb(A)||(tt.attributes=m.f0({},A))),j=0;break}tt&&e.push(tt),_=null}};for(;p!==null;){switch(p.content.constructor){case he:case be:this.adds(p)?this.deletes(p)||(Q(),_="insert",F=p.content.getContent()[0],Q()):this.deletes(p)?(_!=="delete"&&(Q(),_="delete"),V+=1):p.deleted||(_!=="retain"&&(Q(),_="retain"),j+=1);break;case ue:this.adds(p)?this.deletes(p)||(_!=="insert"&&(Q(),_="insert"),F+=p.content.str):this.deletes(p)?(_!=="delete"&&(Q(),_="delete"),V+=p.length):p.deleted||(_!=="retain"&&(Q(),_="retain"),j+=p.length);break;case qt:{const{key:tt,value:pt}=p.content;if(this.adds(p)){if(!this.deletes(p)){const It=o.get(tt)||null;ye(It,pt)?pt!==null&&p.delete(s):(_==="retain"&&Q(),ye(pt,l.get(tt)||null)?delete A[tt]:A[tt]=pt)}}else if(this.deletes(p)){l.set(tt,pt);const It=o.get(tt)||null;ye(It,pt)||(_==="retain"&&Q(),A[tt]=It)}else if(!p.deleted){l.set(tt,pt);const It=A[tt];It!==void 0&&(ye(It,pt)?It!==null&&p.delete(s):(_==="retain"&&Q(),pt===null?delete A[tt]:A[tt]=pt))}p.deleted||(_==="insert"&&Q(),Ce(o,p.content));break}}p=p.right}for(Q();e.length>0;){const tt=e[e.length-1];if(tt.retain!==void 0&&tt.attributes===void 0)e.pop();else break}}),this._delta=e}return this._delta}}class ke extends ne{constructor(t){super(),this._pending=t!==void 0?[()=>this.insert(0,t)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this._length}_integrate(t,e){super._integrate(t,e);try{this._pending.forEach(s=>s())}catch(s){console.error(s)}this._pending=null}_copy(){return new ke}clone(){const t=new ke;return t.applyDelta(this.toDelta()),t}_callObserver(t,e){super._callObserver(t,e);const s=new Tr(this,t,e);We(this,t,s),!t.local&&this._hasFormatting&&(t._needFormattingCleanup=!0)}toString(){let t="",e=this._start;for(;e!==null;)!e.deleted&&e.countable&&e.content.constructor===ue&&(t+=e.content.str),e=e.right;return t}toJSON(){return this.toString()}applyDelta(t,{sanitize:e=!0}={}){this.doc!==null?Vt(this.doc,s=>{const o=new sn(null,this._start,0,new Map);for(let l=0;l<t.length;l++){const p=t[l];if(p.insert!==void 0){const _=!e&&typeof p.insert=="string"&&l===t.length-1&&o.right===null&&p.insert.slice(-1)===`
`?p.insert.slice(0,-1):p.insert;(typeof _!="string"||_.length>0)&&on(s,this,o,_,p.attributes||{})}else p.retain!==void 0?Hn(s,this,o,p.retain,p.attributes||{}):p.delete!==void 0&&Gn(s,o,p.delete)}}):this._pending.push(()=>this.applyDelta(t))}toDelta(t,e,s){const o=[],l=new Map,p=this.doc;let _="",A=this._start;function F(){if(_.length>0){const V={};let Q=!1;l.forEach((pt,It)=>{Q=!0,V[It]=pt});const tt={insert:_};Q&&(tt.attributes=V),o.push(tt),_=""}}const j=()=>{for(;A!==null;){if(_e(A,t)||e!==void 0&&_e(A,e))switch(A.content.constructor){case ue:{const V=l.get("ychange");t!==void 0&&!_e(A,t)?(V===void 0||V.user!==A.id.client||V.type!=="removed")&&(F(),l.set("ychange",s?s("removed",A.id):{type:"removed"})):e!==void 0&&!_e(A,e)?(V===void 0||V.user!==A.id.client||V.type!=="added")&&(F(),l.set("ychange",s?s("added",A.id):{type:"added"})):V!==void 0&&(F(),l.delete("ychange")),_+=A.content.str;break}case he:case be:{F();const V={insert:A.content.getContent()[0]};if(l.size>0){const Q={};V.attributes=Q,l.forEach((tt,pt)=>{Q[pt]=tt})}o.push(V);break}case qt:_e(A,t)&&(F(),Ce(l,A.content));break}A=A.right}F()};return t||e?Vt(p,V=>{t&&Ze(V,t),e&&Ze(V,e),j()},"cleanup"):j(),o}insert(t,e,s){if(e.length<=0)return;const o=this.doc;o!==null?Vt(o,l=>{const p=Ke(l,this,t);s||(s={},p.currentAttributes.forEach((_,A)=>{s[A]=_})),on(l,this,p,e,s)}):this._pending.push(()=>this.insert(t,e,s))}insertEmbed(t,e,s={}){const o=this.doc;o!==null?Vt(o,l=>{const p=Ke(l,this,t);on(l,this,p,e,s)}):this._pending.push(()=>this.insertEmbed(t,e,s))}delete(t,e){if(e===0)return;const s=this.doc;s!==null?Vt(s,o=>{Gn(o,Ke(o,this,t),e)}):this._pending.push(()=>this.delete(t,e))}format(t,e,s){if(e===0)return;const o=this.doc;o!==null?Vt(o,l=>{const p=Ke(l,this,t);p.right!==null&&Hn(l,this,p,e,s)}):this._pending.push(()=>this.format(t,e,s))}removeAttribute(t){this.doc!==null?Vt(this.doc,e=>{Ye(e,this,t)}):this._pending.push(()=>this.removeAttribute(t))}setAttribute(t,e){this.doc!==null?Vt(this.doc,s=>{nn(s,this,t,e)}):this._pending.push(()=>this.setAttribute(t,e))}getAttribute(t){return rn(this,t)}getAttributes(){return Bn(this)}_write(t){t.writeTypeRef(Gr)}}const Rr=i=>new ke;class ln{constructor(t,e=()=>!0){this._filter=e,this._root=t,this._currentNode=t._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let t=this._currentNode,e=t&&t.content&&t.content.type;if(t!==null&&(!this._firstCall||t.deleted||!this._filter(e)))do if(e=t.content.type,!t.deleted&&(e.constructor===Te||e.constructor===Ee)&&e._start!==null)t=e._start;else for(;t!==null;)if(t.right!==null){t=t.right;break}else t.parent===this._root?t=null:t=t.parent._item;while(t!==null&&(t.deleted||!this._filter(t.content.type)));return this._firstCall=!1,t===null?{value:void 0,done:!0}:(this._currentNode=t,{value:t.content.type,done:!1})}}class Ee extends ne{constructor(){super(),this._prelimContent=[]}get firstChild(){const t=this._first;return t?t.content.getContent()[0]:null}_integrate(t,e){super._integrate(t,e),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Ee}clone(){const t=new Ee;return t.insert(0,this.toArray().map(e=>e instanceof ne?e.clone():e)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(t){return new ln(this,t)}querySelector(t){t=t.toUpperCase();const s=new ln(this,o=>o.nodeName&&o.nodeName.toUpperCase()===t).next();return s.done?null:s.value}querySelectorAll(t){return t=t.toUpperCase(),ct.Dp(new ln(this,e=>e.nodeName&&e.nodeName.toUpperCase()===t))}_callObserver(t,e){We(this,t,new Ir(this,e,t))}toString(){return On(this,t=>t.toString()).join("")}toJSON(){return this.toString()}toDOM(t=document,e={},s){const o=t.createDocumentFragment();return s!==void 0&&s._createAssociation(o,this),Le(this,l=>{o.insertBefore(l.toDOM(t,e,s),null)}),o}insert(t,e){this.doc!==null?Vt(this.doc,s=>{Nn(s,this,t,e)}):this._prelimContent.splice(t,0,...e)}insertAfter(t,e){if(this.doc!==null)Vt(this.doc,s=>{const o=t&&t instanceof ne?t._item:t;He(s,this,o,e)});else{const s=this._prelimContent,o=t===null?0:s.findIndex(l=>l===t)+1;if(o===0&&t!==null)throw a.Ue("Reference item not found");s.splice(o,0,...e)}}delete(t,e=1){this.doc!==null?Vt(this.doc,s=>{xn(s,this,t,e)}):this._prelimContent.splice(t,e)}toArray(){return Un(this)}push(t){this.insert(this.length,t)}unshift(t){this.insert(0,t)}get(t){return Ln(this,t)}slice(t=0,e=this.length){return In(this,t,e)}forEach(t){Le(this,t)}_write(t){t.writeTypeRef(zr)}}const Dr=i=>new Ee;class Te extends Ee{constructor(t="UNDEFINED"){super(),this.nodeName=t,this._prelimAttrs=new Map}get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_integrate(t,e){super._integrate(t,e),this._prelimAttrs.forEach((s,o)=>{this.setAttribute(o,s)}),this._prelimAttrs=null}_copy(){return new Te(this.nodeName)}clone(){const t=new Te(this.nodeName),e=this.getAttributes();return m.Ed(e,(s,o)=>{typeof s=="string"&&t.setAttribute(o,s)}),t.insert(0,this.toArray().map(s=>s instanceof ne?s.clone():s)),t}toString(){const t=this.getAttributes(),e=[],s=[];for(const _ in t)s.push(_);s.sort();const o=s.length;for(let _=0;_<o;_++){const A=s[_];e.push(A+'="'+t[A]+'"')}const l=this.nodeName.toLocaleLowerCase(),p=e.length>0?" "+e.join(" "):"";return`<${l}${p}>${super.toString()}</${l}>`}removeAttribute(t){this.doc!==null?Vt(this.doc,e=>{Ye(e,this,t)}):this._prelimAttrs.delete(t)}setAttribute(t,e){this.doc!==null?Vt(this.doc,s=>{nn(s,this,t,e)}):this._prelimAttrs.set(t,e)}getAttribute(t){return rn(this,t)}hasAttribute(t){return jn(this,t)}getAttributes(){return Bn(this)}toDOM(t=document,e={},s){const o=t.createElement(this.nodeName),l=this.getAttributes();for(const p in l){const _=l[p];typeof _=="string"&&o.setAttribute(p,_)}return Le(this,p=>{o.appendChild(p.toDOM(t,e,s))}),s!==void 0&&s._createAssociation(o,this),o}_write(t){t.writeTypeRef(Kr),t.writeKey(this.nodeName)}}const Ar=i=>new Te(i.readKey());class Ir extends Fe{constructor(t,e,s){super(t,s),this.childListChanged=!1,this.attributesChanged=new Set,e.forEach(o=>{o===null?this.childListChanged=!0:this.attributesChanged.add(o)})}}class Me extends ve{constructor(t){super(),this.hookName=t}_copy(){return new Me(this.hookName)}clone(){const t=new Me(this.hookName);return this.forEach((e,s)=>{t.set(s,e)}),t}toDOM(t=document,e={},s){const o=e[this.hookName];let l;return o!==void 0?l=o.createDom(this):l=document.createElement(this.hookName),l.setAttribute("data-yjs-hook",this.hookName),s!==void 0&&s._createAssociation(l,this),l}_write(t){t.writeTypeRef($r),t.writeKey(this.hookName)}}const Ur=i=>new Me(i.readKey());class ze extends ke{get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_copy(){return new ze}clone(){const t=new ze;return t.applyDelta(this.toDelta()),t}toDOM(t=document,e,s){const o=t.createTextNode(this.toString());return s!==void 0&&s._createAssociation(o,this),o}toString(){return this.toDelta().map(t=>{const e=[];for(const o in t.attributes){const l=[];for(const p in t.attributes[o])l.push({key:p,value:t.attributes[o][p]});l.sort((p,_)=>p.key<_.key?-1:1),e.push({nodeName:o,attrs:l})}e.sort((o,l)=>o.nodeName<l.nodeName?-1:1);let s="";for(let o=0;o<e.length;o++){const l=e[o];s+=`<${l.nodeName}`;for(let p=0;p<l.attrs.length;p++){const _=l.attrs[p];s+=` ${_.key}="${_.value}"`}s+=">"}s+=t.insert;for(let o=e.length-1;o>=0;o--)s+=`</${e[o].nodeName}>`;return s}).join("")}toJSON(){return this.toString()}_write(t){t.writeTypeRef(Jr)}}const Or=i=>new ze;class cn{constructor(t,e){this.id=t,this.length=e}get deleted(){throw a.Nw()}mergeWith(t){return!1}write(t,e,s){throw a.Nw()}integrate(t,e){throw a.Nw()}}const Lr=0;class le extends cn{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,e){e>0&&(this.id.clock+=e,this.length-=e),pn(t.doc.store,this)}write(t,e){t.writeInfo(Lr),t.writeLen(this.length-e)}getMissing(t,e){return null}}class Re{constructor(t){this.content=t}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new Re(this.content)}splice(t){throw a.Nw()}mergeWith(t){return!1}integrate(t,e){}delete(t){}gc(t){}write(t,e){t.writeBuf(this.content)}getRef(){return 3}}const Mr=i=>new Re(i.readBuf());class De{constructor(t){this.len=t}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new De(this.len)}splice(t){const e=new De(this.len-t);return this.len=t,e}mergeWith(t){return this.len+=t.len,!0}integrate(t,e){bt(t.deleteSet,e.id.client,e.id.clock,this.len),e.markDeleted()}delete(t){}gc(t){}write(t,e){t.writeLen(this.len-e)}getRef(){return 1}}const Nr=i=>new De(i.readLen()),Kn=(i,t)=>new st({guid:i,...t,shouldLoad:t.shouldLoad||t.autoLoad||!1});class Ae{constructor(t){t._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=t;const e={};this.opts=e,t.gc||(e.gc=!1),t.autoLoad&&(e.autoLoad=!0),t.meta!==null&&(e.meta=t.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new Ae(Kn(this.doc.guid,this.opts))}splice(t){throw a.Nw()}mergeWith(t){return!1}integrate(t,e){this.doc._item=e,t.subdocsAdded.add(this.doc),this.doc.shouldLoad&&t.subdocsLoaded.add(this.doc)}delete(t){t.subdocsAdded.has(this.doc)?t.subdocsAdded.delete(this.doc):t.subdocsRemoved.add(this.doc)}gc(t){}write(t,e){t.writeString(this.doc.guid),t.writeAny(this.opts)}getRef(){return 9}}const xr=i=>new Ae(Kn(i.readString(),i.readAny()));class be{constructor(t){this.embed=t}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new be(this.embed)}splice(t){throw a.Nw()}mergeWith(t){return!1}integrate(t,e){}delete(t){}gc(t){}write(t,e){t.writeJSON(this.embed)}getRef(){return 5}}const Br=i=>new be(i.readJSON());class qt{constructor(t,e){this.key=t,this.value=e}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new qt(this.key,this.value)}splice(t){throw a.Nw()}mergeWith(t){return!1}integrate(t,e){const s=e.parent;s._searchMarker=null,s._hasFormatting=!0}delete(t){}gc(t){}write(t,e){t.writeKey(this.key),t.writeJSON(this.value)}getRef(){return 6}}const jr=i=>new qt(i.readKey(),i.readJSON());class Ne{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Ne(this.arr)}splice(t){const e=new Ne(this.arr.slice(t));return this.arr=this.arr.slice(0,t),e}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){const s=this.arr.length;t.writeLen(s-e);for(let o=e;o<s;o++){const l=this.arr[o];t.writeString(l===void 0?"undefined":JSON.stringify(l))}}getRef(){return 2}}const Pr=i=>{const t=i.readLen(),e=[];for(let s=0;s<t;s++){const o=i.readString();o==="undefined"?e.push(void 0):e.push(JSON.parse(o))}return new Ne(e)};class we{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new we(this.arr)}splice(t){const e=new we(this.arr.slice(t));return this.arr=this.arr.slice(0,t),e}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){const s=this.arr.length;t.writeLen(s-e);for(let o=e;o<s;o++){const l=this.arr[o];t.writeAny(l)}}getRef(){return 8}}const Fr=i=>{const t=i.readLen(),e=[];for(let s=0;s<t;s++)e.push(i.readAny());return new we(e)};class ue{constructor(t){this.str=t}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new ue(this.str)}splice(t){const e=new ue(this.str.slice(t));this.str=this.str.slice(0,t);const s=this.str.charCodeAt(t-1);return s>=55296&&s<=56319&&(this.str=this.str.slice(0,t-1)+"\uFFFD",e.str="\uFFFD"+e.str.slice(1)),e}mergeWith(t){return this.str+=t.str,!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){t.writeString(e===0?this.str:this.str.slice(e))}getRef(){return 4}}const Vr=i=>new ue(i.readString()),Wr=[_r,Er,Rr,Ar,Dr,Ur,Or],Hr=0,Yr=1,Gr=2,Kr=3,zr=4,$r=5,Jr=6;class he{constructor(t){this.type=t}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new he(this.type._copy())}splice(t){throw a.Nw()}mergeWith(t){return!1}integrate(t,e){this.type._integrate(t.doc,e)}delete(t){let e=this.type._start;for(;e!==null;)e.deleted?e.id.clock<(t.beforeState.get(e.id.client)||0)&&t._mergeStructs.push(e):e.delete(t),e=e.right;this.type._map.forEach(s=>{s.deleted?s.id.clock<(t.beforeState.get(s.id.client)||0)&&t._mergeStructs.push(s):s.delete(t)}),t.changed.delete(this.type)}gc(t){let e=this.type._start;for(;e!==null;)e.gc(t,!0),e=e.right;this.type._start=null,this.type._map.forEach(s=>{for(;s!==null;)s.gc(t,!0),s=s.left}),this.type._map=new Map}write(t,e){this.type._write(t)}getRef(){return 7}}const Xr=i=>new he(Wr[i.readTypeRef()](i)),an=(i,t)=>{let e=t,s=0,o;do s>0&&(e=gt(e.client,e.clock+s)),o=xe(i,e),s=e.clock-o.id.clock,e=o.redone;while(e!==null&&o instanceof Wt);return{item:o,diff:s}},un=(i,t)=>{for(;i!==null&&i.keep!==t;)i.keep=t,i=i.parent._item},$e=(i,t,e)=>{const{client:s,clock:o}=t.id,l=new Wt(gt(s,o+e),t,gt(s,o+e-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(e));return t.deleted&&l.markDeleted(),t.keep&&(l.keep=!0),t.redone!==null&&(l.redone=gt(t.redone.client,t.redone.clock+e)),t.right=l,l.right!==null&&(l.right.left=l),i._mergeStructs.push(l),l.parentSub!==null&&l.right===null&&l.parent._map.set(l.parentSub,l),t.length=e,l},zn=(i,t)=>array.some(i,e=>P(e.deletions,t)),$n=(i,t,e,s,o,l)=>{const p=i.doc,_=p.store,A=p.clientID,F=t.redone;if(F!==null)return se(i,F);let j=t.parent._item,V=null,Q;if(j!==null&&j.deleted===!0){if(j.redone===null&&(!e.has(j)||$n(i,j,e,s,o,l)===null))return null;for(;j.redone!==null;)j=se(i,j.redone)}const tt=j===null?t.parent:j.content.type;if(t.parentSub===null){for(V=t.left,Q=t;V!==null;){let zt=V;for(;zt!==null&&zt.parent._item!==j;)zt=zt.redone===null?null:se(i,zt.redone);if(zt!==null&&zt.parent._item===j){V=zt;break}V=V.left}for(;Q!==null;){let zt=Q;for(;zt!==null&&zt.parent._item!==j;)zt=zt.redone===null?null:se(i,zt.redone);if(zt!==null&&zt.parent._item===j){Q=zt;break}Q=Q.right}}else if(Q=null,t.right&&!o){for(V=t;V!==null&&V.right!==null&&(V.right.redone||P(s,V.right.id)||zn(l.undoStack,V.right.id)||zn(l.redoStack,V.right.id));)for(V=V.right;V.redone;)V=se(i,V.redone);if(V&&V.right!==null)return null}else V=tt._map.get(t.parentSub)||null;const pt=Kt(_,A),It=gt(A,pt),Gt=new Wt(It,V,V&&V.lastId,Q,Q&&Q.id,tt,t.parentSub,t.content.copy());return t.redone=It,un(Gt,!0),Gt.integrate(i,0),Gt};class Wt extends cn{constructor(t,e,s,o,l,p,_,A){super(t,A.getLength()),this.origin=s,this.left=e,this.right=o,this.rightOrigin=l,this.parent=p,this.parentSub=_,this.redone=null,this.content=A,this.info=this.content.isCountable()?b.Qn:0}set marker(t){(this.info&b.Ko)>0!==t&&(this.info^=b.Ko)}get marker(){return(this.info&b.Ko)>0}get keep(){return(this.info&b.Vw)>0}set keep(t){this.keep!==t&&(this.info^=b.Vw)}get countable(){return(this.info&b.Qn)>0}get deleted(){return(this.info&b.CY)>0}set deleted(t){this.deleted!==t&&(this.info^=b.CY)}markDeleted(){this.info|=b.CY}getMissing(t,e){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=Kt(e,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=Kt(e,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===nt&&this.id.client!==this.parent.client&&this.parent.clock>=Kt(e,this.parent.client))return this.parent.client;if(this.origin&&(this.left=gn(t,e,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=se(t,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===le||this.right&&this.right.constructor===le)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===Wt&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===Wt&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===nt){const s=xe(e,this.parent);s.constructor===le?this.parent=null:this.parent=s.content.type}return null}integrate(t,e){if(e>0&&(this.id.clock+=e,this.left=gn(t,t.doc.store,gt(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(e),this.length-=e),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let s=this.left,o;if(s!==null)o=s.right;else if(this.parentSub!==null)for(o=this.parent._map.get(this.parentSub)||null;o!==null&&o.left!==null;)o=o.left;else o=this.parent._start;const l=new Set,p=new Set;for(;o!==null&&o!==this.right;){if(p.add(o),l.add(o),mt(this.origin,o.origin)){if(o.id.client<this.id.client)s=o,l.clear();else if(mt(this.rightOrigin,o.rightOrigin))break}else if(o.origin!==null&&p.has(xe(t.doc.store,o.origin)))l.has(xe(t.doc.store,o.origin))||(s=o,l.clear());else break;o=o.right}this.left=s}if(this.left!==null){const s=this.left.right;this.right=s,this.left.right=this}else{let s;if(this.parentSub!==null)for(s=this.parent._map.get(this.parentSub)||null;s!==null&&s.left!==null;)s=s.left;else s=this.parent._start,this.parent._start=this;this.right=s}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(t)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),pn(t.doc.store,this),this.content.integrate(t,this),bn(t,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(t)}else new le(this.id,this.length).integrate(t,0)}get next(){let t=this.right;for(;t!==null&&t.deleted;)t=t.right;return t}get prev(){let t=this.left;for(;t!==null&&t.deleted;)t=t.left;return t}get lastId(){return this.length===1?this.id:gt(this.id.client,this.id.clock+this.length-1)}mergeWith(t){if(this.constructor===t.constructor&&mt(t.origin,this.lastId)&&this.right===t&&mt(this.rightOrigin,t.rightOrigin)&&this.id.client===t.id.client&&this.id.clock+this.length===t.id.clock&&this.deleted===t.deleted&&this.redone===null&&t.redone===null&&this.content.constructor===t.content.constructor&&this.content.mergeWith(t.content)){const e=this.parent._searchMarker;return e&&e.forEach(s=>{s.p===t&&(s.p=this,!this.deleted&&this.countable&&(s.index-=this.length))}),t.keep&&(this.keep=!0),this.right=t.right,this.right!==null&&(this.right.left=this),this.length+=t.length,!0}return!1}delete(t){if(!this.deleted){const e=this.parent;this.countable&&this.parentSub===null&&(e._length-=this.length),this.markDeleted(),bt(t.deleteSet,this.id.client,this.id.clock,this.length),bn(t,e,this.parentSub),this.content.delete(t)}}gc(t,e){if(!this.deleted)throw a.zR();this.content.gc(t),e?nr(t,this,new le(this.id,this.length)):this.content=new De(this.length)}write(t,e){const s=e>0?gt(this.id.client,this.id.clock+e-1):this.origin,o=this.rightOrigin,l=this.parentSub,p=this.content.getRef()&b.kr|(s===null?0:b.x1)|(o===null?0:b.rc)|(l===null?0:b.cq);if(t.writeInfo(p),s!==null&&t.writeLeftID(s),o!==null&&t.writeRightID(o),s===null&&o===null){const _=this.parent;if(_._item!==void 0){const A=_._item;if(A===null){const F=Yt(_);t.writeParentInfo(!0),t.writeString(F)}else t.writeParentInfo(!1),t.writeLeftID(A.id)}else _.constructor===String?(t.writeParentInfo(!0),t.writeString(_)):_.constructor===nt?(t.writeParentInfo(!1),t.writeLeftID(_)):a.zR();l!==null&&t.writeString(l)}this.content.write(t,e)}}const Jn=(i,t)=>Zr[t&b.kr](i),Zr=[()=>{a.zR()},Nr,Pr,Mr,Vr,Br,jr,Xr,Fr,xr,()=>{a.zR()}],qr=10;class oe extends cn{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,e){a.zR()}write(t,e){t.writeInfo(qr),D.uE(t.restEncoder,this.length-e)}getMissing(t,e){return null}}const Xn=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof $.g!="undefined"?$.g:{},Zn="__ $YJS$ __";Xn[Zn]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438"),Xn[Zn]=!0}}]);})();
