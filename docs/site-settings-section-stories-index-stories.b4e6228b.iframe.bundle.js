"use strict";(()=>{var Ie=Object.defineProperty;var Re=(p,n,s)=>n in p?Ie(p,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):p[n]=s;var Y=(p,n,s)=>(Re(p,typeof n!="symbol"?n+"":n,s),s);(self.webpackChunk_automattic_jetpack_storybook=self.webpackChunk_automattic_jetpack_storybook||[]).push([[3556],{"../../packages/videopress/src/client/admin/components/site-settings-section/stories/index.stories.tsx":(p,n,s)=>{var y,D,O;s.r(n),s.d(n,{__namedExportsOrder:()=>P,_default:()=>E,default:()=>x});var d=s("../../../node_modules/.pnpm/@storybook+addon-actions@7.6.5/node_modules/@storybook/addon-actions/dist/index.mjs"),_=s("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),i=s("../components/components/layout/container/index.tsx"),u=s("../components/components/layout/col/index.tsx"),r=s("../components/components/text/index.tsx"),m=s("../../../node_modules/.pnpm/@wordpress+i18n@4.47.0/node_modules/@wordpress/i18n/build-module/index.js"),l=s("../../packages/videopress/src/client/admin/hooks/use-permission/index.ts"),C=s("../../packages/videopress/src/client/admin/hooks/use-videopress-settings/index.ts"),I=s("../../packages/videopress/src/client/admin/components/video-filter/index.tsx"),g=s("../../packages/videopress/src/client/admin/components/site-settings-section/constants.ts"),c=s("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");const R=m.__,v=({videoPressVideosPrivateForSite:S,siteIsPrivate:h,siteType:U,onPrivacyChange:T})=>{const{canPerformAction:f}=(0,l.g)(),a=h&&U===g.mP,B=!f||a,k=a?R("You cannot change this setting because your site is private. You can only choose the video privacy default on public sites.","jetpack-videopress-pkg"):null;return(0,c.jsxs)(i.Z,{horizontalSpacing:0,horizontalGap:0,children:[(0,c.jsx)(u.Z,{children:(0,c.jsx)(r.ZP,{variant:"headline-small",mb:1,children:R("Settings","jetpack-videopress-pkg")})}),(0,c.jsx)(u.Z,{sm:12,md:12,lg:12,children:(0,c.jsx)(I.JC,{for:"settings-site-privacy",label:R("Video Privacy: Restrict views to members of this site","jetpack-videopress-pkg"),onChange:T,checked:S,disabled:B,disabledReason:k})})]})};v.displayName="SiteSettingsSection";const A=()=>{const{settings:S,onUpdate:h}=(0,C.C)(),{videoPressVideosPrivateForSite:U,siteIsPrivate:T,siteType:f}=S;return(0,c.jsx)(v,{videoPressVideosPrivateForSite:U,siteIsPrivate:T,siteType:f,onPrivacyChange:a=>{h({videoPressVideosPrivateForSite:a})}})};A.displayName="ConnectSiteSettingsSection";const j=v;var w=`/**
 * External dependencies
 */
import { action } from '@storybook/addon-actions';
import React from 'react';
/**
 * Internal dependencies
 */
import SettingsSection from '..';

export default {
	title: 'Packages/VideoPress/Site Settings',
	component: SettingsSection,
	argTypes: {},
};

const Template = args => <SettingsSection { ...args } />;

export const _default = Template.bind( {} );
_default.args = {
	onPrivacyChange: action( 'onPrivacyChange' ),
};
`,L={_default:{startLoc:{col:17,line:17},endLoc:{col:56,line:17},startBody:{col:17,line:17},endBody:{col:56,line:17}}};const x={parameters:{storySource:{source:`/**
 * External dependencies
 */
import { action } from '@storybook/addon-actions';
import React from 'react';
/**
 * Internal dependencies
 */
import SettingsSection from '..';

export default {
	title: 'Packages/VideoPress/Site Settings',
	component: SettingsSection,
	argTypes: {},
};

const Template = args => <SettingsSection { ...args } />;

export const _default = Template.bind( {} );
_default.args = {
	onPrivacyChange: action( 'onPrivacyChange' ),
};
`,locationsMap:{default:{startLoc:{col:17,line:17},endLoc:{col:56,line:17},startBody:{col:17,line:17},endBody:{col:56,line:17}}}}},title:"Packages/VideoPress/Site Settings",component:j,argTypes:{}},N=S=>(0,c.jsx)(j,{...S});N.displayName="Template";const E=N.bind({});E.args={onPrivacyChange:(0,d.aD)("onPrivacyChange")},E.parameters={...E.parameters,docs:{...(y=E.parameters)==null?void 0:y.docs,source:{originalSource:"args => <SettingsSection {...args} />",...(O=(D=E.parameters)==null?void 0:D.docs)==null?void 0:O.source}}};const P=["_default"]},"../../../node_modules/.pnpm/@wordpress+data@9.17.0_react@18.2.0/node_modules/@wordpress/data/build-module/components/use-dispatch/use-dispatch.js":(p,n,s)=>{s.d(n,{Z:()=>i});var d=s("../../../node_modules/.pnpm/@wordpress+data@9.17.0_react@18.2.0/node_modules/@wordpress/data/build-module/components/registry-provider/use-registry.js");const i=u=>{const{dispatch:r}=(0,d.Z)();return u===void 0?r:r(u)}},"../../../node_modules/.pnpm/@wordpress+data@9.17.0_react@18.2.0/node_modules/@wordpress/data/build-module/select.js":(p,n,s)=>{s.d(n,{Y:()=>_});var d=s("../../../node_modules/.pnpm/@wordpress+data@9.17.0_react@18.2.0/node_modules/@wordpress/data/build-module/default-registry.js");function _(i){return d.Z.select(i)}},"../connection/components/use-connection/index.jsx":(p,n,s)=>{s.d(n,{Z:()=>l});var d=s("../api/index.jsx"),_=s("../../../node_modules/.pnpm/@wordpress+data@9.17.0_react@18.2.0/node_modules/@wordpress/data/build-module/components/use-dispatch/use-dispatch.js"),i=s("../../../node_modules/.pnpm/@wordpress+data@9.17.0_react@18.2.0/node_modules/@wordpress/data/build-module/components/use-select/index.js"),u=s("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),r=s("../connection/state/store.jsx");const m=window!=null&&window.JP_CONNECTION_INITIAL_STATE?window.JP_CONNECTION_INITIAL_STATE:{},l=({registrationNonce:C=m.registrationNonce,apiRoot:I=m.apiRoot,apiNonce:g=m.apiNonce,redirectUri:c,autoTrigger:R,from:v,skipUserConnection:A}={})=>{const{registerSite:j,connectUser:w,refreshConnectedPlugins:L}=(0,_.Z)(r.t),x=(0,i.Z)(a=>a(r.t).getRegistrationError()),{siteIsRegistering:N,userIsConnecting:E,userConnectionData:P,connectedPlugins:y,connectionErrors:D,isRegistered:O,isUserConnected:S,hasConnectedOwner:h,isOfflineMode:U}=(0,i.Z)(a=>({siteIsRegistering:a(r.t).getSiteIsRegistering(),userIsConnecting:a(r.t).getUserIsConnecting(),userConnectionData:a(r.t).getUserConnectionData(),connectedPlugins:a(r.t).getConnectedPlugins(),connectionErrors:a(r.t).getConnectionErrors(),isOfflineMode:a(r.t).getIsOfflineMode(),...a(r.t).getConnectionStatus()})),T=()=>{if(A){if(c)return window.location=c,Promise.resolve(c)}else return w({from:v,redirectUri:c});return Promise.resolve()},f=a=>(a&&a.preventDefault(),O?T():j({registrationNonce:C,redirectUri:c}).then(()=>T()));return(0,u.useEffect)(()=>{d.ZP.setApiRoot(I),d.ZP.setApiNonce(g)},[I,g]),(0,u.useEffect)(()=>{R&&!N&&!E&&f()},[]),{handleRegisterSite:f,handleConnectUser:T,refreshConnectedPlugins:L,isRegistered:O,isUserConnected:S,siteIsRegistering:N,userIsConnecting:E,registrationError:x,userConnectionData:P,hasConnectedOwner:h,connectedPlugins:y,connectionErrors:D,isOfflineMode:U}}},"../connection/state/store.jsx":(p,n,s)=>{s.d(n,{t:()=>M});var d=s("../api/index.jsx");const _="SET_CONNECTION_STATUS",i="SET_CONNECTION_STATUS_IS_FETCHING",u="FETCH_CONNECTION_STATUS",r="SET_SITE_IS_REGISTERING",m="SET_USER_IS_CONNECTING",l="SET_REGISTRATION_ERROR",C="CLEAR_REGISTRATION_ERROR",I="REGISTER_SITE",g="SET_AUTHORIZATION_URL",c="CONNECT_USER",R="DISCONNECT_USER_SUCCESS",v="FETCH_AUTHORIZATION_URL",A="SET_CONNECTED_PLUGINS",j="REFRESH_CONNECTED_PLUGINS",w="SET_CONNECTION_ERRORS",L="SET_IS_OFFLINE_MODE",x=e=>({type:_,connectionStatus:e}),N=e=>({type:i,isFetching:e}),E=()=>({type:u}),P=e=>({type:r,isRegistering:e}),y=e=>({type:m,isConnecting:e}),D=()=>({type:R}),O=e=>({type:l,registrationError:e}),S=()=>({type:C}),h=e=>({type:g,authorizationUrl:e}),U=e=>({type:v,redirectUri:e}),T=e=>({type:A,connectedPlugins:e}),f=e=>({type:w,connectionErrors:e}),a=e=>({type:L,isOfflineMode:e});function*B({from:e,redirectFunc:t,redirectUri:o}={}){yield y(!0),yield{type:c,from:e,redirectFunc:t,redirectUri:o}}function*k({registrationNonce:e,redirectUri:t}){yield S(),yield P(!0);try{const o=yield{type:I,registrationNonce:e,redirectUri:t};return yield x({isRegistered:!0}),yield h(o.authorizeUrl),yield P(!1),Promise.resolve(o)}catch(o){return yield O(o),yield P(!1),Promise.reject(o)}}const G={setConnectionStatus:x,setConnectionStatusIsFetching:N,fetchConnectionStatus:E,fetchAuthorizationUrl:U,setSiteIsRegistering:P,setUserIsConnecting:y,setRegistrationError:O,clearRegistrationError:S,setAuthorizationUrl:h,registerSite:k,connectUser:B,disconnectUserSuccess:D,setConnectedPlugins:T,refreshConnectedPlugins:()=>async({dispatch:e})=>await new Promise(t=>d.ZP.fetchConnectedPlugins().then(o=>{e(T(o)),t(o)})),setConnectionErrors:f,setIsOfflineMode:a};var J=s("../../../node_modules/.pnpm/@wordpress+data@9.17.0_react@18.2.0/node_modules/@wordpress/data/build-module/factory.js");const M="jetpack-connection",X=({registrationNonce:e,redirectUri:t})=>d.ZP.registerSite(e,t),Q=(0,J.R)(({resolveSelect:e})=>({from:t,redirectFunc:o,redirectUri:z}={})=>new Promise((ge,Se)=>{e(M).getAuthorizationUrl(z).then(W=>{const Te=o||(Ce=>window.location.assign(Ce)),K=new URL(W);t&&K.searchParams.set("from",encodeURIComponent(t));const V=K.toString();Te(V),ge(V)}).catch(W=>{Se(W)})})),$={FETCH_AUTHORIZATION_URL:({redirectUri:e})=>d.ZP.fetchAuthorizationUrl(e),REGISTER_SITE:X,CONNECT_USER:Q};var H=s("../../../node_modules/.pnpm/@wordpress+data@9.17.0_react@18.2.0/node_modules/@wordpress/data/build-module/index.js");const q=(e={},t)=>{switch(t.type){case _:return{...e,...t.connectionStatus};case R:return{...e,isUserConnected:!1}}return e},ee=(e={},t)=>{switch(t.type){case A:return t.connectedPlugins}return e},te=(e=!1,t)=>{switch(t.type){case i:return t.isFetching}return e},se=(e=!1,t)=>{switch(t.type){case r:return t.isRegistering}return e},ne=(e=!1,t)=>{switch(t.type){case m:return t.isConnecting}return e},oe=(e,t)=>{switch(t.type){case C:return!1;case l:return t.registrationError;default:return e}},re=(e,t)=>{switch(t.type){case g:return t.authorizationUrl;default:return e}},ie=(e,t)=>{switch(t.type){default:return e}},ce=(e={},t)=>{switch(t.type){case w:return t.connectionErrors}return e},ae=(e=!1,t)=>{switch(t.type){case L:return t.isConnecting}return e},de=(0,H.UY)({connectionStatus:q,connectionStatusIsFetching:te,siteIsRegistering:se,userIsConnecting:ne,registrationError:oe,authorizationUrl:re,userConnectionData:ie,connectedPlugins:ee,connectionErrors:ce,isOfflineMode:ae});var le=s("../../../node_modules/.pnpm/@wordpress+data@9.17.0_react@18.2.0/node_modules/@wordpress/data/build-module/select.js"),ue=s("../../../node_modules/.pnpm/@wordpress+data@9.17.0_react@18.2.0/node_modules/@wordpress/data/build-module/dispatch.js");const pe={...{getAuthorizationUrl:{isFulfilled:(e,...t)=>{const o=!!e.authorizationUrl,z=(0,le.Y)(M).hasFinishedResolution("getAuthorizationUrl",t);return o&&!z&&(0,ue.W)(M).finishResolution("getAuthorizationUrl",t),o},*fulfill(e){const t=yield G.fetchAuthorizationUrl(e);yield G.setAuthorizationUrl(t.authorizeUrl)}}}},_e={...{getConnectionStatus:e=>e.connectionStatus||{},getConnectionStatusIsFetching:()=>!1,getSiteIsRegistering:e=>e.siteIsRegistering||!1,getUserIsConnecting:e=>e.userIsConnecting||!1,getRegistrationError:e=>e.registrationError||!1,getAuthorizationUrl:e=>e.authorizationUrl||!1,getUserConnectionData:e=>e.userConnectionData||!1,getConnectedPlugins:e=>e.connectedPlugins||[],getConnectionErrors:e=>e.connectionErrors||[],getIsOfflineMode:e=>e.isOfflineMode||!1,getWpcomUser:e=>{var t,o;return(o=(t=e==null?void 0:e.userConnectionData)==null?void 0:t.currentUser)==null?void 0:o.wpcomUser},getBlogId:e=>{var t,o;return(o=(t=e==null?void 0:e.userConnectionData)==null?void 0:t.currentUser)==null?void 0:o.blogId}}};var me=s("../../../node_modules/.pnpm/@wordpress+data@9.17.0_react@18.2.0/node_modules/@wordpress/data/build-module/redux-store/index.js");const F=class{static mayBeInit(t,o){F.store===null&&(F.store=(0,me.Z)(t,o),(0,H.z2)(F.store))}};let Z=F;Y(Z,"store",null);const Ee=Z,b=window.JP_CONNECTION_INITIAL_STATE;b||console.error("Jetpack Connection package: Initial state is missing. Check documentation to see how to use the Connection composer package to set up the initial state."),Ee.mayBeInit(M,{__experimentalUseThunks:!0,reducer:de,actions:G,selectors:_e,resolvers:pe,controls:$,initialState:b||{}})},"../../packages/videopress/src/client/admin/components/site-settings-section/constants.ts":(p,n,s)=>{s.d(n,{RB:()=>i,mP:()=>d});const d="atomic",_="simple",i="jetpack"},"../../packages/videopress/src/client/admin/hooks/use-permission/index.ts":(p,n,s)=>{s.d(n,{g:()=>_});var d=s("../connection/components/use-connection/index.jsx");const _=()=>{const{isRegistered:i,hasConnectedOwner:u,isUserConnected:r}=(0,d.Z)();return{isRegistered:i,hasConnectedOwner:u,isUserConnected:r,canPerformAction:i&&u&&r}}},"../../packages/videopress/src/client/admin/hooks/use-videopress-settings/index.ts":(p,n,s)=>{s.d(n,{C:()=>r});var d=s("../../../node_modules/.pnpm/@wordpress+data@9.17.0_react@18.2.0/node_modules/@wordpress/data/build-module/components/use-dispatch/use-dispatch.js"),_=s("../../../node_modules/.pnpm/@wordpress+data@9.17.0_react@18.2.0/node_modules/@wordpress/data/build-module/components/use-select/index.js"),i=s("../../packages/videopress/src/client/state/index.js"),u=s("../../packages/videopress/src/client/admin/components/site-settings-section/constants.ts");const r=()=>{var C,I,g;const m=(0,d.Z)(i.tT),l=(0,_.Z)(c=>c(i.tT).getVideoPressSettings(),[]);return{settings:{videoPressVideosPrivateForSite:(C=l==null?void 0:l.videoPressVideosPrivateForSite)!=null?C:!1,siteIsPrivate:(I=l==null?void 0:l.siteIsPrivate)!=null?I:!1,siteType:(g=l==null?void 0:l.siteType)!=null?g:u.RB},onUpdate:c=>m.updateVideoPressSettings(c)}}}}]);})();
