"use strict";(()=>{(self.webpackChunk_automattic_jetpack_storybook=self.webpackChunk_automattic_jetpack_storybook||[]).push([[1462],{"../analytics/index.jsx":(k,U,c)=>{c.d(U,{Z:()=>T});var C=c("../../../node_modules/.pnpm/debug@4.3.4/node_modules/debug/src/browser.js"),E=c.n(C);const a=E()("dops:analytics");let f,l;window._tkq=window._tkq||[],window.ga=window.ga||function(){(window.ga.q=window.ga.q||[]).push(arguments)},window.ga.l=+new Date;function o(t,s){let r="";if(typeof t=="object"){for(const d in t)r+="&x_"+encodeURIComponent(d)+"="+encodeURIComponent(t[d]);a("Bumping stats %o",t)}else r="&x_"+encodeURIComponent(t)+"="+encodeURIComponent(s),a('Bumping stat "%s" in group "%s"',s,t);return r}function R(t,s){let r="";if(typeof t=="object"){for(const d in t)r+="&"+encodeURIComponent(d)+"="+encodeURIComponent(t[d]);a("Built stats %o",t)}else r="&"+encodeURIComponent(t)+"="+encodeURIComponent(s),a('Built stat "%s" in group "%s"',s,t);return r}const u={initialize:function(t,s,r){u.setUser(t,s),u.setSuperProps(r),u.identifyUser()},setGoogleAnalyticsEnabled:function(t){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.googleAnalyticsEnabled=t,this.googleAnalyticsKey=s},setMcAnalyticsEnabled:function(t){this.mcAnalyticsEnabled=t},setUser:function(t,s){l={ID:t,username:s}},setSuperProps:function(t){f=t},assignSuperProps:function(t){f=Object.assign(f||{},t)},mc:{bumpStat:function(t,s){const r=o(t,s);u.mcAnalyticsEnabled&&(new Image().src=document.location.protocol+"//pixel.wp.com/g.gif?v=wpcom-no-pv"+r+"&t="+Math.random())},bumpStatWithPageView:function(t,s){const r=R(t,s);u.mcAnalyticsEnabled&&(new Image().src=document.location.protocol+"//pixel.wp.com/g.gif?v=wpcom"+r+"&t="+Math.random())}},pageView:{record:function(t,s){u.tracks.recordPageView(t),u.ga.recordPageView(t,s)}},purchase:{record:function(t,s,r,d,_,O,i){u.ga.recordPurchase(t,s,r,d,_,O,i)}},tracks:{recordEvent:function(t,s){if(s=s||{},t.indexOf("akismet_")!==0&&t.indexOf("jetpack_")!==0){a('- Event name must be prefixed by "akismet_" or "jetpack_"');return}f&&(a("- Super Props: %o",f),s=Object.assign(s,f)),a('Record event "%s" called with props %s',t,JSON.stringify(s)),window._tkq.push(["recordEvent",t,s])},recordJetpackClick:function(t){const s=typeof t=="object"?t:{target:t};u.tracks.recordEvent("jetpack_wpa_click",s)},recordPageView:function(t){u.tracks.recordEvent("akismet_page_view",{path:t})},setOptOut:function(t){a("Pushing setOptOut: %o",t),window._tkq.push(["setOptOut",t])}},ga:{initialized:!1,initialize:function(){let t={};u.ga.initialized||(l&&(t={userId:"u-"+l.ID}),window.ga("create",this.googleAnalyticsKey,"auto",t),u.ga.initialized=!0)},recordPageView:function(t,s){u.ga.initialize(),a("Recording Page View ~ [URL: "+t+"] [Title: "+s+"]"),this.googleAnalyticsEnabled&&(window.ga("set","page",t),window.ga("send",{hitType:"pageview",page:t,title:s}))},recordEvent:function(t,s,r,d){u.ga.initialize();let _="Recording Event ~ [Category: "+t+"] [Action: "+s+"]";typeof r!="undefined"&&(_+=" [Option Label: "+r+"]"),typeof d!="undefined"&&(_+=" [Option Value: "+d+"]"),a(_),this.googleAnalyticsEnabled&&window.ga("send","event",t,s,r,d)},recordPurchase:function(t,s,r,d,_,O,i){window.ga("require","ecommerce"),window.ga("ecommerce:addTransaction",{id:t,revenue:d,currency:i}),window.ga("ecommerce:addItem",{id:t,name:s,sku:r,price:_,quantity:O}),window.ga("ecommerce:send")}},identifyUser:function(){l&&window._tkq.push(["identifyUser",l.ID,l.username])},setProperties:function(t){window._tkq.push(["setProperties",t])},clearedIdentity:function(){window._tkq.push(["clearIdentity"])}},T=u},"../connection/components/use-connection/index.jsx":(k,U,c)=>{c.d(U,{Z:()=>R});var C=c("../api/index.jsx"),E=c("../../../node_modules/.pnpm/@wordpress+data@9.2.0_react@18.2.0/node_modules/@wordpress/data/build-module/components/use-dispatch/use-dispatch.js"),a=c("../../../node_modules/.pnpm/@wordpress+data@9.2.0_react@18.2.0/node_modules/@wordpress/data/build-module/components/use-select/index.js"),f=c("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),l=c("../connection/state/store.jsx");const o=window!=null&&window.JP_CONNECTION_INITIAL_STATE?window.JP_CONNECTION_INITIAL_STATE:{},R=function(){let{registrationNonce:u=o.registrationNonce,apiRoot:T=o.apiRoot,apiNonce:t=o.apiNonce,redirectUri:s,autoTrigger:r,from:d,skipUserConnection:_}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{registerSite:O,connectUser:i,refreshConnectedPlugins:m}=(0,E.Z)(l.t),P=(0,a.Z)(p=>p(l.t).getRegistrationError()),{siteIsRegistering:w,userIsConnecting:y,userConnectionData:S,connectedPlugins:I,connectionErrors:N,isRegistered:j,isUserConnected:L,hasConnectedOwner:x,isOfflineMode:z}=(0,a.Z)(p=>({siteIsRegistering:p(l.t).getSiteIsRegistering(),userIsConnecting:p(l.t).getUserIsConnecting(),userConnectionData:p(l.t).getUserConnectionData(),connectedPlugins:p(l.t).getConnectedPlugins(),connectionErrors:p(l.t).getConnectionErrors(),isOfflineMode:p(l.t).getIsOfflineMode(),...p(l.t).getConnectionStatus()})),A=()=>{if(_){if(s)return window.location=s,Promise.resolve(s)}else return i({from:d,redirectUri:s});return Promise.resolve()},b=p=>(p&&p.preventDefault(),j?A():O({registrationNonce:u,redirectUri:s}).then(()=>A()));return(0,f.useEffect)(()=>{C.ZP.setApiRoot(T),C.ZP.setApiNonce(t)},[T,t]),(0,f.useEffect)(()=>{r&&!w&&!y&&b()},[]),{handleRegisterSite:b,handleConnectUser:A,refreshConnectedPlugins:m,isRegistered:j,isUserConnected:L,siteIsRegistering:w,userIsConnecting:y,registrationError:P,userConnectionData:S,hasConnectedOwner:x,connectedPlugins:I,connectionErrors:N,isOfflineMode:z}}},"../connection/state/store.jsx":(k,U,c)=>{c.d(U,{t:()=>v});var C=c("../api/index.jsx");const E="SET_CONNECTION_STATUS",a="SET_CONNECTION_STATUS_IS_FETCHING",f="FETCH_CONNECTION_STATUS",l="SET_SITE_IS_REGISTERING",o="SET_USER_IS_CONNECTING",R="SET_REGISTRATION_ERROR",u="CLEAR_REGISTRATION_ERROR",T="REGISTER_SITE",t="SET_AUTHORIZATION_URL",s="CONNECT_USER",r="DISCONNECT_USER_SUCCESS",d="FETCH_AUTHORIZATION_URL",_="SET_CONNECTED_PLUGINS",O="REFRESH_CONNECTED_PLUGINS",i="SET_CONNECTION_ERRORS",m="SET_IS_OFFLINE_MODE",P=e=>({type:E,connectionStatus:e}),w=e=>({type:a,isFetching:e}),y=()=>({type:f}),S=e=>({type:l,isRegistering:e}),I=e=>({type:o,isConnecting:e}),N=()=>({type:r}),j=e=>({type:R,registrationError:e}),L=()=>({type:u}),x=e=>({type:t,authorizationUrl:e}),z=e=>({type:d,redirectUri:e}),A=e=>({type:_,connectedPlugins:e}),b=e=>({type:i,connectionErrors:e}),p=e=>({type:m,isOfflineMode:e});function V(){let{from:e,redirectFunc:n,redirectUri:g}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function*(){yield I(!0),yield{type:s,from:e,redirectFunc:n,redirectUri:g}}()}function J(e){let{registrationNonce:n,redirectUri:g}=e;return function*(){yield L(),yield S(!0);try{const h=yield{type:T,registrationNonce:n,redirectUri:g};return yield P({isRegistered:!0}),yield x(h.authorizeUrl),yield S(!1),Promise.resolve(h)}catch(h){return yield j(h),yield S(!1),Promise.reject(h)}}()}const B={setConnectionStatus:P,setConnectionStatusIsFetching:w,fetchConnectionStatus:y,fetchAuthorizationUrl:z,setSiteIsRegistering:S,setUserIsConnecting:I,setRegistrationError:j,clearRegistrationError:L,setAuthorizationUrl:x,registerSite:J,connectUser:V,disconnectUserSuccess:N,setConnectedPlugins:A,refreshConnectedPlugins:()=>async e=>{let{dispatch:n}=e;return await new Promise(g=>C.ZP.fetchConnectedPlugins().then(h=>{n(A(h)),g(h)}))},setConnectionErrors:b,setIsOfflineMode:p};var X=c("../../../node_modules/.pnpm/@wordpress+data@9.2.0_react@18.2.0/node_modules/@wordpress/data/build-module/factory.js");const v="jetpack-connection",$=e=>{let{registrationNonce:n,redirectUri:g}=e;return C.ZP.registerSite(n,g)},Q=(0,X.R)(e=>{let{resolveSelect:n}=e;return function(){let{from:g,redirectFunc:h,redirectUri:M}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new Promise((Z,fe)=>{n(v).getAuthorizationUrl(M).then(G=>{const pe=h||(he=>window.location.assign(he)),K=new URL(G);g&&K.searchParams.set("from",encodeURIComponent(g));const H=K.toString();pe(H),Z(H)}).catch(G=>{fe(G)})})}}),Y={FETCH_AUTHORIZATION_URL:e=>{let{redirectUri:n}=e;return C.ZP.fetchAuthorizationUrl(n)},REGISTER_SITE:$,CONNECT_USER:Q};var F=c("../../../node_modules/.pnpm/@wordpress+data@9.2.0_react@18.2.0/node_modules/@wordpress/data/build-module/index.js");const q=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;switch(n.type){case E:return{...e,...n.connectionStatus};case r:return{...e,isUserConnected:!1}}return e},ee=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;switch(n.type){case _:return n.connectedPlugins}return e},te=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case a:return n.isFetching}return e},ne=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case l:return n.isRegistering}return e},se=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case o:return n.isConnecting}return e},oe=(e,n)=>{switch(n.type){case u:return!1;case R:return n.registrationError;default:return e}},re=(e,n)=>{switch(n.type){case t:return n.authorizationUrl;default:return e}},ie=(e,n)=>{switch(n.type){default:return e}},ce=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;switch(n.type){case i:return n.connectionErrors}return e},ae=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case m:return n.isConnecting}return e},ue=(0,F.UY)({connectionStatus:q,connectionStatusIsFetching:te,siteIsRegistering:ne,userIsConnecting:se,registrationError:oe,authorizationUrl:re,userConnectionData:ie,connectedPlugins:ee,connectionErrors:ce,isOfflineMode:ae}),de={...{getAuthorizationUrl:{isFulfilled:function(e){const n=!!e.authorizationUrl;for(var g=arguments.length,h=new Array(g>1?g-1:0),M=1;M<g;M++)h[M-1]=arguments[M];const Z=(0,F.Ys)(v).hasFinishedResolution("getAuthorizationUrl",h);return n&&!Z&&(0,F.WI)(v).finishResolution("getAuthorizationUrl",h),n},*fulfill(e){const n=yield B.fetchAuthorizationUrl(e);yield B.setAuthorizationUrl(n.authorizeUrl)}}}},le={...{getConnectionStatus:e=>e.connectionStatus||{},getConnectionStatusIsFetching:()=>!1,getSiteIsRegistering:e=>e.siteIsRegistering||!1,getUserIsConnecting:e=>e.userIsConnecting||!1,getRegistrationError:e=>e.registrationError||!1,getAuthorizationUrl:e=>e.authorizationUrl||!1,getUserConnectionData:e=>e.userConnectionData||!1,getConnectedPlugins:e=>e.connectedPlugins||[],getConnectionErrors:e=>e.connectionErrors||[],getIsOfflineMode:e=>e.isOfflineMode||!1,getWpcomUser:e=>{var n,g;return(g=(n=e==null?void 0:e.userConnectionData)==null?void 0:n.currentUser)==null?void 0:g.wpcomUser},getBlogId:e=>{var n,g;return(g=(n=e==null?void 0:e.userConnectionData)==null?void 0:n.currentUser)==null?void 0:g.blogId}}};var ge=c("../../../node_modules/.pnpm/@babel+runtime@7.21.5/node_modules/@babel/runtime/helpers/defineProperty.js"),_e=c.n(ge),me=c("../../../node_modules/.pnpm/@wordpress+data@9.2.0_react@18.2.0/node_modules/@wordpress/data/build-module/redux-store/index.js");class D{static mayBeInit(n,g){D.store===null&&(D.store=(0,me.Z)(n,g),(0,F.z2)(D.store))}}_e()(D,"store",null);const Ee=D,W=window.JP_CONNECTION_INITIAL_STATE;W||console.error("Jetpack Connection package: Initial state is missing. Check documentation to see how to use the Connection composer package to set up the initial state."),Ee.mayBeInit(v,{__experimentalUseThunks:!0,reducer:ue,actions:B,selectors:le,resolvers:de,controls:Y,initialState:W||{}})},"../../plugins/protect/src/js/hooks/use-analytics-tracks/index.js":(k,U,c)=>{c.d(U,{Z:()=>l});var C=c("../analytics/index.jsx"),E=c("../connection/components/use-connection/index.jsx"),a=c("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js");const l=function(){var y;let{pageViewEventName:o,pageViewNamespace:R="jetpack",pageViewSuffix:u="page_view",pageViewEventProperties:T={}}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{isUserConnected:t,isRegistered:s,userConnectionData:r}=(0,E.Z)(),{login:d,ID:_}=((y=r.currentUser)==null?void 0:y.wpcomUser)||{},{tracks:O}=C.Z,{recordEvent:i}=O,m=(0,a.useCallback)(async(S,I)=>{i(S,I)},[i]),P=(0,a.useCallback)(function(S,I){let N=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>{};return N=typeof I=="function"?I:N,I=typeof I=="function"?{}:I,()=>m(S,I).then(N)},[m]);(0,a.useEffect)(()=>{t&&_&&d&&C.Z.initialize(_,d)},[t,_,d]);const w=o?`${R}_${o}_${u}`:null;return(0,a.useEffect)(()=>{s&&w&&i(w,T)},[]),{recordEvent:m,recordEventHandler:P}}},"../../plugins/protect/src/js/hooks/use-protect-data/index.js":(k,U,c)=>{c.d(U,{Z:()=>f});var C=c("../../../node_modules/.pnpm/@wordpress+data@9.2.0_react@18.2.0/node_modules/@wordpress/data/build-module/components/use-select/index.js"),E=c("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),a=c("../../plugins/protect/src/js/state/store.js");function f(){const{statusIsFetching:l,status:o,jetpackScan:R,hasRequiredPlan:u}=(0,C.Z)(i=>({statusIsFetching:i(a.t).getStatusIsFetching(),status:i(a.t).getStatus(),jetpackScan:i(a.t).getJetpackScan(),hasRequiredPlan:i(a.t).hasRequiredPlan()}));let T="error";l===!0?T="loading":o.status&&(T=o.status);const t=(0,E.useMemo)(()=>{var i,m;return((m=(i=o.core)==null?void 0:i.threats)==null?void 0:m.length)||0},[o.core]),s=(0,E.useMemo)(()=>(o.plugins||[]).reduce((i,m)=>i+m.threats.length,0),[o.plugins]),r=(0,E.useMemo)(()=>(o.themes||[]).reduce((i,m)=>i+m.threats.length,0),[o.themes]),d=(0,E.useMemo)(()=>{var i;return((i=o.files)==null?void 0:i.length)||0},[o.files]),_=(0,E.useMemo)(()=>{var i;return((i=o.database)==null?void 0:i.length)||0},[o.database]);return{numThreats:t+s+r+d+_,numCoreThreats:t,numPluginsThreats:s,numThemesThreats:r,numFilesThreats:d,numDatabaseThreats:_,lastChecked:o.lastChecked||null,errorCode:o.errorCode||null,errorMessage:o.errorMessage||null,core:o.core||{},plugins:o.plugins||[],themes:o.themes||[],files:{threats:o.files||[]},database:{threats:o.database||[]},currentStatus:T,hasUncheckedItems:o.hasUncheckedItems,jetpackScan:R,hasRequiredPlan:u}}}}]);})();
