"use strict";(()=>{(self.webpackChunk_automattic_jetpack_storybook=self.webpackChunk_automattic_jetpack_storybook||[]).push([[781],{"../components/components/boost-score-graph/index.tsx":(j,h,s)=>{s.d(h,{i:()=>b,Z:()=>W});var c=s("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),y=s("../components/components/text/index.tsx"),g=s("../../../node_modules/.pnpm/@wordpress+i18n@4.38.0/node_modules/@wordpress/i18n/build-module/index.js"),d=s("../../../node_modules/.pnpm/uplot@1.6.24/node_modules/uplot/dist/uPlot.esm.js"),_=s("../../../node_modules/.pnpm/uplot-react@1.1.4_react@18.2.0_uplot@1.6.24/node_modules/uplot-react/uplot-react.js"),u=s.n(_),S=s("../components/lib/locale/index.ts"),L=s("../components/components/number-format/index.ts");function O(){let n,e;function t(o){n=o.over,e=document.createElement("div"),e.classList.add("day-highlighter"),d.default.assign(e.style,{pointerEvents:"none",display:"none",position:"absolute",left:0,top:0,height:"100%",backgroundColor:"rgba(0,0,0,0.04)"}),n.appendChild(e),n.addEventListener("mouseenter",()=>{e.style.display=null}),n.addEventListener("mouseleave",()=>{e.style.display="none"})}function r(o){const{idx:a}=o.cursor,l=o.data[0][a],i=l-l%86400,m=i+86400,p=o.valToPos(Math.max(i,o.scales.x.min),"x"),x=o.valToPos(Math.min(m,o.scales.x.max),"x")-p;e.style.transform="translateX("+Math.round(p)+"px)",e.style.width=Math.round(x)+"px"}return{opts:(o,a)=>{d.default.assign(a,{cursor:{x:!1,y:!1}})},hooks:{init:t,setCursor:r}}}const D="short";function I(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"en",r,o;switch(n){case"{M}/{D}":return e.toLocaleDateString(t,{month:D,day:"numeric"});case`{M}/{D}
{YYYY}`:return r=e.toLocaleDateString(t,{month:D,day:"numeric"}),o=e.toLocaleDateString(t,{year:"numeric"}),`${r}
${o}`;case"{MMM}":return e.toLocaleDateString(t,{month:D});case`{MMM}
{YYYY}`:return r=e.toLocaleDateString(t,{month:D}),o=e.toLocaleDateString(t,{year:"numeric"}),`${r}
${o}`;case"{h}{aa}":return"";default:return e.toLocaleDateString(t,{month:D,day:"numeric"})}return e.toLocaleDateString(t)}var B=s("../../../node_modules/.pnpm/react-dom@18.2.0_react@18.2.0/node_modules/react-dom/client.js"),z=s("../components/components/boost-score-graph/tooltip.tsx");function U(n){const e=document.createElement("div");let t;function r(a,l){const i=a.over;t=B.createRoot(e),e.style.position="absolute",e.style.bottom="-20px",e.style.translate="-50% calc( 100% - 20px )",i.appendChild(e);function m(){e.style.display="none"}function p(){e.style.display=null}i.addEventListener("mouseleave",()=>{a.cursor._lock||m()}),i.addEventListener("mouseenter",()=>{p()}),a.cursor.left<0?m():p()}function o(a){const{idx:l}=a.cursor,i=n[l],m=a.data[0][l],p=m-m%86400,x=p+86400,f=a.valToPos(Math.max(p,a.scales.x.min),"x"),v=a.valToPos(Math.min(x,a.scales.x.max),"x")-f,R=f+v/2;e.style.left=R+"px",t.render((0,z.u)({period:i}))}return{hooks:{init:r,setCursor:o}}}var N=s("../../../node_modules/.pnpm/@wordpress+compose@6.15.0_react@18.2.0/node_modules/@wordpress/compose/build-module/utils/throttle/index.js");const V=400;function Y(n,e){(0,c.useEffect)(()=>{if(!n.current||!e.current)return;const t=(0,N.P)(()=>{!n.current||!e.current||n.current.setSize({height:n.current.height,width:e.current.clientWidth})},V);return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[n,e])}var F=s("../../../node_modules/.pnpm/style-loader@2.0.0_webpack@5.76.0/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),K=s.n(F),w=s("../../../node_modules/.pnpm/css-loader@6.5.1_webpack@5.76.0/node_modules/css-loader/dist/cjs.js!../../../node_modules/.pnpm/postcss-loader@6.2.0_postcss@8.4.21_webpack@5.76.0/node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../../node_modules/.pnpm/sass-loader@12.4.0_sass@1.64.1_webpack@5.76.0/node_modules/sass-loader/dist/cjs.js!../components/components/boost-score-graph/style-uplot.scss"),C={};C.insert="head",C.singleton=!1;var $=K()(w.Z,C);const X=w.Z.locals||{};var E=s("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");const T=g.__,P={height:300,width:600};function A(n,e){const{spline:t}=d.default.paths;return{label:n,stroke:M(e),fill:r=>{const o=r.ctx.createLinearGradient(0,0,0,P.height);return o.addColorStop(0,M(e,"44")),o.addColorStop(1,M(e,"11")),o},width:2,paths:(r,o,a,l)=>(t==null?void 0:t()(r,o,a,l))||null,points:{show:!0},value:(r,o)=>o?(0,L.Z)(o):"-"}}function M(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"FF",t="#D63638";return n>70?t="#069e08":n>50&&(t="#faa754"),`${t}${e}`}function k(n){let{data:e,range:t,periods:r}=n;const o=(0,c.useRef)(null),a=(0,c.useRef)(null),l=e[1][e[1].length-1],i=e[2][e[2].length-1],m=(0,c.useMemo)(()=>({...{class:"boost-score-graph",...P,tzDate:f=>d.default.tzDate(new Date(f*1e3),"Etc/UTC"),fmtDate:f=>v=>I(f,v,(0,S.X)()),padding:[17,0,17,0],axes:[{grid:{show:!1},ticks:{stroke:"#50575E",width:1,size:3}},{side:1,gap:8,space:100,size:30,grid:{stroke:"rgba(220, 220, 222, 0.5)",width:1},ticks:{show:!1}}],cursor:{x:!1,y:!1},series:[{label:T("Date","jetpack"),value:(f,v)=>v?new Date(v).toLocaleDateString((0,S.X)()):"-"},A(T("Desktop","jetpack"),l),A(T("Mobile","jetpack"),i)],scales:{x:{time:!0,auto:!1,range:[t.startDate/1e3,t.endDate/1e3]},y:{range:[0,100],auto:!1}},legend:{show:!1},plugins:[U(r),O()]}}),[l,i,r,t.endDate,t.startDate]);Y(o,a);const p=(0,c.useCallback)(x=>o.current=x,[]);return(0,E.jsx)("div",{ref:a,children:(0,E.jsx)(u(),{data:e,onCreate:p,options:m})})}k.displayName="UplotLineChart";try{uplotlinechart.displayName="uplotlinechart",uplotlinechart.__docgenInfo={description:"UplotLineChart component.",displayName:"uplotlinechart",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"uPlot.AlignedData"}},periods:{defaultValue:null,description:"",name:"periods",required:!0,type:{name:"Period[]"}},options:{defaultValue:null,description:"",name:"options",required:!1,type:{name:"uPlot.Options"}},legendContainer:{defaultValue:null,description:"",name:"legendContainer",required:!1,type:{name:"React.RefObject<HTMLDivElement>"}},solidFill:{defaultValue:null,description:"",name:"solidFill",required:!1,type:{name:"boolean"}},period:{defaultValue:null,description:"",name:"period",required:!1,type:{name:"string"}},range:{defaultValue:null,description:"",name:"range",required:!1,type:{name:"{ startDate: number; endDate: number; }"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["../components/components/boost-score-graph/uplot-line-chart.tsx#uplotlinechart"]={docgenInfo:uplotlinechart.__docgenInfo,name:"uplotlinechart",path:"../components/components/boost-score-graph/uplot-line-chart.tsx#uplotlinechart"})}catch(n){}function G(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["desktop_overall_score","mobile_overall_score"];return(0,c.useMemo)(()=>{if(!(n!=null&&n.length)||!n[0].dimensions)return[];const t=n.map(o=>{let{timestamp:a}=o;return a/1e3}),r=[];for(const o of e)r.push(n.map(a=>{let{dimensions:l}=a;return l[o]}));return[t,...r]},[e,n])}const b=n=>{let{periods:e,startDate:t,endDate:r,title:o,isLoading:a=!1}=n;e.sort((m,p)=>m.timestamp-p.timestamp);const l=r-24*60*60*1e3;e.length>0?t=Math.min(e[0].timestamp-12*60*60*1e3,l):t=l;const i=G(e);return a||!(i!=null&&i.length)?null:(0,E.jsxs)("div",{className:"jb-score-graph",children:[o&&(0,E.jsx)(y.ZP,{variant:"title-medium",children:o}),(0,E.jsx)(k,{data:i,periods:e,range:{startDate:t,endDate:r}})]})};b.displayName="BoostScoreGraph";const W=b;try{b.displayName="BoostScoreGraph",b.__docgenInfo={description:"BoostScoreGraph component composed by the chart and the legend.",displayName:"BoostScoreGraph",props:{periods:{defaultValue:null,description:"",name:"periods",required:!0,type:{name:"Period[]"}},startDate:{defaultValue:null,description:"",name:"startDate",required:!0,type:{name:"number"}},endDate:{defaultValue:null,description:"",name:"endDate",required:!0,type:{name:"number"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}},isLoading:{defaultValue:{value:"false"},description:"",name:"isLoading",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["../components/components/boost-score-graph/index.tsx#BoostScoreGraph"]={docgenInfo:b.__docgenInfo,name:"BoostScoreGraph",path:"../components/components/boost-score-graph/index.tsx#BoostScoreGraph"})}catch(n){}try{boostscoregraph.displayName="boostscoregraph",boostscoregraph.__docgenInfo={description:"BoostScoreGraph component composed by the chart and the legend.",displayName:"boostscoregraph",props:{periods:{defaultValue:null,description:"",name:"periods",required:!0,type:{name:"Period[]"}},startDate:{defaultValue:null,description:"",name:"startDate",required:!0,type:{name:"number"}},endDate:{defaultValue:null,description:"",name:"endDate",required:!0,type:{name:"number"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}},isLoading:{defaultValue:{value:"false"},description:"",name:"isLoading",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["../components/components/boost-score-graph/index.tsx#boostscoregraph"]={docgenInfo:boostscoregraph.__docgenInfo,name:"boostscoregraph",path:"../components/components/boost-score-graph/index.tsx#boostscoregraph"})}catch(n){}},"../components/components/number-format/index.ts":(j,h,s)=>{s.d(h,{Z:()=>g});var c=s("../components/lib/locale/index.ts");const g=function(d){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const u=(0,c.X)();return new Intl.NumberFormat(u,_).format(d)}},"../components/lib/locale/index.ts":(j,h,s)=>{s.d(h,{X:()=>g});var c=s("../../../node_modules/.pnpm/@wordpress+date@4.38.0/node_modules/@wordpress/date/build-module/index.js");const y=d=>{const _=/^([a-z]{2,3})(_[a-z]{2}|_[a-z][a-z0-9]{4,7})?(?:_.*)?$/i,u=d.match(_);return u?`${u[1]}${u[2]?u[2]:""}`.replace("_","-"):"en-US"},g=()=>{var u,S,L,O;const{l10n:{locale:d}}=(0,c.Gw)();return d?y(d):(O=(L=(S=(u=s.g)==null?void 0:u.window)==null?void 0:S.navigator)==null?void 0:L.language)!=null?O:"en-US"}},"../../../node_modules/.pnpm/css-loader@6.5.1_webpack@5.76.0/node_modules/css-loader/dist/cjs.js!../../../node_modules/.pnpm/postcss-loader@6.2.0_postcss@8.4.21_webpack@5.76.0/node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[14].use[2]!../../../node_modules/.pnpm/sass-loader@12.4.0_sass@1.64.1_webpack@5.76.0/node_modules/sass-loader/dist/cjs.js!../components/components/boost-score-graph/style-uplot.scss":(j,h,s)=>{s.d(h,{Z:()=>u});var c=s("../../../node_modules/.pnpm/css-loader@6.5.1_webpack@5.76.0/node_modules/css-loader/dist/runtime/noSourceMaps.js"),y=s.n(c),g=s("../../../node_modules/.pnpm/css-loader@6.5.1_webpack@5.76.0/node_modules/css-loader/dist/runtime/api.js"),d=s.n(g),_=d()(y());_.push([j.id,'.uplot,.uplot *,.uplot *::before,.uplot *::after{box-sizing:border-box}.uplot{font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.5;width:min-content}.u-title{text-align:center;font-size:18px;font-weight:bold}.u-wrap{position:relative;-webkit-user-select:none;user-select:none}.u-over,.u-under{position:absolute}.u-under{overflow:hidden}.uplot canvas{display:block;position:relative;width:100%;height:100%}.u-axis{position:absolute}.u-legend{font-size:14px;margin:auto;text-align:center}.u-inline{display:block}.u-inline *{display:inline-block}.u-inline tr{margin-right:16px}.u-legend th{font-weight:600}.u-legend th>*{vertical-align:middle;display:inline-block}.u-legend .u-marker{width:1em;height:1em;margin-right:4px;background-clip:padding-box !important}.u-inline.u-live th::after{content:":";vertical-align:middle}.u-inline:not(.u-live) .u-value{display:none}.u-series>*{padding:4px}.u-series th{cursor:pointer}.u-legend .u-off>*{opacity:.3}.u-select{background:rgba(0,0,0,.07);position:absolute;pointer-events:none}.u-cursor-x,.u-cursor-y{position:absolute;left:0;top:0;pointer-events:none;will-change:transform;z-index:100}.u-hz .u-cursor-x,.u-vt .u-cursor-y{height:100%;border-right:1px dashed #607d8b}.u-hz .u-cursor-y,.u-vt .u-cursor-x{width:100%;border-bottom:1px dashed #607d8b}.u-cursor-pt{position:absolute;top:0;left:0;border-radius:50%;border:0 solid;pointer-events:none;will-change:transform;z-index:100;background-clip:padding-box !important}.u-axis.u-off,.u-select.u-off,.u-cursor-x.u-off,.u-cursor-y.u-off,.u-cursor-pt.u-off{display:none}',""]);const u=_}}]);})();
