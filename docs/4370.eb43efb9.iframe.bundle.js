"use strict";(()=>{(self.webpackChunk_automattic_jetpack_storybook=self.webpackChunk_automattic_jetpack_storybook||[]).push([[4370],{"../connection/components/use-connection/index.jsx":(gt,Z,o)=>{o.d(Z,{Z:()=>R});var _=o("../api/index.jsx"),E=o("../../../node_modules/.pnpm/@wordpress+data@9.5.0_react@18.2.0/node_modules/@wordpress/data/build-module/components/use-dispatch/use-dispatch.js"),A=o("../../../node_modules/.pnpm/@wordpress+data@9.5.0_react@18.2.0/node_modules/@wordpress/data/build-module/components/use-select/index.js"),h=o("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),c=o("../connection/state/store.jsx");const l=window!=null&&window.JP_CONNECTION_INITIAL_STATE?window.JP_CONNECTION_INITIAL_STATE:{},R=function(){let{registrationNonce:j=l.registrationNonce,apiRoot:w=l.apiRoot,apiNonce:f=l.apiNonce,redirectUri:P,autoTrigger:p,from:D,skipUserConnection:N}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{registerSite:M,connectUser:O,refreshConnectedPlugins:b}=(0,E.Z)(c.t),y=(0,A.Z)(T=>T(c.t).getRegistrationError()),{siteIsRegistering:U,userIsConnecting:F,userConnectionData:C,connectedPlugins:H,connectionErrors:m,isRegistered:k,isUserConnected:V,hasConnectedOwner:z,isOfflineMode:Q}=(0,A.Z)(T=>({siteIsRegistering:T(c.t).getSiteIsRegistering(),userIsConnecting:T(c.t).getUserIsConnecting(),userConnectionData:T(c.t).getUserConnectionData(),connectedPlugins:T(c.t).getConnectedPlugins(),connectionErrors:T(c.t).getConnectionErrors(),isOfflineMode:T(c.t).getIsOfflineMode(),...T(c.t).getConnectionStatus()})),B=()=>{if(N){if(P)return window.location=P,Promise.resolve(P)}else return O({from:D,redirectUri:P});return Promise.resolve()},X=T=>(T&&T.preventDefault(),k?B():M({registrationNonce:j,redirectUri:P}).then(()=>B()));return(0,h.useEffect)(()=>{_.ZP.setApiRoot(w),_.ZP.setApiNonce(f)},[w,f]),(0,h.useEffect)(()=>{p&&!U&&!F&&X()},[]),{handleRegisterSite:X,handleConnectUser:B,refreshConnectedPlugins:b,isRegistered:k,isUserConnected:V,siteIsRegistering:U,userIsConnecting:F,registrationError:y,userConnectionData:C,hasConnectedOwner:z,connectedPlugins:H,connectionErrors:m,isOfflineMode:Q}}},"../connection/state/store.jsx":(gt,Z,o)=>{o.d(Z,{t:()=>W});var _=o("../api/index.jsx");const E="SET_CONNECTION_STATUS",A="SET_CONNECTION_STATUS_IS_FETCHING",h="FETCH_CONNECTION_STATUS",c="SET_SITE_IS_REGISTERING",l="SET_USER_IS_CONNECTING",R="SET_REGISTRATION_ERROR",j="CLEAR_REGISTRATION_ERROR",w="REGISTER_SITE",f="SET_AUTHORIZATION_URL",P="CONNECT_USER",p="DISCONNECT_USER_SUCCESS",D="FETCH_AUTHORIZATION_URL",N="SET_CONNECTED_PLUGINS",M="REFRESH_CONNECTED_PLUGINS",O="SET_CONNECTION_ERRORS",b="SET_IS_OFFLINE_MODE",y=s=>({type:E,connectionStatus:s}),U=s=>({type:A,isFetching:s}),F=()=>({type:h}),C=s=>({type:c,isRegistering:s}),H=s=>({type:l,isConnecting:s}),m=()=>({type:p}),k=s=>({type:R,registrationError:s}),V=()=>({type:j}),z=s=>({type:f,authorizationUrl:s}),Q=s=>({type:D,redirectUri:s}),B=s=>({type:N,connectedPlugins:s}),X=s=>({type:O,connectionErrors:s}),T=s=>({type:b,isOfflineMode:s});function rt(){let{from:s,redirectFunc:i,redirectUri:u}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function*(){yield H(!0),yield{type:P,from:s,redirectFunc:i,redirectUri:u}}()}function Et(s){let{registrationNonce:i,redirectUri:u}=s;return function*(){yield V(),yield C(!0);try{const S=yield{type:w,registrationNonce:i,redirectUri:u};return yield y({isRegistered:!0}),yield z(S.authorizeUrl),yield C(!1),Promise.resolve(S)}catch(S){return yield k(S),yield C(!1),Promise.reject(S)}}()}const nt={setConnectionStatus:y,setConnectionStatusIsFetching:U,fetchConnectionStatus:F,fetchAuthorizationUrl:Q,setSiteIsRegistering:C,setUserIsConnecting:H,setRegistrationError:k,clearRegistrationError:V,setAuthorizationUrl:z,registerSite:Et,connectUser:rt,disconnectUserSuccess:m,setConnectedPlugins:B,refreshConnectedPlugins:()=>async s=>{let{dispatch:i}=s;return await new Promise(u=>_.ZP.fetchConnectedPlugins().then(S=>{i(B(S)),u(S)}))},setConnectionErrors:X,setIsOfflineMode:T};var _t=o("../../../node_modules/.pnpm/@wordpress+data@9.5.0_react@18.2.0/node_modules/@wordpress/data/build-module/factory.js");const W="jetpack-connection",ht=s=>{let{registrationNonce:i,redirectUri:u}=s;return _.ZP.registerSite(i,u)},mt=(0,_t.R)(s=>{let{resolveSelect:i}=s;return function(){let{from:u,redirectFunc:S,redirectUri:J}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new Promise((st,Ot)=>{i(W).getAuthorizationUrl(J).then(at=>{const Mt=S||(yt=>window.location.assign(yt)),ct=new URL(at);u&&ct.searchParams.set("from",encodeURIComponent(u));const ut=ct.toString();Mt(ut),st(ut)}).catch(at=>{Ot(at)})})}}),Tt={FETCH_AUTHORIZATION_URL:s=>{let{redirectUri:i}=s;return _.ZP.fetchAuthorizationUrl(i)},REGISTER_SITE:ht,CONNECT_USER:mt};var q=o("../../../node_modules/.pnpm/@wordpress+data@9.5.0_react@18.2.0/node_modules/@wordpress/data/build-module/index.js");const $=function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;switch(i.type){case E:return{...s,...i.connectionStatus};case p:return{...s,isUserConnected:!1}}return s},St=function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;switch(i.type){case N:return i.connectedPlugins}return s},K=function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1?arguments[1]:void 0;switch(i.type){case A:return i.isFetching}return s},pt=function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1?arguments[1]:void 0;switch(i.type){case c:return i.isRegistering}return s},v=function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1?arguments[1]:void 0;switch(i.type){case l:return i.isConnecting}return s},it=(s,i)=>{switch(i.type){case j:return!1;case R:return i.registrationError;default:return s}},Lt=(s,i)=>{switch(i.type){case f:return i.authorizationUrl;default:return s}},jt=(s,i)=>{switch(i.type){default:return s}},wt=function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;switch(i.type){case O:return i.connectionErrors}return s},Dt=function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1?arguments[1]:void 0;switch(i.type){case b:return i.isConnecting}return s},bt=(0,q.UY)({connectionStatus:$,connectionStatusIsFetching:K,siteIsRegistering:pt,userIsConnecting:v,registrationError:it,authorizationUrl:Lt,userConnectionData:jt,connectedPlugins:St,connectionErrors:wt,isOfflineMode:Dt});var Ht=o("../../../node_modules/.pnpm/@wordpress+data@9.5.0_react@18.2.0/node_modules/@wordpress/data/build-module/select.js"),Ct=o("../../../node_modules/.pnpm/@wordpress+data@9.5.0_react@18.2.0/node_modules/@wordpress/data/build-module/dispatch.js");const It={...{getAuthorizationUrl:{isFulfilled:function(s){const i=!!s.authorizationUrl;for(var u=arguments.length,S=new Array(u>1?u-1:0),J=1;J<u;J++)S[J-1]=arguments[J];const st=(0,Ht.Y)(W).hasFinishedResolution("getAuthorizationUrl",S);return i&&!st&&(0,Ct.W)(W).finishResolution("getAuthorizationUrl",S),i},*fulfill(s){const i=yield nt.fetchAuthorizationUrl(s);yield nt.setAuthorizationUrl(i.authorizeUrl)}}}},ft={...{getConnectionStatus:s=>s.connectionStatus||{},getConnectionStatusIsFetching:()=>!1,getSiteIsRegistering:s=>s.siteIsRegistering||!1,getUserIsConnecting:s=>s.userIsConnecting||!1,getRegistrationError:s=>s.registrationError||!1,getAuthorizationUrl:s=>s.authorizationUrl||!1,getUserConnectionData:s=>s.userConnectionData||!1,getConnectedPlugins:s=>s.connectedPlugins||[],getConnectionErrors:s=>s.connectionErrors||[],getIsOfflineMode:s=>s.isOfflineMode||!1,getWpcomUser:s=>{var i,u;return(u=(i=s==null?void 0:s.userConnectionData)==null?void 0:i.currentUser)==null?void 0:u.wpcomUser},getBlogId:s=>{var i,u;return(u=(i=s==null?void 0:s.userConnectionData)==null?void 0:i.currentUser)==null?void 0:u.blogId}}};var Pt=o("../../../node_modules/.pnpm/@babel+runtime@7.21.5/node_modules/@babel/runtime/helpers/defineProperty.js"),Rt=o.n(Pt),Nt=o("../../../node_modules/.pnpm/@wordpress+data@9.5.0_react@18.2.0/node_modules/@wordpress/data/build-module/redux-store/index.js");class x{static mayBeInit(i,u){x.store===null&&(x.store=(0,Nt.Z)(i,u),(0,q.z2)(x.store))}}Rt()(x,"store",null);const Zt=x,ot=window.JP_CONNECTION_INITIAL_STATE;ot||console.error("Jetpack Connection package: Initial state is missing. Check documentation to see how to use the Connection composer package to set up the initial state."),Zt.mayBeInit(W,{__experimentalUseThunks:!0,reducer:bt,actions:nt,selectors:ft,resolvers:It,controls:Tt,initialState:ot||{}})},"../../packages/my-jetpack/_inc/components/product-card/action-buton.jsx":(gt,Z,o)=>{o.d(Z,{N:()=>l,Z:()=>j});var _=o("../components/components/button/index.tsx"),E=o("../../../node_modules/.pnpm/@wordpress+i18n@4.35.0/node_modules/@wordpress/i18n/build-module/index.js"),A=o("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),h=o("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");const c=E.__,l={ACTIVE:"active",INACTIVE:"inactive",ERROR:"error",ABSENT:"plugin_absent",ABSENT_WITH_PLAN:"plugin_absent_with_plan",NEEDS_PURCHASE:"needs_purchase",NEEDS_PURCHASE_OR_FREE:"needs_purchase_or_free"},R=w=>{let{status:f,admin:P,name:p,onActivate:D,onManage:N,onFixConnection:M,isFetching:O,isInstallingStandalone:b,isDeactivatingStandalone:y,isManageDisabled:U,className:F,onAdd:C}=w;if(!P)return(0,h.jsx)(_.Z,{...m,size:"small",variant:"link",weight:"regular",children:(0,E.gB)(c("Learn about %s","jetpack-my-jetpack"),p)});const H=O||b||y,m={variant:H?void 0:"primary",disabled:H,className:F};switch(f){case l.ABSENT:case l.ABSENT_WITH_PLAN:return(0,h.jsxs)(_.Z,{...m,size:"small",variant:"link",weight:"regular",children:[f===l.ABSENT&&(0,E.gB)(c("Get %s","jetpack-my-jetpack"),p),f===l.ABSENT_WITH_PLAN&&(0,E.gB)(c("Install %s","jetpack-my-jetpack"),p)]});case l.NEEDS_PURCHASE:return(0,h.jsx)(_.Z,{...m,size:"small",weight:"regular",onClick:C,children:c("Purchase","jetpack-my-jetpack")});case l.NEEDS_PURCHASE_OR_FREE:return(0,h.jsx)(_.Z,{...m,size:"small",weight:"regular",onClick:C,children:c("Start for free","jetpack-my-jetpack")});case l.ACTIVE:return(0,h.jsx)(_.Z,{...m,disabled:U||(m==null?void 0:m.disabled),size:"small",weight:"regular",variant:"secondary",onClick:N,children:c("Manage","jetpack-my-jetpack")});case l.ERROR:return(0,h.jsx)(_.Z,{...m,size:"small",weight:"regular",onClick:M,children:c("Fix connection","jetpack-my-jetpack")});case l.INACTIVE:return(0,h.jsx)(_.Z,{...m,size:"small",weight:"regular",variant:"secondary",onClick:D,children:c("Activate","jetpack-my-jetpack")});default:return null}};R.__docgenInfo={description:"",methods:[],displayName:"ActionButton"};const j=R},"../../packages/my-jetpack/_inc/state/store.js":(gt,Z,o)=>{o.d(Z,{t:()=>zt,N:()=>Xt});var _=o("../connection/state/store.jsx"),E=o("../../../node_modules/.pnpm/@wordpress+api-fetch@6.32.0/node_modules/@wordpress/api-fetch/build-module/index.js"),A=o("../../../node_modules/.pnpm/@wordpress+i18n@4.35.0/node_modules/@wordpress/i18n/build-module/index.js");const h="my-jetpack/v1",c=`${h}/site/purchases`,l=`${h}/site/products`,R=`${h}/chat/availability`,j=`${h}/chat/authentication`,w=["scan"],f="videopress",P="videopress/v1/stats/featured",p=A.__,D="SET_PURCHASES_IS_FETCHING",N="FETCH_PURCHASES",M="SET_PURCHASES",O="SET_AVAILABLE_LICENSES_IS_FETCHING",b="FETCH_AVAILABLE_LICENSES",y="SET_AVAILABLE_LICENSES",U="SET_IS_FETCHING_PRODUCT",F="SET_PRODUCT",C="SET_PRODUCT_REQUEST_ERROR",H="ACTIVATE_PRODUCT",m="SET_PRODUCT_STATUS",k="SET_CHAT_AVAILABILITY_IS_FETCHING",V="SET_CHAT_AVAILABILITY",z="SET_CHAT_AUTHENTICATION_IS_FETCHING",Q="SET_CHAT_AUTHENTICATION",B="SET_GLOBAL_NOTICE",X="CLEAN_GLOBAL_NOTICE",T="SET_PRODUCT_STATS",rt="SET_IS_FETCHING_PRODUCT_STATS",Et=t=>({type:D,isFetching:t}),Ut=t=>({type:k,isFetching:t}),nt=t=>({type:z,isFetching:t}),_t=()=>({type:N}),Ft=t=>({type:M,purchases:t}),W=t=>({type:V,chatAvailability:t}),ht=t=>({type:Q,chatAuthentication:t}),mt=t=>({type:O,isFetching:t}),vt=()=>({type:b}),Tt=t=>({type:y,availableLicenses:t}),q=t=>({type:F,product:t}),$=(t,e)=>({type:C,productId:t,error:e}),St=(t,e)=>({type:m,productId:t,status:e}),K=(t,e)=>({type:"SET_GLOBAL_NOTICE",message:t,options:e}),pt=()=>({type:"CLEAN_GLOBAL_NOTICE"});function v(t,e){return{type:U,productId:t,isFetching:e}}function it(t,e,r){let{select:n,dispatch:a,registry:d}=r;return new Promise((L,G)=>{if(!n.isValidProduct(t)){const I=p("Invalid product name","jetpack-my-jetpack"),dt=new Error(I);a($(t,dt)),a(K(I,{status:"error",isDismissible:!0})),G(dt);return}const et=e.activate?"POST":"DELETE";return a(v(t,!0)),(0,E.Z)({path:`${l}/${t}`,method:et}).then(I=>{a(v(t,!1)),a(q(I)),d.dispatch(_.t).refreshConnectedPlugins(),L(I==null?void 0:I.status)}).catch(I=>{const{name:dt}=n.getProduct(t),qt=(0,A.gB)(p("Failed to activate %1$s. Please try again","jetpack-my-jetpack"),dt);a(v(t,!1)),a($(t,I)),a(K(qt,{status:"error",isDismissible:!0})),G(I)})})}const Ct={setPurchasesIsFetching:Et,setChatAvailabilityIsFetching:Ut,setChatAuthenticationIsFetching:nt,fetchPurchases:_t,setPurchases:Ft,setChatAvailability:W,setChatAuthentication:ht,setAvailableLicensesIsFetching:mt,fetchAvailableLicenses:vt,setAvailableLicenses:Tt,setProductStats:(t,e)=>({type:T,productId:t,stats:e}),setIsFetchingProductStats:(t,e)=>({type:rt,productId:t,isFetching:e}),...{setGlobalNotice:K,cleanGlobalNotice:pt},...{setProduct:q,activateProduct:t=>async e=>await it(t,{activate:!0},e),deactivateStandalonePluginForProduct:t=>async e=>await it(t,{activate:!1},e),installStandalonePluginForProduct:t=>async e=>{const{select:r,dispatch:n,registry:a}=e;return await new Promise((d,L)=>{if(!r.isValidProduct(t)){const g=p("Invalid product name","jetpack-my-jetpack"),et=new Error(g);n($(t,et)),n(K(g,{status:"error",isDismissible:!0})),L(et);return}return n(v(t,!0)),(0,E.Z)({path:`${l}/${t}/install-standalone`,method:"POST"}).then(g=>{n(v(t,!1)),n(q(g)),a.dispatch(_.t).refreshConnectedPlugins(),d(g==null?void 0:g.standalone_plugin_info)}).catch(g=>{const{name:et}=r.getProduct(t),I=(0,A.gB)(p("Failed to install standalone plugin for %1$s: %2$s. Please try again","jetpack-my-jetpack"),et,g.message);n(v(t,!1)),n($(t,g)),n(K(I,{status:"error",isDismissible:!0})),L(g)})})},setIsFetchingProduct:v,setRequestProductError:$,setProductStatus:St}};function kt(){return new Promise((t,e)=>{(0,E.Z)({path:c}).then(t).catch(e)})}const It={[N]:kt};var At=o("../../../node_modules/.pnpm/@wordpress+data@9.5.0_react@18.2.0/node_modules/@wordpress/data/build-module/index.js");const Bt=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case U:{const{productId:r,isFetching:n}=e;return{...t,isFetching:{...t.isFetching,[r]:n},errors:{...t.errors,[r]:n?void 0:t.errors[r]}}}case m:{const{productId:r,status:n}=e;return{...t,items:{...t.items,[r]:{...t.items[r],status:n}}}}case F:{const{product:r}=e,{slug:n}=r;return{...t,items:{...t.items,[n]:r}}}case C:{const{productId:r,error:n}=e;return{...t,errors:{...t.errors,[r]:n}}}default:return t}},xt=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case D:return{...t,isFetching:e.isFetching};case M:return{...t,items:(e==null?void 0:e.purchases)||[]};default:return t}},Gt=function(){var r;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{isFetching:!1,isAvailable:!1},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case k:return{...t,isFetching:e.isFetching};case V:return{...t,isAvailable:(r=e==null?void 0:e.chatAvailability)==null?void 0:r.is_available};default:return t}},ft=function(){var r,n;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{isFetching:!1,jwt:!1},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case z:return{...t,isFetching:e.isFetching};case Q:return{...t,jwt:(n=(r=e==null?void 0:e.chatAuthentication)==null?void 0:r.user)==null?void 0:n.jwt};default:return t}},Pt=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case O:return{...t,isFetching:e.isFetching};case y:return{...t,items:(e==null?void 0:e.availableLicenses)||[]};default:return t}},Rt=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{global:{}},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case B:{const{message:r,options:n}=e;return{...t,global:{message:r,options:n}}}case X:return{...t,global:{}};default:return t}},Nt=function(){return arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}},x=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case rt:{const{productId:r,isFetching:n}=e;return{...t,isFetching:{...t.isFetching,[r]:n}}}case T:{const{productId:r,stats:n}=e;return{...t,items:{...t.items,[r]:n}}}default:return t}},ot=(0,At.UY)({products:Bt,purchases:xt,chatAvailability:Gt,chatAuthentication:ft,availableLicenses:Pt,notices:Rt,plugins:Nt,stats:x});var s=o("../api/index.jsx"),i=o("../../packages/my-jetpack/_inc/components/product-card/action-buton.jsx");const S=async()=>(0,E.Z)({path:P}),st=async t=>t===f?S():null,Ot=A.__,ct={...{getProduct:{isFulfilled:(t,e)=>{var n;return(((n=t==null?void 0:t.products)==null?void 0:n.items)||{}).hasOwnProperty(e)&&!w.includes(e)},fulfill:t=>async e=>{let{dispatch:r}=e;try{r.setIsFetchingProduct(t,!0);const n=await(0,E.Z)({path:`${l}/${t}`});return r.setProduct(n),r.setIsFetchingProduct(t,!1),Promise.resolve()}catch(n){if(r.setIsFetchingProduct(t,!1),n!=null&&n.code&&(n!=null&&n.message))return r.setRequestProductError(t,n),Promise.reject(n);throw new Error(n)}}},getPurchases:()=>async t=>{let{dispatch:e}=t;e.setPurchasesIsFetching(!0);try{e.setPurchases(await(0,E.Z)({path:c})),e.setPurchasesIsFetching(!1)}catch(r){e.setPurchasesIsFetching(!1),r.code!=="not_connected"&&e.setGlobalNotice(Ot("There was an error fetching your purchases information. Check your site connectivity and try again.","jetpack-my-jetpack"),{status:"error"})}},getChatAvailability:()=>async t=>{let{dispatch:e}=t;e.setChatAvailabilityIsFetching(!0);try{e.setChatAvailability(await(0,E.Z)({path:R})),e.setChatAvailabilityIsFetching(!1)}catch(r){e.setChatAvailabilityIsFetching(!1)}},getChatAuthentication:()=>async t=>{let{dispatch:e}=t;e.setChatAuthenticationIsFetching(!0);try{e.setChatAuthentication(await(0,E.Z)({path:j})),e.setChatAuthenticationIsFetching(!1)}catch(r){e.setChatAuthenticationIsFetching(!1)}},getAvailableLicenses:()=>async t=>{let{dispatch:e}=t;e.setAvailableLicensesIsFetching(!0);try{const{apiRoot:r,apiNonce:n}=(window==null?void 0:window.myJetpackRest)||{};s.ZP.setApiRoot(r),s.ZP.setApiNonce(n);const a=await s.ZP.getUserLicenses();a&&a.items?e.setAvailableLicenses(a.items.filter(d=>{let{attached_at:L,revoked_at:G}=d;return L===null&&G===null})):e.setAvailableLicenses([])}catch(r){e.setAvailableLicenses([])}finally{e.setAvailableLicensesIsFetching(!1)}}},getProductStats:{isFulfilled:(t,e)=>{var r,n;return((n=(r=t.stats)==null?void 0:r.items)==null?void 0:n.hasOwnProperty(e))||!1},fulfill:t=>async e=>{let{dispatch:r,select:n}=e;const{status:a}=n.getProduct(t);if(a!==i.N.ACTIVE)return r.setProductStats(t,null),Promise.resolve();try{r.setIsFetchingProductStats(t,!0);const d=await st(t);return r.setProductStats(t,d),r.setIsFetchingProductStats(t,!1),Promise.resolve()}catch(d){if(r.setProductStats(t,null),r.setIsFetchingProductStats(t,!1),d!=null&&d.code&&(d!=null&&d.message))return Promise.reject(d);throw new Error(d)}}}};function ut(t){return t.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace("_",""))}function yt(t){return t.indexOf("_")!==-1}function Y(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=Object.assign({},t);for(const n in r)r.hasOwnProperty(n)&&yt(n)&&(r[ut(n)]=r[n],e&&delete r[n]);return r}const lt=t=>{var e;return((e=t.products)==null?void 0:e.items)||{}},Vt=t=>Object.keys(lt(t)),$t={...{getProducts:lt,getProductNames:Vt,getProduct:(t,e)=>{var a,d;const r=((a=lt(t))==null?void 0:a[e])||{},n=Y(r,!0);return n.standalonePluginInfo=Y(n.standalonePluginInfo||{},!0),n.pricingForUi=Y(n.pricingForUi||{},!0),n.pricingForUi.introductoryOffer=n.pricingForUi.isIntroductoryOffer?Y(n.pricingForUi.introductoryOffer,!0):null,(d=n.pricingForUi)!=null&&d.tiers&&(n.pricingForUi.tiers=Y(n.pricingForUi.tiers,!0),n.pricingForUi.tiers=Object.keys(n.pricingForUi.tiers).reduce((L,G)=>{const g=Y(n.pricingForUi.tiers[G],!0)||{};return L[G]={...g,introductoryOffer:g!=null&&g.isIntroductoryOffer?Y(g==null?void 0:g.introductoryOffer,!0):null},L},{})),n.features=n.features||[],n.supportedProducts=n.supportedProducts||[],n.pricingForUi.fullPricePerMonth=n.pricingForUi.productTerm==="year"?Math.ceil(n.pricingForUi.fullPrice/12*100)/100:n.pricingForUi.fullPrice,n.pricingForUi.discountPricePerMonth=n.pricingForUi.productTerm==="year"?Math.ceil(n.pricingForUi.discountPrice/12*100)/100:n.pricingForUi.discountPrice,n},isValidProduct:(t,e)=>Vt(t).includes(e),isFetching:(t,e)=>{var r,n;return((n=(r=t.products)==null?void 0:r.isFetching)==null?void 0:n[e])||!1},getProductsThatRequiresUserConnection:t=>{const e=lt(t);return Object.keys(e).reduce((r,n)=>{const a=e[n];return(a==null?void 0:a.requires_user_connection)&&((a==null?void 0:a.status)===i.N.ACTIVE||(a==null?void 0:a.status)===i.N.ERROR)&&r.push(a==null?void 0:a.name),r},[])}},...{getPurchases:t=>{var e;return((e=t.purchases)==null?void 0:e.items)||[]},isRequestingPurchases:t=>{var e;return((e=t.purchases)==null?void 0:e.isFetching)||!1}},...{getChatAvailability:t=>t.chatAvailability.isAvailable,isRequestingChatAvailability:t=>t.chatAvailability.isFetching},...{getChatAuthentication:t=>t.chatAuthentication.jwt,isRequestingChatAuthentication:t=>t.chatAuthentication.isFetching},...{getAvailableLicenses:t=>{var e;return((e=t.availableLicenses)==null?void 0:e.items)||[]},isFetchingAvailableLicenses:t=>{var e;return((e=t.availableLicenses)==null?void 0:e.isFetching)||!1}},...{getGlobalNotice:t=>{var e;return(e=t.notices)==null?void 0:e.global}},...{hasStandalonePluginInstalled:t=>Object.values(t.plugins).filter(e=>["jetpack-backup","jetpack-boost","jetpack-protect","jetpack-search","jetpack-social","jetpack-videopress"].indexOf(e.TextDomain)>=0).length>0},...{getProductStats:(t,e)=>{var r,n;return(n=(r=t.stats)==null?void 0:r.items)==null?void 0:n[e]},isFetchingProductStats:(t,e)=>{var r,n;return((n=(r=t.stats)==null?void 0:r.isFetching)==null?void 0:n[e])||!1}}};var Kt=o("../../../node_modules/.pnpm/@babel+runtime@7.21.5/node_modules/@babel/runtime/helpers/defineProperty.js"),Jt=o.n(Kt),Yt=o("../../../node_modules/.pnpm/@wordpress+data@9.5.0_react@18.2.0/node_modules/@wordpress/data/build-module/redux-store/index.js");class tt{static mayBeInit(e,r){tt.store===null&&(tt.store=(0,Yt.Z)(e,r),(0,At.z2)(tt.store))}}Jt()(tt,"store",null);const Qt=tt,zt="my-jetpack";function Xt(){Qt.mayBeInit(zt,{__experimentalUseThunks:!0,reducer:ot,actions:Ct,selectors:$t,resolvers:ct,controls:It,initialState:window.myJetpackInitialState||{}})}}}]);})();
