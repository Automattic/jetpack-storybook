"use strict";(()=>{var mt=Object.defineProperty;var Rt=(f,l,s)=>l in f?mt(f,l,{enumerable:!0,configurable:!0,writable:!0,value:s}):f[l]=s;var W=(f,l,s)=>(Rt(f,typeof l!="symbol"?l+"":l,s),s);(self.webpackChunk_automattic_jetpack_storybook=self.webpackChunk_automattic_jetpack_storybook||[]).push([[603],{"../analytics/index.jsx":(f,l,s)=>{s.d(l,{Z:()=>m});var u=s("../../../node_modules/.pnpm/debug@4.3.4/node_modules/debug/src/browser.js"),T=s.n(u);const a=T()("dops:analytics");let _,i;window._tkq=window._tkq||[],window.ga=window.ga||function(){(window.ga.q=window.ga.q||[]).push(arguments)},window.ga.l=+new Date;function I(e,o){let c="";if(typeof e=="object"){for(const d in e)c+="&x_"+encodeURIComponent(d)+"="+encodeURIComponent(e[d]);a("Bumping stats %o",e)}else c="&x_"+encodeURIComponent(e)+"="+encodeURIComponent(o),a('Bumping stat "%s" in group "%s"',o,e);return c}function S(e,o){let c="";if(typeof e=="object"){for(const d in e)c+="&"+encodeURIComponent(d)+"="+encodeURIComponent(e[d]);a("Built stats %o",e)}else c="&"+encodeURIComponent(e)+"="+encodeURIComponent(o),a('Built stat "%s" in group "%s"',o,e);return c}const r={initialize:function(e,o,c){r.setUser(e,o),r.setSuperProps(c),r.identifyUser()},setGoogleAnalyticsEnabled:function(e,o=null){this.googleAnalyticsEnabled=e,this.googleAnalyticsKey=o},setMcAnalyticsEnabled:function(e){this.mcAnalyticsEnabled=e},setUser:function(e,o){i={ID:e,username:o}},setSuperProps:function(e){_=e},assignSuperProps:function(e){_=Object.assign(_||{},e)},mc:{bumpStat:function(e,o){const c=I(e,o);r.mcAnalyticsEnabled&&(new Image().src=document.location.protocol+"//pixel.wp.com/g.gif?v=wpcom-no-pv"+c+"&t="+Math.random())},bumpStatWithPageView:function(e,o){const c=S(e,o);r.mcAnalyticsEnabled&&(new Image().src=document.location.protocol+"//pixel.wp.com/g.gif?v=wpcom"+c+"&t="+Math.random())}},pageView:{record:function(e,o){r.tracks.recordPageView(e),r.ga.recordPageView(e,o)}},purchase:{record:function(e,o,c,d,p,g,C){r.ga.recordPurchase(e,o,c,d,p,g,C)}},tracks:{recordEvent:function(e,o){if(o=o||{},e.indexOf("akismet_")!==0&&e.indexOf("jetpack_")!==0){a('- Event name must be prefixed by "akismet_" or "jetpack_"');return}_&&(a("- Super Props: %o",_),o=Object.assign(o,_)),a('Record event "%s" called with props %s',e,JSON.stringify(o)),window._tkq.push(["recordEvent",e,o])},recordJetpackClick:function(e){const o=typeof e=="object"?e:{target:e};r.tracks.recordEvent("jetpack_wpa_click",o)},recordPageView:function(e){r.tracks.recordEvent("akismet_page_view",{path:e})},setOptOut:function(e){a("Pushing setOptOut: %o",e),window._tkq.push(["setOptOut",e])}},ga:{initialized:!1,initialize:function(){let e={};r.ga.initialized||(i&&(e={userId:"u-"+i.ID}),window.ga("create",this.googleAnalyticsKey,"auto",e),r.ga.initialized=!0)},recordPageView:function(e,o){r.ga.initialize(),a("Recording Page View ~ [URL: "+e+"] [Title: "+o+"]"),this.googleAnalyticsEnabled&&(window.ga("set","page",e),window.ga("send",{hitType:"pageview",page:e,title:o}))},recordEvent:function(e,o,c,d){r.ga.initialize();let p="Recording Event ~ [Category: "+e+"] [Action: "+o+"]";typeof c!="undefined"&&(p+=" [Option Label: "+c+"]"),typeof d!="undefined"&&(p+=" [Option Value: "+d+"]"),a(p),this.googleAnalyticsEnabled&&window.ga("send","event",e,o,c,d)},recordPurchase:function(e,o,c,d,p,g,C){window.ga("require","ecommerce"),window.ga("ecommerce:addTransaction",{id:e,revenue:d,currency:C}),window.ga("ecommerce:addItem",{id:e,name:o,sku:c,price:p,quantity:g}),window.ga("ecommerce:send")}},identifyUser:function(){i&&window._tkq.push(["identifyUser",i.ID,i.username])},setProperties:function(e){window._tkq.push(["setProperties",e])},clearedIdentity:function(){window._tkq.push(["clearIdentity"])}},m=r},"../connection/components/use-connection/index.jsx":(f,l,s)=>{s.d(l,{Z:()=>S});var u=s("../api/index.jsx"),T=s("../../../node_modules/.pnpm/@wordpress+data@9.23.0_react@18.2.0/node_modules/@wordpress/data/build-module/components/use-dispatch/use-dispatch.js"),a=s("../../../node_modules/.pnpm/@wordpress+data@9.23.0_react@18.2.0/node_modules/@wordpress/data/build-module/components/use-select/index.js"),_=s("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),i=s("../connection/state/store.jsx");const I=window!=null&&window.JP_CONNECTION_INITIAL_STATE?window.JP_CONNECTION_INITIAL_STATE:{},S=({registrationNonce:r=I.registrationNonce,apiRoot:m=I.apiRoot,apiNonce:e=I.apiNonce,redirectUri:o,autoTrigger:c,from:d,skipUserConnection:p}={})=>{const{registerSite:g,connectUser:C,refreshConnectedPlugins:h}=(0,T.Z)(i.t),P=(0,a.Z)(R=>R(i.t).getRegistrationError()),{siteIsRegistering:y,userIsConnecting:U,userConnectionData:A,connectedPlugins:N,connectionErrors:w,isRegistered:O,isUserConnected:k,hasConnectedOwner:D,isOfflineMode:b}=(0,a.Z)(R=>({siteIsRegistering:R(i.t).getSiteIsRegistering(),userIsConnecting:R(i.t).getUserIsConnecting(),userConnectionData:R(i.t).getUserConnectionData(),connectedPlugins:R(i.t).getConnectedPlugins(),connectionErrors:R(i.t).getConnectionErrors(),isOfflineMode:R(i.t).getIsOfflineMode(),...R(i.t).getConnectionStatus()})),j=()=>{if(p){if(o)return window.location=o,Promise.resolve(o)}else return C({from:d,redirectUri:o});return Promise.resolve()},L=R=>(R&&R.preventDefault(),O?j():g({registrationNonce:r,redirectUri:o}).then(()=>j()));return(0,_.useEffect)(()=>{u.ZP.setApiRoot(m),u.ZP.setApiNonce(e)},[m,e]),(0,_.useEffect)(()=>{c&&!y&&!U&&L()},[]),{handleRegisterSite:L,handleConnectUser:j,refreshConnectedPlugins:h,isRegistered:O,isUserConnected:k,siteIsRegistering:y,userIsConnecting:U,registrationError:P,userConnectionData:A,hasConnectedOwner:D,connectedPlugins:N,connectionErrors:w,isOfflineMode:b}}},"../connection/state/store.jsx":(f,l,s)=>{s.d(l,{t:()=>x});var u=s("../api/index.jsx");const T="SET_CONNECTION_STATUS",a="SET_CONNECTION_STATUS_IS_FETCHING",_="FETCH_CONNECTION_STATUS",i="SET_SITE_IS_REGISTERING",I="SET_USER_IS_CONNECTING",S="SET_REGISTRATION_ERROR",r="CLEAR_REGISTRATION_ERROR",m="REGISTER_SITE",e="SET_AUTHORIZATION_URL",o="CONNECT_USER",c="DISCONNECT_USER_SUCCESS",d="FETCH_AUTHORIZATION_URL",p="SET_CONNECTED_PLUGINS",g="REFRESH_CONNECTED_PLUGINS",C="SET_CONNECTION_ERRORS",h="SET_IS_OFFLINE_MODE",P=t=>({type:T,connectionStatus:t}),y=t=>({type:a,isFetching:t}),U=()=>({type:_}),A=t=>({type:i,isRegistering:t}),N=t=>({type:I,isConnecting:t}),w=()=>({type:c}),O=t=>({type:S,registrationError:t}),k=()=>({type:r}),D=t=>({type:e,authorizationUrl:t}),b=t=>({type:d,redirectUri:t}),j=t=>({type:p,connectedPlugins:t}),L=t=>({type:C,connectionErrors:t}),R=t=>({type:h,isOfflineMode:t});function*G({from:t,redirectFunc:n,redirectUri:E}={}){yield N(!0),yield{type:o,from:t,redirectFunc:n,redirectUri:E}}function*J({registrationNonce:t,redirectUri:n}){yield k(),yield A(!0);try{const E=yield{type:m,registrationNonce:t,redirectUri:n};return yield P({isRegistered:!0}),yield D(E.authorizeUrl),yield A(!1),Promise.resolve(E)}catch(E){return yield O(E),yield A(!1),Promise.reject(E)}}const B={setConnectionStatus:P,setConnectionStatusIsFetching:y,fetchConnectionStatus:U,fetchAuthorizationUrl:b,setSiteIsRegistering:A,setUserIsConnecting:N,setRegistrationError:O,clearRegistrationError:k,setAuthorizationUrl:D,registerSite:J,connectUser:G,disconnectUserSuccess:w,setConnectedPlugins:j,refreshConnectedPlugins:()=>async({dispatch:t})=>await new Promise(n=>u.ZP.fetchConnectedPlugins().then(E=>{t(j(E)),n(E)})),setConnectionErrors:L,setIsOfflineMode:R};var V=s("../../../node_modules/.pnpm/@wordpress+data@9.23.0_react@18.2.0/node_modules/@wordpress/data/build-module/factory.js");const x="jetpack-connection",Q=({registrationNonce:t,redirectUri:n})=>u.ZP.registerSite(t,n),$=(0,V.R)(({resolveSelect:t})=>({from:n,redirectFunc:E,redirectUri:K}={})=>new Promise((Ct,It)=>{t(x).getAuthorizationUrl(K).then(Y=>{const gt=E||(St=>window.location.assign(St)),z=new URL(Y);n&&z.searchParams.set("from",encodeURIComponent(n));const Z=z.toString();gt(Z),Ct(Z)}).catch(Y=>{It(Y)})})),X={FETCH_AUTHORIZATION_URL:({redirectUri:t})=>u.ZP.fetchAuthorizationUrl(t),REGISTER_SITE:Q,CONNECT_USER:$};var F=s("../../../node_modules/.pnpm/@wordpress+data@9.23.0_react@18.2.0/node_modules/@wordpress/data/build-module/index.js");const q=(t={},n)=>{switch(n.type){case T:return{...t,...n.connectionStatus};case c:return{...t,isUserConnected:!1}}return t},tt=(t={},n)=>{switch(n.type){case p:return n.connectedPlugins}return t},et=(t=!1,n)=>{switch(n.type){case a:return n.isFetching}return t},nt=(t=!1,n)=>{switch(n.type){case i:return n.isRegistering}return t},ot=(t=!1,n)=>{switch(n.type){case I:return n.isConnecting}return t},st=(t,n)=>{switch(n.type){case r:return!1;case S:return n.registrationError;default:return t}},ct=(t,n)=>{switch(n.type){case e:return n.authorizationUrl;default:return t}},it=(t,n)=>{switch(n.type){default:return t}},rt=(t={},n)=>{switch(n.type){case C:return n.connectionErrors}return t},at=(t=!1,n)=>{switch(n.type){case h:return n.isConnecting}return t},dt=(0,F.UY)({connectionStatus:q,connectionStatusIsFetching:et,siteIsRegistering:nt,userIsConnecting:ot,registrationError:st,authorizationUrl:ct,userConnectionData:it,connectedPlugins:tt,connectionErrors:rt,isOfflineMode:at});var ut=s("../../../node_modules/.pnpm/@wordpress+data@9.23.0_react@18.2.0/node_modules/@wordpress/data/build-module/select.js"),_t=s("../../../node_modules/.pnpm/@wordpress+data@9.23.0_react@18.2.0/node_modules/@wordpress/data/build-module/dispatch.js");const lt={...{getAuthorizationUrl:{isFulfilled:(t,...n)=>{const E=!!t.authorizationUrl,K=(0,ut.Y)(x).hasFinishedResolution("getAuthorizationUrl",n);return E&&!K&&(0,_t.W)(x).finishResolution("getAuthorizationUrl",n),E},*fulfill(t){const n=yield B.fetchAuthorizationUrl(t);yield B.setAuthorizationUrl(n.authorizeUrl)}}}},Et={...{getConnectionStatus:t=>t.connectionStatus||{},getConnectionStatusIsFetching:()=>!1,getSiteIsRegistering:t=>t.siteIsRegistering||!1,getUserIsConnecting:t=>t.userIsConnecting||!1,getRegistrationError:t=>t.registrationError||!1,getAuthorizationUrl:t=>t.authorizationUrl||!1,getUserConnectionData:t=>t.userConnectionData||!1,getConnectedPlugins:t=>t.connectedPlugins||[],getConnectionErrors:t=>t.connectionErrors||[],getIsOfflineMode:t=>t.isOfflineMode||!1,getWpcomUser:t=>{var n,E;return(E=(n=t==null?void 0:t.userConnectionData)==null?void 0:n.currentUser)==null?void 0:E.wpcomUser},getBlogId:t=>{var n,E;return(E=(n=t==null?void 0:t.userConnectionData)==null?void 0:n.currentUser)==null?void 0:E.blogId}}};var pt=s("../../../node_modules/.pnpm/@wordpress+data@9.23.0_react@18.2.0/node_modules/@wordpress/data/build-module/redux-store/index.js");const v=class{static mayBeInit(n,E){v.store===null&&(v.store=(0,pt.Z)(n,E),(0,F.z2)(v.store))}};let M=v;W(M,"store",null);const Tt=M,H=window.JP_CONNECTION_INITIAL_STATE;H||console.error("Jetpack Connection package: Initial state is missing. Check documentation to see how to use the Connection composer package to set up the initial state."),Tt.mayBeInit(x,{__experimentalUseThunks:!0,reducer:dt,actions:B,selectors:Et,resolvers:lt,controls:X,initialState:H||{}})},"../../packages/my-jetpack/_inc/hooks/use-analytics/index.js":(f,l,s)=>{s.d(l,{Z:()=>I});var u=s("../analytics/index.jsx"),T=s("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),a=s("../../packages/my-jetpack/_inc/data/utils/get-my-jetpack-window-state.ts"),_=s("../../packages/my-jetpack/_inc/hooks/use-my-jetpack-connection/index.js");const I=()=>{var O;const{isUserConnected:S,connectedPlugins:r,userConnectionData:m={}}=(0,_.Z)(),{login:e,ID:o}=((O=m.currentUser)==null?void 0:O.wpcomUser)||{},{myJetpackVersion:c=""}=(0,a.Z)();(0,T.useEffect)(()=>{S&&o&&e&&u.Z.initialize(o,e)},[o,S,e]);const d=Object.keys(r||{}).sort().join(",").replaceAll("jetpack-",""),{clearedIdentity:p,ga:g,mc:C,pageView:h,purchase:P,setGoogleAnalyticsEnabled:y,setMcAnalyticsEnabled:U,setProperties:A,tracks:N}=u.Z,w=(0,T.useCallback)((k,D)=>{N.recordEvent(k,{...D,version:c,referring_plugins:d})},[]);return{clearedIdentity:p,ga:g,mc:C,pageView:h,purchase:P,recordEvent:w,setGoogleAnalyticsEnabled:y,setMcAnalyticsEnabled:U,setProperties:A,tracks:N}}},"../../packages/my-jetpack/_inc/hooks/use-my-jetpack-connection/index.js":(f,l,s)=>{s.d(l,{Z:()=>T});var u=s("../connection/components/use-connection/index.jsx");function T(){const{apiRoot:a,apiNonce:_}=myJetpackRest,{topJetpackMenuItemUrl:i,blogID:I}=myJetpackInitialState,S=(0,u.Z)({apiRoot:a,apiNonce:_}),{registrationNonce:r}=JP_CONNECTION_INITIAL_STATE,m=S.isRegistered;return{apiNonce:_,apiRoot:a,blogID:I,registrationNonce:r,...S,isSiteConnected:m,topJetpackMenuItemUrl:i}}},"../../packages/my-jetpack/_inc/data/constants.ts":(f,l,s)=>{s.d(l,{Jk:()=>r,Kf:()=>y,LQ:()=>a,RQ:()=>U,Vu:()=>N,YF:()=>e,_H:()=>_,db:()=>g,h3:()=>w,hd:()=>i,iG:()=>d,n2:()=>m,q9:()=>c,yv:()=>p});const u="my-jetpack/v1",T="jetpack/v4/stats-app",a=`${u}/site/purchases`,_=`${u}/site/backup/undo-event`,i=`${u}/site/backup/count-items`,I=`${u}/chat/availability`,S=`${u}/chat/authentication`,r=`${u}/site/products`,m="videopress/v1/stats/featured",e=`${u}/site/dismiss-welcome-banner`,o=O=>`${T}/sites/${O}/stats/highlights`,c="product",d="activate product",p="install product",g="videopress stats",C="available licenses",h="chat availability",P="chat authentication",y="backup history",U="backup stats",A="stats counts",N="dismiss welcome banner",w="purchases"},"../../packages/my-jetpack/_inc/data/notices/use-fetching-error-notice.ts":(f,l,s)=>{s.d(l,{o:()=>o});var u=s("../../../node_modules/.pnpm/@wordpress+i18n@4.53.0/node_modules/@wordpress/i18n/build-module/index.js"),T=s("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),a=s("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");const _={message:"",options:{status:"",actions:{label:"",onClick:()=>{}}}},i=(0,T.createContext)({currentNotice:_,setNotice:null}),I=({children:c})=>{const[d,p]=(0,T.useState)(_),g=C=>{d.message||p(C)};return(0,a.jsx)(i.Provider,{value:{currentNotice:d,setNotice:g},children:c})};I.displayName="NoticeContextProvider";const S=null;try{noticeContext.displayName="noticeContext",noticeContext.__docgenInfo={description:"",displayName:"noticeContext",props:{}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["../../packages/my-jetpack/_inc/context/notices/noticeContext.tsx#noticeContext"]={docgenInfo:noticeContext.__docgenInfo,name:"noticeContext",path:"../../packages/my-jetpack/_inc/context/notices/noticeContext.tsx#noticeContext"})}catch(c){}var r=s("../../packages/my-jetpack/_inc/data/constants.ts");const m=u.__,e=[r.h3,r.iG,r.yv],o=({infoName:c,isError:d,overrideMessage:p})=>{const{setNotice:g}=(0,T.useContext)(i),C=p!=null?p:(0,u.gB)(m("There was an error fetching your %s information. Check your site connectivity and try again.","jetpack-my-jetpack"),c);(0,T.useEffect)(()=>{d&&e.includes(c)&&g({message:C,options:{status:"error"}})},[C,g,d,c])}},"../../packages/my-jetpack/_inc/data/utils/get-my-jetpack-window-state.ts":(f,l,s)=>{s.d(l,{Z:()=>T});const T=a=>{var _,i;return a?(i=(_=window==null?void 0:window.myJetpackInitialState)==null?void 0:_[a])!=null?i:null:window==null?void 0:window.myJetpackInitialState}}}]);})();
