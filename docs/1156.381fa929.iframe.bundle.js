"use strict";(()=>{var Re=Object.defineProperty;var Se=(R,_,s)=>_ in R?Re(R,_,{enumerable:!0,configurable:!0,writable:!0,value:s}):R[_]=s;var K=(R,_,s)=>(Se(R,typeof _!="symbol"?_+"":_,s),s);(self.webpackChunk_automattic_jetpack_storybook=self.webpackChunk_automattic_jetpack_storybook||[]).push([[1156],{"../analytics/index.jsx":(R,_,s)=>{s.d(_,{Z:()=>U});var f=s("../../../node_modules/.pnpm/debug@4.3.4/node_modules/debug/src/browser.js"),m=s.n(f);const a=m()("dops:analytics");let p,d;window._tkq=window._tkq||[],window.ga=window.ga||function(){(window.ga.q=window.ga.q||[]).push(arguments)},window.ga.l=+new Date;function I(t,o){let r="";if(typeof t=="object"){for(const c in t)r+="&x_"+encodeURIComponent(c)+"="+encodeURIComponent(t[c]);a("Bumping stats %o",t)}else r="&x_"+encodeURIComponent(t)+"="+encodeURIComponent(o),a('Bumping stat "%s" in group "%s"',o,t);return r}function O(t,o){let r="";if(typeof t=="object"){for(const c in t)r+="&"+encodeURIComponent(c)+"="+encodeURIComponent(t[c]);a("Built stats %o",t)}else r="&"+encodeURIComponent(t)+"="+encodeURIComponent(o),a('Built stat "%s" in group "%s"',o,t);return r}const i={initialize:function(t,o,r){i.setUser(t,o),i.setSuperProps(r),i.identifyUser()},setGoogleAnalyticsEnabled:function(t,o=null){this.googleAnalyticsEnabled=t,this.googleAnalyticsKey=o},setMcAnalyticsEnabled:function(t){this.mcAnalyticsEnabled=t},setUser:function(t,o){d={ID:t,username:o}},setSuperProps:function(t){p=t},assignSuperProps:function(t){p=Object.assign(p||{},t)},mc:{bumpStat:function(t,o){const r=I(t,o);i.mcAnalyticsEnabled&&(new Image().src=document.location.protocol+"//pixel.wp.com/g.gif?v=wpcom-no-pv"+r+"&t="+Math.random())},bumpStatWithPageView:function(t,o){const r=O(t,o);i.mcAnalyticsEnabled&&(new Image().src=document.location.protocol+"//pixel.wp.com/g.gif?v=wpcom"+r+"&t="+Math.random())}},pageView:{record:function(t,o){i.tracks.recordPageView(t),i.ga.recordPageView(t,o)}},purchase:{record:function(t,o,r,c,l,w,C){i.ga.recordPurchase(t,o,r,c,l,w,C)}},tracks:{recordEvent:function(t,o){if(o=o||{},t.indexOf("akismet_")!==0&&t.indexOf("jetpack_")!==0){a('- Event name must be prefixed by "akismet_" or "jetpack_"');return}p&&(a("- Super Props: %o",p),o=Object.assign(o,p)),a('Record event "%s" called with props %s',t,JSON.stringify(o)),window._tkq.push(["recordEvent",t,o])},recordJetpackClick:function(t){const o=typeof t=="object"?t:{target:t};i.tracks.recordEvent("jetpack_wpa_click",o)},recordPageView:function(t){i.tracks.recordEvent("akismet_page_view",{path:t})},setOptOut:function(t){a("Pushing setOptOut: %o",t),window._tkq.push(["setOptOut",t])}},ga:{initialized:!1,initialize:function(){let t={};i.ga.initialized||(d&&(t={userId:"u-"+d.ID}),window.ga("create",this.googleAnalyticsKey,"auto",t),i.ga.initialized=!0)},recordPageView:function(t,o){i.ga.initialize(),a("Recording Page View ~ [URL: "+t+"] [Title: "+o+"]"),this.googleAnalyticsEnabled&&(window.ga("set","page",t),window.ga("send",{hitType:"pageview",page:t,title:o}))},recordEvent:function(t,o,r,c){i.ga.initialize();let l="Recording Event ~ [Category: "+t+"] [Action: "+o+"]";typeof r!="undefined"&&(l+=" [Option Label: "+r+"]"),typeof c!="undefined"&&(l+=" [Option Value: "+c+"]"),a(l),this.googleAnalyticsEnabled&&window.ga("send","event",t,o,r,c)},recordPurchase:function(t,o,r,c,l,w,C){window.ga("require","ecommerce"),window.ga("ecommerce:addTransaction",{id:t,revenue:c,currency:C}),window.ga("ecommerce:addItem",{id:t,name:o,sku:r,price:l,quantity:w}),window.ga("ecommerce:send")}},identifyUser:function(){d&&window._tkq.push(["identifyUser",d.ID,d.username])},setProperties:function(t){window._tkq.push(["setProperties",t])},clearedIdentity:function(){window._tkq.push(["clearIdentity"])}},U=i},"../connection/components/use-connection/index.jsx":(R,_,s)=>{s.d(_,{Z:()=>O});var f=s("../api/index.jsx"),m=s("../../../node_modules/.pnpm/@wordpress+data@9.25.0_react@18.2.0/node_modules/@wordpress/data/build-module/components/use-dispatch/use-dispatch.js"),a=s("../../../node_modules/.pnpm/@wordpress+data@9.25.0_react@18.2.0/node_modules/@wordpress/data/build-module/components/use-select/index.js"),p=s("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),d=s("../connection/state/store.jsx");const I=window!=null&&window.JP_CONNECTION_INITIAL_STATE?window.JP_CONNECTION_INITIAL_STATE:{},O=({registrationNonce:i=I.registrationNonce,apiRoot:U=I.apiRoot,apiNonce:t=I.apiNonce,redirectUri:o,autoTrigger:r,from:c,skipUserConnection:l}={})=>{const{registerSite:w,connectUser:C,refreshConnectedPlugins:h}=(0,m.Z)(d.t),P=(0,a.Z)(E=>E(d.t).getRegistrationError()),{siteIsRegistering:y,userIsConnecting:N,userConnectionData:T,connectedPlugins:g,connectionErrors:A,isRegistered:j,isUserConnected:L,hasConnectedOwner:x,isOfflineMode:z}=(0,a.Z)(E=>({siteIsRegistering:E(d.t).getSiteIsRegistering(),userIsConnecting:E(d.t).getUserIsConnecting(),userConnectionData:E(d.t).getUserConnectionData(),connectedPlugins:E(d.t).getConnectedPlugins(),connectionErrors:E(d.t).getConnectionErrors(),isOfflineMode:E(d.t).getIsOfflineMode(),...E(d.t).getConnectionStatus()})),D=()=>{if(l){if(o)return window.location=o,Promise.resolve(o)}else return C({from:c,redirectUri:o});return Promise.resolve()},M=E=>(E&&E.preventDefault(),j?D():w({registrationNonce:i,redirectUri:o,from:c}).then(()=>D()));return(0,p.useEffect)(()=>{f.ZP.setApiRoot(U),f.ZP.setApiNonce(t)},[U,t]),(0,p.useEffect)(()=>{r&&!y&&!N&&M()},[]),{handleRegisterSite:M,handleConnectUser:D,refreshConnectedPlugins:h,isRegistered:j,isUserConnected:L,siteIsRegistering:y,userIsConnecting:N,registrationError:P,userConnectionData:T,hasConnectedOwner:x,connectedPlugins:g,connectionErrors:A,isOfflineMode:z}}},"../connection/state/store.jsx":(R,_,s)=>{s.d(_,{t:()=>k});var f=s("../api/index.jsx");const m="SET_CONNECTION_STATUS",a="SET_CONNECTION_STATUS_IS_FETCHING",p="FETCH_CONNECTION_STATUS",d="SET_SITE_IS_REGISTERING",I="SET_USER_IS_CONNECTING",O="SET_REGISTRATION_ERROR",i="CLEAR_REGISTRATION_ERROR",U="REGISTER_SITE",t="SET_AUTHORIZATION_URL",o="CONNECT_USER",r="DISCONNECT_USER_SUCCESS",c="FETCH_AUTHORIZATION_URL",l="SET_CONNECTED_PLUGINS",w="REFRESH_CONNECTED_PLUGINS",C="SET_CONNECTION_ERRORS",h="SET_IS_OFFLINE_MODE",P=e=>({type:m,connectionStatus:e}),y=e=>({type:a,isFetching:e}),N=()=>({type:p}),T=e=>({type:d,isRegistering:e}),g=e=>({type:I,isConnecting:e}),A=()=>({type:r}),j=e=>({type:O,registrationError:e}),L=()=>({type:i}),x=e=>({type:t,authorizationUrl:e}),z=e=>({type:c,redirectUri:e}),D=e=>({type:l,connectedPlugins:e}),M=e=>({type:C,connectionErrors:e}),E=e=>({type:h,isOfflineMode:e});function*V({from:e,redirectFunc:n,redirectUri:u}={}){yield g(!0),yield{type:o,from:e,redirectFunc:n,redirectUri:u}}function*J({registrationNonce:e,redirectUri:n,from:u=""}){yield L(),yield T(!0);try{const S=yield{type:U,registrationNonce:e,redirectUri:n,from:u};return yield P({isRegistered:!0}),yield x(S.authorizeUrl),yield T(!1),Promise.resolve(S)}catch(S){return yield j(S),yield T(!1),Promise.reject(S)}}const F={setConnectionStatus:P,setConnectionStatusIsFetching:y,fetchConnectionStatus:N,fetchAuthorizationUrl:z,setSiteIsRegistering:T,setUserIsConnecting:g,setRegistrationError:j,clearRegistrationError:L,setAuthorizationUrl:x,registerSite:J,connectUser:V,disconnectUserSuccess:A,setConnectedPlugins:D,refreshConnectedPlugins:()=>async({dispatch:e})=>await new Promise(n=>f.ZP.fetchConnectedPlugins().then(u=>{e(D(u)),n(u)})),setConnectionErrors:M,setIsOfflineMode:E};var X=s("../../../node_modules/.pnpm/@wordpress+data@9.25.0_react@18.2.0/node_modules/@wordpress/data/build-module/factory.js");const k="jetpack-connection",$=({registrationNonce:e,redirectUri:n,from:u})=>f.ZP.registerSite(e,n,u),Q=(0,X.R)(({resolveSelect:e})=>({from:n,redirectFunc:u,redirectUri:S}={})=>new Promise((Ce,fe)=>{e(k).getAuthorizationUrl(S).then(B=>{const Ie=u||(Te=>window.location.assign(Te)),H=new URL(B);n&&H.searchParams.set("from",encodeURIComponent(n));const W=H.toString();Ie(W),Ce(W)}).catch(B=>{fe(B)})})),Y={FETCH_AUTHORIZATION_URL:({redirectUri:e})=>f.ZP.fetchAuthorizationUrl(e),REGISTER_SITE:$,CONNECT_USER:Q};var Z=s("../../../node_modules/.pnpm/@wordpress+data@9.25.0_react@18.2.0/node_modules/@wordpress/data/build-module/index.js");const q=(e={},n)=>{switch(n.type){case m:return{...e,...n.connectionStatus};case r:return{...e,isUserConnected:!1}}return e},ee=(e={},n)=>{switch(n.type){case l:return n.connectedPlugins}return e},te=(e=!1,n)=>{switch(n.type){case a:return n.isFetching}return e},ne=(e=!1,n)=>{switch(n.type){case d:return n.isRegistering}return e},oe=(e=!1,n)=>{switch(n.type){case I:return n.isConnecting}return e},se=(e,n)=>{switch(n.type){case i:return!1;case O:return n.registrationError;default:return e}},re=(e,n)=>{switch(n.type){case t:return n.authorizationUrl;default:return e}},ie=(e,n)=>{switch(n.type){default:return e}},ce=(e={},n)=>{switch(n.type){case C:return n.connectionErrors}return e},ae=(e=!1,n)=>{switch(n.type){case h:return n.isConnecting}return e},de=(0,Z.UY)({connectionStatus:q,connectionStatusIsFetching:te,siteIsRegistering:ne,userIsConnecting:oe,registrationError:se,authorizationUrl:re,userConnectionData:ie,connectedPlugins:ee,connectionErrors:ce,isOfflineMode:ae});var ue=s("../../../node_modules/.pnpm/@wordpress+data@9.25.0_react@18.2.0/node_modules/@wordpress/data/build-module/select.js"),le=s("../../../node_modules/.pnpm/@wordpress+data@9.25.0_react@18.2.0/node_modules/@wordpress/data/build-module/dispatch.js");const _e={...{getAuthorizationUrl:{isFulfilled:(e,...n)=>{const u=!!e.authorizationUrl,S=(0,ue.Y)(k).hasFinishedResolution("getAuthorizationUrl",n);return u&&!S&&(0,le.W)(k).finishResolution("getAuthorizationUrl",n),u},*fulfill(e){const n=yield F.fetchAuthorizationUrl(e);yield F.setAuthorizationUrl(n.authorizeUrl)}}}},Ee={...{getConnectionStatus:e=>e.connectionStatus||{},getConnectionStatusIsFetching:()=>!1,getSiteIsRegistering:e=>e.siteIsRegistering||!1,getUserIsConnecting:e=>e.userIsConnecting||!1,getRegistrationError:e=>e.registrationError||!1,getAuthorizationUrl:e=>e.authorizationUrl||!1,getUserConnectionData:e=>e.userConnectionData||!1,getConnectedPlugins:e=>e.connectedPlugins||[],getConnectionErrors:e=>e.connectionErrors||[],getIsOfflineMode:e=>e.isOfflineMode||!1,getWpcomUser:e=>{var n,u;return(u=(n=e==null?void 0:e.userConnectionData)==null?void 0:n.currentUser)==null?void 0:u.wpcomUser},getBlogId:e=>{var n,u;return(u=(n=e==null?void 0:e.userConnectionData)==null?void 0:n.currentUser)==null?void 0:u.blogId}}};var ge=s("../../../node_modules/.pnpm/@wordpress+data@9.25.0_react@18.2.0/node_modules/@wordpress/data/build-module/redux-store/index.js");const v=class{static mayBeInit(n,u){v.store===null&&(v.store=(0,ge.Z)(n,u),(0,Z.z2)(v.store))}};let b=v;K(b,"store",null);const pe=b,G=window.JP_CONNECTION_INITIAL_STATE;G||console.error("Jetpack Connection package: Initial state is missing. Check documentation to see how to use the Connection composer package to set up the initial state."),pe.mayBeInit(k,{__experimentalUseThunks:!0,reducer:de,actions:F,selectors:Ee,resolvers:_e,controls:Y,initialState:G||{}})},"../../plugins/protect/src/js/hooks/use-analytics-tracks/index.js":(R,_,s)=>{s.d(_,{Z:()=>d});var f=s("../analytics/index.jsx"),m=s("../connection/components/use-connection/index.jsx"),a=s("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js");const d=({pageViewEventName:I,pageViewNamespace:O="jetpack",pageViewSuffix:i="page_view",pageViewEventProperties:U={}}={})=>{var N;const{isUserConnected:t,isRegistered:o,userConnectionData:r}=(0,m.Z)(),{login:c,ID:l}=((N=r.currentUser)==null?void 0:N.wpcomUser)||{},{tracks:w}=f.Z,{recordEvent:C}=w,h=(0,a.useCallback)(async(T,g)=>{C(T,g)},[C]),P=(0,a.useCallback)((T,g,A=()=>{})=>(A=typeof g=="function"?g:A,g=typeof g=="function"?{}:g,()=>h(T,g).then(A)),[h]);(0,a.useEffect)(()=>{t&&l&&c&&f.Z.initialize(l,c)},[t,l,c]);const y=I?`${O}_${I}_${i}`:null;return(0,a.useEffect)(()=>{o&&y&&C(y,U)},[]),{recordEvent:h,recordEventHandler:P}}}}]);})();
