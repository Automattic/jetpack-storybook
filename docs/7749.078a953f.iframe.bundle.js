"use strict";(()=>{var Se=Object.defineProperty;var fe=(S,l,s)=>l in S?Se(S,l,{enumerable:!0,configurable:!0,writable:!0,value:s}):S[l]=s;var W=(S,l,s)=>(fe(S,typeof l!="symbol"?l+"":l,s),s);(self.webpackChunk_automattic_jetpack_storybook=self.webpackChunk_automattic_jetpack_storybook||[]).push([[7749],{"../analytics/index.jsx":(S,l,s)=>{s.d(l,{Z:()=>g});var d=s("../../../node_modules/.pnpm/debug@4.3.4/node_modules/debug/src/browser.js"),C=s.n(d);const a=C()("dops:analytics");let E,r;window._tkq=window._tkq||[],window.ga=window.ga||function(){(window.ga.q=window.ga.q||[]).push(arguments)},window.ga.l=+new Date;function I(t,n){let c="";if(typeof t=="object"){for(const u in t)c+="&x_"+encodeURIComponent(u)+"="+encodeURIComponent(t[u]);a("Bumping stats %o",t)}else c="&x_"+encodeURIComponent(t)+"="+encodeURIComponent(n),a('Bumping stat "%s" in group "%s"',n,t);return c}function m(t,n){let c="";if(typeof t=="object"){for(const u in t)c+="&"+encodeURIComponent(u)+"="+encodeURIComponent(t[u]);a("Built stats %o",t)}else c="&"+encodeURIComponent(t)+"="+encodeURIComponent(n),a('Built stat "%s" in group "%s"',n,t);return c}const i={initialize:function(t,n,c){i.setUser(t,n),i.setSuperProps(c),i.identifyUser()},setGoogleAnalyticsEnabled:function(t,n=null){this.googleAnalyticsEnabled=t,this.googleAnalyticsKey=n},setMcAnalyticsEnabled:function(t){this.mcAnalyticsEnabled=t},setUser:function(t,n){r={ID:t,username:n}},setSuperProps:function(t){E=t},assignSuperProps:function(t){E=Object.assign(E||{},t)},mc:{bumpStat:function(t,n){const c=I(t,n);i.mcAnalyticsEnabled&&(new Image().src=document.location.protocol+"//pixel.wp.com/g.gif?v=wpcom-no-pv"+c+"&t="+Math.random())},bumpStatWithPageView:function(t,n){const c=m(t,n);i.mcAnalyticsEnabled&&(new Image().src=document.location.protocol+"//pixel.wp.com/g.gif?v=wpcom"+c+"&t="+Math.random())}},pageView:{record:function(t,n){i.tracks.recordPageView(t),i.ga.recordPageView(t,n)}},purchase:{record:function(t,n,c,u,p,R,f){i.ga.recordPurchase(t,n,c,u,p,R,f)}},tracks:{recordEvent:function(t,n){if(n=n||{},t.indexOf("akismet_")!==0&&t.indexOf("jetpack_")!==0){a('- Event name must be prefixed by "akismet_" or "jetpack_"');return}E&&(a("- Super Props: %o",E),n=Object.assign(n,E)),a('Record event "%s" called with props %s',t,JSON.stringify(n)),window._tkq.push(["recordEvent",t,n])},recordJetpackClick:function(t){const n=typeof t=="object"?t:{target:t};i.tracks.recordEvent("jetpack_wpa_click",n)},recordPageView:function(t){i.tracks.recordEvent("akismet_page_view",{path:t})},setOptOut:function(t){a("Pushing setOptOut: %o",t),window._tkq.push(["setOptOut",t])}},ga:{initialized:!1,initialize:function(){let t={};i.ga.initialized||(r&&(t={userId:"u-"+r.ID}),window.ga("create",this.googleAnalyticsKey,"auto",t),i.ga.initialized=!0)},recordPageView:function(t,n){i.ga.initialize(),a("Recording Page View ~ [URL: "+t+"] [Title: "+n+"]"),this.googleAnalyticsEnabled&&(window.ga("set","page",t),window.ga("send",{hitType:"pageview",page:t,title:n}))},recordEvent:function(t,n,c,u){i.ga.initialize();let p="Recording Event ~ [Category: "+t+"] [Action: "+n+"]";typeof c!="undefined"&&(p+=" [Option Label: "+c+"]"),typeof u!="undefined"&&(p+=" [Option Value: "+u+"]"),a(p),this.googleAnalyticsEnabled&&window.ga("send","event",t,n,c,u)},recordPurchase:function(t,n,c,u,p,R,f){window.ga("require","ecommerce"),window.ga("ecommerce:addTransaction",{id:t,revenue:u,currency:f}),window.ga("ecommerce:addItem",{id:t,name:n,sku:c,price:p,quantity:R}),window.ga("ecommerce:send")}},identifyUser:function(){r&&window._tkq.push(["identifyUser",r.ID,r.username])},setProperties:function(t){window._tkq.push(["setProperties",t])},clearedIdentity:function(){window._tkq.push(["clearIdentity"])}},g=i},"../connection/components/use-connection/index.jsx":(S,l,s)=>{s.d(l,{Z:()=>m});var d=s("../api/index.jsx"),C=s("../../../node_modules/.pnpm/@wordpress+data@9.22.0_react@18.2.0/node_modules/@wordpress/data/build-module/components/use-dispatch/use-dispatch.js"),a=s("../../../node_modules/.pnpm/@wordpress+data@9.22.0_react@18.2.0/node_modules/@wordpress/data/build-module/components/use-select/index.js"),E=s("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),r=s("../connection/state/store.jsx");const I=window!=null&&window.JP_CONNECTION_INITIAL_STATE?window.JP_CONNECTION_INITIAL_STATE:{},m=({registrationNonce:i=I.registrationNonce,apiRoot:g=I.apiRoot,apiNonce:t=I.apiNonce,redirectUri:n,autoTrigger:c,from:u,skipUserConnection:p}={})=>{const{registerSite:R,connectUser:f,refreshConnectedPlugins:h}=(0,C.Z)(r.t),w=(0,a.Z)(T=>T(r.t).getRegistrationError()),{siteIsRegistering:P,userIsConnecting:N,userConnectionData:O,connectedPlugins:y,connectionErrors:D,isRegistered:A,isUserConnected:U,hasConnectedOwner:v,isOfflineMode:M}=(0,a.Z)(T=>({siteIsRegistering:T(r.t).getSiteIsRegistering(),userIsConnecting:T(r.t).getUserIsConnecting(),userConnectionData:T(r.t).getUserConnectionData(),connectedPlugins:T(r.t).getConnectedPlugins(),connectionErrors:T(r.t).getConnectionErrors(),isOfflineMode:T(r.t).getIsOfflineMode(),...T(r.t).getConnectionStatus()})),k=()=>{if(p){if(n)return window.location=n,Promise.resolve(n)}else return f({from:u,redirectUri:n});return Promise.resolve()},L=T=>(T&&T.preventDefault(),A?k():R({registrationNonce:i,redirectUri:n}).then(()=>k()));return(0,E.useEffect)(()=>{d.ZP.setApiRoot(g),d.ZP.setApiNonce(t)},[g,t]),(0,E.useEffect)(()=>{c&&!P&&!N&&L()},[]),{handleRegisterSite:L,handleConnectUser:k,refreshConnectedPlugins:h,isRegistered:A,isUserConnected:U,siteIsRegistering:P,userIsConnecting:N,registrationError:w,userConnectionData:O,hasConnectedOwner:v,connectedPlugins:y,connectionErrors:D,isOfflineMode:M}}},"../connection/state/store.jsx":(S,l,s)=>{s.d(l,{t:()=>x});var d=s("../api/index.jsx");const C="SET_CONNECTION_STATUS",a="SET_CONNECTION_STATUS_IS_FETCHING",E="FETCH_CONNECTION_STATUS",r="SET_SITE_IS_REGISTERING",I="SET_USER_IS_CONNECTING",m="SET_REGISTRATION_ERROR",i="CLEAR_REGISTRATION_ERROR",g="REGISTER_SITE",t="SET_AUTHORIZATION_URL",n="CONNECT_USER",c="DISCONNECT_USER_SUCCESS",u="FETCH_AUTHORIZATION_URL",p="SET_CONNECTED_PLUGINS",R="REFRESH_CONNECTED_PLUGINS",f="SET_CONNECTION_ERRORS",h="SET_IS_OFFLINE_MODE",w=e=>({type:C,connectionStatus:e}),P=e=>({type:a,isFetching:e}),N=()=>({type:E}),O=e=>({type:r,isRegistering:e}),y=e=>({type:I,isConnecting:e}),D=()=>({type:c}),A=e=>({type:m,registrationError:e}),U=()=>({type:i}),v=e=>({type:t,authorizationUrl:e}),M=e=>({type:u,redirectUri:e}),k=e=>({type:p,connectedPlugins:e}),L=e=>({type:f,connectionErrors:e}),T=e=>({type:h,isOfflineMode:e});function*J({from:e,redirectFunc:o,redirectUri:_}={}){yield y(!0),yield{type:n,from:e,redirectFunc:o,redirectUri:_}}function*V({registrationNonce:e,redirectUri:o}){yield U(),yield O(!0);try{const _=yield{type:g,registrationNonce:e,redirectUri:o};return yield w({isRegistered:!0}),yield v(_.authorizeUrl),yield O(!1),Promise.resolve(_)}catch(_){return yield A(_),yield O(!1),Promise.reject(_)}}const B={setConnectionStatus:w,setConnectionStatusIsFetching:P,fetchConnectionStatus:N,fetchAuthorizationUrl:M,setSiteIsRegistering:O,setUserIsConnecting:y,setRegistrationError:A,clearRegistrationError:U,setAuthorizationUrl:v,registerSite:V,connectUser:J,disconnectUserSuccess:D,setConnectedPlugins:k,refreshConnectedPlugins:()=>async({dispatch:e})=>await new Promise(o=>d.ZP.fetchConnectedPlugins().then(_=>{e(k(_)),o(_)})),setConnectionErrors:L,setIsOfflineMode:T};var $=s("../../../node_modules/.pnpm/@wordpress+data@9.22.0_react@18.2.0/node_modules/@wordpress/data/build-module/factory.js");const x="jetpack-connection",Y=({registrationNonce:e,redirectUri:o})=>d.ZP.registerSite(e,o),Q=(0,$.R)(({resolveSelect:e})=>({from:o,redirectFunc:_,redirectUri:F}={})=>new Promise((Ie,ge)=>{e(x).getAuthorizationUrl(F).then(z=>{const Te=_||(me=>window.location.assign(me)),H=new URL(z);o&&H.searchParams.set("from",encodeURIComponent(o));const K=H.toString();Te(K),Ie(K)}).catch(z=>{ge(z)})})),X={FETCH_AUTHORIZATION_URL:({redirectUri:e})=>d.ZP.fetchAuthorizationUrl(e),REGISTER_SITE:Y,CONNECT_USER:Q};var Z=s("../../../node_modules/.pnpm/@wordpress+data@9.22.0_react@18.2.0/node_modules/@wordpress/data/build-module/index.js");const q=(e={},o)=>{switch(o.type){case C:return{...e,...o.connectionStatus};case c:return{...e,isUserConnected:!1}}return e},ee=(e={},o)=>{switch(o.type){case p:return o.connectedPlugins}return e},te=(e=!1,o)=>{switch(o.type){case a:return o.isFetching}return e},ne=(e=!1,o)=>{switch(o.type){case r:return o.isRegistering}return e},oe=(e=!1,o)=>{switch(o.type){case I:return o.isConnecting}return e},se=(e,o)=>{switch(o.type){case i:return!1;case m:return o.registrationError;default:return e}},ce=(e,o)=>{switch(o.type){case t:return o.authorizationUrl;default:return e}},ie=(e,o)=>{switch(o.type){default:return e}},re=(e={},o)=>{switch(o.type){case f:return o.connectionErrors}return e},ae=(e=!1,o)=>{switch(o.type){case h:return o.isConnecting}return e},de=(0,Z.UY)({connectionStatus:q,connectionStatusIsFetching:te,siteIsRegistering:ne,userIsConnecting:oe,registrationError:se,authorizationUrl:ce,userConnectionData:ie,connectedPlugins:ee,connectionErrors:re,isOfflineMode:ae});var ue=s("../../../node_modules/.pnpm/@wordpress+data@9.22.0_react@18.2.0/node_modules/@wordpress/data/build-module/select.js"),_e=s("../../../node_modules/.pnpm/@wordpress+data@9.22.0_react@18.2.0/node_modules/@wordpress/data/build-module/dispatch.js");const le={...{getAuthorizationUrl:{isFulfilled:(e,...o)=>{const _=!!e.authorizationUrl,F=(0,ue.Y)(x).hasFinishedResolution("getAuthorizationUrl",o);return _&&!F&&(0,_e.W)(x).finishResolution("getAuthorizationUrl",o),_},*fulfill(e){const o=yield B.fetchAuthorizationUrl(e);yield B.setAuthorizationUrl(o.authorizeUrl)}}}},Ee={...{getConnectionStatus:e=>e.connectionStatus||{},getConnectionStatusIsFetching:()=>!1,getSiteIsRegistering:e=>e.siteIsRegistering||!1,getUserIsConnecting:e=>e.userIsConnecting||!1,getRegistrationError:e=>e.registrationError||!1,getAuthorizationUrl:e=>e.authorizationUrl||!1,getUserConnectionData:e=>e.userConnectionData||!1,getConnectedPlugins:e=>e.connectedPlugins||[],getConnectionErrors:e=>e.connectionErrors||[],getIsOfflineMode:e=>e.isOfflineMode||!1,getWpcomUser:e=>{var o,_;return(_=(o=e==null?void 0:e.userConnectionData)==null?void 0:o.currentUser)==null?void 0:_.wpcomUser},getBlogId:e=>{var o,_;return(_=(o=e==null?void 0:e.userConnectionData)==null?void 0:o.currentUser)==null?void 0:_.blogId}}};var pe=s("../../../node_modules/.pnpm/@wordpress+data@9.22.0_react@18.2.0/node_modules/@wordpress/data/build-module/redux-store/index.js");const j=class{static mayBeInit(o,_){j.store===null&&(j.store=(0,pe.Z)(o,_),(0,Z.z2)(j.store))}};let b=j;W(b,"store",null);const Ce=b,G=window.JP_CONNECTION_INITIAL_STATE;G||console.error("Jetpack Connection package: Initial state is missing. Check documentation to see how to use the Connection composer package to set up the initial state."),Ce.mayBeInit(x,{__experimentalUseThunks:!0,reducer:de,actions:B,selectors:Ee,resolvers:le,controls:X,initialState:G||{}})},"../../packages/my-jetpack/_inc/hooks/use-analytics/index.js":(S,l,s)=>{s.d(l,{Z:()=>r});var d=s("../analytics/index.jsx"),C=s("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),a=s("../../packages/my-jetpack/_inc/hooks/use-my-jetpack-connection/index.js");const r=()=>{var y;const{isUserConnected:I,connectedPlugins:m,userConnectionData:i={}}=(0,a.Z)(),{login:g,ID:t}=((y=i.currentUser)==null?void 0:y.wpcomUser)||{};(0,C.useEffect)(()=>{I&&t&&g&&d.Z.initialize(t,g)},[t,I,g]);const n=Object.keys(m||{}).sort().join(",").replaceAll("jetpack-",""),{clearedIdentity:c,ga:u,mc:p,pageView:R,purchase:f,setGoogleAnalyticsEnabled:h,setMcAnalyticsEnabled:w,setProperties:P,tracks:N}=d.Z,O=(0,C.useCallback)((D,A)=>{var U;N.recordEvent(D,{...A,version:(U=window==null?void 0:window.myJetpackInitialState)==null?void 0:U.myJetpackVersion,referring_plugins:n})},[]);return{clearedIdentity:c,ga:u,mc:p,pageView:R,purchase:f,recordEvent:O,setGoogleAnalyticsEnabled:h,setMcAnalyticsEnabled:w,setProperties:P,tracks:N}}},"../../packages/my-jetpack/_inc/hooks/use-my-jetpack-connection/index.js":(S,l,s)=>{s.d(l,{Z:()=>C});var d=s("../connection/components/use-connection/index.jsx");function C(){const{apiRoot:a,apiNonce:E}=myJetpackRest,{topJetpackMenuItemUrl:r}=myJetpackInitialState,I=(0,d.Z)({apiRoot:a,apiNonce:E}),{registrationNonce:m}=JP_CONNECTION_INITIAL_STATE,i=I.isRegistered;return{apiNonce:E,apiRoot:a,registrationNonce:m,...I,isSiteConnected:i,topJetpackMenuItemUrl:r}}},"../../packages/my-jetpack/_inc/data/constants.ts":(S,l,s)=>{s.d(l,{Jk:()=>m,LQ:()=>C,YF:()=>g,_H:()=>a,hd:()=>E,n2:()=>i});const d="my-jetpack/v1",C=`${d}/site/purchases`,a=`${d}/site/backup/undo-event`,E=`${d}/site/backup/count-items`,r=`${d}/chat/availability`,I=`${d}/chat/authentication`,m=`${d}/site/products`,i="videopress/v1/stats/featured",g=`${d}/site/dismiss-welcome-banner`},"../../packages/my-jetpack/_inc/data/notices/use-fetching-error-notice.ts":(S,l,s)=>{s.d(l,{o:()=>g});var d=s("../../../node_modules/.pnpm/@wordpress+i18n@4.52.0/node_modules/@wordpress/i18n/build-module/index.js"),C=s("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),a=s("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");const E={message:"",options:{status:"",actions:{label:"",onClick:()=>{}}}},r=(0,C.createContext)({currentNotice:E,setNotice:null}),I=({children:t})=>{const[n,c]=(0,C.useState)(E),u=p=>{n.message||c(p)};return(0,a.jsx)(r.Provider,{value:{currentNotice:n,setNotice:u},children:t})};I.displayName="NoticeContextProvider";const m=null;try{noticeContext.displayName="noticeContext",noticeContext.__docgenInfo={description:"",displayName:"noticeContext",props:{}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["../../packages/my-jetpack/_inc/context/notices/noticeContext.tsx#noticeContext"]={docgenInfo:noticeContext.__docgenInfo,name:"noticeContext",path:"../../packages/my-jetpack/_inc/context/notices/noticeContext.tsx#noticeContext"})}catch(t){}const i=d.__,g=({infoName:t,isError:n,overrideMessage:c})=>{const{setNotice:u}=(0,C.useContext)(r),p=c!=null?c:(0,d.gB)(i("There was an error fetching your %s information. Check your site connectivity and try again.","jetpack-my-jetpack"),t);(0,C.useEffect)(()=>{n&&u({message:p,options:{status:"error"}})},[p,u,n])}}}]);})();
