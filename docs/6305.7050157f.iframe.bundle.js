(()=>{(self.webpackChunk_automattic_jetpack_storybook=self.webpackChunk_automattic_jetpack_storybook||[]).push([[6305],{"../../../node_modules/.pnpm/@wordpress+compose@6.21.0_react@18.2.0/node_modules/@wordpress/compose/build-module/hooks/use-focusable-iframe/index.js":(Vt,Tt,$)=>{"use strict";$.d(Tt,{Z:()=>ft});var ct=$("../../../node_modules/.pnpm/@wordpress+compose@6.21.0_react@18.2.0/node_modules/@wordpress/compose/build-module/hooks/use-ref-effect/index.js");function ft(){return(0,ct.Z)(st=>{const{ownerDocument:M}=st;if(!M)return;const{defaultView:A}=M;if(!A)return;function b(){M&&M.activeElement===st&&st.focus()}return A.addEventListener("blur",b),()=>{A.removeEventListener("blur",b)}},[])}},"../../../node_modules/.pnpm/@wordpress+sync@0.6.0/node_modules/@wordpress/sync/build-module/connect-indexdb.js":(Vt,Tt,$)=>{"use strict";$.d(Tt,{D:()=>Jt});var ct=$("../../../node_modules/.pnpm/yjs@13.6.8/node_modules/yjs/dist/yjs.mjs"),ft=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/promise.js"),st=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/error.js");const M=ot=>ft.Ue((nt,lt)=>{ot.onerror=wt=>lt(new Error(wt.target.error)),ot.onsuccess=wt=>nt(wt.target.result)}),A=(ot,nt)=>ft.Ue((lt,wt)=>{const _t=indexedDB.open(ot);_t.onupgradeneeded=At=>nt(At.target.result),_t.onerror=At=>wt(st.Ue(At.target.error)),_t.onsuccess=At=>{const jt=At.target.result;jt.onversionchange=()=>{jt.close()},lt(jt)}}),b=ot=>M(indexedDB.deleteDatabase(ot)),m=(ot,nt)=>nt.forEach(lt=>ot.createObjectStore.apply(ot,lt)),U=(ot,nt,lt="readwrite")=>{const wt=ot.transaction(nt,lt);return nt.map(_t=>H(wt,_t))},L=(ot,nt)=>M(ot.count(nt)),a=(ot,nt)=>M(ot.get(nt)),w=(ot,nt)=>M(ot.delete(nt)),d=(ot,nt,lt)=>M(ot.put(nt,lt)),h=(ot,nt,lt)=>M(ot.add(nt,lt)),O=(ot,nt)=>M(ot.add(nt)),R=(ot,nt,lt)=>M(ot.getAll(nt,lt)),S=(ot,nt,lt)=>M(ot.getAllKeys(nt,lt)),x=(ot,nt,lt)=>{let wt=null;return D(ot,nt,_t=>(wt=_t,!1),lt).then(()=>wt)},u=(ot,nt=null)=>x(ot,nt,"prev"),_=(ot,nt=null)=>x(ot,nt,"next"),g=(ot,nt,lt)=>promise.all([S(ot,nt,lt),R(ot,nt,lt)]).then(([wt,_t])=>wt.map((At,jt)=>({k:At,v:_t[jt]}))),C=(ot,nt)=>ft.Ue((lt,wt)=>{ot.onerror=wt,ot.onsuccess=async _t=>{const At=_t.target.result;if(At===null||await nt(At)===!1)return lt();At.continue()}}),v=(ot,nt,lt,wt="next")=>C(ot.openCursor(nt,wt),_t=>lt(_t.value,_t.key)),D=(ot,nt,lt,wt="next")=>C(ot.openKeyCursor(nt,wt),_t=>lt(_t.key)),H=(ot,nt)=>ot.objectStore(nt),N=(ot,nt,lt,wt)=>IDBKeyRange.bound(ot,nt,lt,wt),j=(ot,nt)=>IDBKeyRange.upperBound(ot,nt),q=(ot,nt)=>IDBKeyRange.lowerBound(ot,nt);var it=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/observable.js");const bt="custom",St="updates",Rt=500,Dt=(ot,nt=()=>{},lt=()=>{})=>{const[wt]=U(ot.db,[St]);return R(wt,q(ot._dbref,!1)).then(_t=>{ot._destroyed||(nt(wt),ct.ay(ot.doc,()=>{_t.forEach(At=>ct.NG(ot.doc,At))},ot,!1),lt(wt))}).then(()=>u(wt).then(_t=>{ot._dbref=_t+1})).then(()=>L(wt).then(_t=>{ot._dbsize=_t})).then(()=>wt)},Ut=(ot,nt=!0)=>Dt(ot).then(lt=>{(nt||ot._dbsize>=Rt)&&O(lt,ct.D$(ot.doc)).then(()=>w(lt,j(ot._dbref,!0))).then(()=>L(lt).then(wt=>{ot._dbsize=wt}))}),vt=ot=>idb.deleteDB(ot);class te extends it.y{constructor(nt,lt){super(),this.doc=lt,this.name=nt,this._dbref=0,this._dbsize=0,this._destroyed=!1,this.db=null,this.synced=!1,this._db=A(nt,wt=>m(wt,[["updates",{autoIncrement:!0}],["custom"]])),this.whenSynced=ft.Ue(wt=>this.on("synced",()=>wt(this))),this._db.then(wt=>{this.db=wt,Dt(this,jt=>O(jt,ct.D$(lt)),()=>{if(this._destroyed)return this;this.synced=!0,this.emit("synced",[this])})}),this._storeTimeout=1e3,this._storeTimeoutId=null,this._storeUpdate=(wt,_t)=>{if(this.db&&_t!==this){const[At]=U(this.db,[St]);O(At,wt),++this._dbsize>=Rt&&(this._storeTimeoutId!==null&&clearTimeout(this._storeTimeoutId),this._storeTimeoutId=setTimeout(()=>{Ut(this,!1),this._storeTimeoutId=null},this._storeTimeout))}},lt.on("update",this._storeUpdate),this.destroy=this.destroy.bind(this),lt.on("destroy",this.destroy)}destroy(){return this._storeTimeoutId&&clearTimeout(this._storeTimeoutId),this.doc.off("update",this._storeUpdate),this.doc.off("destroy",this.destroy),this._destroyed=!0,this._db.then(nt=>{nt.close()})}clearData(){return this.destroy().then(()=>{b(this.name)})}get(nt){return this._db.then(lt=>{const[wt]=U(lt,[bt],"readonly");return a(wt,nt)})}set(nt,lt){return this._db.then(wt=>{const[_t]=U(wt,[bt]);return d(_t,lt,nt)})}del(nt){return this._db.then(lt=>{const[wt]=U(lt,[bt]);return w(wt,nt)})}}function Jt(ot,nt,lt){const wt=`${nt}-${ot}`,_t=new te(wt,lt);return new Promise(At=>{_t.on("synced",()=>{At(()=>_t.destroy())})})}},"../../../node_modules/.pnpm/@wordpress+sync@0.6.0/node_modules/@wordpress/sync/build-module/connect-webrtc.js":(Vt,Tt,$)=>{"use strict";$.d(Tt,{o:()=>hn});var ct=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/observable.js"),ft=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/time.js"),st=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/math.js");const M=1200,A=2500,b=3e4,m=W=>{if(W.shouldConnect&&W.ws===null){const K=new WebSocket(W.url),X=W.binaryType;let ut=null;X&&(K.binaryType=X),W.ws=K,W.connecting=!0,W.connected=!1,K.onmessage=Ct=>{W.lastMessageReceived=ft.ZG();const Nt=Ct.data,Bt=typeof Nt=="string"?JSON.parse(Nt):Nt;Bt&&Bt.type==="pong"&&(clearTimeout(ut),ut=setTimeout(Et,b/2)),W.emit("message",[Bt,W])};const ht=Ct=>{W.ws!==null&&(W.ws=null,W.connecting=!1,W.connected?(W.connected=!1,W.emit("disconnect",[{type:"disconnect",error:Ct},W])):W.unsuccessfulReconnects++,setTimeout(m,st.VV(st.mv(W.unsuccessfulReconnects+1)*M,A),W)),clearTimeout(ut)},Et=()=>{W.ws===K&&W.send({type:"ping"})};K.onclose=()=>ht(null),K.onerror=Ct=>ht(Ct),K.onopen=()=>{W.lastMessageReceived=ft.ZG(),W.connecting=!1,W.connected=!0,W.unsuccessfulReconnects=0,W.emit("connect",[{type:"connect"},W]),ut=setTimeout(Et,b/2)}}};class U extends ct.y{constructor(K,{binaryType:X}={}){super(),this.url=K,this.ws=null,this.binaryType=X||null,this.connected=!1,this.connecting=!1,this.unsuccessfulReconnects=0,this.lastMessageReceived=0,this.shouldConnect=!0,this._checkInterval=setInterval(()=>{this.connected&&b<ft.ZG()-this.lastMessageReceived&&this.ws.close()},b/2),m(this)}send(K){this.ws&&this.ws.send(JSON.stringify(K))}destroy(){clearInterval(this._checkInterval),this.disconnect(),super.destroy()}disconnect(){this.shouldConnect=!1,this.ws!==null&&this.ws.close()}connect(){this.shouldConnect=!0,!this.connected&&this.ws===null&&m(this)}}var L=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/map.js"),a=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/error.js"),w=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/random.js"),d=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/encoding.js"),h=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/decoding.js"),O=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/logging.js"),R=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/logging.common.js"),S=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/promise.js"),x=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/set.js"),u=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/buffer.js"),_=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/storage.js");const g=new Map;class C{constructor(K){this.room=K,this.onmessage=null,this._onChange=X=>X.key===K&&this.onmessage!==null&&this.onmessage({data:u.Gh(X.newValue||"")}),_.z2(this._onChange)}postMessage(K){_.XN.setItem(this.room,u.s3(u.eh(K)))}close(){_.F(this._onChange)}}const v=typeof BroadcastChannel=="undefined"?C:BroadcastChannel,D=W=>L.Yu(g,W,()=>{const K=x.Ue(),X=new v(W);return X.onmessage=ut=>K.forEach(ht=>ht(ut.data,"broadcastchannel")),{bc:X,subs:K}}),H=(W,K)=>(D(W).subs.add(K),K),N=(W,K)=>{const X=D(W),ut=X.subs.delete(K);return ut&&X.subs.size===0&&(X.bc.close(),g.delete(W)),ut},j=(W,K,X=null)=>{const ut=D(W);ut.bc.postMessage(K),ut.subs.forEach(ht=>ht(K,X))},q=()=>{let W=!0;return(K,X)=>{if(W){W=!1;try{K()}finally{W=!0}}else X!==void 0&&X()}};var it=$("../../../node_modules/.pnpm/simple-peer@9.11.1/node_modules/simple-peer/simplepeer.min.js"),bt=$.n(it),St=$("../../../node_modules/.pnpm/yjs@13.6.8/node_modules/yjs/dist/yjs.mjs");const Rt=0,Dt=1,Ut=2,vt=(W,K)=>{d.uE(W,Rt);const X=St.gJ(K);d.mP(W,X)},te=(W,K,X)=>{d.uE(W,Dt),d.mP(W,St.D$(K,X))},Jt=(W,K,X)=>te(K,X,h.HN(W)),ot=(W,K,X)=>{try{St.NG(K,h.HN(W),X)}catch(ut){console.error("Caught error while handling a Yjs update",ut)}},nt=(W,K)=>{d.uE(W,Ut),d.mP(W,K)},lt=ot,wt=(W,K,X,ut)=>{const ht=h.yg(W);switch(ht){case Rt:Jt(W,K,X);break;case Dt:ot(W,X,ut);break;case Ut:lt(W,X,ut);break;default:throw new Error("Unknown message type")}return ht};var _t=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/function.js");const At=3e4;class jt extends ct.y{constructor(K){super(),this.doc=K,this.clientID=K.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{const X=ft.ZG();this.getLocalState()!==null&&At/2<=X-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const ut=[];this.meta.forEach((ht,Et)=>{Et!==this.clientID&&At<=X-ht.lastUpdated&&this.states.has(Et)&&ut.push(Et)}),ut.length>0&&Qt(this,ut,"timeout")},st.GW(At/10)),K.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(K){const X=this.clientID,ut=this.meta.get(X),ht=ut===void 0?0:ut.clock+1,Et=this.states.get(X);K===null?this.states.delete(X):this.states.set(X,K),this.meta.set(X,{clock:ht,lastUpdated:ft.ZG()});const Ct=[],Nt=[],Bt=[],Yt=[];K===null?Yt.push(X):Et==null?K!=null&&Ct.push(X):(Nt.push(X),_t.Hi(Et,K)||Bt.push(X)),(Ct.length>0||Bt.length>0||Yt.length>0)&&this.emit("change",[{added:Ct,updated:Bt,removed:Yt},"local"]),this.emit("update",[{added:Ct,updated:Nt,removed:Yt},"local"])}setLocalStateField(K,X){const ut=this.getLocalState();ut!==null&&this.setLocalState({...ut,[K]:X})}getStates(){return this.states}}const Qt=(W,K,X)=>{const ut=[];for(let ht=0;ht<K.length;ht++){const Et=K[ht];if(W.states.has(Et)){if(W.states.delete(Et),Et===W.clientID){const Ct=W.meta.get(Et);W.meta.set(Et,{clock:Ct.clock+1,lastUpdated:ft.ZG()})}ut.push(Et)}}ut.length>0&&(W.emit("change",[{added:[],updated:[],removed:ut},X]),W.emit("update",[{added:[],updated:[],removed:ut},X]))},xt=(W,K,X=W.states)=>{const ut=K.length,ht=d.Mf();d.uE(ht,ut);for(let Et=0;Et<ut;Et++){const Ct=K[Et],Nt=X.get(Ct)||null,Bt=W.meta.get(Ct).clock;d.uE(ht,Ct),d.uE(ht,Bt),d.uw(ht,JSON.stringify(Nt))}return d._f(ht)},ne=(W,K)=>{const X=decoding.createDecoder(W),ut=encoding.createEncoder(),ht=decoding.readVarUint(X);encoding.writeVarUint(ut,ht);for(let Et=0;Et<ht;Et++){const Ct=decoding.readVarUint(X),Nt=decoding.readVarUint(X),Bt=JSON.parse(decoding.readVarString(X)),Yt=K(Bt);encoding.writeVarUint(ut,Ct),encoding.writeVarUint(ut,Nt),encoding.writeVarString(ut,JSON.stringify(Yt))}return encoding.toUint8Array(ut)},Y=(W,K,X)=>{const ut=h.l1(K),ht=ft.ZG(),Et=[],Ct=[],Nt=[],Bt=[],Yt=h.yg(ut);for(let qt=0;qt<Yt;qt++){const re=h.yg(ut);let fe=h.yg(ut);const de=JSON.parse(h.kf(ut)),Ie=W.meta.get(re),Je=W.states.get(re),Xe=Ie===void 0?0:Ie.clock;(Xe<fe||Xe===fe&&de===null&&W.states.has(re))&&(de===null?re===W.clientID&&W.getLocalState()!=null?fe++:W.states.delete(re):W.states.set(re,de),W.meta.set(re,{clock:fe,lastUpdated:ht}),Ie===void 0&&de!==null?Et.push(re):Ie!==void 0&&de===null?Bt.push(re):de!==null&&(_t.Hi(de,Je)||Nt.push(re),Ct.push(re)))}(Et.length>0||Nt.length>0||Bt.length>0)&&W.emit("change",[{added:Et,updated:Nt,removed:Bt},X]),(Et.length>0||Ct.length>0||Bt.length>0)&&W.emit("update",[{added:Et,updated:Ct,removed:Bt},X])};var tt=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/string.js");const yt=(W,K)=>{const X=tt.lz(W).buffer,ut=tt.lz(K).buffer;return crypto.subtle.importKey("raw",X,"PBKDF2",!1,["deriveKey"]).then(ht=>crypto.subtle.deriveKey({name:"PBKDF2",salt:ut,iterations:1e5,hash:"SHA-256"},ht,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]))},P=(W,K)=>{if(!K)return S.DB(W);const X=crypto.getRandomValues(new Uint8Array(12));return crypto.subtle.encrypt({name:"AES-GCM",iv:X},K,W).then(ut=>{const ht=d.Mf();return d.uw(ht,"AES-GCM"),d.mP(ht,X),d.mP(ht,new Uint8Array(ut)),d._f(ht)})},y=(W,K)=>{const X=d.Mf();return d.EM(X,W),P(d._f(X),K)},T=(W,K)=>{if(!K)return S.DB(W);const X=h.l1(W);h.kf(X)!=="AES-GCM"&&S.d1(a.Ue("Unknown encryption algorithm"));const ht=h.HN(X),Et=h.HN(X);return crypto.subtle.decrypt({name:"AES-GCM",iv:ht},K,Et).then(Ct=>new Uint8Array(Ct))},Z=(W,K)=>T(W,K).then(X=>h.v_(h.l1(new Uint8Array(X))));var pt=$("../../../node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js");const n=O.YX("y-webrtc"),r=0,c=3,k=1,G=4,z=new Map,at=new Map,kt=W=>{let K=!0;W.webrtcConns.forEach(X=>{X.synced||(K=!1)}),(!K&&W.synced||K&&!W.synced)&&(W.synced=K,W.provider.emit("synced",[{synced:K}]),n("synced ",R.Pl,W.name,R.YW," with all peers"))},Ft=(W,K,X)=>{const ut=h.l1(K),ht=d.Mf(),Et=h.yg(ut);if(W===void 0)return null;const Ct=W.awareness,Nt=W.doc;let Bt=!1;switch(Et){case r:{d.uE(ht,r);const Yt=wt(ut,ht,Nt,W);Yt===Dt&&!W.synced&&X(),Yt===Rt&&(Bt=!0);break}case c:d.uE(ht,k),d.mP(ht,xt(Ct,Array.from(Ct.getStates().keys()))),Bt=!0;break;case k:Y(Ct,h.HN(ut),W);break;case G:{const Yt=h.kj(ut)===1,qt=h.kf(ut);if(qt!==W.peerId&&(W.bcConns.has(qt)&&!Yt||!W.bcConns.has(qt)&&Yt)){const re=[],fe=[];Yt?(W.bcConns.add(qt),fe.push(qt)):(W.bcConns.delete(qt),re.push(qt)),W.provider.emit("peers",[{added:fe,removed:re,webrtcPeers:Array.from(W.webrtcConns.keys()),bcPeers:Array.from(W.bcConns)}]),gt(W)}break}default:return console.error("Unable to compute message"),ht}return Bt?ht:null},Lt=(W,K)=>{const X=W.room;return n("received message from ",R.Pl,W.remotePeerId,R.s7," (",X.name,")",R.YW,R.WO),Ft(X,K,()=>{W.synced=!0,n("synced ",R.Pl,X.name,R.YW," with ",R.Pl,W.remotePeerId),kt(X)})},It=(W,K)=>{n("send message to ",R.Pl,W.remotePeerId,R.YW,R.s7," (",W.room.name,")",R.WO);try{W.peer.send(d._f(K))}catch(X){}},Mt=(W,K)=>{n("broadcast message in ",R.Pl,W.name,R.YW),W.webrtcConns.forEach(X=>{try{X.peer.send(K)}catch(ut){}})};class ie{constructor(K,X,ut,ht){n("establishing connection to ",R.Pl,ut),this.room=ht,this.remotePeerId=ut,this.closed=!1,this.connected=!1,this.synced=!1,this.peer=new(bt())({initiator:X,...ht.provider.peerOpts}),this.peer.on("signal",Et=>{Gt(K,ht,{to:ut,from:ht.peerId,type:"signal",signal:Et})}),this.peer.on("connect",()=>{n("connected to ",R.Pl,ut),this.connected=!0;const Ct=ht.provider.doc,Nt=ht.awareness,Bt=d.Mf();d.uE(Bt,r),vt(Bt,Ct),It(this,Bt);const Yt=Nt.getStates();if(Yt.size>0){const qt=d.Mf();d.uE(qt,k),d.mP(qt,xt(Nt,Array.from(Yt.keys()))),It(this,qt)}}),this.peer.on("close",()=>{this.connected=!1,this.closed=!0,ht.webrtcConns.has(this.remotePeerId)&&(ht.webrtcConns.delete(this.remotePeerId),ht.provider.emit("peers",[{removed:[this.remotePeerId],added:[],webrtcPeers:Array.from(ht.webrtcConns.keys()),bcPeers:Array.from(ht.bcConns)}])),kt(ht),this.peer.destroy(),n("closed connection to ",R.Pl,ut),mt(ht)}),this.peer.on("error",Et=>{n("Error in connection to ",R.Pl,ut,": ",Et),mt(ht)}),this.peer.on("data",Et=>{const Ct=Lt(this,Et);Ct!==null&&It(this,Ct)})}destroy(){this.peer.destroy()}}const J=(W,K)=>P(K,W.key).then(X=>W.mux(()=>j(W.name,X))),rt=(W,K)=>{W.bcconnected&&J(W,K),Mt(W,K)},mt=W=>{z.forEach(K=>{K.connected&&(K.send({type:"subscribe",topics:[W.name]}),W.webrtcConns.size<W.provider.maxConns&&Gt(K,W,{type:"announce",from:W.peerId}))})},gt=W=>{if(W.provider.filterBcConns){const K=d.Mf();d.uE(K,G),d.$F(K,1),d.uw(K,W.peerId),J(W,d._f(K))}};class Pt{constructor(K,X,ut,ht){this.peerId=w.k$(),this.doc=K,this.awareness=X.awareness,this.provider=X,this.synced=!1,this.name=ut,this.key=ht,this.webrtcConns=new Map,this.bcConns=new Set,this.mux=q(),this.bcconnected=!1,this._bcSubscriber=Et=>T(new Uint8Array(Et),ht).then(Ct=>this.mux(()=>{const Nt=Ft(this,Ct,()=>{});Nt&&J(this,d._f(Nt))})),this._docUpdateHandler=(Et,Ct)=>{const Nt=d.Mf();d.uE(Nt,r),nt(Nt,Et),rt(this,d._f(Nt))},this._awarenessUpdateHandler=({added:Et,updated:Ct,removed:Nt},Bt)=>{const Yt=Et.concat(Ct).concat(Nt),qt=d.Mf();d.uE(qt,k),d.mP(qt,xt(this.awareness,Yt)),rt(this,d._f(qt))},this._beforeUnloadHandler=()=>{Qt(this.awareness,[K.clientID],"window unload"),at.forEach(Et=>{Et.disconnect()})},typeof window!="undefined"?window.addEventListener("beforeunload",this._beforeUnloadHandler):typeof pt!="undefined"&&pt.on("exit",this._beforeUnloadHandler)}connect(){this.doc.on("update",this._docUpdateHandler),this.awareness.on("update",this._awarenessUpdateHandler),mt(this);const K=this.name;H(K,this._bcSubscriber),this.bcconnected=!0,gt(this);const X=d.Mf();d.uE(X,r),vt(X,this.doc),J(this,d._f(X));const ut=d.Mf();d.uE(ut,r),te(ut,this.doc),J(this,d._f(ut));const ht=d.Mf();d.uE(ht,c),J(this,d._f(ht));const Et=d.Mf();d.uE(Et,k),d.mP(Et,xt(this.awareness,[this.doc.clientID])),J(this,d._f(Et))}disconnect(){z.forEach(X=>{X.connected&&X.send({type:"unsubscribe",topics:[this.name]})}),Qt(this.awareness,[this.doc.clientID],"disconnect");const K=d.Mf();d.uE(K,G),d.$F(K,0),d.uw(K,this.peerId),J(this,d._f(K)),N(this.name,this._bcSubscriber),this.bcconnected=!1,this.doc.off("update",this._docUpdateHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.webrtcConns.forEach(X=>X.destroy())}destroy(){this.disconnect(),typeof window!="undefined"?window.removeEventListener("beforeunload",this._beforeUnloadHandler):typeof pt!="undefined"&&pt.off("exit",this._beforeUnloadHandler)}}const Xt=(W,K,X,ut)=>{if(at.has(X))throw a.Ue(`A Yjs Doc connected to room "${X}" already exists!`);const ht=new Pt(W,K,X,ut);return at.set(X,ht),ht},Gt=(W,K,X)=>{K.key?y(X,K.key).then(ut=>{W.send({type:"publish",topic:K.name,data:u.s3(ut)})}):W.send({type:"publish",topic:K.name,data:X})};class ce extends U{constructor(K){super(K),this.providers=new Set,this.on("connect",()=>{n(`connected (${K})`);const X=Array.from(at.keys());this.send({type:"subscribe",topics:X}),at.forEach(ut=>Gt(this,ut,{type:"announce",from:ut.peerId}))}),this.on("message",X=>{switch(X.type){case"publish":{const ut=X.topic,ht=at.get(ut);if(ht==null||typeof ut!="string")return;const Et=Ct=>{const Nt=ht.webrtcConns,Bt=ht.peerId;if(Ct==null||Ct.from===Bt||Ct.to!==void 0&&Ct.to!==Bt||ht.bcConns.has(Ct.from))return;const Yt=Nt.has(Ct.from)?()=>{}:()=>ht.provider.emit("peers",[{removed:[],added:[Ct.from],webrtcPeers:Array.from(ht.webrtcConns.keys()),bcPeers:Array.from(ht.bcConns)}]);switch(Ct.type){case"announce":Nt.size<ht.provider.maxConns&&(L.Yu(Nt,Ct.from,()=>new ie(this,!0,Ct.from,ht)),Yt());break;case"signal":Ct.to===Bt&&(L.Yu(Nt,Ct.from,()=>new ie(this,!1,Ct.from,ht)).peer.signal(Ct.signal),Yt());break}};ht.key?typeof X.data=="string"&&Z(u.Gh(X.data),ht.key).then(Et):Et(X.data)}}}),this.on("disconnect",()=>n(`disconnect (${K})`))}}class Se extends ct.y{constructor(K,X,{signaling:ut=["wss://y-webrtc-eu.fly.dev"],password:ht=null,awareness:Et=new jt(X),maxConns:Ct=20+st.GW(w.TN()*15),filterBcConns:Nt=!0,peerOpts:Bt={}}={}){super(),this.roomName=K,this.doc=X,this.filterBcConns=Nt,this.awareness=Et,this.shouldConnect=!1,this.signalingUrls=ut,this.signalingConns=[],this.maxConns=Ct,this.peerOpts=Bt,this.key=ht?yt(ht,K):S.DB(null),this.room=null,this.key.then(Yt=>{this.room=Xt(X,this,K,Yt),this.shouldConnect?this.room.connect():this.room.disconnect()}),this.connect(),this.destroy=this.destroy.bind(this),X.on("destroy",this.destroy)}get connected(){return this.room!==null&&this.shouldConnect}connect(){this.shouldConnect=!0,this.signalingUrls.forEach(K=>{const X=L.Yu(z,K,()=>new ce(K));this.signalingConns.push(X),X.providers.add(this)}),this.room&&this.room.connect()}disconnect(){this.shouldConnect=!1,this.signalingConns.forEach(K=>{K.providers.delete(this),K.providers.size===0&&(K.destroy(),z.delete(K.url))}),this.room&&this.room.disconnect()}destroy(){this.doc.off("destroy",this.destroy),this.key.then(()=>{this.room.destroy(),at.delete(this.roomName)}),super.destroy()}}function hn(W,K,X){const ut=`${K}-${W}`;return new Se(ut,X,{password:window.__experimentalCollaborativeEditingSecret}),Promise.resolve(()=>!0)}},"../../../node_modules/.pnpm/@wordpress+sync@0.6.0/node_modules/@wordpress/sync/build-module/provider.js":(Vt,Tt,$)=>{"use strict";$.d(Tt,{G:()=>ft});var ct=$("../../../node_modules/.pnpm/yjs@13.6.8/node_modules/yjs/dist/yjs.mjs");const ft=(st,M)=>{const A={},b={},m={};function U(d,h){A[d]=h}async function L(d,h,O){const R=new ct.QW;m[d]=m[d]||{},m[d][h]=R;const S=()=>{const _=A[d].fromCRDTDoc(R);O(_)};R.on("update",S);const x=await st(h,d,R);M&&await M(h,d,R);const u=A[d].fetch;u&&u(h).then(_=>{R.transact(()=>{A[d].applyChangesToDoc(R,_)})}),b[d]=b[d]||{},b[d][h]=()=>{x(),R.off("update",S)}}async function a(d,h,O){const R=m[d][h];if(!R)throw"Error doc "+d+" "+h+" not found";R.transact(()=>{A[d].applyChangesToDoc(R,O)})}async function w(d,h){var O;(O=b==null?void 0:b[d])!=null&&O[h]&&b[d][h]()}return{register:U,bootstrap:L,update:a,discard:w}}},"../../../node_modules/.pnpm/@wordpress+undo-manager@0.4.0/node_modules/@wordpress/undo-manager/build-module/index.js":(Vt,Tt,$)=>{"use strict";$.d(Tt,{U:()=>M});var ct=$("../../../node_modules/.pnpm/@wordpress+is-shallow-equal@4.44.0/node_modules/@wordpress/is-shallow-equal/build-module/index.js");function ft(A,b){const m={...A};return Object.entries(b).forEach(([U,L])=>{m[U]?m[U]={...m[U],to:L.to}:m[U]=L}),m}const st=(A,b)=>{const m=A==null?void 0:A.findIndex(({id:L})=>typeof L=="string"?L===b.id:(0,ct.ZP)(L,b.id)),U=[...A];return m!==-1?U[m]={id:b.id,changes:ft(U[m].changes,b.changes)}:U.push(b),U};function M(){let A=[],b=[],m=0;const U=()=>{A=A.slice(0,m||void 0),m=0},L=()=>{var w;const d=A.length===0?0:A.length-1;let h=(w=A[d])!==null&&w!==void 0?w:[];b.forEach(O=>{h=st(h,O)}),b=[],A[d]=h},a=w=>!w.filter(({changes:h})=>Object.values(h).some(({from:O,to:R})=>typeof O!="function"&&typeof R!="function"&&!(0,ct.ZP)(O,R))).length;return{addRecord(w,d=!1){const h=!w||a(w);if(d){if(h)return;w.forEach(O=>{b=st(b,O)})}else{if(U(),b.length&&L(),h)return;A.push(w)}},undo(){b.length&&(U(),L());const w=A[A.length-1+m];if(w)return m-=1,w},redo(){const w=A[A.length+m];if(w)return m+=1,w},hasUndo(){return!!A[A.length-1+m]},hasRedo(){return!!A[A.length+m]}}}},"../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/array.js":(Vt,Tt,$)=>{"use strict";$.d(Tt,{Dp:()=>A,Z$:()=>ct,kJ:()=>d,s7:()=>M});const ct=S=>S[S.length-1],ft=()=>[],st=S=>S.slice(),M=(S,x)=>{for(let u=0;u<x.length;u++)S.push(x[u])},A=Array.from,b=(S,x)=>{for(let u=0;u<S.length;u++)if(!x(S[u],u,S))return!1;return!0},m=(S,x)=>{for(let u=0;u<S.length;u++)if(x(S[u],u,S))return!0;return!1},U=(S,x)=>S.length===x.length&&b(S,(u,_)=>u===x[_]),L=S=>w(S,[],(x,u)=>x.concat(u)),a=(S,x)=>{const u=new Array(S);for(let _=0;_<S;_++)u[_]=x(_,u);return u},w=(S,x,u)=>S.reduce(u,x),d=Array.isArray,h=S=>A(set.from(S)),O=(S,x)=>{const u=set.create(),_=[];for(let g=0;g<S.length;g++){const C=S[g],v=x(C);u.has(v)||(u.add(v),_.push(C))}return _},R=(S,x)=>{const u=Array(S.length);for(let _=0;_<S.length;_++)u[_]=x(S[_],_,S);return u}},"../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/binary.js":(Vt,Tt,$)=>{"use strict";$.d(Tt,{$2:()=>lt,CY:()=>st,Ko:()=>M,Qn:()=>ft,RP:()=>Lt,Tg:()=>It,Vw:()=>ct,cq:()=>b,jS:()=>wt,kr:()=>nt,rc:()=>m,x1:()=>U});const ct=1,ft=2,st=4,M=8,A=16,b=32,m=64,U=128,L=256,a=512,w=1024,d=2048,h=4096,O=8192,R=16384,S=32768,x=65536,u=1<<17,_=1<<18,g=1<<19,C=1<<20,v=1<<21,D=1<<22,H=1<<23,N=1<<24,j=1<<25,q=1<<26,it=1<<27,bt=1<<28,St=1<<29,Rt=1<<30,Dt=null,Ut=0,vt=1,te=3,Jt=7,ot=15,nt=31,lt=63,wt=127,_t=255,At=511,jt=1023,Qt=2047,xt=4095,ne=8191,Y=16383,tt=32767,yt=65535,P=u-1,y=_-1,T=g-1,Z=C-1,pt=v-1,n=D-1,r=H-1,c=N-1,k=j-1,G=q-1,z=it-1,at=bt-1,kt=St-1,Ft=Rt-1,Lt=2147483647,It=4294967295},"../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/buffer.js":(Vt,Tt,$)=>{"use strict";$.d(Tt,{Gh:()=>w,eh:()=>A,f9:()=>S,s3:()=>a});var ct=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/string.js"),ft=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/environment.js");const st=g=>new Uint8Array(g),M=(g,C,v)=>new Uint8Array(g,C,v),A=g=>new Uint8Array(g),b=g=>{let C="";for(let v=0;v<g.byteLength;v++)C+=ct.IK(g[v]);return btoa(C)},m=g=>Buffer.from(g.buffer,g.byteOffset,g.byteLength).toString("base64"),U=g=>{const C=atob(g),v=st(C.length);for(let D=0;D<C.length;D++)v[D]=C.charCodeAt(D);return v},L=g=>{const C=Buffer.from(g,"base64");return M(C.buffer,C.byteOffset,C.byteLength)},a=ft.jU?b:m,w=ft.jU?U:L,d=g=>a(g).replaceAll("+","-").replaceAll("/","_").replaceAll("=",""),h=g=>w(g.replaceAll("-","+").replaceAll("_","/")),O=g=>array.map(g,C=>C.toString(16).padStart(2,"0")).join(""),R=g=>{const C=g.length,v=new Uint8Array(math.ceil(C/2));for(let D=0;D<C;D+=2)v[v.length-D/2-1]=Number.parseInt(g.slice(C-D-2,C-D),16);return v},S=g=>{const C=st(g.byteLength);return C.set(g),C},x=g=>encoding.encode(C=>encoding.writeAny(C,g)),u=g=>decoding.readAny(decoding.createDecoder(g)),_=(g,C)=>{if(C===0)return g;g=new Uint8Array(g),g[0]<<=C;for(let v=1;v<g.length;v++)g[v-1]|=g[v]>>>8-C,g[v]<<=C;return g}},"../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/decoding.js":(Vt,Tt,$)=>{"use strict";$.d(Tt,{HN:()=>h,UF:()=>jt,XW:()=>wt,dD:()=>xt,kf:()=>bt,kj:()=>S,l1:()=>L,sO:()=>ne,v_:()=>lt,yg:()=>D});var ct=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/binary.js"),ft=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/math.js"),st=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/number.js"),M=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/string.js"),A=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/error.js");const b=A.Ue("Unexpected end of array"),m=A.Ue("Integer out of Range");class U{constructor(tt){this.arr=tt,this.pos=0}}const L=Y=>new U(Y),a=Y=>Y.pos!==Y.arr.length,w=(Y,tt=Y.pos)=>{const yt=L(Y.arr);return yt.pos=tt,yt},d=(Y,tt)=>{const yt=new Uint8Array(Y.arr.buffer,Y.pos+Y.arr.byteOffset,tt);return Y.pos+=tt,yt},h=Y=>d(Y,D(Y)),O=Y=>d(Y,Y.arr.length-Y.pos),R=Y=>Y.pos++,S=Y=>Y.arr[Y.pos++],x=Y=>{const tt=Y.arr[Y.pos]+(Y.arr[Y.pos+1]<<8);return Y.pos+=2,tt},u=Y=>{const tt=Y.arr[Y.pos]+(Y.arr[Y.pos+1]<<8)+(Y.arr[Y.pos+2]<<16)+(Y.arr[Y.pos+3]<<24)>>>0;return Y.pos+=4,tt},_=Y=>{const tt=Y.arr[Y.pos+3]+(Y.arr[Y.pos+2]<<8)+(Y.arr[Y.pos+1]<<16)+(Y.arr[Y.pos]<<24)>>>0;return Y.pos+=4,tt},g=Y=>Y.arr[Y.pos],C=Y=>Y.arr[Y.pos]+(Y.arr[Y.pos+1]<<8),v=Y=>Y.arr[Y.pos]+(Y.arr[Y.pos+1]<<8)+(Y.arr[Y.pos+2]<<16)+(Y.arr[Y.pos+3]<<24)>>>0,D=Y=>{let tt=0,yt=1;const P=Y.arr.length;for(;Y.pos<P;){const y=Y.arr[Y.pos++];if(tt=tt+(y&ct.jS)*yt,yt*=128,y<ct.x1)return tt;if(tt>st.YM)throw m}throw b},H=Y=>{let tt=Y.arr[Y.pos++],yt=tt&ct.$2,P=64;const y=(tt&ct.rc)>0?-1:1;if(!(tt&ct.x1))return y*yt;const T=Y.arr.length;for(;Y.pos<T;){if(tt=Y.arr[Y.pos++],yt=yt+(tt&ct.jS)*P,P*=128,tt<ct.x1)return y*yt;if(yt>st.YM)throw m}throw b},N=Y=>{const tt=Y.pos,yt=D(Y);return Y.pos=tt,yt},j=Y=>{const tt=Y.pos,yt=H(Y);return Y.pos=tt,yt},q=Y=>{let tt=D(Y);if(tt===0)return"";{let yt=String.fromCodePoint(S(Y));if(--tt<100)for(;tt--;)yt+=String.fromCodePoint(S(Y));else for(;tt>0;){const P=tt<1e4?tt:1e4,y=Y.arr.subarray(Y.pos,Y.pos+P);Y.pos+=P,yt+=String.fromCodePoint.apply(null,y),tt-=P}return decodeURIComponent(escape(yt))}},it=Y=>M.CO.decode(h(Y)),bt=M.CO?it:q,St=Y=>{const tt=encoding.createEncoder();let yt;for(;;){if(yt=S(Y),yt===0)return encoding.toUint8Array(tt);yt===1&&(yt=S(Y)),encoding.write(tt,yt)}},Rt=Y=>string.decodeUtf8(St(Y)),Dt=Y=>{const tt=Y.pos,yt=bt(Y);return Y.pos=tt,yt},Ut=(Y,tt)=>{const yt=new DataView(Y.arr.buffer,Y.arr.byteOffset+Y.pos,tt);return Y.pos+=tt,yt},vt=Y=>Ut(Y,4).getFloat32(0,!1),te=Y=>Ut(Y,8).getFloat64(0,!1),Jt=Y=>Ut(Y,8).getBigInt64(0,!1),ot=Y=>Ut(Y,8).getBigUint64(0,!1),nt=[Y=>{},Y=>null,H,vt,te,Jt,Y=>!1,Y=>!0,bt,Y=>{const tt=D(Y),yt={};for(let P=0;P<tt;P++){const y=bt(Y);yt[y]=lt(Y)}return yt},Y=>{const tt=D(Y),yt=[];for(let P=0;P<tt;P++)yt.push(lt(Y));return yt},h],lt=Y=>nt[127-S(Y)](Y);class wt extends U{constructor(tt,yt){super(tt),this.reader=yt,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),a(this)?this.count=D(this)+1:this.count=-1),this.count--,this.s}}class _t extends null{constructor(tt,yt){super(tt),this.s=yt}read(){return this.s+=H(this),this.s}}class At extends null{constructor(tt,yt){super(tt),this.s=yt,this.count=0}read(){return this.count===0&&(this.s+=H(this),a(this)?this.count=D(this)+1:this.count=-1),this.count--,this.s}}class jt extends U{constructor(tt){super(tt),this.s=0,this.count=0}read(){if(this.count===0){this.s=H(this);const tt=ft.GR(this.s);this.count=1,tt&&(this.s=-this.s,this.count=D(this)+2)}return this.count--,this.s}}class Qt extends null{constructor(tt){super(tt),this.s=0,this.count=0}read(){if(this.count===0){this.s=H(this);const tt=math.isNegativeZero(this.s);this.count=1,tt&&(this.s=-this.s,this.count=D(this)+2)}return this.count--,this.s++}}class xt extends U{constructor(tt){super(tt),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const tt=H(this),yt=tt&1;this.diff=ft.GW(tt/2),this.count=1,yt&&(this.count=D(this)+2)}return this.s+=this.diff,this.count--,this.s}}class ne{constructor(tt){this.decoder=new jt(tt),this.str=bt(this.decoder),this.spos=0}read(){const tt=this.spos+this.decoder.read(),yt=this.str.slice(this.spos,tt);return this.spos=tt,yt}}},"../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/encoding.js":(Vt,Tt,$)=>{"use strict";$.d(Tt,{$F:()=>R,EM:()=>_t,GF:()=>At,HE:()=>ne,HK:()=>Dt,Mf:()=>m,TS:()=>P,_f:()=>w,mP:()=>Ut,sX:()=>yt,uE:()=>v,uw:()=>it});var ct=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/math.js"),ft=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/number.js"),st=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/binary.js"),M=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/string.js"),A=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/array.js");class b{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const m=()=>new b,U=y=>{const T=m();return y(T),w(T)},L=y=>{let T=y.cpos;for(let Z=0;Z<y.bufs.length;Z++)T+=y.bufs[Z].length;return T},a=y=>y.cpos>0||y.bufs.length>0,w=y=>{const T=new Uint8Array(L(y));let Z=0;for(let pt=0;pt<y.bufs.length;pt++){const n=y.bufs[pt];T.set(n,Z),Z+=n.length}return T.set(new Uint8Array(y.cbuf.buffer,0,y.cpos),Z),T},d=(y,T)=>{const Z=y.cbuf.length;Z-y.cpos<T&&(y.bufs.push(new Uint8Array(y.cbuf.buffer,0,y.cpos)),y.cbuf=new Uint8Array(ct.Fp(Z,T)*2),y.cpos=0)},h=(y,T)=>{const Z=y.cbuf.length;y.cpos===Z&&(y.bufs.push(y.cbuf),y.cbuf=new Uint8Array(Z*2),y.cpos=0),y.cbuf[y.cpos++]=T},O=(y,T,Z)=>{let pt=null;for(let n=0;n<y.bufs.length&&pt===null;n++){const r=y.bufs[n];T<r.length?pt=r:T-=r.length}pt===null&&(pt=y.cbuf),pt[T]=Z},R=h,S=null,x=(y,T)=>{h(y,T&binary.BITS8),h(y,T>>>8&binary.BITS8)},u=(y,T,Z)=>{O(y,T,Z&binary.BITS8),O(y,T+1,Z>>>8&binary.BITS8)},_=(y,T)=>{for(let Z=0;Z<4;Z++)h(y,T&binary.BITS8),T>>>=8},g=(y,T)=>{for(let Z=3;Z>=0;Z--)h(y,T>>>8*Z&binary.BITS8)},C=(y,T,Z)=>{for(let pt=0;pt<4;pt++)O(y,T+pt,Z&binary.BITS8),Z>>>=8},v=(y,T)=>{for(;T>st.jS;)h(y,st.x1|st.jS&T),T=ct.GW(T/128);h(y,st.jS&T)},D=(y,T)=>{const Z=ct.GR(T);for(Z&&(T=-T),h(y,(T>st.$2?st.x1:0)|(Z?st.rc:0)|st.$2&T),T=ct.GW(T/64);T>0;)h(y,(T>st.jS?st.x1:0)|st.jS&T),T=ct.GW(T/128)},H=new Uint8Array(3e4),N=H.length/3,j=(y,T)=>{if(T.length<N){const Z=M.YZ.encodeInto(T,H).written||0;v(y,Z);for(let pt=0;pt<Z;pt++)h(y,H[pt])}else Ut(y,M.lz(T))},q=(y,T)=>{const Z=unescape(encodeURIComponent(T)),pt=Z.length;v(y,pt);for(let n=0;n<pt;n++)h(y,Z.codePointAt(n))},it=M.YZ&&M.YZ.encodeInto?j:q,bt=(y,T)=>St(y,string.encodeUtf8(T)),St=(y,T)=>{for(let Z=0;Z<T.length;Z++){const pt=T[Z];(pt===0||pt===1)&&h(y,1),h(y,T[Z])}h(y,0)},Rt=(y,T)=>Dt(y,w(T)),Dt=(y,T)=>{const Z=y.cbuf.length,pt=y.cpos,n=ct.VV(Z-pt,T.length),r=T.length-n;y.cbuf.set(T.subarray(0,n),pt),y.cpos+=n,r>0&&(y.bufs.push(y.cbuf),y.cbuf=new Uint8Array(ct.Fp(Z*2,r)),y.cbuf.set(T.subarray(n)),y.cpos=r)},Ut=(y,T)=>{v(y,T.byteLength),Dt(y,T)},vt=(y,T)=>{d(y,T);const Z=new DataView(y.cbuf.buffer,y.cpos,T);return y.cpos+=T,Z},te=(y,T)=>vt(y,4).setFloat32(0,T,!1),Jt=(y,T)=>vt(y,8).setFloat64(0,T,!1),ot=(y,T)=>vt(y,8).setBigInt64(0,T,!1),nt=(y,T)=>vt(y,8).setBigUint64(0,T,!1),lt=new DataView(new ArrayBuffer(4)),wt=y=>(lt.setFloat32(0,y),lt.getFloat32(0)===y),_t=(y,T)=>{switch(typeof T){case"string":h(y,119),it(y,T);break;case"number":ft.U(T)&&ct.Wn(T)<=st.RP?(h(y,125),D(y,T)):wt(T)?(h(y,124),te(y,T)):(h(y,123),Jt(y,T));break;case"bigint":h(y,122),ot(y,T);break;case"object":if(T===null)h(y,126);else if(A.kJ(T)){h(y,117),v(y,T.length);for(let Z=0;Z<T.length;Z++)_t(y,T[Z])}else if(T instanceof Uint8Array)h(y,116),Ut(y,T);else{h(y,118);const Z=Object.keys(T);v(y,Z.length);for(let pt=0;pt<Z.length;pt++){const n=Z[pt];it(y,n),_t(y,T[n])}}break;case"boolean":h(y,T?120:121);break;default:h(y,127)}};class At extends b{constructor(T){super(),this.w=T,this.s=null,this.count=0}write(T){this.s===T?this.count++:(this.count>0&&v(this,this.count-1),this.count=1,this.w(this,T),this.s=T)}}class jt extends null{constructor(T){super(),this.s=T}write(T){D(this,T-this.s),this.s=T}}class Qt extends null{constructor(T){super(),this.s=T,this.count=0}write(T){this.s===T&&this.count>0?this.count++:(this.count>0&&v(this,this.count-1),this.count=1,D(this,T-this.s),this.s=T)}}const xt=y=>{y.count>0&&(D(y.encoder,y.count===1?y.s:-y.s),y.count>1&&v(y.encoder,y.count-2))};class ne{constructor(){this.encoder=new b,this.s=0,this.count=0}write(T){this.s===T?this.count++:(xt(this),this.count=1,this.s=T)}toUint8Array(){return xt(this),w(this.encoder)}}class Y{constructor(){this.encoder=new b,this.s=0,this.count=0}write(T){this.s+this.count===T?this.count++:(xt(this),this.count=1,this.s=T)}toUint8Array(){return xt(this),w(this.encoder)}}const tt=y=>{if(y.count>0){const T=y.diff*2+(y.count===1?0:1);D(y.encoder,T),y.count>1&&v(y.encoder,y.count-2)}};class yt{constructor(){this.encoder=new b,this.s=0,this.count=0,this.diff=0}write(T){this.diff===T-this.s?(this.s=T,this.count++):(tt(this),this.count=1,this.diff=T-this.s,this.s=T)}toUint8Array(){return tt(this),w(this.encoder)}}class P{constructor(){this.sarr=[],this.s="",this.lensE=new ne}write(T){this.s+=T,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(T.length)}toUint8Array(){const T=new b;return this.sarr.push(this.s),this.s="",it(T,this.sarr.join("")),Dt(T,this.lensE.toUint8Array()),w(T)}}},"../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/environment.js":(Vt,Tt,$)=>{"use strict";$.d(Tt,{E0:()=>R,jU:()=>U,hH:()=>g});var ct=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/map.js"),ft=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/string.js");const st=C=>C===void 0?null:C;var M=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/storage.js"),A=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/function.js"),b=$("../../../node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js");const m=typeof b!="undefined"&&b.release&&/node|io\.js/.test(b.release.name)&&Object.prototype.toString.call(typeof b!="undefined"?b:0)==="[object process]",U=typeof window!="undefined"&&typeof document!="undefined"&&!m,L=typeof navigator!="undefined"?/Mac/.test(navigator.platform):!1;let a;const w=[],d=()=>{if(a===void 0)if(m){a=ct.Ue();const C=b.argv;let v=null;for(let D=0;D<C.length;D++){const H=C[D];H[0]==="-"?(v!==null&&a.set(v,""),v=H):v!==null?(a.set(v,H),v=null):w.push(H)}v!==null&&a.set(v,"")}else typeof location=="object"?(a=ct.Ue(),(location.search||"?").slice(1).split("&").forEach(C=>{if(C.length!==0){const[v,D]=C.split("=");a.set(`--${ft.NF(v,"-")}`,D),a.set(`-${ft.NF(v,"-")}`,D)}})):a=ct.Ue();return a},h=C=>d().has(C),O=(C,v)=>d().get(C)||v,R=C=>st(m?b.env[C.toUpperCase()]:M.XN.getItem(C)),S=C=>d().get("--"+C)||R(C),u=(C=>h("--"+C)||R(C)!==null)("production"),_=m&&A.gB(b.env.FORCE_COLOR,["true","1","2"]),g=!h("no-colors")&&(!m||b.stdout.isTTY||_)&&(!m||h("color")||_||R("COLORTERM")!==null||(R("TERM")||"").includes("color"))},"../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/error.js":(Vt,Tt,$)=>{"use strict";$.d(Tt,{Nw:()=>ft,Ue:()=>ct,zR:()=>st});const ct=M=>new Error(M),ft=()=>{throw ct("Method unimplemented")},st=()=>{throw ct("Unexpected case")}},"../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/function.js":(Vt,Tt,$)=>{"use strict";$.d(Tt,{Hi:()=>L,PP:()=>st,WY:()=>M,gB:()=>a,id:()=>b});var ct=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/array.js"),ft=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/object.js");const st=(S,x,u=0)=>{try{for(;u<S.length;u++)S[u](...x)}finally{u<S.length&&st(S,x,u+1)}},M=()=>{},A=S=>S(),b=S=>S,m=(S,x)=>S===x,U=(S,x)=>S===x||S!=null&&x!=null&&S.constructor===x.constructor&&(array.isArray(S)&&array.equalFlat(S,x)||typeof S=="object"&&object.equalFlat(S,x)),L=(S,x)=>{if(S==null||x==null)return m(S,x);if(S.constructor!==x.constructor)return!1;if(S===x)return!0;switch(S.constructor){case ArrayBuffer:S=new Uint8Array(S),x=new Uint8Array(x);case Uint8Array:{if(S.byteLength!==x.byteLength)return!1;for(let u=0;u<S.length;u++)if(S[u]!==x[u])return!1;break}case Set:{if(S.size!==x.size)return!1;for(const u of S)if(!x.has(u))return!1;break}case Map:{if(S.size!==x.size)return!1;for(const u of S.keys())if(!x.has(u)||!L(S.get(u),x.get(u)))return!1;break}case Object:if(ft.kE(S)!==ft.kE(x))return!1;for(const u in S)if(!ft.l$(S,u)||!L(S[u],x[u]))return!1;break;case Array:if(S.length!==x.length)return!1;for(let u=0;u<S.length;u++)if(!L(S[u],x[u]))return!1;break;default:return!1}return!0},a=(S,x)=>x.includes(S),w=ct.kJ,d=S=>S&&S.constructor===String,h=S=>S!=null&&S.constructor===Number,O=(S,x)=>S&&S.constructor===x,R=S=>x=>x&&x.constructor===S},"../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/logging.common.js":(Vt,Tt,$)=>{"use strict";$.d(Tt,{Ej:()=>U,Pl:()=>b,ZA:()=>a,s7:()=>L,ud:()=>h,Wd:()=>d,hM:()=>w,YW:()=>m,WO:()=>O,_X:()=>R,YX:()=>_});const ct=Symbol,ft=g=>typeof g=="symbol";var st=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/time.js"),M=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/environment.js"),A=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/function.js");const b=ct(),m=ct(),U=ct(),L=ct(),a=ct(),w=ct(),d=ct(),h=ct(),O=ct(),R=g=>{const C=[],v=[];let D=0;for(;D<g.length;D++){const H=g[D];H.constructor===String||H.constructor===Number?C.push(H):H.constructor===Object&&v.push(JSON.stringify(H))}return v},S=[a,d,h,U];let x=0,u=st.ZG();const _=(g,C)=>{const v=S[x],D=M.E0("log"),H=D!==null&&(D==="*"||D==="true"||new RegExp(D,"gi").test(C));return x=(x+1)%S.length,C+=": ",H?(...N)=>{const j=st.ZG(),q=j-u;u=j,g(v,C,O,...N.map(it=>typeof it=="string"||typeof it=="symbol"?it:JSON.stringify(it)),v," +"+q+"ms")}:A.WY}},"../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/logging.js":(Vt,Tt,$)=>{"use strict";$.d(Tt,{YX:()=>ie,S0:()=>T});var ct=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/environment.js"),ft=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/set.js");class st{constructor(rt,mt){this.left=rt,this.right=mt}}const M=(J,rt)=>new st(J,rt),A=(J,rt)=>new st(rt,J),b=(J,rt)=>J.forEach(mt=>rt(mt.left,mt.right)),m=(J,rt)=>J.map(mt=>rt(mt.left,mt.right));var U=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/map.js");const L=typeof document!="undefined"?document:{},a=J=>L.createElement(J),w=()=>L.createDocumentFragment(),d=J=>L.createTextNode(J),h=typeof DOMParser!="undefined"?new DOMParser:null,O=(J,rt,mt)=>J.dispatchEvent(new CustomEvent(rt,mt)),R=(J,rt)=>(pair.forEach(rt,(mt,gt)=>{gt===!1?J.removeAttribute(mt):gt===!0?J.setAttribute(mt,""):J.setAttribute(mt,gt)}),J),S=(J,rt)=>(rt.forEach((mt,gt)=>{J.setAttribute(gt,mt)}),J),x=J=>{const rt=w();for(let mt=0;mt<J.length;mt++)nt(rt,J[mt]);return rt},u=(J,rt)=>(nt(J,x(rt)),J),_=J=>J.remove(),g=(J,rt,mt)=>J.addEventListener(rt,mt),C=(J,rt,mt)=>J.removeEventListener(rt,mt),v=(J,rt)=>(pair.forEach(rt,(mt,gt)=>g(J,mt,gt)),J),D=(J,rt)=>(pair.forEach(rt,(mt,gt)=>C(J,mt,gt)),J),H=(J,rt=[],mt=[])=>u(R(a(J),rt),mt),N=(J,rt)=>{const mt=a("canvas");return mt.height=rt,mt.width=J,mt},j=null,q=J=>`${J.left}:${J.right};`,it=J=>J.map(q).join(""),bt=J=>U.UI(J,(rt,mt)=>`${mt}:${rt};`).join(""),St=(J,rt)=>J.querySelector(rt),Rt=(J,rt)=>J.querySelectorAll(rt),Dt=J=>L.getElementById(J),Ut=J=>h.parseFromString(`<html><body>${J}</body></html>`,"text/html").body,vt=J=>x(Ut(J).childNodes),te=J=>Ut(J).firstElementChild,Jt=(J,rt)=>J.replaceWith(rt),ot=(J,rt,mt)=>J.insertBefore(rt,mt),nt=(J,rt)=>J.appendChild(rt),lt=L.ELEMENT_NODE,wt=L.TEXT_NODE,_t=L.CDATA_SECTION_NODE,At=L.COMMENT_NODE,jt=L.DOCUMENT_NODE,Qt=L.DOCUMENT_TYPE_NODE,xt=L.DOCUMENT_FRAGMENT_NODE,ne=(J,rt)=>J.nodeType===rt,Y=(J,rt)=>{let mt=rt.parentNode;for(;mt&&mt!==J;)mt=mt.parentNode;return mt===J};var tt=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/logging.common.js");const yt={[tt.Pl]:M("font-weight","bold"),[tt.YW]:M("font-weight","normal"),[tt.Ej]:M("color","blue"),[tt.ZA]:M("color","green"),[tt.s7]:M("color","grey"),[tt.hM]:M("color","red"),[tt.Wd]:M("color","purple"),[tt.ud]:M("color","orange"),[tt.WO]:M("color","black")},P=J=>{const rt=[],mt=[],gt=U.Ue();let Pt=[],Xt=0;for(;Xt<J.length;Xt++){const Gt=J[Xt],ce=yt[Gt];if(ce!==void 0)gt.set(ce.left,ce.right);else if(Gt.constructor===String||Gt.constructor===Number){const Se=bt(gt);Xt>0||Se.length>0?(rt.push("%c"+Gt),mt.push(Se)):rt.push(Gt)}else break}for(Xt>0&&(Pt=mt,Pt.unshift(rt.join("")));Xt<J.length;Xt++){const Gt=J[Xt];Gt instanceof Symbol||Pt.push(Gt)}return Pt},y=ct.hH?P:tt._X,T=(...J)=>{console.log(...y(J)),kt.forEach(rt=>rt.print(J))},Z=(...J)=>{console.warn(...y(J)),J.unshift(common.ORANGE),kt.forEach(rt=>rt.print(J))},pt=J=>{console.error(J),kt.forEach(rt=>rt.printError(J))},n=(J,rt)=>{env.isBrowser&&console.log("%c                      ",`font-size: ${rt}px; background-size: contain; background-repeat: no-repeat; background-image: url(${J})`),kt.forEach(mt=>mt.printImg(J,rt))},r=(J,rt)=>n(`data:image/gif;base64,${J}`,rt),c=(...J)=>{console.group(...y(J)),kt.forEach(rt=>rt.group(J))},k=(...J)=>{console.groupCollapsed(...y(J)),kt.forEach(rt=>rt.groupCollapsed(J))},G=()=>{console.groupEnd(),kt.forEach(J=>J.groupEnd())},z=J=>kt.forEach(rt=>rt.printDom(J())),at=(J,rt)=>n(J.toDataURL(),rt),kt=ft.Ue(),Ft=J=>{const rt=[],mt=new Map;let gt=0;for(;gt<J.length;gt++){const Pt=J[gt],Xt=yt[Pt];if(Xt!==void 0)mt.set(Xt.left,Xt.right);else if(Pt.constructor===String||Pt.constructor===Number){const Gt=dom.element("span",[pair.create("style",dom.mapToStyleString(mt))],[dom.text(Pt.toString())]);Gt.innerHTML===""&&(Gt.innerHTML="&nbsp;"),rt.push(Gt)}else break}for(;gt<J.length;gt++){let Pt=J[gt];Pt instanceof Symbol||(Pt.constructor!==String&&Pt.constructor!==Number&&(Pt=" "+json.stringify(Pt)+" "),rt.push(dom.element("span",[],[dom.text(Pt)])))}return rt},Lt="font-family:monospace;border-bottom:1px solid #e2e2e2;padding:2px;";class It{constructor(rt){this.dom=rt,this.ccontainer=this.dom,this.depth=0,kt.add(this)}group(rt,mt=!1){eventloop.enqueue(()=>{const gt=dom.element("span",[pair.create("hidden",mt),pair.create("style","color:grey;font-size:120%;")],[dom.text("\u25BC")]),Pt=dom.element("span",[pair.create("hidden",!mt),pair.create("style","color:grey;font-size:125%;")],[dom.text("\u25B6")]),Xt=dom.element("div",[pair.create("style",`${Lt};padding-left:${this.depth*10}px`)],[gt,Pt,dom.text(" ")].concat(Ft(rt))),Gt=dom.element("div",[pair.create("hidden",mt)]),ce=dom.element("div",[],[Xt,Gt]);dom.append(this.ccontainer,[ce]),this.ccontainer=Gt,this.depth++,dom.addEventListener(Xt,"click",Se=>{Gt.toggleAttribute("hidden"),gt.toggleAttribute("hidden"),Pt.toggleAttribute("hidden")})})}groupCollapsed(rt){this.group(rt,!0)}groupEnd(){eventloop.enqueue(()=>{this.depth>0&&(this.depth--,this.ccontainer=this.ccontainer.parentElement.parentElement)})}print(rt){eventloop.enqueue(()=>{dom.append(this.ccontainer,[dom.element("div",[pair.create("style",`${Lt};padding-left:${this.depth*10}px`)],Ft(rt))])})}printError(rt){this.print([common.RED,common.BOLD,rt.toString()])}printImg(rt,mt){eventloop.enqueue(()=>{dom.append(this.ccontainer,[dom.element("img",[pair.create("src",rt),pair.create("height",`${math.round(mt*1.5)}px`)])])})}printDom(rt){eventloop.enqueue(()=>{dom.append(this.ccontainer,[rt])})}destroy(){eventloop.enqueue(()=>{kt.delete(this)})}}const Mt=J=>new It(J),ie=J=>tt.YX(T,J)},"../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/map.js":(Vt,Tt,$)=>{"use strict";$.d(Tt,{JG:()=>ft,UI:()=>M,Ue:()=>ct,Yj:()=>A,Yu:()=>st});const ct=()=>new Map,ft=m=>{const U=ct();return m.forEach((L,a)=>{U.set(a,L)}),U},st=(m,U,L)=>{let a=m.get(U);return a===void 0&&m.set(U,a=L()),a},M=(m,U)=>{const L=[];for(const[a,w]of m)L.push(U(w,a));return L},A=(m,U)=>{for(const[L,a]of m)if(U(a,L))return!0;return!1},b=(m,U)=>{for(const[L,a]of m)if(!U(a,L))return!1;return!0}},"../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/math.js":(Vt,Tt,$)=>{"use strict";$.d(Tt,{Fp:()=>d,GR:()=>x,GW:()=>ct,VV:()=>w,Wn:()=>st,mv:()=>b});const ct=Math.floor,ft=Math.ceil,st=Math.abs,M=Math.imul,A=Math.round,b=Math.log10,m=Math.log2,U=Math.log,L=Math.sqrt,a=(u,_)=>u+_,w=(u,_)=>u<_?u:_,d=(u,_)=>u>_?u:_,h=Number.isNaN,O=Math.pow,R=u=>Math.pow(10,u),S=Math.sign,x=u=>u!==0?u<0:1/u<0},"../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/number.js":(Vt,Tt,$)=>{"use strict";$.d(Tt,{U:()=>U,YM:()=>st});var ct=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/math.js"),ft=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/binary.js");const st=Number.MAX_SAFE_INTEGER,M=Number.MIN_SAFE_INTEGER,A=null,b=ft.RP,m=ft.Tg,U=Number.isInteger||(d=>typeof d=="number"&&isFinite(d)&&ct.GW(d)===d),L=Number.isNaN,a=Number.parseInt,w=d=>{d&=binary.BITS32;let h=0;for(;d;)d&=d-1,h++;return h}},"../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/object.js":(Vt,Tt,$)=>{"use strict";$.d(Tt,{$m:()=>w,Ed:()=>M,f0:()=>ft,kE:()=>b,l$:()=>a,xb:()=>U});const ct=()=>Object.create(null),ft=Object.assign,st=Object.keys,M=(d,h)=>{for(const O in d)h(d[O],O)},A=(d,h)=>{const O=[];for(const R in d)O.push(h(d[R],R));return O},b=d=>st(d).length,m=(d,h)=>{for(const O in d)if(h(d[O],O))return!0;return!1},U=d=>{for(const h in d)return!1;return!0},L=(d,h)=>{for(const O in d)if(!h(d[O],O))return!1;return!0},a=(d,h)=>Object.prototype.hasOwnProperty.call(d,h),w=(d,h)=>d===h||b(d)===b(h)&&L(d,(O,R)=>(O!==void 0||a(h,R))&&h[R]===O)},"../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/observable.js":(Vt,Tt,$)=>{"use strict";$.d(Tt,{y:()=>A});var ct=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/map.js"),ft=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/set.js"),st=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/array.js");class M{constructor(){this._observers=map.create()}on(m,U){return map.setIfUndefined(this._observers,m,set.create).add(U),U}once(m,U){const L=(...a)=>{this.off(m,L),U(...a)};this.on(m,L)}off(m,U){const L=this._observers.get(m);L!==void 0&&(L.delete(U),L.size===0&&this._observers.delete(m))}emit(m,U){return array.from((this._observers.get(m)||map.create()).values()).forEach(L=>L(...U))}destroy(){this._observers=map.create()}}class A{constructor(){this._observers=ct.Ue()}on(m,U){ct.Yu(this._observers,m,ft.Ue).add(U)}once(m,U){const L=(...a)=>{this.off(m,L),U(...a)};this.on(m,L)}off(m,U){const L=this._observers.get(m);L!==void 0&&(L.delete(U),L.size===0&&this._observers.delete(m))}emit(m,U){return st.Dp((this._observers.get(m)||ct.Ue()).values()).forEach(L=>L(...U))}destroy(){this._observers=ct.Ue()}}},"../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/promise.js":(Vt,Tt,$)=>{"use strict";$.d(Tt,{DB:()=>A,Ue:()=>ct,d1:()=>M});const ct=a=>new Promise(a),ft=a=>new Promise(a),st=Promise.all.bind(Promise),M=a=>Promise.reject(a),A=a=>Promise.resolve(a),b=a=>Promise.resolve(a),m=(a,w,d=10)=>ct((h,O)=>{const R=time.getUnixTime(),S=a>0,u=setInterval(()=>{w()?(clearInterval(u),h()):S&&time.getUnixTime()-R>a&&(clearInterval(u),O(new Error("Timeout")))},d)}),U=a=>ct((w,d)=>setTimeout(w,a)),L=a=>a instanceof Promise||a&&a.then&&a.catch&&a.finally},"../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/random.js":(Vt,Tt,$)=>{"use strict";$.d(Tt,{TN:()=>st,U7:()=>M,k$:()=>U});const ct=crypto.subtle,ft=crypto.getRandomValues.bind(crypto),st=Math.random,M=()=>ft(new Uint32Array(1))[0],A=()=>{const L=getRandomValues(new Uint32Array(8));return(L[0]&binary.BITS21)*(binary.BITS32+1)+(L[1]>>>0)},b=L=>L[math.floor(st()*L.length)],m=[1e7]+-1e3+-4e3+-8e3+-1e11,U=()=>m.replace(/[018]/g,L=>(L^M()&15>>L/4).toString(16))},"../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/set.js":(Vt,Tt,$)=>{"use strict";$.d(Tt,{Ue:()=>ct});const ct=()=>new Set,ft=A=>Array.from(A),st=A=>A.values().next().value||void 0,M=A=>new Set(A)},"../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/storage.js":(Vt,Tt,$)=>{"use strict";$.d(Tt,{F:()=>b,XN:()=>M,z2:()=>A});class ct{constructor(){this.map=new Map}setItem(U,L){this.map.set(U,L)}getItem(U){return this.map.get(U)}}let ft=new ct,st=!0;try{typeof localStorage!="undefined"&&localStorage&&(ft=localStorage,st=!1)}catch(m){}const M=ft,A=m=>st||addEventListener("storage",m),b=m=>st||removeEventListener("storage",m)},"../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/string.js":(Vt,Tt,$)=>{"use strict";$.d(Tt,{CO:()=>R,IK:()=>ct,NF:()=>U,YZ:()=>w,lz:()=>h});const ct=String.fromCharCode,ft=String.fromCodePoint,st=ct(65535),M=g=>g.toLowerCase(),A=/^\s*/g,b=g=>g.replace(A,""),m=/([A-Z])/g,U=(g,C)=>b(g.replace(m,v=>`${C}${M(v)}`)),L=g=>unescape(encodeURIComponent(g)).length,a=g=>{const C=unescape(encodeURIComponent(g)),v=C.length,D=new Uint8Array(v);for(let H=0;H<v;H++)D[H]=C.codePointAt(H);return D},w=typeof TextEncoder!="undefined"?new TextEncoder:null,h=w?g=>w.encode(g):a,O=g=>{let C=g.length,v="",D=0;for(;C>0;){const H=C<1e4?C:1e4,N=g.subarray(D,D+H);D+=H,v+=String.fromCodePoint.apply(null,N),C-=H}return decodeURIComponent(escape(v))};let R=typeof TextDecoder=="undefined"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});R&&R.decode(new Uint8Array).length===1&&(R=null);const S=g=>R.decode(g),x=null,u=(g,C,v,D="")=>g.slice(0,C)+D+g.slice(C+v),_=(g,C)=>array.unfold(C,()=>g).join("")},"../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/time.js":(Vt,Tt,$)=>{"use strict";$.d(Tt,{ZG:()=>ft});const ct=()=>new Date,ft=Date.now,st=M=>{if(M<6e4){const L=metric.prefix(M,-1);return math.round(L.n*100)/100+L.prefix+"s"}M=math.floor(M/1e3);const A=M%60,b=math.floor(M/60)%60,m=math.floor(M/3600)%24,U=math.floor(M/86400);return U>0?U+"d"+(m>0||b>30?" "+(b>30?m+1:m)+"h":""):m>0?m+"h"+(b>0||A>30?" "+(A>30?b+1:b)+"min":""):b+"min"+(A>0?" "+A+"s":"")}},"../../../node_modules/.pnpm/simple-peer@9.11.1/node_modules/simple-peer/simplepeer.min.js":(Vt,Tt,$)=>{(function(ct){if(!0)Vt.exports=ct();else var ft})(function(){var ct=Math.floor,ft=Math.abs,st=Math.pow;return function(){function M(A,b,m){function U(w,d){if(!b[w]){if(!A[w]){var h=void 0;if(!d&&h)return require(w,!0);if(L)return L(w,!0);var O=new Error("Cannot find module '"+w+"'");throw O.code="MODULE_NOT_FOUND",O}var R=b[w]={exports:{}};A[w][0].call(R.exports,function(S){var x=A[w][1][S];return U(x||S)},R,R.exports,M,A,b,m)}return b[w].exports}for(var L=void 0,a=0;a<m.length;a++)U(m[a]);return U}return M}()({1:[function(M,A,b){"use strict";function m(_){var g=_.length;if(0<g%4)throw new Error("Invalid string. Length must be a multiple of 4");var C=_.indexOf("=");C===-1&&(C=g);var v=C===g?0:4-C%4;return[C,v]}function U(_,g,C){return 3*(g+C)/4-C}function L(_){var g,C,v=m(_),D=v[0],H=v[1],N=new R(U(_,D,H)),j=0,q=0<H?D-4:D;for(C=0;C<q;C+=4)g=O[_.charCodeAt(C)]<<18|O[_.charCodeAt(C+1)]<<12|O[_.charCodeAt(C+2)]<<6|O[_.charCodeAt(C+3)],N[j++]=255&g>>16,N[j++]=255&g>>8,N[j++]=255&g;return H===2&&(g=O[_.charCodeAt(C)]<<2|O[_.charCodeAt(C+1)]>>4,N[j++]=255&g),H===1&&(g=O[_.charCodeAt(C)]<<10|O[_.charCodeAt(C+1)]<<4|O[_.charCodeAt(C+2)]>>2,N[j++]=255&g>>8,N[j++]=255&g),N}function a(_){return h[63&_>>18]+h[63&_>>12]+h[63&_>>6]+h[63&_]}function w(_,g,C){for(var v,D=[],H=g;H<C;H+=3)v=(16711680&_[H]<<16)+(65280&_[H+1]<<8)+(255&_[H+2]),D.push(a(v));return D.join("")}function d(_){for(var g,C=_.length,v=C%3,D=[],H=16383,N=0,j=C-v;N<j;N+=H)D.push(w(_,N,N+H>j?j:N+H));return v===1?(g=_[C-1],D.push(h[g>>2]+h[63&g<<4]+"==")):v===2&&(g=(_[C-2]<<8)+_[C-1],D.push(h[g>>10]+h[63&g>>4]+h[63&g<<2]+"=")),D.join("")}b.byteLength=function(_){var g=m(_),C=g[0],v=g[1];return 3*(C+v)/4-v},b.toByteArray=L,b.fromByteArray=d;for(var h=[],O=[],R=typeof Uint8Array=="undefined"?Array:Uint8Array,S="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",x=0,u=S.length;x<u;++x)h[x]=S[x],O[S.charCodeAt(x)]=x;O[45]=62,O[95]=63},{}],2:[function(){},{}],3:[function(M,A,b){(function(){(function(){/*!
* The buffer module from node.js, for the browser.
*
* @author   Feross Aboukhadijeh <https://feross.org>
* @license  MIT
*/"use strict";var m=String.fromCharCode,U=Math.min;function L(n){if(2147483647<n)throw new RangeError('The value "'+n+'" is invalid for option "size"');var r=new Uint8Array(n);return r.__proto__=a.prototype,r}function a(n,r,c){if(typeof n=="number"){if(typeof r=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return O(n)}return w(n,r,c)}function w(n,r,c){if(typeof n=="string")return R(n,r);if(ArrayBuffer.isView(n))return S(n);if(n==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof n);if(P(n,ArrayBuffer)||n&&P(n.buffer,ArrayBuffer))return x(n,r,c);if(typeof n=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var k=n.valueOf&&n.valueOf();if(k!=null&&k!==n)return a.from(k,r,c);var G=u(n);if(G)return G;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof n[Symbol.toPrimitive]=="function")return a.from(n[Symbol.toPrimitive]("string"),r,c);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof n)}function d(n){if(typeof n!="number")throw new TypeError('"size" argument must be of type number');if(0>n)throw new RangeError('The value "'+n+'" is invalid for option "size"')}function h(n,r,c){return d(n),0>=n||r===void 0?L(n):typeof c=="string"?L(n).fill(r,c):L(n).fill(r)}function O(n){return d(n),L(0>n?0:0|_(n))}function R(n,r){if((typeof r!="string"||r==="")&&(r="utf8"),!a.isEncoding(r))throw new TypeError("Unknown encoding: "+r);var c=0|g(n,r),k=L(c),G=k.write(n,r);return G!==c&&(k=k.slice(0,G)),k}function S(n){for(var r=0>n.length?0:0|_(n.length),c=L(r),k=0;k<r;k+=1)c[k]=255&n[k];return c}function x(n,r,c){if(0>r||n.byteLength<r)throw new RangeError('"offset" is outside of buffer bounds');if(n.byteLength<r+(c||0))throw new RangeError('"length" is outside of buffer bounds');var k;return k=r===void 0&&c===void 0?new Uint8Array(n):c===void 0?new Uint8Array(n,r):new Uint8Array(n,r,c),k.__proto__=a.prototype,k}function u(n){if(a.isBuffer(n)){var r=0|_(n.length),c=L(r);return c.length===0||n.copy(c,0,0,r),c}return n.length===void 0?n.type==="Buffer"&&Array.isArray(n.data)?S(n.data):void 0:typeof n.length!="number"||y(n.length)?L(0):S(n)}function _(n){if(n>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|n}function g(n,r){if(a.isBuffer(n))return n.length;if(ArrayBuffer.isView(n)||P(n,ArrayBuffer))return n.byteLength;if(typeof n!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof n);var c=n.length,k=2<arguments.length&&arguments[2]===!0;if(!k&&c===0)return 0;for(var G=!1;;)switch(r){case"ascii":case"latin1":case"binary":return c;case"utf8":case"utf-8":return xt(n).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*c;case"hex":return c>>>1;case"base64":return tt(n).length;default:if(G)return k?-1:xt(n).length;r=(""+r).toLowerCase(),G=!0}}function C(n,r,c){var k=!1;if((r===void 0||0>r)&&(r=0),r>this.length||((c===void 0||c>this.length)&&(c=this.length),0>=c)||(c>>>=0,r>>>=0,c<=r))return"";for(n||(n="utf8");;)switch(n){case"hex":return Jt(this,r,c);case"utf8":case"utf-8":return Dt(this,r,c);case"ascii":return vt(this,r,c);case"latin1":case"binary":return te(this,r,c);case"base64":return Rt(this,r,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ot(this,r,c);default:if(k)throw new TypeError("Unknown encoding: "+n);n=(n+"").toLowerCase(),k=!0}}function v(n,r,c){var k=n[r];n[r]=n[c],n[c]=k}function D(n,r,c,k,G){if(n.length===0)return-1;if(typeof c=="string"?(k=c,c=0):2147483647<c?c=2147483647:-2147483648>c&&(c=-2147483648),c=+c,y(c)&&(c=G?0:n.length-1),0>c&&(c=n.length+c),c>=n.length){if(G)return-1;c=n.length-1}else if(0>c)if(G)c=0;else return-1;if(typeof r=="string"&&(r=a.from(r,k)),a.isBuffer(r))return r.length===0?-1:H(n,r,c,k,G);if(typeof r=="number")return r&=255,typeof Uint8Array.prototype.indexOf=="function"?G?Uint8Array.prototype.indexOf.call(n,r,c):Uint8Array.prototype.lastIndexOf.call(n,r,c):H(n,[r],c,k,G);throw new TypeError("val must be string, number or Buffer")}function H(n,r,c,k,G){function z(J,rt){return at===1?J[rt]:J.readUInt16BE(rt*at)}var at=1,kt=n.length,Ft=r.length;if(k!==void 0&&(k=(k+"").toLowerCase(),k==="ucs2"||k==="ucs-2"||k==="utf16le"||k==="utf-16le")){if(2>n.length||2>r.length)return-1;at=2,kt/=2,Ft/=2,c/=2}var Lt;if(G){var It=-1;for(Lt=c;Lt<kt;Lt++)if(z(n,Lt)!==z(r,It===-1?0:Lt-It))It!==-1&&(Lt-=Lt-It),It=-1;else if(It===-1&&(It=Lt),Lt-It+1===Ft)return It*at}else for(c+Ft>kt&&(c=kt-Ft),Lt=c;0<=Lt;Lt--){for(var Mt=!0,ie=0;ie<Ft;ie++)if(z(n,Lt+ie)!==z(r,ie)){Mt=!1;break}if(Mt)return Lt}return-1}function N(n,r,c,k){c=+c||0;var G=n.length-c;k?(k=+k,k>G&&(k=G)):k=G;var z=r.length;k>z/2&&(k=z/2);for(var at,kt=0;kt<k;++kt){if(at=parseInt(r.substr(2*kt,2),16),y(at))return kt;n[c+kt]=at}return kt}function j(n,r,c,k){return yt(xt(r,n.length-c),n,c,k)}function q(n,r,c,k){return yt(ne(r),n,c,k)}function it(n,r,c,k){return q(n,r,c,k)}function bt(n,r,c,k){return yt(tt(r),n,c,k)}function St(n,r,c,k){return yt(Y(r,n.length-c),n,c,k)}function Rt(n,r,c){return r===0&&c===n.length?T.fromByteArray(n):T.fromByteArray(n.slice(r,c))}function Dt(n,r,c){c=U(n.length,c);for(var k=[],G=r;G<c;){var z=n[G],at=null,kt=239<z?4:223<z?3:191<z?2:1;if(G+kt<=c){var Ft,Lt,It,Mt;kt===1?128>z&&(at=z):kt===2?(Ft=n[G+1],(192&Ft)==128&&(Mt=(31&z)<<6|63&Ft,127<Mt&&(at=Mt))):kt===3?(Ft=n[G+1],Lt=n[G+2],(192&Ft)==128&&(192&Lt)==128&&(Mt=(15&z)<<12|(63&Ft)<<6|63&Lt,2047<Mt&&(55296>Mt||57343<Mt)&&(at=Mt))):kt===4&&(Ft=n[G+1],Lt=n[G+2],It=n[G+3],(192&Ft)==128&&(192&Lt)==128&&(192&It)==128&&(Mt=(15&z)<<18|(63&Ft)<<12|(63&Lt)<<6|63&It,65535<Mt&&1114112>Mt&&(at=Mt)))}at===null?(at=65533,kt=1):65535<at&&(at-=65536,k.push(55296|1023&at>>>10),at=56320|1023&at),k.push(at),G+=kt}return Ut(k)}function Ut(n){var r=n.length;if(r<=4096)return m.apply(String,n);for(var c="",k=0;k<r;)c+=m.apply(String,n.slice(k,k+=4096));return c}function vt(n,r,c){var k="";c=U(n.length,c);for(var G=r;G<c;++G)k+=m(127&n[G]);return k}function te(n,r,c){var k="";c=U(n.length,c);for(var G=r;G<c;++G)k+=m(n[G]);return k}function Jt(n,r,c){var k=n.length;(!r||0>r)&&(r=0),(!c||0>c||c>k)&&(c=k);for(var G="",z=r;z<c;++z)G+=Qt(n[z]);return G}function ot(n,r,c){for(var k=n.slice(r,c),G="",z=0;z<k.length;z+=2)G+=m(k[z]+256*k[z+1]);return G}function nt(n,r,c){if(n%1!=0||0>n)throw new RangeError("offset is not uint");if(n+r>c)throw new RangeError("Trying to access beyond buffer length")}function lt(n,r,c,k,G,z){if(!a.isBuffer(n))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>G||r<z)throw new RangeError('"value" argument is out of bounds');if(c+k>n.length)throw new RangeError("Index out of range")}function wt(n,r,c,k){if(c+k>n.length)throw new RangeError("Index out of range");if(0>c)throw new RangeError("Index out of range")}function _t(n,r,c,k,G){return r=+r,c>>>=0,G||wt(n,r,c,4,34028234663852886e22,-34028234663852886e22),Z.write(n,r,c,k,23,4),c+4}function At(n,r,c,k,G){return r=+r,c>>>=0,G||wt(n,r,c,8,17976931348623157e292,-17976931348623157e292),Z.write(n,r,c,k,52,8),c+8}function jt(n){if(n=n.split("=")[0],n=n.trim().replace(pt,""),2>n.length)return"";for(;n.length%4!=0;)n+="=";return n}function Qt(n){return 16>n?"0"+n.toString(16):n.toString(16)}function xt(n,r){r=r||1/0;for(var c,k=n.length,G=null,z=[],at=0;at<k;++at){if(c=n.charCodeAt(at),55295<c&&57344>c){if(!G){if(56319<c){-1<(r-=3)&&z.push(239,191,189);continue}else if(at+1===k){-1<(r-=3)&&z.push(239,191,189);continue}G=c;continue}if(56320>c){-1<(r-=3)&&z.push(239,191,189),G=c;continue}c=(G-55296<<10|c-56320)+65536}else G&&-1<(r-=3)&&z.push(239,191,189);if(G=null,128>c){if(0>(r-=1))break;z.push(c)}else if(2048>c){if(0>(r-=2))break;z.push(192|c>>6,128|63&c)}else if(65536>c){if(0>(r-=3))break;z.push(224|c>>12,128|63&c>>6,128|63&c)}else if(1114112>c){if(0>(r-=4))break;z.push(240|c>>18,128|63&c>>12,128|63&c>>6,128|63&c)}else throw new Error("Invalid code point")}return z}function ne(n){for(var r=[],c=0;c<n.length;++c)r.push(255&n.charCodeAt(c));return r}function Y(n,r){for(var c,k,G,z=[],at=0;at<n.length&&!(0>(r-=2));++at)c=n.charCodeAt(at),k=c>>8,G=c%256,z.push(G),z.push(k);return z}function tt(n){return T.toByteArray(jt(n))}function yt(n,r,c,k){for(var G=0;G<k&&!(G+c>=r.length||G>=n.length);++G)r[G+c]=n[G];return G}function P(n,r){return n instanceof r||n!=null&&n.constructor!=null&&n.constructor.name!=null&&n.constructor.name===r.name}function y(n){return n!==n}var T=M("base64-js"),Z=M("ieee754");b.Buffer=a,b.SlowBuffer=function(n){return+n!=n&&(n=0),a.alloc(+n)},b.INSPECT_MAX_BYTES=50,b.kMaxLength=2147483647,a.TYPED_ARRAY_SUPPORT=function(){try{var n=new Uint8Array(1);return n.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},n.foo()===42}catch(r){return!1}}(),a.TYPED_ARRAY_SUPPORT||typeof console=="undefined"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){return a.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){return a.isBuffer(this)?this.byteOffset:void 0}}),typeof Symbol!="undefined"&&Symbol.species!=null&&a[Symbol.species]===a&&Object.defineProperty(a,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),a.poolSize=8192,a.from=function(n,r,c){return w(n,r,c)},a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array,a.alloc=function(n,r,c){return h(n,r,c)},a.allocUnsafe=function(n){return O(n)},a.allocUnsafeSlow=function(n){return O(n)},a.isBuffer=function(n){return n!=null&&n._isBuffer===!0&&n!==a.prototype},a.compare=function(n,r){if(P(n,Uint8Array)&&(n=a.from(n,n.offset,n.byteLength)),P(r,Uint8Array)&&(r=a.from(r,r.offset,r.byteLength)),!a.isBuffer(n)||!a.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(n===r)return 0;for(var c=n.length,k=r.length,G=0,z=U(c,k);G<z;++G)if(n[G]!==r[G]){c=n[G],k=r[G];break}return c<k?-1:k<c?1:0},a.isEncoding=function(n){switch((n+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(n,r){if(!Array.isArray(n))throw new TypeError('"list" argument must be an Array of Buffers');if(n.length===0)return a.alloc(0);var c;if(r===void 0)for(r=0,c=0;c<n.length;++c)r+=n[c].length;var k=a.allocUnsafe(r),G=0;for(c=0;c<n.length;++c){var z=n[c];if(P(z,Uint8Array)&&(z=a.from(z)),!a.isBuffer(z))throw new TypeError('"list" argument must be an Array of Buffers');z.copy(k,G),G+=z.length}return k},a.byteLength=g,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var n=this.length;if(n%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<n;r+=2)v(this,r,r+1);return this},a.prototype.swap32=function(){var n=this.length;if(n%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<n;r+=4)v(this,r,r+3),v(this,r+1,r+2);return this},a.prototype.swap64=function(){var n=this.length;if(n%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<n;r+=8)v(this,r,r+7),v(this,r+1,r+6),v(this,r+2,r+5),v(this,r+3,r+4);return this},a.prototype.toString=function(){var n=this.length;return n===0?"":arguments.length===0?Dt(this,0,n):C.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(n){if(!a.isBuffer(n))throw new TypeError("Argument must be a Buffer");return this===n||a.compare(this,n)===0},a.prototype.inspect=function(){var n="",r=b.INSPECT_MAX_BYTES;return n=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(n+=" ... "),"<Buffer "+n+">"},a.prototype.compare=function(n,r,c,k,G){if(P(n,Uint8Array)&&(n=a.from(n,n.offset,n.byteLength)),!a.isBuffer(n))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof n);if(r===void 0&&(r=0),c===void 0&&(c=n?n.length:0),k===void 0&&(k=0),G===void 0&&(G=this.length),0>r||c>n.length||0>k||G>this.length)throw new RangeError("out of range index");if(k>=G&&r>=c)return 0;if(k>=G)return-1;if(r>=c)return 1;if(r>>>=0,c>>>=0,k>>>=0,G>>>=0,this===n)return 0;for(var z=G-k,at=c-r,kt=U(z,at),Ft=this.slice(k,G),Lt=n.slice(r,c),It=0;It<kt;++It)if(Ft[It]!==Lt[It]){z=Ft[It],at=Lt[It];break}return z<at?-1:at<z?1:0},a.prototype.includes=function(n,r,c){return this.indexOf(n,r,c)!==-1},a.prototype.indexOf=function(n,r,c){return D(this,n,r,c,!0)},a.prototype.lastIndexOf=function(n,r,c){return D(this,n,r,c,!1)},a.prototype.write=function(n,r,c,k){if(r===void 0)k="utf8",c=this.length,r=0;else if(c===void 0&&typeof r=="string")k=r,c=this.length,r=0;else if(isFinite(r))r>>>=0,isFinite(c)?(c>>>=0,k===void 0&&(k="utf8")):(k=c,c=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var G=this.length-r;if((c===void 0||c>G)&&(c=G),0<n.length&&(0>c||0>r)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");k||(k="utf8");for(var z=!1;;)switch(k){case"hex":return N(this,n,r,c);case"utf8":case"utf-8":return j(this,n,r,c);case"ascii":return q(this,n,r,c);case"latin1":case"binary":return it(this,n,r,c);case"base64":return bt(this,n,r,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return St(this,n,r,c);default:if(z)throw new TypeError("Unknown encoding: "+k);k=(""+k).toLowerCase(),z=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},a.prototype.slice=function(n,r){var c=this.length;n=~~n,r=r===void 0?c:~~r,0>n?(n+=c,0>n&&(n=0)):n>c&&(n=c),0>r?(r+=c,0>r&&(r=0)):r>c&&(r=c),r<n&&(r=n);var k=this.subarray(n,r);return k.__proto__=a.prototype,k},a.prototype.readUIntLE=function(n,r,c){n>>>=0,r>>>=0,c||nt(n,r,this.length);for(var k=this[n],G=1,z=0;++z<r&&(G*=256);)k+=this[n+z]*G;return k},a.prototype.readUIntBE=function(n,r,c){n>>>=0,r>>>=0,c||nt(n,r,this.length);for(var k=this[n+--r],G=1;0<r&&(G*=256);)k+=this[n+--r]*G;return k},a.prototype.readUInt8=function(n,r){return n>>>=0,r||nt(n,1,this.length),this[n]},a.prototype.readUInt16LE=function(n,r){return n>>>=0,r||nt(n,2,this.length),this[n]|this[n+1]<<8},a.prototype.readUInt16BE=function(n,r){return n>>>=0,r||nt(n,2,this.length),this[n]<<8|this[n+1]},a.prototype.readUInt32LE=function(n,r){return n>>>=0,r||nt(n,4,this.length),(this[n]|this[n+1]<<8|this[n+2]<<16)+16777216*this[n+3]},a.prototype.readUInt32BE=function(n,r){return n>>>=0,r||nt(n,4,this.length),16777216*this[n]+(this[n+1]<<16|this[n+2]<<8|this[n+3])},a.prototype.readIntLE=function(n,r,c){n>>>=0,r>>>=0,c||nt(n,r,this.length);for(var k=this[n],G=1,z=0;++z<r&&(G*=256);)k+=this[n+z]*G;return G*=128,k>=G&&(k-=st(2,8*r)),k},a.prototype.readIntBE=function(n,r,c){n>>>=0,r>>>=0,c||nt(n,r,this.length);for(var k=r,G=1,z=this[n+--k];0<k&&(G*=256);)z+=this[n+--k]*G;return G*=128,z>=G&&(z-=st(2,8*r)),z},a.prototype.readInt8=function(n,r){return n>>>=0,r||nt(n,1,this.length),128&this[n]?-1*(255-this[n]+1):this[n]},a.prototype.readInt16LE=function(n,r){n>>>=0,r||nt(n,2,this.length);var c=this[n]|this[n+1]<<8;return 32768&c?4294901760|c:c},a.prototype.readInt16BE=function(n,r){n>>>=0,r||nt(n,2,this.length);var c=this[n+1]|this[n]<<8;return 32768&c?4294901760|c:c},a.prototype.readInt32LE=function(n,r){return n>>>=0,r||nt(n,4,this.length),this[n]|this[n+1]<<8|this[n+2]<<16|this[n+3]<<24},a.prototype.readInt32BE=function(n,r){return n>>>=0,r||nt(n,4,this.length),this[n]<<24|this[n+1]<<16|this[n+2]<<8|this[n+3]},a.prototype.readFloatLE=function(n,r){return n>>>=0,r||nt(n,4,this.length),Z.read(this,n,!0,23,4)},a.prototype.readFloatBE=function(n,r){return n>>>=0,r||nt(n,4,this.length),Z.read(this,n,!1,23,4)},a.prototype.readDoubleLE=function(n,r){return n>>>=0,r||nt(n,8,this.length),Z.read(this,n,!0,52,8)},a.prototype.readDoubleBE=function(n,r){return n>>>=0,r||nt(n,8,this.length),Z.read(this,n,!1,52,8)},a.prototype.writeUIntLE=function(n,r,c,k){if(n=+n,r>>>=0,c>>>=0,!k){var G=st(2,8*c)-1;lt(this,n,r,c,G,0)}var z=1,at=0;for(this[r]=255&n;++at<c&&(z*=256);)this[r+at]=255&n/z;return r+c},a.prototype.writeUIntBE=function(n,r,c,k){if(n=+n,r>>>=0,c>>>=0,!k){var G=st(2,8*c)-1;lt(this,n,r,c,G,0)}var z=c-1,at=1;for(this[r+z]=255&n;0<=--z&&(at*=256);)this[r+z]=255&n/at;return r+c},a.prototype.writeUInt8=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,1,255,0),this[r]=255&n,r+1},a.prototype.writeUInt16LE=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,2,65535,0),this[r]=255&n,this[r+1]=n>>>8,r+2},a.prototype.writeUInt16BE=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,2,65535,0),this[r]=n>>>8,this[r+1]=255&n,r+2},a.prototype.writeUInt32LE=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,4,4294967295,0),this[r+3]=n>>>24,this[r+2]=n>>>16,this[r+1]=n>>>8,this[r]=255&n,r+4},a.prototype.writeUInt32BE=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,4,4294967295,0),this[r]=n>>>24,this[r+1]=n>>>16,this[r+2]=n>>>8,this[r+3]=255&n,r+4},a.prototype.writeIntLE=function(n,r,c,k){if(n=+n,r>>>=0,!k){var G=st(2,8*c-1);lt(this,n,r,c,G-1,-G)}var z=0,at=1,kt=0;for(this[r]=255&n;++z<c&&(at*=256);)0>n&&kt===0&&this[r+z-1]!==0&&(kt=1),this[r+z]=255&(n/at>>0)-kt;return r+c},a.prototype.writeIntBE=function(n,r,c,k){if(n=+n,r>>>=0,!k){var G=st(2,8*c-1);lt(this,n,r,c,G-1,-G)}var z=c-1,at=1,kt=0;for(this[r+z]=255&n;0<=--z&&(at*=256);)0>n&&kt===0&&this[r+z+1]!==0&&(kt=1),this[r+z]=255&(n/at>>0)-kt;return r+c},a.prototype.writeInt8=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,1,127,-128),0>n&&(n=255+n+1),this[r]=255&n,r+1},a.prototype.writeInt16LE=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,2,32767,-32768),this[r]=255&n,this[r+1]=n>>>8,r+2},a.prototype.writeInt16BE=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,2,32767,-32768),this[r]=n>>>8,this[r+1]=255&n,r+2},a.prototype.writeInt32LE=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,4,2147483647,-2147483648),this[r]=255&n,this[r+1]=n>>>8,this[r+2]=n>>>16,this[r+3]=n>>>24,r+4},a.prototype.writeInt32BE=function(n,r,c){return n=+n,r>>>=0,c||lt(this,n,r,4,2147483647,-2147483648),0>n&&(n=4294967295+n+1),this[r]=n>>>24,this[r+1]=n>>>16,this[r+2]=n>>>8,this[r+3]=255&n,r+4},a.prototype.writeFloatLE=function(n,r,c){return _t(this,n,r,!0,c)},a.prototype.writeFloatBE=function(n,r,c){return _t(this,n,r,!1,c)},a.prototype.writeDoubleLE=function(n,r,c){return At(this,n,r,!0,c)},a.prototype.writeDoubleBE=function(n,r,c){return At(this,n,r,!1,c)},a.prototype.copy=function(n,r,c,k){if(!a.isBuffer(n))throw new TypeError("argument should be a Buffer");if(c||(c=0),k||k===0||(k=this.length),r>=n.length&&(r=n.length),r||(r=0),0<k&&k<c&&(k=c),k===c||n.length===0||this.length===0)return 0;if(0>r)throw new RangeError("targetStart out of bounds");if(0>c||c>=this.length)throw new RangeError("Index out of range");if(0>k)throw new RangeError("sourceEnd out of bounds");k>this.length&&(k=this.length),n.length-r<k-c&&(k=n.length-r+c);var G=k-c;if(this===n&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(r,c,k);else if(this===n&&c<r&&r<k)for(var z=G-1;0<=z;--z)n[z+r]=this[z+c];else Uint8Array.prototype.set.call(n,this.subarray(c,k),r);return G},a.prototype.fill=function(n,r,c,k){if(typeof n=="string"){if(typeof r=="string"?(k=r,r=0,c=this.length):typeof c=="string"&&(k=c,c=this.length),k!==void 0&&typeof k!="string")throw new TypeError("encoding must be a string");if(typeof k=="string"&&!a.isEncoding(k))throw new TypeError("Unknown encoding: "+k);if(n.length===1){var G=n.charCodeAt(0);(k==="utf8"&&128>G||k==="latin1")&&(n=G)}}else typeof n=="number"&&(n&=255);if(0>r||this.length<r||this.length<c)throw new RangeError("Out of range index");if(c<=r)return this;r>>>=0,c=c===void 0?this.length:c>>>0,n||(n=0);var z;if(typeof n=="number")for(z=r;z<c;++z)this[z]=n;else{var at=a.isBuffer(n)?n:a.from(n,k),kt=at.length;if(kt===0)throw new TypeError('The value "'+n+'" is invalid for argument "value"');for(z=0;z<c-r;++z)this[z+r]=at[z%kt]}return this};var pt=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,M("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:9}],4:[function(M,A,b){(function(m){(function(){function U(){let a;try{a=b.storage.getItem("debug")}catch(w){}return!a&&typeof m!="undefined"&&"env"in m&&(a=m.env.DEBUG),a}b.formatArgs=function(a){if(a[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+a[0]+(this.useColors?"%c ":" ")+"+"+A.exports.humanize(this.diff),!this.useColors)return;const w="color: "+this.color;a.splice(1,0,w,"color: inherit");let d=0,h=0;a[0].replace(/%[a-zA-Z%]/g,O=>{O==="%%"||(d++,O==="%c"&&(h=d))}),a.splice(h,0,w)},b.save=function(a){try{a?b.storage.setItem("debug",a):b.storage.removeItem("debug")}catch(w){}},b.load=U,b.useColors=function(){return!!(typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))||!(typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},b.storage=function(){try{return localStorage}catch(a){}}(),b.destroy=(()=>{let a=!1;return()=>{a||(a=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),b.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],b.log=console.debug||console.log||(()=>{}),A.exports=M("./common")(b);const{formatters:L}=A.exports;L.j=function(a){try{return JSON.stringify(a)}catch(w){return"[UnexpectedJSONParseError]: "+w.message}}}).call(this)}).call(this,M("_process"))},{"./common":5,_process:12}],5:[function(M,A){A.exports=function(b){function m(a){function w(...O){if(!w.enabled)return;const R=w,S=+new Date,x=S-(d||S);R.diff=x,R.prev=d,R.curr=S,d=S,O[0]=m.coerce(O[0]),typeof O[0]!="string"&&O.unshift("%O");let u=0;O[0]=O[0].replace(/%([a-zA-Z%])/g,(g,C)=>{if(g==="%%")return"%";u++;const v=m.formatters[C];if(typeof v=="function"){const D=O[u];g=v.call(R,D),O.splice(u,1),u--}return g}),m.formatArgs.call(R,O),(R.log||m.log).apply(R,O)}let d,h=null;return w.namespace=a,w.useColors=m.useColors(),w.color=m.selectColor(a),w.extend=U,w.destroy=m.destroy,Object.defineProperty(w,"enabled",{enumerable:!0,configurable:!1,get:()=>h===null?m.enabled(a):h,set:O=>{h=O}}),typeof m.init=="function"&&m.init(w),w}function U(a,w){const d=m(this.namespace+(typeof w=="undefined"?":":w)+a);return d.log=this.log,d}function L(a){return a.toString().substring(2,a.toString().length-2).replace(/\.\*\?$/,"*")}return m.debug=m,m.default=m,m.coerce=function(a){return a instanceof Error?a.stack||a.message:a},m.disable=function(){const a=[...m.names.map(L),...m.skips.map(L).map(w=>"-"+w)].join(",");return m.enable(""),a},m.enable=function(a){m.save(a),m.names=[],m.skips=[];let w;const d=(typeof a=="string"?a:"").split(/[\s,]+/),h=d.length;for(w=0;w<h;w++)d[w]&&(a=d[w].replace(/\*/g,".*?"),a[0]==="-"?m.skips.push(new RegExp("^"+a.substr(1)+"$")):m.names.push(new RegExp("^"+a+"$")))},m.enabled=function(a){if(a[a.length-1]==="*")return!0;let w,d;for(w=0,d=m.skips.length;w<d;w++)if(m.skips[w].test(a))return!1;for(w=0,d=m.names.length;w<d;w++)if(m.names[w].test(a))return!0;return!1},m.humanize=M("ms"),m.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(b).forEach(a=>{m[a]=b[a]}),m.names=[],m.skips=[],m.formatters={},m.selectColor=function(a){let w=0;for(let d=0;d<a.length;d++)w=(w<<5)-w+a.charCodeAt(d),w|=0;return m.colors[ft(w)%m.colors.length]},m.enable(m.load()),m}},{ms:11}],6:[function(M,A){"use strict";function b(m,U){for(const L in U)Object.defineProperty(m,L,{value:U[L],enumerable:!0,configurable:!0});return m}A.exports=function(m,U,L){if(!m||typeof m=="string")throw new TypeError("Please pass an Error to err-code");L||(L={}),typeof U=="object"&&(L=U,U=""),U&&(L.code=U);try{return b(m,L)}catch(a){L.message=m.message,L.stack=m.stack;const w=function(){};return w.prototype=Object.create(Object.getPrototypeOf(m)),b(new w,L)}}},{}],7:[function(M,A){"use strict";function b(N){console&&console.warn&&console.warn(N)}function m(){m.init.call(this)}function U(N){if(typeof N!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof N)}function L(N){return N._maxListeners===void 0?m.defaultMaxListeners:N._maxListeners}function a(N,j,q,it){var bt,St,Rt;if(U(q),St=N._events,St===void 0?(St=N._events=Object.create(null),N._eventsCount=0):(St.newListener!==void 0&&(N.emit("newListener",j,q.listener?q.listener:q),St=N._events),Rt=St[j]),Rt===void 0)Rt=St[j]=q,++N._eventsCount;else if(typeof Rt=="function"?Rt=St[j]=it?[q,Rt]:[Rt,q]:it?Rt.unshift(q):Rt.push(q),bt=L(N),0<bt&&Rt.length>bt&&!Rt.warned){Rt.warned=!0;var Dt=new Error("Possible EventEmitter memory leak detected. "+Rt.length+" "+(j+" listeners added. Use emitter.setMaxListeners() to increase limit"));Dt.name="MaxListenersExceededWarning",Dt.emitter=N,Dt.type=j,Dt.count=Rt.length,b(Dt)}return N}function w(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(N,j,q){var it={fired:!1,wrapFn:void 0,target:N,type:j,listener:q},bt=w.bind(it);return bt.listener=q,it.wrapFn=bt,bt}function h(N,j,q){var it=N._events;if(it===void 0)return[];var bt=it[j];return bt===void 0?[]:typeof bt=="function"?q?[bt.listener||bt]:[bt]:q?x(bt):R(bt,bt.length)}function O(N){var j=this._events;if(j!==void 0){var q=j[N];if(typeof q=="function")return 1;if(q!==void 0)return q.length}return 0}function R(N,j){for(var q=Array(j),it=0;it<j;++it)q[it]=N[it];return q}function S(N,j){for(;j+1<N.length;j++)N[j]=N[j+1];N.pop()}function x(N){for(var j=Array(N.length),q=0;q<j.length;++q)j[q]=N[q].listener||N[q];return j}function u(N,j,q){typeof N.on=="function"&&_(N,"error",j,q)}function _(N,j,q,it){if(typeof N.on=="function")it.once?N.once(j,q):N.on(j,q);else if(typeof N.addEventListener=="function")N.addEventListener(j,function bt(St){it.once&&N.removeEventListener(j,bt),q(St)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof N)}var g,C=typeof Reflect=="object"?Reflect:null,v=C&&typeof C.apply=="function"?C.apply:function(N,j,q){return Function.prototype.apply.call(N,j,q)};g=C&&typeof C.ownKeys=="function"?C.ownKeys:Object.getOwnPropertySymbols?function(N){return Object.getOwnPropertyNames(N).concat(Object.getOwnPropertySymbols(N))}:function(N){return Object.getOwnPropertyNames(N)};var D=Number.isNaN||function(N){return N!==N};A.exports=m,A.exports.once=function(N,j){return new Promise(function(q,it){function bt(Rt){N.removeListener(j,St),it(Rt)}function St(){typeof N.removeListener=="function"&&N.removeListener("error",bt),q([].slice.call(arguments))}_(N,j,St,{once:!0}),j!=="error"&&u(N,bt,{once:!0})})},m.EventEmitter=m,m.prototype._events=void 0,m.prototype._eventsCount=0,m.prototype._maxListeners=void 0;var H=10;Object.defineProperty(m,"defaultMaxListeners",{enumerable:!0,get:function(){return H},set:function(N){if(typeof N!="number"||0>N||D(N))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+N+".");H=N}}),m.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},m.prototype.setMaxListeners=function(N){if(typeof N!="number"||0>N||D(N))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+N+".");return this._maxListeners=N,this},m.prototype.getMaxListeners=function(){return L(this)},m.prototype.emit=function(N){for(var j=[],q=1;q<arguments.length;q++)j.push(arguments[q]);var it=N==="error",bt=this._events;if(bt!==void 0)it=it&&bt.error===void 0;else if(!it)return!1;if(it){var St;if(0<j.length&&(St=j[0]),St instanceof Error)throw St;var Rt=new Error("Unhandled error."+(St?" ("+St.message+")":""));throw Rt.context=St,Rt}var Dt=bt[N];if(Dt===void 0)return!1;if(typeof Dt=="function")v(Dt,this,j);else for(var Ut=Dt.length,vt=R(Dt,Ut),q=0;q<Ut;++q)v(vt[q],this,j);return!0},m.prototype.addListener=function(N,j){return a(this,N,j,!1)},m.prototype.on=m.prototype.addListener,m.prototype.prependListener=function(N,j){return a(this,N,j,!0)},m.prototype.once=function(N,j){return U(j),this.on(N,d(this,N,j)),this},m.prototype.prependOnceListener=function(N,j){return U(j),this.prependListener(N,d(this,N,j)),this},m.prototype.removeListener=function(N,j){var q,it,bt,St,Rt;if(U(j),it=this._events,it===void 0)return this;if(q=it[N],q===void 0)return this;if(q===j||q.listener===j)--this._eventsCount==0?this._events=Object.create(null):(delete it[N],it.removeListener&&this.emit("removeListener",N,q.listener||j));else if(typeof q!="function"){for(bt=-1,St=q.length-1;0<=St;St--)if(q[St]===j||q[St].listener===j){Rt=q[St].listener,bt=St;break}if(0>bt)return this;bt===0?q.shift():S(q,bt),q.length===1&&(it[N]=q[0]),it.removeListener!==void 0&&this.emit("removeListener",N,Rt||j)}return this},m.prototype.off=m.prototype.removeListener,m.prototype.removeAllListeners=function(N){var j,q,it;if(q=this._events,q===void 0)return this;if(q.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):q[N]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete q[N]),this;if(arguments.length===0){var bt,St=Object.keys(q);for(it=0;it<St.length;++it)bt=St[it],bt!=="removeListener"&&this.removeAllListeners(bt);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(j=q[N],typeof j=="function")this.removeListener(N,j);else if(j!==void 0)for(it=j.length-1;0<=it;it--)this.removeListener(N,j[it]);return this},m.prototype.listeners=function(N){return h(this,N,!0)},m.prototype.rawListeners=function(N){return h(this,N,!1)},m.listenerCount=function(N,j){return typeof N.listenerCount=="function"?N.listenerCount(j):O.call(N,j)},m.prototype.listenerCount=O,m.prototype.eventNames=function(){return 0<this._eventsCount?g(this._events):[]}},{}],8:[function(M,A){A.exports=function(){if(typeof globalThis=="undefined")return null;var b={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return b.RTCPeerConnection?b:null}},{}],9:[function(M,A,b){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */b.read=function(m,U,L,a,w){var d,h,O=8*w-a-1,R=(1<<O)-1,S=R>>1,x=-7,u=L?w-1:0,_=L?-1:1,g=m[U+u];for(u+=_,d=g&(1<<-x)-1,g>>=-x,x+=O;0<x;d=256*d+m[U+u],u+=_,x-=8);for(h=d&(1<<-x)-1,d>>=-x,x+=a;0<x;h=256*h+m[U+u],u+=_,x-=8);if(d===0)d=1-S;else{if(d===R)return h?NaN:(g?-1:1)*(1/0);h+=st(2,a),d-=S}return(g?-1:1)*h*st(2,d-a)},b.write=function(m,U,L,a,w,d){var h,O,R,S=Math.LN2,x=Math.log,u=8*d-w-1,_=(1<<u)-1,g=_>>1,C=w===23?st(2,-24)-st(2,-77):0,v=a?0:d-1,D=a?1:-1,H=0>U||U===0&&0>1/U?1:0;for(U=ft(U),isNaN(U)||U===1/0?(O=isNaN(U)?1:0,h=_):(h=ct(x(U)/S),1>U*(R=st(2,-h))&&(h--,R*=2),U+=1<=h+g?C/R:C*st(2,1-g),2<=U*R&&(h++,R/=2),h+g>=_?(O=0,h=_):1<=h+g?(O=(U*R-1)*st(2,w),h+=g):(O=U*st(2,g-1)*st(2,w),h=0));8<=w;m[L+v]=255&O,v+=D,O/=256,w-=8);for(h=h<<w|O,u+=w;0<u;m[L+v]=255&h,v+=D,h/=256,u-=8);m[L+v-D]|=128*H}},{}],10:[function(M,A){A.exports=typeof Object.create=="function"?function(b,m){m&&(b.super_=m,b.prototype=Object.create(m.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}))}:function(b,m){if(m){b.super_=m;var U=function(){};U.prototype=m.prototype,b.prototype=new U,b.prototype.constructor=b}}},{}],11:[function(M,A){var b=Math.round;function m(d){if(d+="",!(100<d.length)){var h=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(d);if(h){var O=parseFloat(h[1]),R=(h[2]||"ms").toLowerCase();return R==="years"||R==="year"||R==="yrs"||R==="yr"||R==="y"?315576e5*O:R==="weeks"||R==="week"||R==="w"?6048e5*O:R==="days"||R==="day"||R==="d"?864e5*O:R==="hours"||R==="hour"||R==="hrs"||R==="hr"||R==="h"?36e5*O:R==="minutes"||R==="minute"||R==="mins"||R==="min"||R==="m"?6e4*O:R==="seconds"||R==="second"||R==="secs"||R==="sec"||R==="s"?1e3*O:R==="milliseconds"||R==="millisecond"||R==="msecs"||R==="msec"||R==="ms"?O:void 0}}}function U(d){var h=ft(d);return 864e5<=h?b(d/864e5)+"d":36e5<=h?b(d/36e5)+"h":6e4<=h?b(d/6e4)+"m":1e3<=h?b(d/1e3)+"s":d+"ms"}function L(d){var h=ft(d);return 864e5<=h?a(d,h,864e5,"day"):36e5<=h?a(d,h,36e5,"hour"):6e4<=h?a(d,h,6e4,"minute"):1e3<=h?a(d,h,1e3,"second"):d+" ms"}function a(d,h,O,R){return b(d/O)+" "+R+(h>=1.5*O?"s":"")}var w=24*(60*6e4);A.exports=function(d,h){h=h||{};var O=typeof d;if(O=="string"&&0<d.length)return m(d);if(O==="number"&&isFinite(d))return h.long?L(d):U(d);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(d))}},{}],12:[function(M,A){function b(){throw new Error("setTimeout has not been defined")}function m(){throw new Error("clearTimeout has not been defined")}function U(C){if(O===setTimeout)return setTimeout(C,0);if((O===b||!O)&&setTimeout)return O=setTimeout,setTimeout(C,0);try{return O(C,0)}catch(v){try{return O.call(null,C,0)}catch(D){return O.call(this,C,0)}}}function L(C){if(R===clearTimeout)return clearTimeout(C);if((R===m||!R)&&clearTimeout)return R=clearTimeout,clearTimeout(C);try{return R(C)}catch(v){try{return R.call(null,C)}catch(D){return R.call(this,C)}}}function a(){_&&x&&(_=!1,x.length?u=x.concat(u):g=-1,u.length&&w())}function w(){if(!_){var C=U(a);_=!0;for(var v=u.length;v;){for(x=u,u=[];++g<v;)x&&x[g].run();g=-1,v=u.length}x=null,_=!1,L(C)}}function d(C,v){this.fun=C,this.array=v}function h(){}var O,R,S=A.exports={};(function(){try{O=typeof setTimeout=="function"?setTimeout:b}catch(C){O=b}try{R=typeof clearTimeout=="function"?clearTimeout:m}catch(C){R=m}})();var x,u=[],_=!1,g=-1;S.nextTick=function(C){var v=Array(arguments.length-1);if(1<arguments.length)for(var D=1;D<arguments.length;D++)v[D-1]=arguments[D];u.push(new d(C,v)),u.length!==1||_||U(w)},d.prototype.run=function(){this.fun.apply(null,this.array)},S.title="browser",S.browser=!0,S.env={},S.argv=[],S.version="",S.versions={},S.on=h,S.addListener=h,S.once=h,S.off=h,S.removeListener=h,S.removeAllListeners=h,S.emit=h,S.prependListener=h,S.prependOnceListener=h,S.listeners=function(){return[]},S.binding=function(){throw new Error("process.binding is not supported")},S.cwd=function(){return"/"},S.chdir=function(){throw new Error("process.chdir is not supported")},S.umask=function(){return 0}},{}],13:[function(M,A){(function(b){(function(){/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let m;A.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window=="undefined"?b:window):U=>(m||(m=Promise.resolve())).then(U).catch(L=>setTimeout(()=>{throw L},0))}).call(this)}).call(this,typeof $.g=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:$.g)},{}],14:[function(M,A){(function(b,m){(function(){"use strict";var U=M("safe-buffer").Buffer,L=m.crypto||m.msCrypto;A.exports=L&&L.getRandomValues?function(a,w){if(a>4294967295)throw new RangeError("requested too many random bytes");var d=U.allocUnsafe(a);if(0<a)if(65536<a)for(var h=0;h<a;h+=65536)L.getRandomValues(d.slice(h,h+65536));else L.getRandomValues(d);return typeof w=="function"?b.nextTick(function(){w(null,d)}):d}:function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,M("_process"),typeof $.g=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:$.g)},{_process:12,"safe-buffer":30}],15:[function(M,A){"use strict";function b(h,O){h.prototype=Object.create(O.prototype),h.prototype.constructor=h,h.__proto__=O}function m(h,O,R){function S(u,_,g){return typeof O=="string"?O:O(u,_,g)}R||(R=Error);var x=function(u){function _(g,C,v){return u.call(this,S(g,C,v))||this}return b(_,u),_}(R);x.prototype.name=R.name,x.prototype.code=h,d[h]=x}function U(h,O){if(Array.isArray(h)){var R=h.length;return h=h.map(function(S){return S+""}),2<R?"one of ".concat(O," ").concat(h.slice(0,R-1).join(", "),", or ")+h[R-1]:R===2?"one of ".concat(O," ").concat(h[0]," or ").concat(h[1]):"of ".concat(O," ").concat(h[0])}return"of ".concat(O," ").concat(h+"")}function L(h,O,R){return h.substr(!R||0>R?0:+R,O.length)===O}function a(h,O,R){return(R===void 0||R>h.length)&&(R=h.length),h.substring(R-O.length,R)===O}function w(h,O,R){return typeof R!="number"&&(R=0),!(R+O.length>h.length)&&h.indexOf(O,R)!==-1}var d={};m("ERR_INVALID_OPT_VALUE",function(h,O){return'The value "'+O+'" is invalid for option "'+h+'"'},TypeError),m("ERR_INVALID_ARG_TYPE",function(h,O,R){var S;typeof O=="string"&&L(O,"not ")?(S="must not be",O=O.replace(/^not /,"")):S="must be";var x;if(a(h," argument"))x="The ".concat(h," ").concat(S," ").concat(U(O,"type"));else{var u=w(h,".")?"property":"argument";x='The "'.concat(h,'" ').concat(u," ").concat(S," ").concat(U(O,"type"))}return x+=". Received type ".concat(typeof R),x},TypeError),m("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),m("ERR_METHOD_NOT_IMPLEMENTED",function(h){return"The "+h+" method is not implemented"}),m("ERR_STREAM_PREMATURE_CLOSE","Premature close"),m("ERR_STREAM_DESTROYED",function(h){return"Cannot call "+h+" after a stream was destroyed"}),m("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),m("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),m("ERR_STREAM_WRITE_AFTER_END","write after end"),m("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),m("ERR_UNKNOWN_ENCODING",function(h){return"Unknown encoding: "+h},TypeError),m("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),A.exports.codes=d},{}],16:[function(M,A){(function(b){(function(){"use strict";function m(S){return this instanceof m?(w.call(this,S),d.call(this,S),this.allowHalfOpen=!0,void(S&&(S.readable===!1&&(this.readable=!1),S.writable===!1&&(this.writable=!1),S.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",U))))):new m(S)}function U(){this._writableState.ended||b.nextTick(L,this)}function L(S){S.end()}var a=Object.keys||function(S){var x=[];for(var u in S)x.push(u);return x};A.exports=m;var w=M("./_stream_readable"),d=M("./_stream_writable");M("inherits")(m,w);for(var h,O=a(d.prototype),R=0;R<O.length;R++)h=O[R],m.prototype[h]||(m.prototype[h]=d.prototype[h]);Object.defineProperty(m.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(m.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(m.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(m.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(S){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=S,this._writableState.destroyed=S)}})}).call(this)}).call(this,M("_process"))},{"./_stream_readable":18,"./_stream_writable":20,_process:12,inherits:10}],17:[function(M,A){"use strict";function b(U){return this instanceof b?void m.call(this,U):new b(U)}A.exports=b;var m=M("./_stream_transform");M("inherits")(b,m),b.prototype._transform=function(U,L,a){a(null,U)}},{"./_stream_transform":19,inherits:10}],18:[function(M,A){(function(b,m){(function(){"use strict";function U(n){return nt.from(n)}function L(n){return nt.isBuffer(n)||n instanceof lt}function a(n,r,c){return typeof n.prependListener=="function"?n.prependListener(r,c):void(n._events&&n._events[r]?Array.isArray(n._events[r])?n._events[r].unshift(c):n._events[r]=[c,n._events[r]]:n.on(r,c))}function w(n,r,c){Ut=Ut||M("./_stream_duplex"),n=n||{},typeof c!="boolean"&&(c=r instanceof Ut),this.objectMode=!!n.objectMode,c&&(this.objectMode=this.objectMode||!!n.readableObjectMode),this.highWaterMark=Y(this,n,"readableHighWaterMark",c),this.buffer=new Qt,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=n.emitClose!==!1,this.autoDestroy=!!n.autoDestroy,this.destroyed=!1,this.defaultEncoding=n.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,n.encoding&&(!_t&&(_t=M("string_decoder/").StringDecoder),this.decoder=new _t(n.encoding),this.encoding=n.encoding)}function d(n){if(Ut=Ut||M("./_stream_duplex"),!(this instanceof d))return new d(n);var r=this instanceof Ut;this._readableState=new w(n,this,r),this.readable=!0,n&&(typeof n.read=="function"&&(this._read=n.read),typeof n.destroy=="function"&&(this._destroy=n.destroy)),ot.call(this)}function h(n,r,c,k,G){vt("readableAddChunk",r);var z=n._readableState;if(r===null)z.reading=!1,u(n,z);else{var at;if(G||(at=R(z,r)),at)Z(n,at);else if(!(z.objectMode||r&&0<r.length))k||(z.reading=!1,C(n,z));else if(typeof r=="string"||z.objectMode||Object.getPrototypeOf(r)===nt.prototype||(r=U(r)),k)z.endEmitted?Z(n,new T):O(n,z,r,!0);else if(z.ended)Z(n,new P);else{if(z.destroyed)return!1;z.reading=!1,z.decoder&&!c?(r=z.decoder.write(r),z.objectMode||r.length!==0?O(n,z,r,!1):C(n,z)):O(n,z,r,!1)}}return!z.ended&&(z.length<z.highWaterMark||z.length===0)}function O(n,r,c,k){r.flowing&&r.length===0&&!r.sync?(r.awaitDrain=0,n.emit("data",c)):(r.length+=r.objectMode?1:c.length,k?r.buffer.unshift(c):r.buffer.push(c),r.needReadable&&_(n)),C(n,r)}function R(n,r){var c;return L(r)||typeof r=="string"||r===void 0||n.objectMode||(c=new yt("chunk",["string","Buffer","Uint8Array"],r)),c}function S(n){return 1073741824<=n?n=1073741824:(n--,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n++),n}function x(n,r){return 0>=n||r.length===0&&r.ended?0:r.objectMode?1:n===n?(n>r.highWaterMark&&(r.highWaterMark=S(n)),n<=r.length?n:r.ended?r.length:(r.needReadable=!0,0)):r.flowing&&r.length?r.buffer.head.data.length:r.length}function u(n,r){if(vt("onEofChunk"),!r.ended){if(r.decoder){var c=r.decoder.end();c&&c.length&&(r.buffer.push(c),r.length+=r.objectMode?1:c.length)}r.ended=!0,r.sync?_(n):(r.needReadable=!1,!r.emittedReadable&&(r.emittedReadable=!0,g(n)))}}function _(n){var r=n._readableState;vt("emitReadable",r.needReadable,r.emittedReadable),r.needReadable=!1,r.emittedReadable||(vt("emitReadable",r.flowing),r.emittedReadable=!0,b.nextTick(g,n))}function g(n){var r=n._readableState;vt("emitReadable_",r.destroyed,r.length,r.ended),!r.destroyed&&(r.length||r.ended)&&(n.emit("readable"),r.emittedReadable=!1),r.needReadable=!r.flowing&&!r.ended&&r.length<=r.highWaterMark,it(n)}function C(n,r){r.readingMore||(r.readingMore=!0,b.nextTick(v,n,r))}function v(n,r){for(;!r.reading&&!r.ended&&(r.length<r.highWaterMark||r.flowing&&r.length===0);){var c=r.length;if(vt("maybeReadMore read 0"),n.read(0),c===r.length)break}r.readingMore=!1}function D(n){return function(){var r=n._readableState;vt("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,r.awaitDrain===0&&Jt(n,"data")&&(r.flowing=!0,it(n))}}function H(n){var r=n._readableState;r.readableListening=0<n.listenerCount("readable"),r.resumeScheduled&&!r.paused?r.flowing=!0:0<n.listenerCount("data")&&n.resume()}function N(n){vt("readable nexttick read 0"),n.read(0)}function j(n,r){r.resumeScheduled||(r.resumeScheduled=!0,b.nextTick(q,n,r))}function q(n,r){vt("resume",r.reading),r.reading||n.read(0),r.resumeScheduled=!1,n.emit("resume"),it(n),r.flowing&&!r.reading&&n.read(0)}function it(n){var r=n._readableState;for(vt("flow",r.flowing);r.flowing&&n.read()!==null;);}function bt(n,r){if(r.length===0)return null;var c;return r.objectMode?c=r.buffer.shift():!n||n>=r.length?(c=r.decoder?r.buffer.join(""):r.buffer.length===1?r.buffer.first():r.buffer.concat(r.length),r.buffer.clear()):c=r.buffer.consume(n,r.decoder),c}function St(n){var r=n._readableState;vt("endReadable",r.endEmitted),r.endEmitted||(r.ended=!0,b.nextTick(Rt,r,n))}function Rt(n,r){if(vt("endReadableNT",n.endEmitted,n.length),!n.endEmitted&&n.length===0&&(n.endEmitted=!0,r.readable=!1,r.emit("end"),n.autoDestroy)){var c=r._writableState;(!c||c.autoDestroy&&c.finished)&&r.destroy()}}function Dt(n,r){for(var c=0,k=n.length;c<k;c++)if(n[c]===r)return c;return-1}A.exports=d;var Ut;d.ReadableState=w;var vt,te=M("events").EventEmitter,Jt=function(n,r){return n.listeners(r).length},ot=M("./internal/streams/stream"),nt=M("buffer").Buffer,lt=m.Uint8Array||function(){},wt=M("util");vt=wt&&wt.debuglog?wt.debuglog("stream"):function(){};var _t,At,jt,Qt=M("./internal/streams/buffer_list"),xt=M("./internal/streams/destroy"),ne=M("./internal/streams/state"),Y=ne.getHighWaterMark,tt=M("../errors").codes,yt=tt.ERR_INVALID_ARG_TYPE,P=tt.ERR_STREAM_PUSH_AFTER_EOF,y=tt.ERR_METHOD_NOT_IMPLEMENTED,T=tt.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;M("inherits")(d,ot);var Z=xt.errorOrDestroy,pt=["error","close","destroy","pause","resume"];Object.defineProperty(d.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(n){this._readableState&&(this._readableState.destroyed=n)}}),d.prototype.destroy=xt.destroy,d.prototype._undestroy=xt.undestroy,d.prototype._destroy=function(n,r){r(n)},d.prototype.push=function(n,r){var c,k=this._readableState;return k.objectMode?c=!0:typeof n=="string"&&(r=r||k.defaultEncoding,r!==k.encoding&&(n=nt.from(n,r),r=""),c=!0),h(this,n,r,!1,c)},d.prototype.unshift=function(n){return h(this,n,null,!0,!1)},d.prototype.isPaused=function(){return this._readableState.flowing===!1},d.prototype.setEncoding=function(n){_t||(_t=M("string_decoder/").StringDecoder);var r=new _t(n);this._readableState.decoder=r,this._readableState.encoding=this._readableState.decoder.encoding;for(var c=this._readableState.buffer.head,k="";c!==null;)k+=r.write(c.data),c=c.next;return this._readableState.buffer.clear(),k!==""&&this._readableState.buffer.push(k),this._readableState.length=k.length,this},d.prototype.read=function(n){vt("read",n),n=parseInt(n,10);var r=this._readableState,c=n;if(n!==0&&(r.emittedReadable=!1),n===0&&r.needReadable&&((r.highWaterMark===0?0<r.length:r.length>=r.highWaterMark)||r.ended))return vt("read: emitReadable",r.length,r.ended),r.length===0&&r.ended?St(this):_(this),null;if(n=x(n,r),n===0&&r.ended)return r.length===0&&St(this),null;var k=r.needReadable;vt("need readable",k),(r.length===0||r.length-n<r.highWaterMark)&&(k=!0,vt("length less than watermark",k)),r.ended||r.reading?(k=!1,vt("reading or ended",k)):k&&(vt("do read"),r.reading=!0,r.sync=!0,r.length===0&&(r.needReadable=!0),this._read(r.highWaterMark),r.sync=!1,!r.reading&&(n=x(c,r)));var G;return G=0<n?bt(n,r):null,G===null?(r.needReadable=r.length<=r.highWaterMark,n=0):(r.length-=n,r.awaitDrain=0),r.length===0&&(!r.ended&&(r.needReadable=!0),c!==n&&r.ended&&St(this)),G!==null&&this.emit("data",G),G},d.prototype._read=function(){Z(this,new y("_read()"))},d.prototype.pipe=function(n,r){function c(gt,Pt){vt("onunpipe"),gt===It&&Pt&&Pt.hasUnpiped===!1&&(Pt.hasUnpiped=!0,G())}function k(){vt("onend"),n.end()}function G(){vt("cleanup"),n.removeListener("close",kt),n.removeListener("finish",Ft),n.removeListener("drain",rt),n.removeListener("error",at),n.removeListener("unpipe",c),It.removeListener("end",k),It.removeListener("end",Lt),It.removeListener("data",z),mt=!0,Mt.awaitDrain&&(!n._writableState||n._writableState.needDrain)&&rt()}function z(gt){vt("ondata");var Pt=n.write(gt);vt("dest.write",Pt),Pt===!1&&((Mt.pipesCount===1&&Mt.pipes===n||1<Mt.pipesCount&&Dt(Mt.pipes,n)!==-1)&&!mt&&(vt("false write response, pause",Mt.awaitDrain),Mt.awaitDrain++),It.pause())}function at(gt){vt("onerror",gt),Lt(),n.removeListener("error",at),Jt(n,"error")===0&&Z(n,gt)}function kt(){n.removeListener("finish",Ft),Lt()}function Ft(){vt("onfinish"),n.removeListener("close",kt),Lt()}function Lt(){vt("unpipe"),It.unpipe(n)}var It=this,Mt=this._readableState;switch(Mt.pipesCount){case 0:Mt.pipes=n;break;case 1:Mt.pipes=[Mt.pipes,n];break;default:Mt.pipes.push(n)}Mt.pipesCount+=1,vt("pipe count=%d opts=%j",Mt.pipesCount,r);var ie=(!r||r.end!==!1)&&n!==b.stdout&&n!==b.stderr,J=ie?k:Lt;Mt.endEmitted?b.nextTick(J):It.once("end",J),n.on("unpipe",c);var rt=D(It);n.on("drain",rt);var mt=!1;return It.on("data",z),a(n,"error",at),n.once("close",kt),n.once("finish",Ft),n.emit("pipe",It),Mt.flowing||(vt("pipe resume"),It.resume()),n},d.prototype.unpipe=function(n){var r=this._readableState,c={hasUnpiped:!1};if(r.pipesCount===0)return this;if(r.pipesCount===1)return n&&n!==r.pipes?this:(n||(n=r.pipes),r.pipes=null,r.pipesCount=0,r.flowing=!1,n&&n.emit("unpipe",this,c),this);if(!n){var k=r.pipes,G=r.pipesCount;r.pipes=null,r.pipesCount=0,r.flowing=!1;for(var z=0;z<G;z++)k[z].emit("unpipe",this,{hasUnpiped:!1});return this}var at=Dt(r.pipes,n);return at===-1?this:(r.pipes.splice(at,1),r.pipesCount-=1,r.pipesCount===1&&(r.pipes=r.pipes[0]),n.emit("unpipe",this,c),this)},d.prototype.on=function(n,r){var c=ot.prototype.on.call(this,n,r),k=this._readableState;return n==="data"?(k.readableListening=0<this.listenerCount("readable"),k.flowing!==!1&&this.resume()):n=="readable"&&!k.endEmitted&&!k.readableListening&&(k.readableListening=k.needReadable=!0,k.flowing=!1,k.emittedReadable=!1,vt("on readable",k.length,k.reading),k.length?_(this):!k.reading&&b.nextTick(N,this)),c},d.prototype.addListener=d.prototype.on,d.prototype.removeListener=function(n,r){var c=ot.prototype.removeListener.call(this,n,r);return n==="readable"&&b.nextTick(H,this),c},d.prototype.removeAllListeners=function(n){var r=ot.prototype.removeAllListeners.apply(this,arguments);return(n==="readable"||n===void 0)&&b.nextTick(H,this),r},d.prototype.resume=function(){var n=this._readableState;return n.flowing||(vt("resume"),n.flowing=!n.readableListening,j(this,n)),n.paused=!1,this},d.prototype.pause=function(){return vt("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(vt("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},d.prototype.wrap=function(n){var r=this,c=this._readableState,k=!1;for(var G in n.on("end",function(){if(vt("wrapped end"),c.decoder&&!c.ended){var at=c.decoder.end();at&&at.length&&r.push(at)}r.push(null)}),n.on("data",function(at){if(vt("wrapped data"),c.decoder&&(at=c.decoder.write(at)),!(c.objectMode&&at==null)&&(c.objectMode||at&&at.length)){var kt=r.push(at);kt||(k=!0,n.pause())}}),n)this[G]===void 0&&typeof n[G]=="function"&&(this[G]=function(at){return function(){return n[at].apply(n,arguments)}}(G));for(var z=0;z<pt.length;z++)n.on(pt[z],this.emit.bind(this,pt[z]));return this._read=function(at){vt("wrapped _read",at),k&&(k=!1,n.resume())},this},typeof Symbol=="function"&&(d.prototype[Symbol.asyncIterator]=function(){return At===void 0&&(At=M("./internal/streams/async_iterator")),At(this)}),Object.defineProperty(d.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(d.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(d.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(n){this._readableState&&(this._readableState.flowing=n)}}),d._fromList=bt,Object.defineProperty(d.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(d.from=function(n,r){return jt===void 0&&(jt=M("./internal/streams/from")),jt(d,n,r)})}).call(this)}).call(this,M("_process"),typeof $.g=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:$.g)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,events:7,inherits:10,"string_decoder/":31,util:2}],19:[function(M,A){"use strict";function b(S,x){var u=this._transformState;u.transforming=!1;var _=u.writecb;if(_===null)return this.emit("error",new d);u.writechunk=null,u.writecb=null,x!=null&&this.push(x),_(S);var g=this._readableState;g.reading=!1,(g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}function m(S){return this instanceof m?(R.call(this,S),this._transformState={afterTransform:b.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,S&&(typeof S.transform=="function"&&(this._transform=S.transform),typeof S.flush=="function"&&(this._flush=S.flush)),void this.on("prefinish",U)):new m(S)}function U(){var S=this;typeof this._flush!="function"||this._readableState.destroyed?L(this,null,null):this._flush(function(x,u){L(S,x,u)})}function L(S,x,u){if(x)return S.emit("error",x);if(u!=null&&S.push(u),S._writableState.length)throw new O;if(S._transformState.transforming)throw new h;return S.push(null)}A.exports=m;var a=M("../errors").codes,w=a.ERR_METHOD_NOT_IMPLEMENTED,d=a.ERR_MULTIPLE_CALLBACK,h=a.ERR_TRANSFORM_ALREADY_TRANSFORMING,O=a.ERR_TRANSFORM_WITH_LENGTH_0,R=M("./_stream_duplex");M("inherits")(m,R),m.prototype.push=function(S,x){return this._transformState.needTransform=!1,R.prototype.push.call(this,S,x)},m.prototype._transform=function(S,x,u){u(new w("_transform()"))},m.prototype._write=function(S,x,u){var _=this._transformState;if(_.writecb=u,_.writechunk=S,_.writeencoding=x,!_.transforming){var g=this._readableState;(_.needTransform||g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}},m.prototype._read=function(){var S=this._transformState;S.writechunk===null||S.transforming?S.needTransform=!0:(S.transforming=!0,this._transform(S.writechunk,S.writeencoding,S.afterTransform))},m.prototype._destroy=function(S,x){R.prototype._destroy.call(this,S,function(u){x(u)})}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(M,A){(function(b,m){(function(){"use strict";function U(P){var y=this;this.next=null,this.entry=null,this.finish=function(){St(y,P)}}function L(P){return vt.from(P)}function a(P){return vt.isBuffer(P)||P instanceof te}function w(){}function d(P,y,T){Rt=Rt||M("./_stream_duplex"),P=P||{},typeof T!="boolean"&&(T=y instanceof Rt),this.objectMode=!!P.objectMode,T&&(this.objectMode=this.objectMode||!!P.writableObjectMode),this.highWaterMark=nt(this,P,"writableHighWaterMark",T),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var Z=P.decodeStrings===!1;this.decodeStrings=!Z,this.defaultEncoding=P.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(pt){C(y,pt)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=P.emitClose!==!1,this.autoDestroy=!!P.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new U(this)}function h(P){Rt=Rt||M("./_stream_duplex");var y=this instanceof Rt;return y||yt.call(h,this)?(this._writableState=new d(P,this,y),this.writable=!0,P&&(typeof P.write=="function"&&(this._write=P.write),typeof P.writev=="function"&&(this._writev=P.writev),typeof P.destroy=="function"&&(this._destroy=P.destroy),typeof P.final=="function"&&(this._final=P.final)),void Ut.call(this)):new h(P)}function O(P,y){var T=new ne;tt(P,T),b.nextTick(y,T)}function R(P,y,T,Z){var pt;return T===null?pt=new xt:typeof T!="string"&&!y.objectMode&&(pt=new wt("chunk",["string","Buffer"],T)),!pt||(tt(P,pt),b.nextTick(Z,pt),!1)}function S(P,y,T){return P.objectMode||P.decodeStrings===!1||typeof y!="string"||(y=vt.from(y,T)),y}function x(P,y,T,Z,pt,n){if(!T){var r=S(y,Z,pt);Z!==r&&(T=!0,pt="buffer",Z=r)}var c=y.objectMode?1:Z.length;y.length+=c;var k=y.length<y.highWaterMark;if(k||(y.needDrain=!0),y.writing||y.corked){var G=y.lastBufferedRequest;y.lastBufferedRequest={chunk:Z,encoding:pt,isBuf:T,callback:n,next:null},G?G.next=y.lastBufferedRequest:y.bufferedRequest=y.lastBufferedRequest,y.bufferedRequestCount+=1}else u(P,y,!1,c,Z,pt,n);return k}function u(P,y,T,Z,pt,n,r){y.writelen=Z,y.writecb=r,y.writing=!0,y.sync=!0,y.destroyed?y.onwrite(new Qt("write")):T?P._writev(pt,y.onwrite):P._write(pt,n,y.onwrite),y.sync=!1}function _(P,y,T,Z,pt){--y.pendingcb,T?(b.nextTick(pt,Z),b.nextTick(it,P,y),P._writableState.errorEmitted=!0,tt(P,Z)):(pt(Z),P._writableState.errorEmitted=!0,tt(P,Z),it(P,y))}function g(P){P.writing=!1,P.writecb=null,P.length-=P.writelen,P.writelen=0}function C(P,y){var T=P._writableState,Z=T.sync,pt=T.writecb;if(typeof pt!="function")throw new At;if(g(T),y)_(P,T,Z,y,pt);else{var n=N(T)||P.destroyed;n||T.corked||T.bufferProcessing||!T.bufferedRequest||H(P,T),Z?b.nextTick(v,P,T,n,pt):v(P,T,n,pt)}}function v(P,y,T,Z){T||D(P,y),y.pendingcb--,Z(),it(P,y)}function D(P,y){y.length===0&&y.needDrain&&(y.needDrain=!1,P.emit("drain"))}function H(P,y){y.bufferProcessing=!0;var T=y.bufferedRequest;if(P._writev&&T&&T.next){var Z=y.bufferedRequestCount,pt=Array(Z),n=y.corkedRequestsFree;n.entry=T;for(var r=0,c=!0;T;)pt[r]=T,T.isBuf||(c=!1),T=T.next,r+=1;pt.allBuffers=c,u(P,y,!0,y.length,pt,"",n.finish),y.pendingcb++,y.lastBufferedRequest=null,n.next?(y.corkedRequestsFree=n.next,n.next=null):y.corkedRequestsFree=new U(y),y.bufferedRequestCount=0}else{for(;T;){var k=T.chunk,G=T.encoding,z=T.callback,at=y.objectMode?1:k.length;if(u(P,y,!1,at,k,G,z),T=T.next,y.bufferedRequestCount--,y.writing)break}T===null&&(y.lastBufferedRequest=null)}y.bufferedRequest=T,y.bufferProcessing=!1}function N(P){return P.ending&&P.length===0&&P.bufferedRequest===null&&!P.finished&&!P.writing}function j(P,y){P._final(function(T){y.pendingcb--,T&&tt(P,T),y.prefinished=!0,P.emit("prefinish"),it(P,y)})}function q(P,y){y.prefinished||y.finalCalled||(typeof P._final!="function"||y.destroyed?(y.prefinished=!0,P.emit("prefinish")):(y.pendingcb++,y.finalCalled=!0,b.nextTick(j,P,y)))}function it(P,y){var T=N(y);if(T&&(q(P,y),y.pendingcb===0&&(y.finished=!0,P.emit("finish"),y.autoDestroy))){var Z=P._readableState;(!Z||Z.autoDestroy&&Z.endEmitted)&&P.destroy()}return T}function bt(P,y,T){y.ending=!0,it(P,y),T&&(y.finished?b.nextTick(T):P.once("finish",T)),y.ended=!0,P.writable=!1}function St(P,y,T){var Z=P.entry;for(P.entry=null;Z;){var pt=Z.callback;y.pendingcb--,pt(T),Z=Z.next}y.corkedRequestsFree.next=P}A.exports=h;var Rt;h.WritableState=d;var Dt={deprecate:M("util-deprecate")},Ut=M("./internal/streams/stream"),vt=M("buffer").Buffer,te=m.Uint8Array||function(){},Jt=M("./internal/streams/destroy"),ot=M("./internal/streams/state"),nt=ot.getHighWaterMark,lt=M("../errors").codes,wt=lt.ERR_INVALID_ARG_TYPE,_t=lt.ERR_METHOD_NOT_IMPLEMENTED,At=lt.ERR_MULTIPLE_CALLBACK,jt=lt.ERR_STREAM_CANNOT_PIPE,Qt=lt.ERR_STREAM_DESTROYED,xt=lt.ERR_STREAM_NULL_VALUES,ne=lt.ERR_STREAM_WRITE_AFTER_END,Y=lt.ERR_UNKNOWN_ENCODING,tt=Jt.errorOrDestroy;M("inherits")(h,Ut),d.prototype.getBuffer=function(){for(var P=this.bufferedRequest,y=[];P;)y.push(P),P=P.next;return y},function(){try{Object.defineProperty(d.prototype,"buffer",{get:Dt.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(P){}}();var yt;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(yt=Function.prototype[Symbol.hasInstance],Object.defineProperty(h,Symbol.hasInstance,{value:function(P){return!!yt.call(this,P)||this===h&&P&&P._writableState instanceof d}})):yt=function(P){return P instanceof this},h.prototype.pipe=function(){tt(this,new jt)},h.prototype.write=function(P,y,T){var Z=this._writableState,pt=!1,n=!Z.objectMode&&a(P);return n&&!vt.isBuffer(P)&&(P=L(P)),typeof y=="function"&&(T=y,y=null),n?y="buffer":!y&&(y=Z.defaultEncoding),typeof T!="function"&&(T=w),Z.ending?O(this,T):(n||R(this,Z,P,T))&&(Z.pendingcb++,pt=x(this,Z,n,P,y,T)),pt},h.prototype.cork=function(){this._writableState.corked++},h.prototype.uncork=function(){var P=this._writableState;P.corked&&(P.corked--,!P.writing&&!P.corked&&!P.bufferProcessing&&P.bufferedRequest&&H(this,P))},h.prototype.setDefaultEncoding=function(P){if(typeof P=="string"&&(P=P.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((P+"").toLowerCase())))throw new Y(P);return this._writableState.defaultEncoding=P,this},Object.defineProperty(h.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),h.prototype._write=function(P,y,T){T(new _t("_write()"))},h.prototype._writev=null,h.prototype.end=function(P,y,T){var Z=this._writableState;return typeof P=="function"?(T=P,P=null,y=null):typeof y=="function"&&(T=y,y=null),P!=null&&this.write(P,y),Z.corked&&(Z.corked=1,this.uncork()),Z.ending||bt(this,Z,T),this},Object.defineProperty(h.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(h.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(P){this._writableState&&(this._writableState.destroyed=P)}}),h.prototype.destroy=Jt.destroy,h.prototype._undestroy=Jt.undestroy,h.prototype._destroy=function(P,y){y(P)}}).call(this)}).call(this,M("_process"),typeof $.g=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:$.g)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,inherits:10,"util-deprecate":32}],21:[function(M,A){(function(b){(function(){"use strict";function m(D,H,N){return H in D?Object.defineProperty(D,H,{value:N,enumerable:!0,configurable:!0,writable:!0}):D[H]=N,D}function U(D,H){return{value:D,done:H}}function L(D){var H=D[O];if(H!==null){var N=D[g].read();N!==null&&(D[u]=null,D[O]=null,D[R]=null,H(U(N,!1)))}}function a(D){b.nextTick(L,D)}function w(D,H){return function(N,j){D.then(function(){return H[x]?void N(U(void 0,!0)):void H[_](N,j)},j)}}var d,h=M("./end-of-stream"),O=Symbol("lastResolve"),R=Symbol("lastReject"),S=Symbol("error"),x=Symbol("ended"),u=Symbol("lastPromise"),_=Symbol("handlePromise"),g=Symbol("stream"),C=Object.getPrototypeOf(function(){}),v=Object.setPrototypeOf((d={get stream(){return this[g]},next:function(){var D=this,H=this[S];if(H!==null)return Promise.reject(H);if(this[x])return Promise.resolve(U(void 0,!0));if(this[g].destroyed)return new Promise(function(it,bt){b.nextTick(function(){D[S]?bt(D[S]):it(U(void 0,!0))})});var N,j=this[u];if(j)N=new Promise(w(j,this));else{var q=this[g].read();if(q!==null)return Promise.resolve(U(q,!1));N=new Promise(this[_])}return this[u]=N,N}},m(d,Symbol.asyncIterator,function(){return this}),m(d,"return",function(){var D=this;return new Promise(function(H,N){D[g].destroy(null,function(j){return j?void N(j):void H(U(void 0,!0))})})}),d),C);A.exports=function(D){var H,N=Object.create(v,(H={},m(H,g,{value:D,writable:!0}),m(H,O,{value:null,writable:!0}),m(H,R,{value:null,writable:!0}),m(H,S,{value:null,writable:!0}),m(H,x,{value:D._readableState.endEmitted,writable:!0}),m(H,_,{value:function(j,q){var it=N[g].read();it?(N[u]=null,N[O]=null,N[R]=null,j(U(it,!1))):(N[O]=j,N[R]=q)},writable:!0}),H));return N[u]=null,h(D,function(j){if(j&&j.code!=="ERR_STREAM_PREMATURE_CLOSE"){var q=N[R];return q!==null&&(N[u]=null,N[O]=null,N[R]=null,q(j)),void(N[S]=j)}var it=N[O];it!==null&&(N[u]=null,N[O]=null,N[R]=null,it(U(void 0,!0))),N[x]=!0}),D.on("readable",a.bind(null,N)),N}}).call(this)}).call(this,M("_process"))},{"./end-of-stream":24,_process:12}],22:[function(M,A){"use strict";function b(u,_){var g=Object.keys(u);if(Object.getOwnPropertySymbols){var C=Object.getOwnPropertySymbols(u);_&&(C=C.filter(function(v){return Object.getOwnPropertyDescriptor(u,v).enumerable})),g.push.apply(g,C)}return g}function m(u){for(var _,g=1;g<arguments.length;g++)_=arguments[g]==null?{}:arguments[g],g%2?b(Object(_),!0).forEach(function(C){U(u,C,_[C])}):Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(_)):b(Object(_)).forEach(function(C){Object.defineProperty(u,C,Object.getOwnPropertyDescriptor(_,C))});return u}function U(u,_,g){return _ in u?Object.defineProperty(u,_,{value:g,enumerable:!0,configurable:!0,writable:!0}):u[_]=g,u}function L(u,_){if(!(u instanceof _))throw new TypeError("Cannot call a class as a function")}function a(u,_){for(var g,C=0;C<_.length;C++)g=_[C],g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(u,g.key,g)}function w(u,_,g){return _&&a(u.prototype,_),g&&a(u,g),u}function d(u,_,g){O.prototype.copy.call(u,_,g)}var h=M("buffer"),O=h.Buffer,R=M("util"),S=R.inspect,x=S&&S.custom||"inspect";A.exports=function(){function u(){L(this,u),this.head=null,this.tail=null,this.length=0}return w(u,[{key:"push",value:function(_){var g={data:_,next:null};0<this.length?this.tail.next=g:this.head=g,this.tail=g,++this.length}},{key:"unshift",value:function(_){var g={data:_,next:this.head};this.length===0&&(this.tail=g),this.head=g,++this.length}},{key:"shift",value:function(){if(this.length!==0){var _=this.head.data;return this.head=this.length===1?this.tail=null:this.head.next,--this.length,_}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(_){if(this.length===0)return"";for(var g=this.head,C=""+g.data;g=g.next;)C+=_+g.data;return C}},{key:"concat",value:function(_){if(this.length===0)return O.alloc(0);for(var g=O.allocUnsafe(_>>>0),C=this.head,v=0;C;)d(C.data,g,v),v+=C.data.length,C=C.next;return g}},{key:"consume",value:function(_,g){var C;return _<this.head.data.length?(C=this.head.data.slice(0,_),this.head.data=this.head.data.slice(_)):_===this.head.data.length?C=this.shift():C=g?this._getString(_):this._getBuffer(_),C}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(_){var g=this.head,C=1,v=g.data;for(_-=v.length;g=g.next;){var D=g.data,H=_>D.length?D.length:_;if(v+=H===D.length?D:D.slice(0,_),_-=H,_===0){H===D.length?(++C,this.head=g.next?g.next:this.tail=null):(this.head=g,g.data=D.slice(H));break}++C}return this.length-=C,v}},{key:"_getBuffer",value:function(_){var g=O.allocUnsafe(_),C=this.head,v=1;for(C.data.copy(g),_-=C.data.length;C=C.next;){var D=C.data,H=_>D.length?D.length:_;if(D.copy(g,g.length-_,0,H),_-=H,_===0){H===D.length?(++v,this.head=C.next?C.next:this.tail=null):(this.head=C,C.data=D.slice(H));break}++v}return this.length-=v,g}},{key:x,value:function(_,g){return S(this,m({},g,{depth:0,customInspect:!1}))}}]),u}()},{buffer:3,util:2}],23:[function(M,A){(function(b){(function(){"use strict";function m(a,w){L(a,w),U(a)}function U(a){a._writableState&&!a._writableState.emitClose||a._readableState&&!a._readableState.emitClose||a.emit("close")}function L(a,w){a.emit("error",w)}A.exports={destroy:function(a,w){var d=this,h=this._readableState&&this._readableState.destroyed,O=this._writableState&&this._writableState.destroyed;return h||O?(w?w(a):a&&(this._writableState?!this._writableState.errorEmitted&&(this._writableState.errorEmitted=!0,b.nextTick(L,this,a)):b.nextTick(L,this,a)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(a||null,function(R){!w&&R?d._writableState?d._writableState.errorEmitted?b.nextTick(U,d):(d._writableState.errorEmitted=!0,b.nextTick(m,d,R)):b.nextTick(m,d,R):w?(b.nextTick(U,d),w(R)):b.nextTick(U,d)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(a,w){var d=a._readableState,h=a._writableState;d&&d.autoDestroy||h&&h.autoDestroy?a.destroy(w):a.emit("error",w)}}}).call(this)}).call(this,M("_process"))},{_process:12}],24:[function(M,A){"use strict";function b(w){var d=!1;return function(){if(!d){d=!0;for(var h=arguments.length,O=Array(h),R=0;R<h;R++)O[R]=arguments[R];w.apply(this,O)}}}function m(){}function U(w){return w.setHeader&&typeof w.abort=="function"}function L(w,d,h){if(typeof d=="function")return L(w,null,d);d||(d={}),h=b(h||m);var O=d.readable||d.readable!==!1&&w.readable,R=d.writable||d.writable!==!1&&w.writable,S=function(){w.writable||u()},x=w._writableState&&w._writableState.finished,u=function(){R=!1,x=!0,O||h.call(w)},_=w._readableState&&w._readableState.endEmitted,g=function(){O=!1,_=!0,R||h.call(w)},C=function(H){h.call(w,H)},v=function(){var H;return O&&!_?(w._readableState&&w._readableState.ended||(H=new a),h.call(w,H)):R&&!x?(w._writableState&&w._writableState.ended||(H=new a),h.call(w,H)):void 0},D=function(){w.req.on("finish",u)};return U(w)?(w.on("complete",u),w.on("abort",v),w.req?D():w.on("request",D)):R&&!w._writableState&&(w.on("end",S),w.on("close",S)),w.on("end",g),w.on("finish",u),d.error!==!1&&w.on("error",C),w.on("close",v),function(){w.removeListener("complete",u),w.removeListener("abort",v),w.removeListener("request",D),w.req&&w.req.removeListener("finish",u),w.removeListener("end",S),w.removeListener("close",S),w.removeListener("finish",u),w.removeListener("end",g),w.removeListener("error",C),w.removeListener("close",v)}}var a=M("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;A.exports=L},{"../../../errors":15}],25:[function(M,A){A.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],26:[function(M,A){"use strict";function b(x){var u=!1;return function(){u||(u=!0,x.apply(void 0,arguments))}}function m(x){if(x)throw x}function U(x){return x.setHeader&&typeof x.abort=="function"}function L(x,u,_,g){g=b(g);var C=!1;x.on("close",function(){C=!0}),h===void 0&&(h=M("./end-of-stream")),h(x,{readable:u,writable:_},function(D){return D?g(D):(C=!0,void g())});var v=!1;return function(D){if(!C)return v?void 0:(v=!0,U(x)?x.abort():typeof x.destroy=="function"?x.destroy():void g(D||new S("pipe")))}}function a(x){x()}function w(x,u){return x.pipe(u)}function d(x){return x.length&&typeof x[x.length-1]=="function"?x.pop():m}var h,O=M("../../../errors").codes,R=O.ERR_MISSING_ARGS,S=O.ERR_STREAM_DESTROYED;A.exports=function(){for(var x=arguments.length,u=Array(x),_=0;_<x;_++)u[_]=arguments[_];var g=d(u);if(Array.isArray(u[0])&&(u=u[0]),2>u.length)throw new R("streams");var C,v=u.map(function(D,H){var N=H<u.length-1;return L(D,N,0<H,function(j){C||(C=j),j&&v.forEach(a),N||(v.forEach(a),g(C))})});return u.reduce(w)}},{"../../../errors":15,"./end-of-stream":24}],27:[function(M,A){"use strict";function b(U,L,a){return U.highWaterMark==null?L?U[a]:null:U.highWaterMark}var m=M("../../../errors").codes.ERR_INVALID_OPT_VALUE;A.exports={getHighWaterMark:function(U,L,a,w){var d=b(L,w,a);if(d!=null){if(!(isFinite(d)&&ct(d)===d)||0>d){var h=w?a:"highWaterMark";throw new m(h,d)}return ct(d)}return U.objectMode?16:16384}}},{"../../../errors":15}],28:[function(M,A){A.exports=M("events").EventEmitter},{events:7}],29:[function(M,A,b){b=A.exports=M("./lib/_stream_readable.js"),b.Stream=b,b.Readable=b,b.Writable=M("./lib/_stream_writable.js"),b.Duplex=M("./lib/_stream_duplex.js"),b.Transform=M("./lib/_stream_transform.js"),b.PassThrough=M("./lib/_stream_passthrough.js"),b.finished=M("./lib/internal/streams/end-of-stream.js"),b.pipeline=M("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],30:[function(M,A,b){function m(w,d){for(var h in w)d[h]=w[h]}function U(w,d,h){return a(w,d,h)}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var L=M("buffer"),a=L.Buffer;a.from&&a.alloc&&a.allocUnsafe&&a.allocUnsafeSlow?A.exports=L:(m(L,b),b.Buffer=U),U.prototype=Object.create(a.prototype),m(a,U),U.from=function(w,d,h){if(typeof w=="number")throw new TypeError("Argument must not be a number");return a(w,d,h)},U.alloc=function(w,d,h){if(typeof w!="number")throw new TypeError("Argument must be a number");var O=a(w);return d===void 0?O.fill(0):typeof h=="string"?O.fill(d,h):O.fill(d),O},U.allocUnsafe=function(w){if(typeof w!="number")throw new TypeError("Argument must be a number");return a(w)},U.allocUnsafeSlow=function(w){if(typeof w!="number")throw new TypeError("Argument must be a number");return L.SlowBuffer(w)}},{buffer:3}],31:[function(M,A,b){"use strict";function m(v){if(!v)return"utf8";for(var D;;)switch(v){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return v;default:if(D)return;v=(""+v).toLowerCase(),D=!0}}function U(v){var D=m(v);if(typeof D!="string"&&(g.isEncoding===C||!C(v)))throw new Error("Unknown encoding: "+v);return D||v}function L(v){this.encoding=U(v);var D;switch(this.encoding){case"utf16le":this.text=O,this.end=R,D=4;break;case"utf8":this.fillLast=h,D=4;break;case"base64":this.text=S,this.end=x,D=3;break;default:return this.write=u,void(this.end=_)}this.lastNeed=0,this.lastTotal=0,this.lastChar=g.allocUnsafe(D)}function a(v){return 127>=v?0:v>>5==6?2:v>>4==14?3:v>>3==30?4:v>>6==2?-1:-2}function w(v,D,H){var N=D.length-1;if(N<H)return 0;var j=a(D[N]);return 0<=j?(0<j&&(v.lastNeed=j-1),j):--N<H||j===-2?0:(j=a(D[N]),0<=j?(0<j&&(v.lastNeed=j-2),j):--N<H||j===-2?0:(j=a(D[N]),0<=j?(0<j&&(j===2?j=0:v.lastNeed=j-3),j):0))}function d(v,D){if((192&D[0])!=128)return v.lastNeed=0,"\uFFFD";if(1<v.lastNeed&&1<D.length){if((192&D[1])!=128)return v.lastNeed=1,"\uFFFD";if(2<v.lastNeed&&2<D.length&&(192&D[2])!=128)return v.lastNeed=2,"\uFFFD"}}function h(v){var D=this.lastTotal-this.lastNeed,H=d(this,v,D);return H===void 0?this.lastNeed<=v.length?(v.copy(this.lastChar,D,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(v.copy(this.lastChar,D,0,v.length),void(this.lastNeed-=v.length)):H}function O(v,D){if((v.length-D)%2==0){var H=v.toString("utf16le",D);if(H){var N=H.charCodeAt(H.length-1);if(55296<=N&&56319>=N)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=v[v.length-2],this.lastChar[1]=v[v.length-1],H.slice(0,-1)}return H}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=v[v.length-1],v.toString("utf16le",D,v.length-1)}function R(v){var D=v&&v.length?this.write(v):"";if(this.lastNeed){var H=this.lastTotal-this.lastNeed;return D+this.lastChar.toString("utf16le",0,H)}return D}function S(v,D){var H=(v.length-D)%3;return H==0?v.toString("base64",D):(this.lastNeed=3-H,this.lastTotal=3,H==1?this.lastChar[0]=v[v.length-1]:(this.lastChar[0]=v[v.length-2],this.lastChar[1]=v[v.length-1]),v.toString("base64",D,v.length-H))}function x(v){var D=v&&v.length?this.write(v):"";return this.lastNeed?D+this.lastChar.toString("base64",0,3-this.lastNeed):D}function u(v){return v.toString(this.encoding)}function _(v){return v&&v.length?this.write(v):""}var g=M("safe-buffer").Buffer,C=g.isEncoding||function(v){switch(v=""+v,v&&v.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};b.StringDecoder=L,L.prototype.write=function(v){if(v.length===0)return"";var D,H;if(this.lastNeed){if(D=this.fillLast(v),D===void 0)return"";H=this.lastNeed,this.lastNeed=0}else H=0;return H<v.length?D?D+this.text(v,H):this.text(v,H):D||""},L.prototype.end=function(v){var D=v&&v.length?this.write(v):"";return this.lastNeed?D+"\uFFFD":D},L.prototype.text=function(v,D){var H=w(this,v,D);if(!this.lastNeed)return v.toString("utf8",D);this.lastTotal=H;var N=v.length-(H-this.lastNeed);return v.copy(this.lastChar,0,N),v.toString("utf8",D,N)},L.prototype.fillLast=function(v){return this.lastNeed<=v.length?(v.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(v.copy(this.lastChar,this.lastTotal-this.lastNeed,0,v.length),void(this.lastNeed-=v.length))}},{"safe-buffer":30}],32:[function(M,A){(function(b){(function(){function m(U){try{if(!b.localStorage)return!1}catch(a){return!1}var L=b.localStorage[U];return L!=null&&(L+"").toLowerCase()==="true"}A.exports=function(U,L){function a(){if(!w){if(m("throwDeprecation"))throw new Error(L);m("traceDeprecation")?console.trace(L):console.warn(L),w=!0}return U.apply(this,arguments)}if(m("noDeprecation"))return U;var w=!1;return a}}).call(this)}).call(this,typeof $.g=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:$.g)},{}],"/":[function(M,A){function b(x){return x.replace(/a=ice-options:trickle\s\n/g,"")}function m(x){console.warn(x)}/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */const U=M("debug")("simple-peer"),L=M("get-browser-rtc"),a=M("randombytes"),w=M("readable-stream"),d=M("queue-microtask"),h=M("err-code"),{Buffer:O}=M("buffer"),R=65536;class S extends w.Duplex{constructor(u){if(u=Object.assign({allowHalfOpen:!1},u),super(u),this._id=a(4).toString("hex").slice(0,7),this._debug("new peer %o",u),this.channelName=u.initiator?u.channelName||a(20).toString("hex"):null,this.initiator=u.initiator||!1,this.channelConfig=u.channelConfig||S.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},S.config,u.config),this.offerOptions=u.offerOptions||{},this.answerOptions=u.answerOptions||{},this.sdpTransform=u.sdpTransform||(_=>_),this.streams=u.streams||(u.stream?[u.stream]:[]),this.trickle=u.trickle===void 0||u.trickle,this.allowHalfTrickle=u.allowHalfTrickle!==void 0&&u.allowHalfTrickle,this.iceCompleteTimeout=u.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=u.wrtc&&typeof u.wrtc=="object"?u.wrtc:L(),!this._wrtc)throw h(typeof window=="undefined"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(_){return void this.destroy(h(_,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=_=>{this._onIceCandidate(_)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(_=>{this.destroy(h(_,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=_=>{this._setupData(_)},this.streams&&this.streams.forEach(_=>{this.addStream(_)}),this._pc.ontrack=_=>{this._onTrack(_)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(u){if(!this.destroying){if(this.destroyed)throw h(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof u=="string")try{u=JSON.parse(u)}catch(_){u={}}this._debug("signal()"),u.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),u.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(u.transceiverRequest.kind,u.transceiverRequest.init)),u.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(u.candidate):this._pendingCandidates.push(u.candidate)),u.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(u)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(_=>{this._addIceCandidate(_)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(_=>{this.destroy(h(_,"ERR_SET_REMOTE_DESCRIPTION"))}),u.sdp||u.candidate||u.renegotiate||u.transceiverRequest||this.destroy(h(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(u){const _=new this._wrtc.RTCIceCandidate(u);this._pc.addIceCandidate(_).catch(g=>{!_.address||_.address.endsWith(".local")?m("Ignoring unsupported ICE candidate."):this.destroy(h(g,"ERR_ADD_ICE_CANDIDATE"))})}send(u){if(!this.destroying){if(this.destroyed)throw h(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(u)}}addTransceiver(u,_){if(!this.destroying){if(this.destroyed)throw h(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(u,_),this._needsNegotiation()}catch(g){this.destroy(h(g,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:u,init:_}})}}addStream(u){if(!this.destroying){if(this.destroyed)throw h(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),u.getTracks().forEach(_=>{this.addTrack(_,u)})}}addTrack(u,_){if(this.destroying)return;if(this.destroyed)throw h(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const g=this._senderMap.get(u)||new Map;let C=g.get(_);if(!C)C=this._pc.addTrack(u,_),g.set(_,C),this._senderMap.set(u,g),this._needsNegotiation();else throw C.removed?h(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):h(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(u,_,g){if(this.destroying)return;if(this.destroyed)throw h(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const C=this._senderMap.get(u),v=C?C.get(g):null;if(!v)throw h(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");_&&this._senderMap.set(_,C),v.replaceTrack==null?this.destroy(h(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):v.replaceTrack(_)}removeTrack(u,_){if(this.destroying)return;if(this.destroyed)throw h(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const g=this._senderMap.get(u),C=g?g.get(_):null;if(!C)throw h(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{C.removed=!0,this._pc.removeTrack(C)}catch(v){v.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(C):this.destroy(h(v,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(u){if(!this.destroying){if(this.destroyed)throw h(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),u.getTracks().forEach(_=>{this.removeTrack(_,u)})}}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,d(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw h(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(u){this._destroy(u,()=>{})}_destroy(u,_){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",u&&(u.message||u)),d(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",u&&(u.message||u)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(g){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(g){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,u&&this.emit("error",u),this.emit("close"),_()}))}_setupData(u){if(!u.channel)return this.destroy(h(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=u.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=R),this.channelName=this._channel.label,this._channel.onmessage=g=>{this._onChannelMessage(g)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=g=>{const C=g.error instanceof Error?g.error:new Error(`Datachannel error: ${g.message} ${g.filename}:${g.lineno}:${g.colno}`);this.destroy(h(C,"ERR_DATA_CHANNEL"))};let _=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(_&&this._onChannelClose(),_=!0):_=!1},5e3)}_read(){}_write(u,_,g){if(this.destroyed)return g(h(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(u)}catch(C){return this.destroy(h(C,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>R?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=g):g(null)}else this._debug("write before connect"),this._chunk=u,this._cb=g}_onFinish(){if(!this.destroyed){const u=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?u():this.once("connect",u)}}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(u=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(u.sdp=b(u.sdp)),u.sdp=this.sdpTransform(u.sdp);const _=()=>{if(!this.destroyed){const g=this._pc.localDescription||u;this._debug("signal"),this.emit("signal",{type:g.type,sdp:g.sdp})}};this._pc.setLocalDescription(u).then(()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?_():this.once("_iceComplete",_))}).catch(g=>{this.destroy(h(g,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(u=>{this.destroy(h(u,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(u=>{u.mid||!u.sender.track||u.requested||(u.requested=!0,this.addTransceiver(u.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(u=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(u.sdp=b(u.sdp)),u.sdp=this.sdpTransform(u.sdp);const _=()=>{if(!this.destroyed){const g=this._pc.localDescription||u;this._debug("signal"),this.emit("signal",{type:g.type,sdp:g.sdp}),this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(u).then(()=>{this.destroyed||(this.trickle||this._iceComplete?_():this.once("_iceComplete",_))}).catch(g=>{this.destroy(h(g,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(u=>{this.destroy(h(u,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(h(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const u=this._pc.iceConnectionState,_=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",u,_),this.emit("iceStateChange",u,_),(u==="connected"||u==="completed")&&(this._pcReady=!0,this._maybeReady()),u==="failed"&&this.destroy(h(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),u==="closed"&&this.destroy(h(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(u){const _=g=>(Object.prototype.toString.call(g.values)==="[object Array]"&&g.values.forEach(C=>{Object.assign(g,C)}),g);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(g=>{const C=[];g.forEach(v=>{C.push(_(v))}),u(null,C)},g=>u(g)):0<this._pc.getStats.length?this._pc.getStats(g=>{if(this.destroyed)return;const C=[];g.result().forEach(v=>{const D={};v.names().forEach(H=>{D[H]=v.stat(H)}),D.id=v.id,D.type=v.type,D.timestamp=v.timestamp,C.push(_(D))}),u(null,C)},g=>u(g)):u(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const u=()=>{this.destroyed||this.getStats((_,g)=>{if(this.destroyed)return;_&&(g=[]);const C={},v={},D={};let H=!1;g.forEach(j=>{(j.type==="remotecandidate"||j.type==="remote-candidate")&&(C[j.id]=j),(j.type==="localcandidate"||j.type==="local-candidate")&&(v[j.id]=j),(j.type==="candidatepair"||j.type==="candidate-pair")&&(D[j.id]=j)});const N=j=>{H=!0;let q=v[j.localCandidateId];q&&(q.ip||q.address)?(this.localAddress=q.ip||q.address,this.localPort=+q.port):q&&q.ipAddress?(this.localAddress=q.ipAddress,this.localPort=+q.portNumber):typeof j.googLocalAddress=="string"&&(q=j.googLocalAddress.split(":"),this.localAddress=q[0],this.localPort=+q[1]),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let it=C[j.remoteCandidateId];it&&(it.ip||it.address)?(this.remoteAddress=it.ip||it.address,this.remotePort=+it.port):it&&it.ipAddress?(this.remoteAddress=it.ipAddress,this.remotePort=+it.portNumber):typeof j.googRemoteAddress=="string"&&(it=j.googRemoteAddress.split(":"),this.remoteAddress=it[0],this.remotePort=+it[1]),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(g.forEach(j=>{j.type==="transport"&&j.selectedCandidatePairId&&N(D[j.selectedCandidatePairId]),(j.type==="googCandidatePair"&&j.googActiveConnection==="true"||(j.type==="candidatepair"||j.type==="candidate-pair")&&j.selected)&&N(j)}),!H&&(!Object.keys(D).length||Object.keys(v).length))return void setTimeout(u,100);if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(q){return this.destroy(h(q,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const j=this._cb;this._cb=null,j(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};u()}_onInterval(){this._cb&&this._channel&&!(this._channel.bufferedAmount>R)&&this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(u=>{this._pc.removeTrack(u),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(u){this.destroyed||(u.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:u.candidate.candidate,sdpMLineIndex:u.candidate.sdpMLineIndex,sdpMid:u.candidate.sdpMid}}):!u.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),u.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(u){if(this.destroyed)return;let _=u.data;_ instanceof ArrayBuffer&&(_=O.from(_)),this.push(_)}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const u=this._cb;this._cb=null,u(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(u){this.destroyed||u.streams.forEach(_=>{this._debug("on track"),this.emit("track",u.track,_),this._remoteTracks.push({track:u.track,stream:_}),this._remoteStreams.some(g=>g.id===_.id)||(this._remoteStreams.push(_),d(()=>{this._debug("on stream"),this.emit("stream",_)}))})}_debug(){const u=[].slice.call(arguments);u[0]="["+this._id+"] "+u[0],U.apply(null,u)}}S.WEBRTC_SUPPORT=!!L(),S.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},S.channelConfig={},A.exports=S},{buffer:3,debug:4,"err-code":6,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/")})},"../../../node_modules/.pnpm/yjs@13.6.8/node_modules/yjs/dist/yjs.mjs":(Vt,Tt,$)=>{"use strict";$.d(Tt,{QW:()=>ot,NG:()=>pt,D$:()=>c,gJ:()=>Ft,ay:()=>Wt});var ct=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/observable.js"),ft=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/array.js"),st=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/math.js"),M=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/map.js"),A=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/encoding.js"),b=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/decoding.js"),m=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/random.js"),U=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/promise.js"),L=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/buffer.js"),a=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/error.js"),w=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/binary.js"),d=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/function.js"),h=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/set.js"),O=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/logging.js"),R=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/logging.common.js");const S=(i,t)=>({[Symbol.iterator](){return this},next(){const e=i.next();return{value:e.done?void 0:t(e.value),done:e.done}}}),x=i=>({[Symbol.iterator](){return this},next:i}),u=(i,t)=>x(()=>{let e;do e=i.next();while(!e.done&&!t(e.value));return e}),_=(i,t)=>x(()=>{const{done:e,value:s}=i.next();return{done:e,value:e?void 0:t(s)}});var g=$("../../../node_modules/.pnpm/lib0@0.2.87/node_modules/lib0/object.js");class C extends null{constructor(t,e){super(),this.doc=t,this.awareness=e}}class v{constructor(t,e){this.clock=t,this.len=e}}class D{constructor(){this.clients=new Map}}const H=(i,t,e)=>t.clients.forEach((s,o)=>{const l=i.doc.store.clients.get(o);for(let p=0;p<s.length;p++){const E=s[p];mn(i,l,E.clock,E.len,e)}}),N=(i,t)=>{let e=0,s=i.length-1;for(;e<=s;){const o=st.GW((e+s)/2),l=i[o],p=l.clock;if(p<=t){if(t<p+l.len)return o;e=o+1}else s=o-1}return null},j=(i,t)=>{const e=i.clients.get(t.client);return e!==void 0&&N(e,t.clock)!==null},q=i=>{i.clients.forEach(t=>{t.sort((o,l)=>o.clock-l.clock);let e,s;for(e=1,s=1;e<t.length;e++){const o=t[s-1],l=t[e];o.clock+o.len>=l.clock?o.len=st.Fp(o.len,l.clock+l.len-o.clock):(s<e&&(t[s]=l),s++)}t.length=s})},it=i=>{const t=new D;for(let e=0;e<i.length;e++)i[e].clients.forEach((s,o)=>{if(!t.clients.has(o)){const l=s.slice();for(let p=e+1;p<i.length;p++)ft.s7(l,i[p].clients.get(o)||[]);t.clients.set(o,l)}});return q(t),t},bt=(i,t,e,s)=>{M.Yu(i.clients,t,()=>[]).push(new v(e,s))},St=()=>new D,Rt=i=>{const t=St();return i.clients.forEach((e,s)=>{const o=[];for(let l=0;l<e.length;l++){const p=e[l];if(p.deleted){const E=p.id.clock;let I=p.length;if(l+1<e.length)for(let F=e[l+1];l+1<e.length&&F.deleted;F=e[++l+1])I+=F.length;o.push(new v(E,I))}}o.length>0&&t.clients.set(s,o)}),t},Dt=(i,t)=>{A.uE(i.restEncoder,t.clients.size),ft.Dp(t.clients.entries()).sort((e,s)=>s[0]-e[0]).forEach(([e,s])=>{i.resetDsCurVal(),A.uE(i.restEncoder,e);const o=s.length;A.uE(i.restEncoder,o);for(let l=0;l<o;l++){const p=s[l];i.writeDsClock(p.clock),i.writeDsLen(p.len)}})},Ut=i=>{const t=new D,e=b.yg(i.restDecoder);for(let s=0;s<e;s++){i.resetDsCurVal();const o=b.yg(i.restDecoder),l=b.yg(i.restDecoder);if(l>0){const p=M.Yu(t.clients,o,()=>[]);for(let E=0;E<l;E++)p.push(new v(i.readDsClock(),i.readDsLen()))}}return t},vt=(i,t,e)=>{const s=new D,o=b.yg(i.restDecoder);for(let l=0;l<o;l++){i.resetDsCurVal();const p=b.yg(i.restDecoder),E=b.yg(i.restDecoder),I=e.clients.get(p)||[],F=Kt(e,p);for(let B=0;B<E;B++){const V=i.readDsClock(),Q=V+i.readDsLen();if(V<F){F<Q&&bt(s,p,F,Q-F);let et=ae(I,V),dt=I[et];for(!dt.deleted&&dt.id.clock<V&&(I.splice(et+1,0,$e(t,dt,V-dt.id.clock)),et++);et<I.length&&(dt=I[et++],dt.id.clock<Q);)dt.deleted||(Q<dt.id.clock+dt.length&&I.splice(et,0,$e(t,dt,Q-dt.id.clock)),dt.delete(t))}else bt(s,p,V,Q-V)}}if(s.clients.size>0){const l=new xt;return A.uE(l.restEncoder,0),Dt(l,s),l.toUint8Array()}return null},te=(i,t)=>{if(i.clients.size!==t.clients.size)return!1;for(const[e,s]of i.clients.entries()){const o=t.clients.get(e);if(o===void 0||s.length!==o.length)return!1;for(let l=0;l<s.length;l++){const p=s[l],E=o[l];if(p.clock!==E.clock||p.len!==E.len)return!1}}return!0},Jt=m.U7;class ot extends ct.y{constructor({guid:t=m.k$(),collectionid:e=null,gc:s=!0,gcFilter:o=()=>!0,meta:l=null,autoLoad:p=!1,shouldLoad:E=!0}={}){super(),this.gc=s,this.gcFilter=o,this.clientID=Jt(),this.guid=t,this.collectionid=e,this.share=new Map,this.store=new fn,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=E,this.autoLoad=p,this.meta=l,this.isLoaded=!1,this.isSynced=!1,this.whenLoaded=U.Ue(F=>{this.on("load",()=>{this.isLoaded=!0,F(this)})});const I=()=>U.Ue(F=>{const B=V=>{(V===void 0||V===!0)&&(this.off("sync",B),F())};this.on("sync",B)});this.on("sync",F=>{F===!1&&this.isSynced&&(this.whenSynced=I()),this.isSynced=F===void 0||F===!0,this.isLoaded||this.emit("load",[])}),this.whenSynced=I()}load(){const t=this._item;t!==null&&!this.shouldLoad&&Wt(t.parent.doc,e=>{e.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(ft.Dp(this.subdocs).map(t=>t.guid))}transact(t,e=null){return Wt(this,t,e)}get(t,e=ee){const s=M.Yu(this.share,t,()=>{const l=new e;return l._integrate(this,null),l}),o=s.constructor;if(e!==ee&&o!==e)if(o===ee){const l=new e;l._map=s._map,s._map.forEach(p=>{for(;p!==null;p=p.left)p.parent=l}),l._start=s._start;for(let p=l._start;p!==null;p=p.right)p.parent=l;return l._length=s._length,this.share.set(t,l),l._integrate(this,null),l}else throw new Error(`Type with the name ${t} has already been defined with a different constructor`);return s}getArray(t=""){return this.get(t,me)}getText(t=""){return this.get(t,ke)}getMap(t=""){return this.get(t,ve)}getXmlFragment(t=""){return this.get(t,Ee)}toJSON(){const t={};return this.share.forEach((e,s)=>{t[s]=e.toJSON()}),t}destroy(){ft.Dp(this.subdocs).forEach(e=>e.destroy());const t=this._item;if(t!==null){this._item=null;const e=t.content;e.doc=new ot({guid:this.guid,...e.opts,shouldLoad:!1}),e.doc._item=t,Wt(t.parent.doc,s=>{const o=e.doc;t.deleted||s.subdocsAdded.add(o),s.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}on(t,e){super.on(t,e)}off(t,e){super.off(t,e)}}class nt{constructor(t){this.restDecoder=t}resetDsCurVal(){}readDsClock(){return b.yg(this.restDecoder)}readDsLen(){return b.yg(this.restDecoder)}}class lt extends nt{readLeftID(){return gt(b.yg(this.restDecoder),b.yg(this.restDecoder))}readRightID(){return gt(b.yg(this.restDecoder),b.yg(this.restDecoder))}readClient(){return b.yg(this.restDecoder)}readInfo(){return b.kj(this.restDecoder)}readString(){return b.kf(this.restDecoder)}readParentInfo(){return b.yg(this.restDecoder)===1}readTypeRef(){return b.yg(this.restDecoder)}readLen(){return b.yg(this.restDecoder)}readAny(){return b.v_(this.restDecoder)}readBuf(){return L.f9(b.HN(this.restDecoder))}readJSON(){return JSON.parse(b.kf(this.restDecoder))}readKey(){return b.kf(this.restDecoder)}}class wt{constructor(t){this.dsCurrVal=0,this.restDecoder=t}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=b.yg(this.restDecoder),this.dsCurrVal}readDsLen(){const t=b.yg(this.restDecoder)+1;return this.dsCurrVal+=t,t}}class _t extends wt{constructor(t){super(t),this.keys=[],b.yg(t),this.keyClockDecoder=new b.dD(b.HN(t)),this.clientDecoder=new b.UF(b.HN(t)),this.leftClockDecoder=new b.dD(b.HN(t)),this.rightClockDecoder=new b.dD(b.HN(t)),this.infoDecoder=new b.XW(b.HN(t),b.kj),this.stringDecoder=new b.sO(b.HN(t)),this.parentInfoDecoder=new b.XW(b.HN(t),b.kj),this.typeRefDecoder=new b.UF(b.HN(t)),this.lenDecoder=new b.UF(b.HN(t))}readLeftID(){return new rt(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new rt(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return b.v_(this.restDecoder)}readBuf(){return b.HN(this.restDecoder)}readJSON(){return b.v_(this.restDecoder)}readKey(){const t=this.keyClockDecoder.read();if(t<this.keys.length)return this.keys[t];{const e=this.stringDecoder.read();return this.keys.push(e),e}}}class At{constructor(){this.restEncoder=A.Mf()}toUint8Array(){return A._f(this.restEncoder)}resetDsCurVal(){}writeDsClock(t){A.uE(this.restEncoder,t)}writeDsLen(t){A.uE(this.restEncoder,t)}}class jt extends At{writeLeftID(t){A.uE(this.restEncoder,t.client),A.uE(this.restEncoder,t.clock)}writeRightID(t){A.uE(this.restEncoder,t.client),A.uE(this.restEncoder,t.clock)}writeClient(t){A.uE(this.restEncoder,t)}writeInfo(t){A.$F(this.restEncoder,t)}writeString(t){A.uw(this.restEncoder,t)}writeParentInfo(t){A.uE(this.restEncoder,t?1:0)}writeTypeRef(t){A.uE(this.restEncoder,t)}writeLen(t){A.uE(this.restEncoder,t)}writeAny(t){A.EM(this.restEncoder,t)}writeBuf(t){A.mP(this.restEncoder,t)}writeJSON(t){A.uw(this.restEncoder,JSON.stringify(t))}writeKey(t){A.uw(this.restEncoder,t)}}class Qt{constructor(){this.restEncoder=A.Mf(),this.dsCurrVal=0}toUint8Array(){return A._f(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(t){const e=t-this.dsCurrVal;this.dsCurrVal=t,A.uE(this.restEncoder,e)}writeDsLen(t){t===0&&a.zR(),A.uE(this.restEncoder,t-1),this.dsCurrVal+=t}}class xt extends Qt{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new A.sX,this.clientEncoder=new A.HE,this.leftClockEncoder=new A.sX,this.rightClockEncoder=new A.sX,this.infoEncoder=new A.GF(A.$F),this.stringEncoder=new A.TS,this.parentInfoEncoder=new A.GF(A.$F),this.typeRefEncoder=new A.HE,this.lenEncoder=new A.HE}toUint8Array(){const t=A.Mf();return A.uE(t,0),A.mP(t,this.keyClockEncoder.toUint8Array()),A.mP(t,this.clientEncoder.toUint8Array()),A.mP(t,this.leftClockEncoder.toUint8Array()),A.mP(t,this.rightClockEncoder.toUint8Array()),A.mP(t,A._f(this.infoEncoder)),A.mP(t,this.stringEncoder.toUint8Array()),A.mP(t,A._f(this.parentInfoEncoder)),A.mP(t,this.typeRefEncoder.toUint8Array()),A.mP(t,this.lenEncoder.toUint8Array()),A.HK(t,A._f(this.restEncoder)),A._f(t)}writeLeftID(t){this.clientEncoder.write(t.client),this.leftClockEncoder.write(t.clock)}writeRightID(t){this.clientEncoder.write(t.client),this.rightClockEncoder.write(t.clock)}writeClient(t){this.clientEncoder.write(t)}writeInfo(t){this.infoEncoder.write(t)}writeString(t){this.stringEncoder.write(t)}writeParentInfo(t){this.parentInfoEncoder.write(t?1:0)}writeTypeRef(t){this.typeRefEncoder.write(t)}writeLen(t){this.lenEncoder.write(t)}writeAny(t){A.EM(this.restEncoder,t)}writeBuf(t){A.mP(this.restEncoder,t)}writeJSON(t){A.EM(this.restEncoder,t)}writeKey(t){const e=this.keyMap.get(t);e===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(t)):this.keyClockEncoder.write(e)}}const ne=(i,t,e,s)=>{s=st.Fp(s,t[0].id.clock);const o=ae(t,s);A.uE(i.restEncoder,t.length-o),i.writeClient(e),A.uE(i.restEncoder,s);const l=t[o];l.write(i,s-l.id.clock);for(let p=o+1;p<t.length;p++)t[p].write(i,0)},Y=(i,t,e)=>{const s=new Map;e.forEach((o,l)=>{Kt(t,l)>o&&s.set(l,o)}),Ue(t).forEach((o,l)=>{e.has(l)||s.set(l,0)}),A.uE(i.restEncoder,s.size),ft.Dp(s.entries()).sort((o,l)=>l[0]-o[0]).forEach(([o,l])=>{ne(i,t.clients.get(o),o,l)})},tt=(i,t)=>{const e=M.Ue(),s=b.yg(i.restDecoder);for(let o=0;o<s;o++){const l=b.yg(i.restDecoder),p=new Array(l),E=i.readClient();let I=b.yg(i.restDecoder);e.set(E,{i:0,refs:p});for(let F=0;F<l;F++){const B=i.readInfo();switch(w.kr&B){case 0:{const V=i.readLen();p[F]=new le(gt(E,I),V),I+=V;break}case 10:{const V=b.yg(i.restDecoder);p[F]=new oe(gt(E,I),V),I+=V;break}default:{const V=(B&(w.rc|w.x1))===0,Q=new Ht(gt(E,I),null,(B&w.x1)===w.x1?i.readLeftID():null,null,(B&w.rc)===w.rc?i.readRightID():null,V?i.readParentInfo()?t.get(i.readString()):i.readLeftID():null,V&&(B&w.cq)===w.cq?i.readString():null,Jn(i,B));p[F]=Q,I+=Q.length}}}}return e},yt=(i,t,e)=>{const s=[];let o=ft.Dp(e.keys()).sort((et,dt)=>et-dt);if(o.length===0)return null;const l=()=>{if(o.length===0)return null;let et=e.get(o[o.length-1]);for(;et.refs.length===et.i;)if(o.pop(),o.length>0)et=e.get(o[o.length-1]);else return null;return et};let p=l();if(p===null&&s.length===0)return null;const E=new fn,I=new Map,F=(et,dt)=>{const Ot=I.get(et);(Ot==null||Ot>dt)&&I.set(et,dt)};let B=p.refs[p.i++];const V=new Map,Q=()=>{for(const et of s){const dt=et.id.client,Ot=e.get(dt);Ot?(Ot.i--,E.clients.set(dt,Ot.refs.slice(Ot.i)),e.delete(dt),Ot.i=0,Ot.refs=[]):E.clients.set(dt,[et]),o=o.filter(zt=>zt!==dt)}s.length=0};for(;;){if(B.constructor!==oe){const dt=M.Yu(V,B.id.client,()=>Kt(t,B.id.client))-B.id.clock;if(dt<0)s.push(B),F(B.id.client,B.id.clock-1),Q();else{const Ot=B.getMissing(i,t);if(Ot!==null){s.push(B);const zt=e.get(Ot)||{refs:[],i:0};if(zt.refs.length===zt.i)F(Ot,Kt(t,Ot)),Q();else{B=zt.refs[zt.i++];continue}}else(dt===0||dt<B.length)&&(B.integrate(i,dt),V.set(B.id.client,B.id.clock+B.length))}}if(s.length>0)B=s.pop();else if(p!==null&&p.i<p.refs.length)B=p.refs[p.i++];else{if(p=l(),p===null)break;B=p.refs[p.i++]}}if(E.clients.size>0){const et=new xt;return Y(et,E,new Map),A.uE(et.restEncoder,0),{missing:I,update:et.toUint8Array()}}return null},P=(i,t)=>Y(i,t.doc.store,t.beforeState),y=(i,t,e,s=new _t(i))=>Wt(t,o=>{o.local=!1;let l=!1;const p=o.doc,E=p.store,I=tt(s,p),F=yt(o,E,I),B=E.pendingStructs;if(B){for(const[Q,et]of B.missing)if(et<Kt(E,Q)){l=!0;break}if(F){for(const[Q,et]of F.missing){const dt=B.missing.get(Q);(dt==null||dt>et)&&B.missing.set(Q,et)}B.update=je([B.update,F.update])}}else E.pendingStructs=F;const V=vt(s,o,E);if(E.pendingDs){const Q=new _t(b.l1(E.pendingDs));b.yg(Q.restDecoder);const et=vt(Q,o,E);V&&et?E.pendingDs=je([V,et]):E.pendingDs=V||et}else E.pendingDs=V;if(l){const Q=E.pendingStructs.update;E.pendingStructs=null,Z(o.doc,Q)}},e,!1),T=(i,t,e)=>y(i,t,e,new lt(i)),Z=(i,t,e,s=_t)=>{const o=b.l1(t);y(o,i,e,new s(o))},pt=(i,t,e)=>Z(i,t,e,lt),n=(i,t,e=new Map)=>{Y(i,t.store,e),Dt(i,Rt(t.store))},r=(i,t=new Uint8Array([0]),e=new xt)=>{const s=G(t);n(e,i,s);const o=[e.toUint8Array()];if(i.store.pendingDs&&o.push(i.store.pendingDs),i.store.pendingStructs&&o.push(Cn(i.store.pendingStructs.update,t)),o.length>1){if(e.constructor===jt)return cr(o.map((l,p)=>p===0?l:dr(l)));if(e.constructor===xt)return je(o)}return o[0]},c=(i,t)=>r(i,t,new jt),k=i=>{const t=new Map,e=b.yg(i.restDecoder);for(let s=0;s<e;s++){const o=b.yg(i.restDecoder),l=b.yg(i.restDecoder);t.set(o,l)}return t},G=i=>k(new nt(b.l1(i))),z=(i,t)=>(A.uE(i.restEncoder,t.size),ft.Dp(t.entries()).sort((e,s)=>s[0]-e[0]).forEach(([e,s])=>{A.uE(i.restEncoder,e),A.uE(i.restEncoder,s)}),i),at=(i,t)=>z(i,Ue(t.store)),kt=(i,t=new Qt)=>(i instanceof Map?z(t,i):at(t,i),t.toUint8Array()),Ft=i=>kt(i,new At);class Lt{constructor(){this.l=[]}}const It=()=>new Lt,Mt=(i,t)=>i.l.push(t),ie=(i,t)=>{const e=i.l,s=e.length;i.l=e.filter(o=>t!==o),s===i.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},J=(i,t,e)=>d.PP(i.l,[t,e]);class rt{constructor(t,e){this.client=t,this.clock=e}}const mt=(i,t)=>i===t||i!==null&&t!==null&&i.client===t.client&&i.clock===t.clock,gt=(i,t)=>new rt(i,t),Pt=(i,t)=>{encoding.writeVarUint(i,t.client),encoding.writeVarUint(i,t.clock)},Xt=i=>gt(decoding.readVarUint(i),decoding.readVarUint(i)),Gt=i=>{for(const[t,e]of i.doc.share.entries())if(e===i)return t;throw a.zR()},ce=(i,t)=>{for(;t!==null;){if(t.parent===i)return!0;t=t.parent._item}return!1},Se=i=>{const t=[];let e=i._start;for(;e;)t.push(e),e=e.right;console.log("Children: ",t),console.log("Children content: ",t.filter(s=>!s.deleted).map(s=>s.content))};class hn{constructor(t,e=t.getMap("users")){const s=new Map;this.yusers=e,this.doc=t,this.clients=new Map,this.dss=s;const o=(l,p)=>{const E=l.get("ds"),I=l.get("ids"),F=B=>this.clients.set(B,p);E.observe(B=>{B.changes.added.forEach(V=>{V.content.getContent().forEach(Q=>{Q instanceof Uint8Array&&this.dss.set(p,it([this.dss.get(p)||St(),Ut(new nt(decoding.createDecoder(Q)))]))})})}),this.dss.set(p,it(E.map(B=>Ut(new nt(decoding.createDecoder(B)))))),I.observe(B=>B.changes.added.forEach(V=>V.content.getContent().forEach(F))),I.forEach(F)};e.observe(l=>{l.keysChanged.forEach(p=>o(e.get(p),p))}),e.forEach(o)}setUserMapping(t,e,s,{filter:o=()=>!0}={}){const l=this.yusers;let p=l.get(s);p||(p=new ve,p.set("ids",new me),p.set("ds",new me),l.set(s,p)),p.get("ids").push([e]),l.observe(E=>{setTimeout(()=>{const I=l.get(s);if(I!==p){p=I,this.clients.forEach((V,Q)=>{s===V&&p.get("ids").push([Q])});const F=new At,B=this.dss.get(s);B&&(Dt(F,B),p.get("ds").push([F.toUint8Array()]))}},0)}),t.on("afterTransaction",E=>{setTimeout(()=>{const I=p.get("ds"),F=E.deleteSet;if(E.local&&F.clients.size>0&&o(E,F)){const B=new At;Dt(B,F),I.push([B.toUint8Array()])}})})}getUserByClientId(t){return this.clients.get(t)||null}getUserByDeletedId(t){for(const[e,s]of this.dss.entries())if(j(s,t))return e;return null}}class W{constructor(t,e,s,o=0){this.type=t,this.tname=e,this.item=s,this.assoc=o}}const K=i=>{const t={};return i.type&&(t.type=i.type),i.tname&&(t.tname=i.tname),i.item&&(t.item=i.item),i.assoc!=null&&(t.assoc=i.assoc),t},X=i=>new W(i.type==null?null:gt(i.type.client,i.type.clock),i.tname||null,i.item==null?null:gt(i.item.client,i.item.clock),i.assoc==null?0:i.assoc);class ut{constructor(t,e,s=0){this.type=t,this.index=e,this.assoc=s}}const ht=(i,t,e=0)=>new ut(i,t,e),Et=(i,t,e)=>{let s=null,o=null;return i._item===null?o=Gt(i):s=gt(i._item.id.client,i._item.id.clock),new W(s,o,t,e)},Ct=(i,t,e=0)=>{let s=i._start;if(e<0){if(t===0)return Et(i,null,e);t--}for(;s!==null;){if(!s.deleted&&s.countable){if(s.length>t)return Et(i,gt(s.id.client,s.id.clock+t),e);t-=s.length}if(s.right===null&&e<0)return Et(i,s.lastId,e);s=s.right}return Et(i,null,e)},Nt=(i,t)=>{const{type:e,tname:s,item:o,assoc:l}=t;if(o!==null)encoding.writeVarUint(i,0),Pt(i,o);else if(s!==null)encoding.writeUint8(i,1),encoding.writeVarString(i,s);else if(e!==null)encoding.writeUint8(i,2),Pt(i,e);else throw error.unexpectedCase();return encoding.writeVarInt(i,l),i},Bt=i=>{const t=encoding.createEncoder();return Nt(t,i),encoding.toUint8Array(t)},Yt=i=>{let t=null,e=null,s=null;switch(decoding.readVarUint(i)){case 0:s=Xt(i);break;case 1:e=decoding.readVarString(i);break;case 2:t=Xt(i)}const o=decoding.hasContent(i)?decoding.readVarInt(i):0;return new W(t,e,s,o)},qt=i=>Yt(decoding.createDecoder(i)),re=(i,t)=>{const e=t.store,s=i.item,o=i.type,l=i.tname,p=i.assoc;let E=null,I=0;if(s!==null){if(Kt(e,s.client)<=s.clock)return null;const F=an(e,s),B=F.item;if(!(B instanceof Ht))return null;if(E=B.parent,E._item===null||!E._item.deleted){I=B.deleted||!B.countable?0:F.diff+(p>=0?0:1);let V=B.left;for(;V!==null;)!V.deleted&&V.countable&&(I+=V.length),V=V.left}}else{if(l!==null)E=t.get(l);else if(o!==null){if(Kt(e,o.client)<=o.clock)return null;const{item:F}=an(e,o);if(F instanceof Ht&&F.content instanceof he)E=F.content.type;else return null}else throw error.unexpectedCase();p>=0?I=E._length:I=0}return ht(E,I,i.assoc)},fe=(i,t)=>i===t||i!==null&&t!==null&&i.tname===t.tname&&mt(i.item,t.item)&&mt(i.type,t.type)&&i.assoc===t.assoc;class de{constructor(t,e){this.ds=t,this.sv=e}}const Ie=(i,t)=>{const e=i.ds.clients,s=t.ds.clients,o=i.sv,l=t.sv;if(o.size!==l.size||e.size!==s.size)return!1;for(const[p,E]of o.entries())if(l.get(p)!==E)return!1;for(const[p,E]of e.entries()){const I=s.get(p)||[];if(E.length!==I.length)return!1;for(let F=0;F<E.length;F++){const B=E[F],V=I[F];if(B.clock!==V.clock||B.len!==V.len)return!1}}return!0},Je=(i,t=new Qt)=>(Dt(t,i.ds),z(t,i.sv),t.toUint8Array()),Xe=i=>Je(i,new At),tr=(i,t=new wt(decoding.createDecoder(i)))=>new de(Ut(t),k(t)),Qr=i=>tr(i,new nt(decoding.createDecoder(i))),dn=(i,t)=>new de(i,t),ts=dn(St(),new Map),es=i=>dn(Rt(i.store),Ue(i.store)),_e=(i,t)=>t===void 0?!i.deleted:t.sv.has(i.id.client)&&(t.sv.get(i.id.client)||0)>i.id.clock&&!j(t.ds,i.id),Ze=(i,t)=>{const e=M.Yu(i.meta,Ze,h.Ue),s=i.doc.store;e.has(t)||(t.sv.forEach((o,l)=>{o<Kt(s,l)&&se(i,gt(l,o))}),H(i,t.ds,o=>{}),e.add(t))},ns=(i,t,e=new ot)=>{if(i.gc)throw new Error("Garbage-collection must be disabled in `originDoc`!");const{sv:s,ds:o}=t,l=new xt;return i.transact(p=>{let E=0;s.forEach(I=>{I>0&&E++}),encoding.writeVarUint(l.restEncoder,E);for(const[I,F]of s){if(F===0)continue;F<Kt(i.store,I)&&se(p,gt(I,F));const B=i.store.clients.get(I)||[],V=ae(B,F-1);encoding.writeVarUint(l.restEncoder,V+1),l.writeClient(I),encoding.writeVarUint(l.restEncoder,0);for(let Q=0;Q<=V;Q++)B[Q].write(l,0)}Dt(l,o)}),Z(e,l.toUint8Array(),"snapshot"),e},er=(i,t,e=_t)=>{const s=new e(decoding.createDecoder(t)),o=new pe(s,!1);for(let p=o.curr;p!==null;p=o.next())if((i.sv.get(p.id.client)||0)<p.id.clock+p.length)return!1;const l=it([i.ds,Ut(s)]);return te(i.ds,l)},rs=(i,t)=>er(i,t,lt);class fn{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const Ue=i=>{const t=new Map;return i.clients.forEach((e,s)=>{const o=e[e.length-1];t.set(s,o.id.clock+o.length)}),t},Kt=(i,t)=>{const e=i.clients.get(t);if(e===void 0)return 0;const s=e[e.length-1];return s.id.clock+s.length},pn=(i,t)=>{let e=i.clients.get(t.id.client);if(e===void 0)e=[],i.clients.set(t.id.client,e);else{const s=e[e.length-1];if(s.id.clock+s.length!==t.id.clock)throw a.zR()}e.push(t)},ae=(i,t)=>{let e=0,s=i.length-1,o=i[s],l=o.id.clock;if(l===t)return s;let p=st.GW(t/(l+o.length-1)*s);for(;e<=s;){if(o=i[p],l=o.id.clock,l<=t){if(t<l+o.length)return p;e=p+1}else s=p-1;p=st.GW((e+s)/2)}throw a.zR()},xe=(i,t)=>{const e=i.clients.get(t.client);return e[ae(e,t.clock)]},qe=(i,t,e)=>{const s=ae(t,e),o=t[s];return o.id.clock<e&&o instanceof Ht?(t.splice(s+1,0,$e(i,o,e-o.id.clock)),s+1):s},se=(i,t)=>{const e=i.doc.store.clients.get(t.client);return e[qe(i,e,t.clock)]},gn=(i,t,e)=>{const s=t.clients.get(e.client),o=ae(s,e.clock),l=s[o];return e.clock!==l.id.clock+l.length-1&&l.constructor!==le&&s.splice(o+1,0,$e(i,l,e.clock-l.id.clock+1)),l},nr=(i,t,e)=>{const s=i.clients.get(t.id.client);s[ae(s,t.id.clock)]=e},mn=(i,t,e,s,o)=>{if(s===0)return;const l=e+s;let p=qe(i,t,e),E;do E=t[p++],l<E.id.clock+E.length&&qe(i,t,l),o(E);while(p<t.length&&t[p].id.clock<l)};class rr{constructor(t,e,s){this.doc=t,this.deleteSet=new D,this.beforeState=Ue(t.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=e,this.meta=new Map,this.local=s,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const yn=(i,t)=>t.deleteSet.clients.size===0&&!M.Yj(t.afterState,(e,s)=>t.beforeState.get(s)!==e)?!1:(q(t.deleteSet),P(i,t),Dt(i,t.deleteSet),!0),bn=(i,t,e)=>{const s=t._item;(s===null||s.id.clock<(i.beforeState.get(s.id.client)||0)&&!s.deleted)&&M.Yu(i.changed,t,h.Ue).add(e)},Be=(i,t)=>{let e=i[t],s=i[t-1],o=t;for(;o>0;e=s,s=i[--o-1]){if(s.deleted===e.deleted&&s.constructor===e.constructor&&s.mergeWith(e)){e instanceof Ht&&e.parentSub!==null&&e.parent._map.get(e.parentSub)===e&&e.parent._map.set(e.parentSub,s);continue}break}const l=t-o;return l&&i.splice(t+1-l,l),l},wn=(i,t,e)=>{for(const[s,o]of i.clients.entries()){const l=t.clients.get(s);for(let p=o.length-1;p>=0;p--){const E=o[p],I=E.clock+E.len;for(let F=ae(l,E.clock),B=l[F];F<l.length&&B.id.clock<I;B=l[++F]){const V=l[F];if(E.clock+E.len<=V.id.clock)break;V instanceof Ht&&V.deleted&&!V.keep&&e(V)&&V.gc(t,!1)}}}},_n=(i,t)=>{i.clients.forEach((e,s)=>{const o=t.clients.get(s);for(let l=e.length-1;l>=0;l--){const p=e[l],E=st.VV(o.length-1,1+ae(o,p.clock+p.len-1));for(let I=E,F=o[I];I>0&&F.id.clock>=p.clock;F=o[I])I-=1+Be(o,I)}})},is=(i,t,e)=>{wn(i,t,e),_n(i,t)},vn=(i,t)=>{if(t<i.length){const e=i[t],s=e.doc,o=s.store,l=e.deleteSet,p=e._mergeStructs;try{q(l),e.afterState=Ue(e.doc.store),s.emit("beforeObserverCalls",[e,s]);const E=[];e.changed.forEach((I,F)=>E.push(()=>{(F._item===null||!F._item.deleted)&&F._callObserver(e,I)})),E.push(()=>{e.changedParentTypes.forEach((I,F)=>{F._dEH.l.length>0&&(F._item===null||!F._item.deleted)&&(I=I.filter(B=>B.target._item===null||!B.target._item.deleted),I.forEach(B=>{B.currentTarget=F,B._path=null}),I.sort((B,V)=>B.path.length-V.path.length),J(F._dEH,I,e))})}),E.push(()=>s.emit("afterTransaction",[e,s])),(0,d.PP)(E,[]),e._needFormattingCleanup&&kr(e)}finally{s.gc&&wn(l,o,s.gcFilter),_n(l,o),e.afterState.forEach((B,V)=>{const Q=e.beforeState.get(V)||0;if(Q!==B){const et=o.clients.get(V),dt=st.Fp(ae(et,Q),1);for(let Ot=et.length-1;Ot>=dt;)Ot-=1+Be(et,Ot)}});for(let B=p.length-1;B>=0;B--){const{client:V,clock:Q}=p[B].id,et=o.clients.get(V),dt=ae(et,Q);dt+1<et.length&&Be(et,dt+1)>1||dt>0&&Be(et,dt)}if(!e.local&&e.afterState.get(s.clientID)!==e.beforeState.get(s.clientID)&&(O.S0(R.ud,R.Pl,"[yjs] ",R.YW,R.hM,"Changed the client-id because another client seems to be using it."),s.clientID=Jt()),s.emit("afterTransactionCleanup",[e,s]),s._observers.has("update")){const B=new jt;yn(B,e)&&s.emit("update",[B.toUint8Array(),e.origin,s,e])}if(s._observers.has("updateV2")){const B=new xt;yn(B,e)&&s.emit("updateV2",[B.toUint8Array(),e.origin,s,e])}const{subdocsAdded:E,subdocsLoaded:I,subdocsRemoved:F}=e;(E.size>0||F.size>0||I.size>0)&&(E.forEach(B=>{B.clientID=s.clientID,B.collectionid==null&&(B.collectionid=s.collectionid),s.subdocs.add(B)}),F.forEach(B=>s.subdocs.delete(B)),s.emit("subdocs",[{loaded:I,added:E,removed:F},s,e]),F.forEach(B=>B.destroy())),i.length<=t+1?(s._transactionCleanups=[],s.emit("afterAllTransactions",[s,i])):vn(i,t+1)}}},Wt=(i,t,e=null,s=!0)=>{const o=i._transactionCleanups;let l=!1,p=null;i._transaction===null&&(l=!0,i._transaction=new rr(i,e,s),o.push(i._transaction),o.length===1&&i.emit("beforeAllTransactions",[i]),i.emit("beforeTransaction",[i._transaction,i]));try{p=t(i._transaction)}finally{if(l){const E=i._transaction===o[0];i._transaction=null,E&&vn(o,0)}}return p};class sr{constructor(t,e){this.insertions=e,this.deletions=t,this.meta=new Map}}const En=(i,t,e)=>{H(i,e.deletions,s=>{s instanceof Ht&&t.scope.some(o=>ce(o,s))&&un(s,!1)})},Sn=(i,t,e)=>{let s=null,o=null;const l=i.doc,p=i.scope;if(Wt(l,E=>{for(;t.length>0&&s===null;){const I=l.store,F=t.pop(),B=new Set,V=[];let Q=!1;H(E,F.insertions,et=>{if(et instanceof Ht){if(et.redone!==null){let{item:dt,diff:Ot}=an(I,et.id);Ot>0&&(dt=se(E,gt(dt.id.client,dt.id.clock+Ot))),et=dt}!et.deleted&&p.some(dt=>ce(dt,et))&&V.push(et)}}),H(E,F.deletions,et=>{et instanceof Ht&&p.some(dt=>ce(dt,et))&&!j(F.insertions,et.id)&&B.add(et)}),B.forEach(et=>{Q=$n(E,et,B,F.insertions,i.ignoreRemoteMapChanges,i)!==null||Q});for(let et=V.length-1;et>=0;et--){const dt=V[et];i.deleteFilter(dt)&&(dt.delete(E),Q=!0)}s=Q?F:null}E.changed.forEach((I,F)=>{I.has(null)&&F._searchMarker&&(F._searchMarker.length=0)}),o=E},i),s!=null){const E=o.changedParentTypes;i.emit("stack-item-popped",[{stackItem:s,type:e,changedParentTypes:E},i])}return s};class os extends null{constructor(t,{captureTimeout:e=500,captureTransaction:s=I=>!0,deleteFilter:o=()=>!0,trackedOrigins:l=new Set([null]),ignoreRemoteMapChanges:p=!1,doc:E=array.isArray(t)?t[0].doc:t.doc}={}){super(),this.scope=[],this.doc=E,this.addToScope(t),this.deleteFilter=o,l.add(this),this.trackedOrigins=l,this.captureTransaction=s,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.lastChange=0,this.ignoreRemoteMapChanges=p,this.captureTimeout=e,this.afterTransactionHandler=I=>{if(!this.captureTransaction(I)||!this.scope.some(zt=>I.changedParentTypes.has(zt))||!this.trackedOrigins.has(I.origin)&&(!I.origin||!this.trackedOrigins.has(I.origin.constructor)))return;const F=this.undoing,B=this.redoing,V=F?this.redoStack:this.undoStack;F?this.stopCapturing():B||this.clear(!1,!0);const Q=new D;I.afterState.forEach((zt,$t)=>{const qn=I.beforeState.get($t)||0,Qn=zt-qn;Qn>0&&bt(Q,$t,qn,Qn)});const et=time.getUnixTime();let dt=!1;if(this.lastChange>0&&et-this.lastChange<this.captureTimeout&&V.length>0&&!F&&!B){const zt=V[V.length-1];zt.deletions=it([zt.deletions,I.deleteSet]),zt.insertions=it([zt.insertions,Q])}else V.push(new sr(I.deleteSet,Q)),dt=!0;!F&&!B&&(this.lastChange=et),H(I,I.deleteSet,zt=>{zt instanceof Ht&&this.scope.some($t=>ce($t,zt))&&un(zt,!0)});const Ot=[{stackItem:V[V.length-1],origin:I.origin,type:F?"redo":"undo",changedParentTypes:I.changedParentTypes},this];dt?this.emit("stack-item-added",Ot):this.emit("stack-item-updated",Ot)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",()=>{this.destroy()})}addToScope(t){t=array.isArray(t)?t:[t],t.forEach(e=>{this.scope.every(s=>s!==e)&&(e.doc!==this.doc&&logging.warn("[yjs#509] Not same Y.Doc"),this.scope.push(e))})}addTrackedOrigin(t){this.trackedOrigins.add(t)}removeTrackedOrigin(t){this.trackedOrigins.delete(t)}clear(t=!0,e=!0){(t&&this.canUndo()||e&&this.canRedo())&&this.doc.transact(s=>{t&&(this.undoStack.forEach(o=>En(s,this,o)),this.undoStack=[]),e&&(this.redoStack.forEach(o=>En(s,this,o)),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:t,redoStackCleared:e}])})}stopCapturing(){this.lastChange=0}undo(){this.undoing=!0;let t;try{t=Sn(this,this.undoStack,"undo")}finally{this.undoing=!1}return t}redo(){this.redoing=!0;let t;try{t=Sn(this,this.redoStack,"redo")}finally{this.redoing=!1}return t}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}}function*ir(i){const t=b.yg(i.restDecoder);for(let e=0;e<t;e++){const s=b.yg(i.restDecoder),o=i.readClient();let l=b.yg(i.restDecoder);for(let p=0;p<s;p++){const E=i.readInfo();if(E===10){const I=b.yg(i.restDecoder);yield new oe(gt(o,l),I),l+=I}else if(w.kr&E){const I=(E&(w.rc|w.x1))===0,F=new Ht(gt(o,l),null,(E&w.x1)===w.x1?i.readLeftID():null,null,(E&w.rc)===w.rc?i.readRightID():null,I?i.readParentInfo()?i.readString():i.readLeftID():null,I&&(E&w.cq)===w.cq?i.readString():null,Jn(i,E));yield F,l+=F.length}else{const I=i.readLen();yield new le(gt(o,l),I),l+=I}}}}class pe{constructor(t,e){this.gen=ir(t),this.curr=null,this.done=!1,this.filterSkips=e,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===oe);return this.curr}}const ls=i=>or(i,lt),or=(i,t=_t)=>{const e=[],s=new t(decoding.createDecoder(i)),o=new pe(s,!1);for(let p=o.curr;p!==null;p=o.next())e.push(p);logging.print("Structs: ",e);const l=Ut(s);logging.print("DeleteSet: ",l)},cs=i=>lr(i,lt),lr=(i,t=_t)=>{const e=[],s=new t(decoding.createDecoder(i)),o=new pe(s,!1);for(let l=o.curr;l!==null;l=o.next())e.push(l);return{structs:e,ds:Ut(s)}};class Qe{constructor(t){this.currClient=0,this.startClock=0,this.written=0,this.encoder=t,this.clientStructs=[]}}const cr=i=>je(i,lt,jt),ar=(i,t=Qt,e=_t)=>{const s=new t,o=new pe(new e(decoding.createDecoder(i)),!1);let l=o.curr;if(l!==null){let p=0,E=l.id.client,I=l.id.clock!==0,F=I?0:l.id.clock+l.length;for(;l!==null;l=o.next())E!==l.id.client&&(F!==0&&(p++,encoding.writeVarUint(s.restEncoder,E),encoding.writeVarUint(s.restEncoder,F)),E=l.id.client,F=0,I=l.id.clock!==0),l.constructor===oe&&(I=!0),I||(F=l.id.clock+l.length);F!==0&&(p++,encoding.writeVarUint(s.restEncoder,E),encoding.writeVarUint(s.restEncoder,F));const B=encoding.createEncoder();return encoding.writeVarUint(B,p),encoding.writeBinaryEncoder(B,s.restEncoder),s.restEncoder=B,s.toUint8Array()}else return encoding.writeVarUint(s.restEncoder,0),s.toUint8Array()},as=i=>ar(i,At,lt),ur=(i,t=_t)=>{const e=new Map,s=new Map,o=new pe(new t(decoding.createDecoder(i)),!1);let l=o.curr;if(l!==null){let p=l.id.client,E=l.id.clock;for(e.set(p,E);l!==null;l=o.next())p!==l.id.client&&(s.set(p,E),e.set(l.id.client,l.id.clock),p=l.id.client),E=l.id.clock+l.length;s.set(p,E)}return{from:e,to:s}},us=i=>ur(i,lt),hr=(i,t)=>{if(i.constructor===le){const{client:e,clock:s}=i.id;return new le(gt(e,s+t),i.length-t)}else if(i.constructor===oe){const{client:e,clock:s}=i.id;return new oe(gt(e,s+t),i.length-t)}else{const e=i,{client:s,clock:o}=e.id;return new Ht(gt(s,o+t),null,gt(s,o+t-1),null,e.rightOrigin,e.parent,e.parentSub,e.content.splice(t))}},je=(i,t=_t,e=xt)=>{if(i.length===1)return i[0];const s=i.map(B=>new t(b.l1(B)));let o=s.map(B=>new pe(B,!0)),l=null;const p=new e,E=new Qe(p);for(;o=o.filter(Q=>Q.curr!==null),o.sort((Q,et)=>{if(Q.curr.id.client===et.curr.id.client){const dt=Q.curr.id.clock-et.curr.id.clock;return dt===0?Q.curr.constructor===et.curr.constructor?0:Q.curr.constructor===oe?1:-1:dt}else return et.curr.id.client-Q.curr.id.client}),o.length!==0;){const B=o[0],V=B.curr.id.client;if(l!==null){let Q=B.curr,et=!1;for(;Q!==null&&Q.id.clock+Q.length<=l.struct.id.clock+l.struct.length&&Q.id.client>=l.struct.id.client;)Q=B.next(),et=!0;if(Q===null||Q.id.client!==V||et&&Q.id.clock>l.struct.id.clock+l.struct.length)continue;if(V!==l.struct.id.client)ge(E,l.struct,l.offset),l={struct:Q,offset:0},B.next();else if(l.struct.id.clock+l.struct.length<Q.id.clock)if(l.struct.constructor===oe)l.struct.length=Q.id.clock+Q.length-l.struct.id.clock;else{ge(E,l.struct,l.offset);const dt=Q.id.clock-l.struct.id.clock-l.struct.length;l={struct:new oe(gt(V,l.struct.id.clock+l.struct.length),dt),offset:0}}else{const dt=l.struct.id.clock+l.struct.length-Q.id.clock;dt>0&&(l.struct.constructor===oe?l.struct.length-=dt:Q=hr(Q,dt)),l.struct.mergeWith(Q)||(ge(E,l.struct,l.offset),l={struct:Q,offset:0},B.next())}}else l={struct:B.curr,offset:0},B.next();for(let Q=B.curr;Q!==null&&Q.id.client===V&&Q.id.clock===l.struct.id.clock+l.struct.length&&Q.constructor!==oe;Q=B.next())ge(E,l.struct,l.offset),l={struct:Q,offset:0}}l!==null&&(ge(E,l.struct,l.offset),l=null),tn(E);const I=s.map(B=>Ut(B)),F=it(I);return Dt(p,F),p.toUint8Array()},Cn=(i,t,e=_t,s=xt)=>{const o=G(t),l=new s,p=new Qe(l),E=new e(b.l1(i)),I=new pe(E,!1);for(;I.curr;){const B=I.curr,V=B.id.client,Q=o.get(V)||0;if(I.curr.constructor===oe){I.next();continue}if(B.id.clock+B.length>Q)for(ge(p,B,st.Fp(Q-B.id.clock,0)),I.next();I.curr&&I.curr.id.client===V;)ge(p,I.curr,0),I.next();else for(;I.curr&&I.curr.id.client===V&&I.curr.id.clock+I.curr.length<=Q;)I.next()}tn(p);const F=Ut(E);return Dt(l,F),l.toUint8Array()},hs=(i,t)=>Cn(i,t,lt,jt),kn=i=>{i.written>0&&(i.clientStructs.push({written:i.written,restEncoder:A._f(i.encoder.restEncoder)}),i.encoder.restEncoder=A.Mf(),i.written=0)},ge=(i,t,e)=>{i.written>0&&i.currClient!==t.id.client&&kn(i),i.written===0&&(i.currClient=t.id.client,i.encoder.writeClient(t.id.client),A.uE(i.encoder.restEncoder,t.id.clock+e)),t.write(i.encoder,e),i.written++},tn=i=>{kn(i);const t=i.encoder.restEncoder;A.uE(t,i.clientStructs.length);for(let e=0;e<i.clientStructs.length;e++){const s=i.clientStructs[e];A.uE(t,s.written),A.HK(t,s.restEncoder)}},Fe=(i,t,e,s)=>{const o=new e(b.l1(i)),l=new pe(o,!1),p=new s,E=new Qe(p);for(let F=l.curr;F!==null;F=l.next())ge(E,t(F),0);tn(E);const I=Ut(o);return Dt(p,I),p.toUint8Array()},Tn=({formatting:i=!0,subdocs:t=!0,yxml:e=!0}={})=>{let s=0;const o=map.create(),l=map.create(),p=map.create(),E=map.create();return E.set(null,null),I=>{switch(I.constructor){case le:case oe:return I;case Ht:{const F=I,B=F.content;switch(B.constructor){case De:break;case he:{if(e){const V=B.type;V instanceof Te&&(V.nodeName=map.setIfUndefined(l,V.nodeName,()=>"node-"+s)),V instanceof Me&&(V.hookName=map.setIfUndefined(l,V.hookName,()=>"hook-"+s))}break}case we:{const V=B;V.arr=V.arr.map(()=>s);break}case Re:{const V=B;V.content=new Uint8Array([s]);break}case Ae:{const V=B;t&&(V.opts={},V.doc.guid=s+"");break}case be:{const V=B;V.embed={};break}case Zt:{const V=B;i&&(V.key=map.setIfUndefined(p,V.key,()=>s+""),V.value=map.setIfUndefined(E,V.value,()=>({i:s})));break}case Ne:{const V=B;V.arr=V.arr.map(()=>s);break}case ue:{const V=B;V.str=string.repeat(s%10+"",V.str.length);break}default:error.unexpectedCase()}return F.parentSub&&(F.parentSub=map.setIfUndefined(o,F.parentSub,()=>s+"")),s++,I}default:error.unexpectedCase()}}},ds=(i,t)=>Fe(i,Tn(t),lt,jt),fs=(i,t)=>Fe(i,Tn(t),_t,xt),ps=i=>Fe(i,f.id,lt,xt),dr=i=>Fe(i,d.id,_t,jt),Rn="You must not compute changes after the event-handler fired.";class Pe{constructor(t,e){this.target=t,this.currentTarget=t,this.transaction=e,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=fr(this.currentTarget,this.target))}deletes(t){return j(this.transaction.deleteSet,t.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw a.Ue(Rn);const t=new Map,e=this.target;this.transaction.changed.get(e).forEach(o=>{if(o!==null){const l=e._map.get(o);let p,E;if(this.adds(l)){let I=l.left;for(;I!==null&&this.adds(I);)I=I.left;if(this.deletes(l))if(I!==null&&this.deletes(I))p="delete",E=ft.Z$(I.content.getContent());else return;else I!==null&&this.deletes(I)?(p="update",E=ft.Z$(I.content.getContent())):(p="add",E=void 0)}else if(this.deletes(l))p="delete",E=ft.Z$(l.content.getContent());else return;t.set(o,{action:p,oldValue:E})}}),this._keys=t}return this._keys}get delta(){return this.changes.delta}adds(t){return t.id.clock>=(this.transaction.beforeState.get(t.id.client)||0)}get changes(){let t=this._changes;if(t===null){if(this.transaction.doc._transactionCleanups.length===0)throw a.Ue(Rn);const e=this.target,s=h.Ue(),o=h.Ue(),l=[];if(t={added:s,deleted:o,delta:l,keys:this.keys},this.transaction.changed.get(e).has(null)){let E=null;const I=()=>{E&&l.push(E)};for(let F=e._start;F!==null;F=F.right)F.deleted?this.deletes(F)&&!this.adds(F)&&((E===null||E.delete===void 0)&&(I(),E={delete:0}),E.delete+=F.length,o.add(F)):this.adds(F)?((E===null||E.insert===void 0)&&(I(),E={insert:[]}),E.insert=E.insert.concat(F.content.getContent()),s.add(F)):((E===null||E.retain===void 0)&&(I(),E={retain:0}),E.retain+=F.length);E!==null&&E.retain===void 0&&I()}this._changes=t}return t}}const fr=(i,t)=>{const e=[];for(;t._item!==null&&t!==i;){if(t._item.parentSub!==null)e.unshift(t._item.parentSub);else{let s=0,o=t._item.parent._start;for(;o!==t._item&&o!==null;)o.deleted||s++,o=o.right;e.unshift(s)}t=t._item.parent}return e},Dn=80;let en=0;class pr{constructor(t,e){t.marker=!0,this.p=t,this.index=e,this.timestamp=en++}}const gr=i=>{i.timestamp=en++},An=(i,t,e)=>{i.p.marker=!1,i.p=t,t.marker=!0,i.index=e,i.timestamp=en++},mr=(i,t,e)=>{if(i.length>=Dn){const s=i.reduce((o,l)=>o.timestamp<l.timestamp?o:l);return An(s,t,e),s}else{const s=new pr(t,e);return i.push(s),s}},Ve=(i,t)=>{if(i._start===null||t===0||i._searchMarker===null)return null;const e=i._searchMarker.length===0?null:i._searchMarker.reduce((l,p)=>st.Wn(t-l.index)<st.Wn(t-p.index)?l:p);let s=i._start,o=0;for(e!==null&&(s=e.p,o=e.index,gr(e));s.right!==null&&o<t;){if(!s.deleted&&s.countable){if(t<o+s.length)break;o+=s.length}s=s.right}for(;s.left!==null&&o>t;)s=s.left,!s.deleted&&s.countable&&(o-=s.length);for(;s.left!==null&&s.left.id.client===s.id.client&&s.left.id.clock+s.left.length===s.id.clock;)s=s.left,!s.deleted&&s.countable&&(o-=s.length);return e!==null&&st.Wn(e.index-o)<s.parent.length/Dn?(An(e,s,o),e):mr(i._searchMarker,s,o)},Oe=(i,t,e)=>{for(let s=i.length-1;s>=0;s--){const o=i[s];if(e>0){let l=o.p;for(l.marker=!1;l&&(l.deleted||!l.countable);)l=l.left,l&&!l.deleted&&l.countable&&(o.index-=l.length);if(l===null||l.marker===!0){i.splice(s,1);continue}o.p=l,l.marker=!0}(t<o.index||e>0&&t===o.index)&&(o.index=st.Fp(t,o.index+e))}},gs=i=>{let t=i._start;const e=[];for(;t;)e.push(t),t=t.right;return e},We=(i,t,e)=>{const s=i,o=t.changedParentTypes;for(;M.Yu(o,i,()=>[]).push(e),i._item!==null;)i=i._item.parent;J(s._eH,e,t)};class ee{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=It(),this._dEH=It(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(t,e){this.doc=t,this._item=e}_copy(){throw a.Nw()}clone(){throw a.Nw()}_write(t){}get _first(){let t=this._start;for(;t!==null&&t.deleted;)t=t.right;return t}_callObserver(t,e){!t.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(t){Mt(this._eH,t)}observeDeep(t){Mt(this._dEH,t)}unobserve(t){ie(this._eH,t)}unobserveDeep(t){ie(this._dEH,t)}toJSON(){}}const In=(i,t,e)=>{t<0&&(t=i._length+t),e<0&&(e=i._length+e);let s=e-t;const o=[];let l=i._start;for(;l!==null&&s>0;){if(l.countable&&!l.deleted){const p=l.content.getContent();if(p.length<=t)t-=p.length;else{for(let E=t;E<p.length&&s>0;E++)o.push(p[E]),s--;t=0}}l=l.right}return o},Un=i=>{const t=[];let e=i._start;for(;e!==null;){if(e.countable&&!e.deleted){const s=e.content.getContent();for(let o=0;o<s.length;o++)t.push(s[o])}e=e.right}return t},ms=(i,t)=>{const e=[];let s=i._start;for(;s!==null;){if(s.countable&&_e(s,t)){const o=s.content.getContent();for(let l=0;l<o.length;l++)e.push(o[l])}s=s.right}return e},Le=(i,t)=>{let e=0,s=i._start;for(;s!==null;){if(s.countable&&!s.deleted){const o=s.content.getContent();for(let l=0;l<o.length;l++)t(o[l],e++,i)}s=s.right}},On=(i,t)=>{const e=[];return Le(i,(s,o)=>{e.push(t(s,o,i))}),e},yr=i=>{let t=i._start,e=null,s=0;return{[Symbol.iterator](){return this},next:()=>{if(e===null){for(;t!==null&&t.deleted;)t=t.right;if(t===null)return{done:!0,value:void 0};e=t.content.getContent(),s=0,t=t.right}const o=e[s++];return e.length<=s&&(e=null),{done:!1,value:o}}}},Ln=(i,t)=>{const e=Ve(i,t);let s=i._start;for(e!==null&&(s=e.p,t-=e.index);s!==null;s=s.right)if(!s.deleted&&s.countable){if(t<s.length)return s.content.getContent()[t];t-=s.length}},He=(i,t,e,s)=>{let o=e;const l=i.doc,p=l.clientID,E=l.store,I=e===null?t._start:e.right;let F=[];const B=()=>{F.length>0&&(o=new Ht(gt(p,Kt(E,p)),o,o&&o.lastId,I,I&&I.id,t,null,new we(F)),o.integrate(i,0),F=[])};s.forEach(V=>{if(V===null)F.push(V);else switch(V.constructor){case Number:case Object:case Boolean:case Array:case String:F.push(V);break;default:switch(B(),V.constructor){case Uint8Array:case ArrayBuffer:o=new Ht(gt(p,Kt(E,p)),o,o&&o.lastId,I,I&&I.id,t,null,new Re(new Uint8Array(V))),o.integrate(i,0);break;case ot:o=new Ht(gt(p,Kt(E,p)),o,o&&o.lastId,I,I&&I.id,t,null,new Ae(V)),o.integrate(i,0);break;default:if(V instanceof ee)o=new Ht(gt(p,Kt(E,p)),o,o&&o.lastId,I,I&&I.id,t,null,new he(V)),o.integrate(i,0);else throw new Error("Unexpected content type in insert operation")}}}),B()},Mn=()=>a.Ue("Length exceeded!"),Nn=(i,t,e,s)=>{if(e>t._length)throw Mn();if(e===0)return t._searchMarker&&Oe(t._searchMarker,e,s.length),He(i,t,null,s);const o=e,l=Ve(t,e);let p=t._start;for(l!==null&&(p=l.p,e-=l.index,e===0&&(p=p.prev,e+=p&&p.countable&&!p.deleted?p.length:0));p!==null;p=p.right)if(!p.deleted&&p.countable){if(e<=p.length){e<p.length&&se(i,gt(p.id.client,p.id.clock+e));break}e-=p.length}return t._searchMarker&&Oe(t._searchMarker,o,s.length),He(i,t,p,s)},br=(i,t,e)=>{let o=(t._searchMarker||[]).reduce((l,p)=>p.index>l.index?p:l,{index:0,p:t._start}).p;if(o)for(;o.right;)o=o.right;return He(i,t,o,e)},xn=(i,t,e,s)=>{if(s===0)return;const o=e,l=s,p=Ve(t,e);let E=t._start;for(p!==null&&(E=p.p,e-=p.index);E!==null&&e>0;E=E.right)!E.deleted&&E.countable&&(e<E.length&&se(i,gt(E.id.client,E.id.clock+e)),e-=E.length);for(;s>0&&E!==null;)E.deleted||(s<E.length&&se(i,gt(E.id.client,E.id.clock+s)),E.delete(i),s-=E.length),E=E.right;if(s>0)throw Mn();t._searchMarker&&Oe(t._searchMarker,o,-l+s)},Ye=(i,t,e)=>{const s=t._map.get(e);s!==void 0&&s.delete(i)},nn=(i,t,e,s)=>{const o=t._map.get(e)||null,l=i.doc,p=l.clientID;let E;if(s==null)E=new we([s]);else switch(s.constructor){case Number:case Object:case Boolean:case Array:case String:E=new we([s]);break;case Uint8Array:E=new Re(s);break;case ot:E=new Ae(s);break;default:if(s instanceof ee)E=new he(s);else throw new Error("Unexpected content type")}new Ht(gt(p,Kt(l.store,p)),o,o&&o.lastId,null,null,t,e,E).integrate(i,0)},rn=(i,t)=>{const e=i._map.get(t);return e!==void 0&&!e.deleted?e.content.getContent()[e.length-1]:void 0},Bn=i=>{const t={};return i._map.forEach((e,s)=>{e.deleted||(t[s]=e.content.getContent()[e.length-1])}),t},jn=(i,t)=>{const e=i._map.get(t);return e!==void 0&&!e.deleted},ys=(i,t,e)=>{let s=i._map.get(t)||null;for(;s!==null&&(!e.sv.has(s.id.client)||s.id.clock>=(e.sv.get(s.id.client)||0));)s=s.left;return s!==null&&_e(s,e)?s.content.getContent()[s.length-1]:void 0},Ge=i=>u(i.entries(),t=>!t[1].deleted);class wr extends Pe{constructor(t,e){super(t,e),this._transaction=e}}class me extends ee{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(t){const e=new me;return e.push(t),e}_integrate(t,e){super._integrate(t,e),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new me}clone(){const t=new me;return t.insert(0,this.toArray().map(e=>e instanceof ee?e.clone():e)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}_callObserver(t,e){super._callObserver(t,e),We(this,t,new wr(this,t))}insert(t,e){this.doc!==null?Wt(this.doc,s=>{Nn(s,this,t,e)}):this._prelimContent.splice(t,0,...e)}push(t){this.doc!==null?Wt(this.doc,e=>{br(e,this,t)}):this._prelimContent.push(...t)}unshift(t){this.insert(0,t)}delete(t,e=1){this.doc!==null?Wt(this.doc,s=>{xn(s,this,t,e)}):this._prelimContent.splice(t,e)}get(t){return Ln(this,t)}toArray(){return Un(this)}slice(t=0,e=this.length){return In(this,t,e)}toJSON(){return this.map(t=>t instanceof ee?t.toJSON():t)}map(t){return On(this,t)}forEach(t){Le(this,t)}[Symbol.iterator](){return yr(this)}_write(t){t.writeTypeRef(Hr)}}const _r=i=>new me;class vr extends Pe{constructor(t,e,s){super(t,e),this.keysChanged=s}}class ve extends ee{constructor(t){super(),this._prelimContent=null,t===void 0?this._prelimContent=new Map:this._prelimContent=new Map(t)}_integrate(t,e){super._integrate(t,e),this._prelimContent.forEach((s,o)=>{this.set(o,s)}),this._prelimContent=null}_copy(){return new ve}clone(){const t=new ve;return this.forEach((e,s)=>{t.set(s,e instanceof ee?e.clone():e)}),t}_callObserver(t,e){We(this,t,new vr(this,t,e))}toJSON(){const t={};return this._map.forEach((e,s)=>{if(!e.deleted){const o=e.content.getContent()[e.length-1];t[s]=o instanceof ee?o.toJSON():o}}),t}get size(){return[...Ge(this._map)].length}keys(){return _(Ge(this._map),t=>t[0])}values(){return _(Ge(this._map),t=>t[1].content.getContent()[t[1].length-1])}entries(){return _(Ge(this._map),t=>[t[0],t[1].content.getContent()[t[1].length-1]])}forEach(t){this._map.forEach((e,s)=>{e.deleted||t(e.content.getContent()[e.length-1],s,this)})}[Symbol.iterator](){return this.entries()}delete(t){this.doc!==null?Wt(this.doc,e=>{Ye(e,this,t)}):this._prelimContent.delete(t)}set(t,e){return this.doc!==null?Wt(this.doc,s=>{nn(s,this,t,e)}):this._prelimContent.set(t,e),e}get(t){return rn(this,t)}has(t){return jn(this,t)}clear(){this.doc!==null?Wt(this.doc,t=>{this.forEach(function(e,s,o){Ye(t,o,s)})}):this._prelimContent.clear()}_write(t){t.writeTypeRef(Yr)}}const Er=i=>new ve,ye=(i,t)=>i===t||typeof i=="object"&&typeof t=="object"&&i&&t&&g.$m(i,t);class sn{constructor(t,e,s,o){this.left=t,this.right=e,this.index=s,this.currentAttributes=o}forward(){switch(this.right===null&&a.zR(),this.right.content.constructor){case Zt:this.right.deleted||Ce(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const Fn=(i,t,e)=>{for(;t.right!==null&&e>0;){switch(t.right.content.constructor){case Zt:t.right.deleted||Ce(t.currentAttributes,t.right.content);break;default:t.right.deleted||(e<t.right.length&&se(i,gt(t.right.id.client,t.right.id.clock+e)),t.index+=t.right.length,e-=t.right.length);break}t.left=t.right,t.right=t.right.right}return t},ze=(i,t,e)=>{const s=new Map,o=Ve(t,e);if(o){const l=new sn(o.p.left,o.p,o.index,s);return Fn(i,l,e-o.index)}else{const l=new sn(null,t._start,0,s);return Fn(i,l,e)}},Pn=(i,t,e,s)=>{for(;e.right!==null&&(e.right.deleted===!0||e.right.content.constructor===Zt&&ye(s.get(e.right.content.key),e.right.content.value));)e.right.deleted||s.delete(e.right.content.key),e.forward();const o=i.doc,l=o.clientID;s.forEach((p,E)=>{const I=e.left,F=e.right,B=new Ht(gt(l,Kt(o.store,l)),I,I&&I.lastId,F,F&&F.id,t,null,new Zt(E,p));B.integrate(i,0),e.right=B,e.forward()})},Ce=(i,t)=>{const{key:e,value:s}=t;s===null?i.delete(e):i.set(e,s)},Vn=(i,t)=>{for(;i.right!==null;){if(!(i.right.deleted||i.right.content.constructor===Zt&&ye(t[i.right.content.key]||null,i.right.content.value)))break;i.forward()}},Wn=(i,t,e,s)=>{const o=i.doc,l=o.clientID,p=new Map;for(const E in s){const I=s[E],F=e.currentAttributes.get(E)||null;if(!ye(F,I)){p.set(E,F);const{left:B,right:V}=e;e.right=new Ht(gt(l,Kt(o.store,l)),B,B&&B.lastId,V,V&&V.id,t,null,new Zt(E,I)),e.right.integrate(i,0),e.forward()}}return p},on=(i,t,e,s,o)=>{e.currentAttributes.forEach((Q,et)=>{o[et]===void 0&&(o[et]=null)});const l=i.doc,p=l.clientID;Vn(e,o);const E=Wn(i,t,e,o),I=s.constructor===String?new ue(s):s instanceof ee?new he(s):new be(s);let{left:F,right:B,index:V}=e;t._searchMarker&&Oe(t._searchMarker,e.index,I.getLength()),B=new Ht(gt(p,Kt(l.store,p)),F,F&&F.lastId,B,B&&B.id,t,null,I),B.integrate(i,0),e.right=B,e.index=V,e.forward(),Pn(i,t,e,E)},Hn=(i,t,e,s,o)=>{const l=i.doc,p=l.clientID;Vn(e,o);const E=Wn(i,t,e,o);t:for(;e.right!==null&&(s>0||E.size>0&&(e.right.deleted||e.right.content.constructor===Zt));){if(!e.right.deleted)switch(e.right.content.constructor){case Zt:{const{key:I,value:F}=e.right.content,B=o[I];if(B!==void 0){if(ye(B,F))E.delete(I);else{if(s===0)break t;E.set(I,F)}e.right.delete(i)}else e.currentAttributes.set(I,F);break}default:s<e.right.length&&se(i,gt(e.right.id.client,e.right.id.clock+s)),s-=e.right.length;break}e.forward()}if(s>0){let I="";for(;s>0;s--)I+=`
`;e.right=new Ht(gt(p,Kt(l.store,p)),e.left,e.left&&e.left.lastId,e.right,e.right&&e.right.id,t,null,new ue(I)),e.right.integrate(i,0),e.forward()}Pn(i,t,e,E)},Yn=(i,t,e,s,o)=>{let l=t;const p=M.Ue();for(;l&&(!l.countable||l.deleted);){if(!l.deleted&&l.content.constructor===Zt){const F=l.content;p.set(F.key,F)}l=l.right}let E=0,I=!1;for(;t!==l;){if(e===t&&(I=!0),!t.deleted){const F=t.content;switch(F.constructor){case Zt:{const{key:B,value:V}=F,Q=s.get(B)||null;(p.get(B)!==F||Q===V)&&(t.delete(i),E++,!I&&(o.get(B)||null)===V&&Q!==V&&(Q===null?o.delete(B):o.set(B,Q))),!I&&!t.deleted&&Ce(o,F);break}}}t=t.right}return E},Sr=(i,t)=>{for(;t&&t.right&&(t.right.deleted||!t.right.countable);)t=t.right;const e=new Set;for(;t&&(t.deleted||!t.countable);){if(!t.deleted&&t.content.constructor===Zt){const s=t.content.key;e.has(s)?t.delete(i):e.add(s)}t=t.left}},Cr=i=>{let t=0;return Wt(i.doc,e=>{let s=i._start,o=i._start,l=M.Ue();const p=M.JG(l);for(;o;){if(o.deleted===!1)switch(o.content.constructor){case Zt:Ce(p,o.content);break;default:t+=Yn(e,s,o,l,p),l=M.JG(p),s=o;break}o=o.right}}),t},kr=i=>{const t=new Set,e=i.doc;for(const[s,o]of i.afterState.entries()){const l=i.beforeState.get(s)||0;o!==l&&mn(i,e.store.clients.get(s),l,o,p=>{!p.deleted&&p.content.constructor===Zt&&p.constructor!==le&&t.add(p.parent)})}Wt(e,s=>{H(i,i.deleteSet,o=>{if(o instanceof le||!o.parent._hasFormatting||t.has(o.parent))return;const l=o.parent;o.content.constructor===Zt?t.add(l):Sr(s,o)});for(const o of t)Cr(o)})},Gn=(i,t,e)=>{const s=e,o=M.JG(t.currentAttributes),l=t.right;for(;e>0&&t.right!==null;){if(t.right.deleted===!1)switch(t.right.content.constructor){case he:case be:case ue:e<t.right.length&&se(i,gt(t.right.id.client,t.right.id.clock+e)),e-=t.right.length,t.right.delete(i);break}t.forward()}l&&Yn(i,l,t.right,o,t.currentAttributes);const p=(t.left||t.right).parent;return p._searchMarker&&Oe(p._searchMarker,t.index,-s+e),t};class Tr extends Pe{constructor(t,e,s){super(t,e),this.childListChanged=!1,this.keysChanged=new Set,s.forEach(o=>{o===null?this.childListChanged=!0:this.keysChanged.add(o)})}get changes(){if(this._changes===null){const t={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=t}return this._changes}get delta(){if(this._delta===null){const t=this.target.doc,e=[];Wt(t,s=>{const o=new Map,l=new Map;let p=this.target._start,E=null;const I={};let F="",B=0,V=0;const Q=()=>{if(E!==null){let et=null;switch(E){case"delete":V>0&&(et={delete:V}),V=0;break;case"insert":(typeof F=="object"||F.length>0)&&(et={insert:F},o.size>0&&(et.attributes={},o.forEach((dt,Ot)=>{dt!==null&&(et.attributes[Ot]=dt)}))),F="";break;case"retain":B>0&&(et={retain:B},g.xb(I)||(et.attributes=g.f0({},I))),B=0;break}et&&e.push(et),E=null}};for(;p!==null;){switch(p.content.constructor){case he:case be:this.adds(p)?this.deletes(p)||(Q(),E="insert",F=p.content.getContent()[0],Q()):this.deletes(p)?(E!=="delete"&&(Q(),E="delete"),V+=1):p.deleted||(E!=="retain"&&(Q(),E="retain"),B+=1);break;case ue:this.adds(p)?this.deletes(p)||(E!=="insert"&&(Q(),E="insert"),F+=p.content.str):this.deletes(p)?(E!=="delete"&&(Q(),E="delete"),V+=p.length):p.deleted||(E!=="retain"&&(Q(),E="retain"),B+=p.length);break;case Zt:{const{key:et,value:dt}=p.content;if(this.adds(p)){if(!this.deletes(p)){const Ot=o.get(et)||null;ye(Ot,dt)?dt!==null&&p.delete(s):(E==="retain"&&Q(),ye(dt,l.get(et)||null)?delete I[et]:I[et]=dt)}}else if(this.deletes(p)){l.set(et,dt);const Ot=o.get(et)||null;ye(Ot,dt)||(E==="retain"&&Q(),I[et]=Ot)}else if(!p.deleted){l.set(et,dt);const Ot=I[et];Ot!==void 0&&(ye(Ot,dt)?Ot!==null&&p.delete(s):(E==="retain"&&Q(),dt===null?delete I[et]:I[et]=dt))}p.deleted||(E==="insert"&&Q(),Ce(o,p.content));break}}p=p.right}for(Q();e.length>0;){const et=e[e.length-1];if(et.retain!==void 0&&et.attributes===void 0)e.pop();else break}}),this._delta=e}return this._delta}}class ke extends ee{constructor(t){super(),this._pending=t!==void 0?[()=>this.insert(0,t)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this._length}_integrate(t,e){super._integrate(t,e);try{this._pending.forEach(s=>s())}catch(s){console.error(s)}this._pending=null}_copy(){return new ke}clone(){const t=new ke;return t.applyDelta(this.toDelta()),t}_callObserver(t,e){super._callObserver(t,e);const s=new Tr(this,t,e);We(this,t,s),!t.local&&this._hasFormatting&&(t._needFormattingCleanup=!0)}toString(){let t="",e=this._start;for(;e!==null;)!e.deleted&&e.countable&&e.content.constructor===ue&&(t+=e.content.str),e=e.right;return t}toJSON(){return this.toString()}applyDelta(t,{sanitize:e=!0}={}){this.doc!==null?Wt(this.doc,s=>{const o=new sn(null,this._start,0,new Map);for(let l=0;l<t.length;l++){const p=t[l];if(p.insert!==void 0){const E=!e&&typeof p.insert=="string"&&l===t.length-1&&o.right===null&&p.insert.slice(-1)===`
`?p.insert.slice(0,-1):p.insert;(typeof E!="string"||E.length>0)&&on(s,this,o,E,p.attributes||{})}else p.retain!==void 0?Hn(s,this,o,p.retain,p.attributes||{}):p.delete!==void 0&&Gn(s,o,p.delete)}}):this._pending.push(()=>this.applyDelta(t))}toDelta(t,e,s){const o=[],l=new Map,p=this.doc;let E="",I=this._start;function F(){if(E.length>0){const V={};let Q=!1;l.forEach((dt,Ot)=>{Q=!0,V[Ot]=dt});const et={insert:E};Q&&(et.attributes=V),o.push(et),E=""}}const B=()=>{for(;I!==null;){if(_e(I,t)||e!==void 0&&_e(I,e))switch(I.content.constructor){case ue:{const V=l.get("ychange");t!==void 0&&!_e(I,t)?(V===void 0||V.user!==I.id.client||V.type!=="removed")&&(F(),l.set("ychange",s?s("removed",I.id):{type:"removed"})):e!==void 0&&!_e(I,e)?(V===void 0||V.user!==I.id.client||V.type!=="added")&&(F(),l.set("ychange",s?s("added",I.id):{type:"added"})):V!==void 0&&(F(),l.delete("ychange")),E+=I.content.str;break}case he:case be:{F();const V={insert:I.content.getContent()[0]};if(l.size>0){const Q={};V.attributes=Q,l.forEach((et,dt)=>{Q[dt]=et})}o.push(V);break}case Zt:_e(I,t)&&(F(),Ce(l,I.content));break}I=I.right}F()};return t||e?Wt(p,V=>{t&&Ze(V,t),e&&Ze(V,e),B()},"cleanup"):B(),o}insert(t,e,s){if(e.length<=0)return;const o=this.doc;o!==null?Wt(o,l=>{const p=ze(l,this,t);s||(s={},p.currentAttributes.forEach((E,I)=>{s[I]=E})),on(l,this,p,e,s)}):this._pending.push(()=>this.insert(t,e,s))}insertEmbed(t,e,s={}){const o=this.doc;o!==null?Wt(o,l=>{const p=ze(l,this,t);on(l,this,p,e,s)}):this._pending.push(()=>this.insertEmbed(t,e,s))}delete(t,e){if(e===0)return;const s=this.doc;s!==null?Wt(s,o=>{Gn(o,ze(o,this,t),e)}):this._pending.push(()=>this.delete(t,e))}format(t,e,s){if(e===0)return;const o=this.doc;o!==null?Wt(o,l=>{const p=ze(l,this,t);p.right!==null&&Hn(l,this,p,e,s)}):this._pending.push(()=>this.format(t,e,s))}removeAttribute(t){this.doc!==null?Wt(this.doc,e=>{Ye(e,this,t)}):this._pending.push(()=>this.removeAttribute(t))}setAttribute(t,e){this.doc!==null?Wt(this.doc,s=>{nn(s,this,t,e)}):this._pending.push(()=>this.setAttribute(t,e))}getAttribute(t){return rn(this,t)}getAttributes(){return Bn(this)}_write(t){t.writeTypeRef(Gr)}}const Rr=i=>new ke;class ln{constructor(t,e=()=>!0){this._filter=e,this._root=t,this._currentNode=t._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let t=this._currentNode,e=t&&t.content&&t.content.type;if(t!==null&&(!this._firstCall||t.deleted||!this._filter(e)))do if(e=t.content.type,!t.deleted&&(e.constructor===Te||e.constructor===Ee)&&e._start!==null)t=e._start;else for(;t!==null;)if(t.right!==null){t=t.right;break}else t.parent===this._root?t=null:t=t.parent._item;while(t!==null&&(t.deleted||!this._filter(t.content.type)));return this._firstCall=!1,t===null?{value:void 0,done:!0}:(this._currentNode=t,{value:t.content.type,done:!1})}}class Ee extends ee{constructor(){super(),this._prelimContent=[]}get firstChild(){const t=this._first;return t?t.content.getContent()[0]:null}_integrate(t,e){super._integrate(t,e),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Ee}clone(){const t=new Ee;return t.insert(0,this.toArray().map(e=>e instanceof ee?e.clone():e)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(t){return new ln(this,t)}querySelector(t){t=t.toUpperCase();const s=new ln(this,o=>o.nodeName&&o.nodeName.toUpperCase()===t).next();return s.done?null:s.value}querySelectorAll(t){return t=t.toUpperCase(),ft.Dp(new ln(this,e=>e.nodeName&&e.nodeName.toUpperCase()===t))}_callObserver(t,e){We(this,t,new Ir(this,e,t))}toString(){return On(this,t=>t.toString()).join("")}toJSON(){return this.toString()}toDOM(t=document,e={},s){const o=t.createDocumentFragment();return s!==void 0&&s._createAssociation(o,this),Le(this,l=>{o.insertBefore(l.toDOM(t,e,s),null)}),o}insert(t,e){this.doc!==null?Wt(this.doc,s=>{Nn(s,this,t,e)}):this._prelimContent.splice(t,0,...e)}insertAfter(t,e){if(this.doc!==null)Wt(this.doc,s=>{const o=t&&t instanceof ee?t._item:t;He(s,this,o,e)});else{const s=this._prelimContent,o=t===null?0:s.findIndex(l=>l===t)+1;if(o===0&&t!==null)throw a.Ue("Reference item not found");s.splice(o,0,...e)}}delete(t,e=1){this.doc!==null?Wt(this.doc,s=>{xn(s,this,t,e)}):this._prelimContent.splice(t,e)}toArray(){return Un(this)}push(t){this.insert(this.length,t)}unshift(t){this.insert(0,t)}get(t){return Ln(this,t)}slice(t=0,e=this.length){return In(this,t,e)}forEach(t){Le(this,t)}_write(t){t.writeTypeRef(Kr)}}const Dr=i=>new Ee;class Te extends Ee{constructor(t="UNDEFINED"){super(),this.nodeName=t,this._prelimAttrs=new Map}get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_integrate(t,e){super._integrate(t,e),this._prelimAttrs.forEach((s,o)=>{this.setAttribute(o,s)}),this._prelimAttrs=null}_copy(){return new Te(this.nodeName)}clone(){const t=new Te(this.nodeName),e=this.getAttributes();return g.Ed(e,(s,o)=>{typeof s=="string"&&t.setAttribute(o,s)}),t.insert(0,this.toArray().map(s=>s instanceof ee?s.clone():s)),t}toString(){const t=this.getAttributes(),e=[],s=[];for(const E in t)s.push(E);s.sort();const o=s.length;for(let E=0;E<o;E++){const I=s[E];e.push(I+'="'+t[I]+'"')}const l=this.nodeName.toLocaleLowerCase(),p=e.length>0?" "+e.join(" "):"";return`<${l}${p}>${super.toString()}</${l}>`}removeAttribute(t){this.doc!==null?Wt(this.doc,e=>{Ye(e,this,t)}):this._prelimAttrs.delete(t)}setAttribute(t,e){this.doc!==null?Wt(this.doc,s=>{nn(s,this,t,e)}):this._prelimAttrs.set(t,e)}getAttribute(t){return rn(this,t)}hasAttribute(t){return jn(this,t)}getAttributes(){return Bn(this)}toDOM(t=document,e={},s){const o=t.createElement(this.nodeName),l=this.getAttributes();for(const p in l){const E=l[p];typeof E=="string"&&o.setAttribute(p,E)}return Le(this,p=>{o.appendChild(p.toDOM(t,e,s))}),s!==void 0&&s._createAssociation(o,this),o}_write(t){t.writeTypeRef(zr),t.writeKey(this.nodeName)}}const Ar=i=>new Te(i.readKey());class Ir extends Pe{constructor(t,e,s){super(t,s),this.childListChanged=!1,this.attributesChanged=new Set,e.forEach(o=>{o===null?this.childListChanged=!0:this.attributesChanged.add(o)})}}class Me extends ve{constructor(t){super(),this.hookName=t}_copy(){return new Me(this.hookName)}clone(){const t=new Me(this.hookName);return this.forEach((e,s)=>{t.set(s,e)}),t}toDOM(t=document,e={},s){const o=e[this.hookName];let l;return o!==void 0?l=o.createDom(this):l=document.createElement(this.hookName),l.setAttribute("data-yjs-hook",this.hookName),s!==void 0&&s._createAssociation(l,this),l}_write(t){t.writeTypeRef($r),t.writeKey(this.hookName)}}const Ur=i=>new Me(i.readKey());class Ke extends ke{get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_copy(){return new Ke}clone(){const t=new Ke;return t.applyDelta(this.toDelta()),t}toDOM(t=document,e,s){const o=t.createTextNode(this.toString());return s!==void 0&&s._createAssociation(o,this),o}toString(){return this.toDelta().map(t=>{const e=[];for(const o in t.attributes){const l=[];for(const p in t.attributes[o])l.push({key:p,value:t.attributes[o][p]});l.sort((p,E)=>p.key<E.key?-1:1),e.push({nodeName:o,attrs:l})}e.sort((o,l)=>o.nodeName<l.nodeName?-1:1);let s="";for(let o=0;o<e.length;o++){const l=e[o];s+=`<${l.nodeName}`;for(let p=0;p<l.attrs.length;p++){const E=l.attrs[p];s+=` ${E.key}="${E.value}"`}s+=">"}s+=t.insert;for(let o=e.length-1;o>=0;o--)s+=`</${e[o].nodeName}>`;return s}).join("")}toJSON(){return this.toString()}_write(t){t.writeTypeRef(Jr)}}const Or=i=>new Ke;class cn{constructor(t,e){this.id=t,this.length=e}get deleted(){throw a.Nw()}mergeWith(t){return!1}write(t,e,s){throw a.Nw()}integrate(t,e){throw a.Nw()}}const Lr=0;class le extends cn{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,e){e>0&&(this.id.clock+=e,this.length-=e),pn(t.doc.store,this)}write(t,e){t.writeInfo(Lr),t.writeLen(this.length-e)}getMissing(t,e){return null}}class Re{constructor(t){this.content=t}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new Re(this.content)}splice(t){throw a.Nw()}mergeWith(t){return!1}integrate(t,e){}delete(t){}gc(t){}write(t,e){t.writeBuf(this.content)}getRef(){return 3}}const Mr=i=>new Re(i.readBuf());class De{constructor(t){this.len=t}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new De(this.len)}splice(t){const e=new De(this.len-t);return this.len=t,e}mergeWith(t){return this.len+=t.len,!0}integrate(t,e){bt(t.deleteSet,e.id.client,e.id.clock,this.len),e.markDeleted()}delete(t){}gc(t){}write(t,e){t.writeLen(this.len-e)}getRef(){return 1}}const Nr=i=>new De(i.readLen()),zn=(i,t)=>new ot({guid:i,...t,shouldLoad:t.shouldLoad||t.autoLoad||!1});class Ae{constructor(t){t._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=t;const e={};this.opts=e,t.gc||(e.gc=!1),t.autoLoad&&(e.autoLoad=!0),t.meta!==null&&(e.meta=t.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new Ae(zn(this.doc.guid,this.opts))}splice(t){throw a.Nw()}mergeWith(t){return!1}integrate(t,e){this.doc._item=e,t.subdocsAdded.add(this.doc),this.doc.shouldLoad&&t.subdocsLoaded.add(this.doc)}delete(t){t.subdocsAdded.has(this.doc)?t.subdocsAdded.delete(this.doc):t.subdocsRemoved.add(this.doc)}gc(t){}write(t,e){t.writeString(this.doc.guid),t.writeAny(this.opts)}getRef(){return 9}}const xr=i=>new Ae(zn(i.readString(),i.readAny()));class be{constructor(t){this.embed=t}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new be(this.embed)}splice(t){throw a.Nw()}mergeWith(t){return!1}integrate(t,e){}delete(t){}gc(t){}write(t,e){t.writeJSON(this.embed)}getRef(){return 5}}const Br=i=>new be(i.readJSON());class Zt{constructor(t,e){this.key=t,this.value=e}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new Zt(this.key,this.value)}splice(t){throw a.Nw()}mergeWith(t){return!1}integrate(t,e){const s=e.parent;s._searchMarker=null,s._hasFormatting=!0}delete(t){}gc(t){}write(t,e){t.writeKey(this.key),t.writeJSON(this.value)}getRef(){return 6}}const jr=i=>new Zt(i.readKey(),i.readJSON());class Ne{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Ne(this.arr)}splice(t){const e=new Ne(this.arr.slice(t));return this.arr=this.arr.slice(0,t),e}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){const s=this.arr.length;t.writeLen(s-e);for(let o=e;o<s;o++){const l=this.arr[o];t.writeString(l===void 0?"undefined":JSON.stringify(l))}}getRef(){return 2}}const Fr=i=>{const t=i.readLen(),e=[];for(let s=0;s<t;s++){const o=i.readString();o==="undefined"?e.push(void 0):e.push(JSON.parse(o))}return new Ne(e)};class we{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new we(this.arr)}splice(t){const e=new we(this.arr.slice(t));return this.arr=this.arr.slice(0,t),e}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){const s=this.arr.length;t.writeLen(s-e);for(let o=e;o<s;o++){const l=this.arr[o];t.writeAny(l)}}getRef(){return 8}}const Pr=i=>{const t=i.readLen(),e=[];for(let s=0;s<t;s++)e.push(i.readAny());return new we(e)};class ue{constructor(t){this.str=t}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new ue(this.str)}splice(t){const e=new ue(this.str.slice(t));this.str=this.str.slice(0,t);const s=this.str.charCodeAt(t-1);return s>=55296&&s<=56319&&(this.str=this.str.slice(0,t-1)+"\uFFFD",e.str="\uFFFD"+e.str.slice(1)),e}mergeWith(t){return this.str+=t.str,!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){t.writeString(e===0?this.str:this.str.slice(e))}getRef(){return 4}}const Vr=i=>new ue(i.readString()),Wr=[_r,Er,Rr,Ar,Dr,Ur,Or],Hr=0,Yr=1,Gr=2,zr=3,Kr=4,$r=5,Jr=6;class he{constructor(t){this.type=t}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new he(this.type._copy())}splice(t){throw a.Nw()}mergeWith(t){return!1}integrate(t,e){this.type._integrate(t.doc,e)}delete(t){let e=this.type._start;for(;e!==null;)e.deleted?e.id.clock<(t.beforeState.get(e.id.client)||0)&&t._mergeStructs.push(e):e.delete(t),e=e.right;this.type._map.forEach(s=>{s.deleted?s.id.clock<(t.beforeState.get(s.id.client)||0)&&t._mergeStructs.push(s):s.delete(t)}),t.changed.delete(this.type)}gc(t){let e=this.type._start;for(;e!==null;)e.gc(t,!0),e=e.right;this.type._start=null,this.type._map.forEach(s=>{for(;s!==null;)s.gc(t,!0),s=s.left}),this.type._map=new Map}write(t,e){this.type._write(t)}getRef(){return 7}}const Xr=i=>new he(Wr[i.readTypeRef()](i)),an=(i,t)=>{let e=t,s=0,o;do s>0&&(e=gt(e.client,e.clock+s)),o=xe(i,e),s=e.clock-o.id.clock,e=o.redone;while(e!==null&&o instanceof Ht);return{item:o,diff:s}},un=(i,t)=>{for(;i!==null&&i.keep!==t;)i.keep=t,i=i.parent._item},$e=(i,t,e)=>{const{client:s,clock:o}=t.id,l=new Ht(gt(s,o+e),t,gt(s,o+e-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(e));return t.deleted&&l.markDeleted(),t.keep&&(l.keep=!0),t.redone!==null&&(l.redone=gt(t.redone.client,t.redone.clock+e)),t.right=l,l.right!==null&&(l.right.left=l),i._mergeStructs.push(l),l.parentSub!==null&&l.right===null&&l.parent._map.set(l.parentSub,l),t.length=e,l},Kn=(i,t)=>array.some(i,e=>j(e.deletions,t)),$n=(i,t,e,s,o,l)=>{const p=i.doc,E=p.store,I=p.clientID,F=t.redone;if(F!==null)return se(i,F);let B=t.parent._item,V=null,Q;if(B!==null&&B.deleted===!0){if(B.redone===null&&(!e.has(B)||$n(i,B,e,s,o,l)===null))return null;for(;B.redone!==null;)B=se(i,B.redone)}const et=B===null?t.parent:B.content.type;if(t.parentSub===null){for(V=t.left,Q=t;V!==null;){let $t=V;for(;$t!==null&&$t.parent._item!==B;)$t=$t.redone===null?null:se(i,$t.redone);if($t!==null&&$t.parent._item===B){V=$t;break}V=V.left}for(;Q!==null;){let $t=Q;for(;$t!==null&&$t.parent._item!==B;)$t=$t.redone===null?null:se(i,$t.redone);if($t!==null&&$t.parent._item===B){Q=$t;break}Q=Q.right}}else if(Q=null,t.right&&!o){for(V=t;V!==null&&V.right!==null&&(V.right.redone||j(s,V.right.id)||Kn(l.undoStack,V.right.id)||Kn(l.redoStack,V.right.id));)for(V=V.right;V.redone;)V=se(i,V.redone);if(V&&V.right!==null)return null}else V=et._map.get(t.parentSub)||null;const dt=Kt(E,I),Ot=gt(I,dt),zt=new Ht(Ot,V,V&&V.lastId,Q,Q&&Q.id,et,t.parentSub,t.content.copy());return t.redone=Ot,un(zt,!0),zt.integrate(i,0),zt};class Ht extends cn{constructor(t,e,s,o,l,p,E,I){super(t,I.getLength()),this.origin=s,this.left=e,this.right=o,this.rightOrigin=l,this.parent=p,this.parentSub=E,this.redone=null,this.content=I,this.info=this.content.isCountable()?w.Qn:0}set marker(t){(this.info&w.Ko)>0!==t&&(this.info^=w.Ko)}get marker(){return(this.info&w.Ko)>0}get keep(){return(this.info&w.Vw)>0}set keep(t){this.keep!==t&&(this.info^=w.Vw)}get countable(){return(this.info&w.Qn)>0}get deleted(){return(this.info&w.CY)>0}set deleted(t){this.deleted!==t&&(this.info^=w.CY)}markDeleted(){this.info|=w.CY}getMissing(t,e){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=Kt(e,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=Kt(e,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===rt&&this.id.client!==this.parent.client&&this.parent.clock>=Kt(e,this.parent.client))return this.parent.client;if(this.origin&&(this.left=gn(t,e,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=se(t,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===le||this.right&&this.right.constructor===le)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===Ht&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===Ht&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===rt){const s=xe(e,this.parent);s.constructor===le?this.parent=null:this.parent=s.content.type}return null}integrate(t,e){if(e>0&&(this.id.clock+=e,this.left=gn(t,t.doc.store,gt(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(e),this.length-=e),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let s=this.left,o;if(s!==null)o=s.right;else if(this.parentSub!==null)for(o=this.parent._map.get(this.parentSub)||null;o!==null&&o.left!==null;)o=o.left;else o=this.parent._start;const l=new Set,p=new Set;for(;o!==null&&o!==this.right;){if(p.add(o),l.add(o),mt(this.origin,o.origin)){if(o.id.client<this.id.client)s=o,l.clear();else if(mt(this.rightOrigin,o.rightOrigin))break}else if(o.origin!==null&&p.has(xe(t.doc.store,o.origin)))l.has(xe(t.doc.store,o.origin))||(s=o,l.clear());else break;o=o.right}this.left=s}if(this.left!==null){const s=this.left.right;this.right=s,this.left.right=this}else{let s;if(this.parentSub!==null)for(s=this.parent._map.get(this.parentSub)||null;s!==null&&s.left!==null;)s=s.left;else s=this.parent._start,this.parent._start=this;this.right=s}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(t)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),pn(t.doc.store,this),this.content.integrate(t,this),bn(t,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(t)}else new le(this.id,this.length).integrate(t,0)}get next(){let t=this.right;for(;t!==null&&t.deleted;)t=t.right;return t}get prev(){let t=this.left;for(;t!==null&&t.deleted;)t=t.left;return t}get lastId(){return this.length===1?this.id:gt(this.id.client,this.id.clock+this.length-1)}mergeWith(t){if(this.constructor===t.constructor&&mt(t.origin,this.lastId)&&this.right===t&&mt(this.rightOrigin,t.rightOrigin)&&this.id.client===t.id.client&&this.id.clock+this.length===t.id.clock&&this.deleted===t.deleted&&this.redone===null&&t.redone===null&&this.content.constructor===t.content.constructor&&this.content.mergeWith(t.content)){const e=this.parent._searchMarker;return e&&e.forEach(s=>{s.p===t&&(s.p=this,!this.deleted&&this.countable&&(s.index-=this.length))}),t.keep&&(this.keep=!0),this.right=t.right,this.right!==null&&(this.right.left=this),this.length+=t.length,!0}return!1}delete(t){if(!this.deleted){const e=this.parent;this.countable&&this.parentSub===null&&(e._length-=this.length),this.markDeleted(),bt(t.deleteSet,this.id.client,this.id.clock,this.length),bn(t,e,this.parentSub),this.content.delete(t)}}gc(t,e){if(!this.deleted)throw a.zR();this.content.gc(t),e?nr(t,this,new le(this.id,this.length)):this.content=new De(this.length)}write(t,e){const s=e>0?gt(this.id.client,this.id.clock+e-1):this.origin,o=this.rightOrigin,l=this.parentSub,p=this.content.getRef()&w.kr|(s===null?0:w.x1)|(o===null?0:w.rc)|(l===null?0:w.cq);if(t.writeInfo(p),s!==null&&t.writeLeftID(s),o!==null&&t.writeRightID(o),s===null&&o===null){const E=this.parent;if(E._item!==void 0){const I=E._item;if(I===null){const F=Gt(E);t.writeParentInfo(!0),t.writeString(F)}else t.writeParentInfo(!1),t.writeLeftID(I.id)}else E.constructor===String?(t.writeParentInfo(!0),t.writeString(E)):E.constructor===rt?(t.writeParentInfo(!1),t.writeLeftID(E)):a.zR();l!==null&&t.writeString(l)}this.content.write(t,e)}}const Jn=(i,t)=>Zr[t&w.kr](i),Zr=[()=>{a.zR()},Nr,Fr,Mr,Vr,Br,jr,Xr,Pr,xr,()=>{a.zR()}],qr=10;class oe extends cn{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,e){a.zR()}write(t,e){t.writeInfo(qr),A.uE(t.restEncoder,this.length-e)}getMissing(t,e){return null}}const Xn=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof $.g!="undefined"?$.g:{},Zn="__ $YJS$ __";Xn[Zn]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438"),Xn[Zn]=!0}}]);})();
