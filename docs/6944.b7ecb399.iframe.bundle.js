"use strict";(()=>{var te=Object.defineProperty;var ee=(v,S,i)=>S in v?te(v,S,{enumerable:!0,configurable:!0,writable:!0,value:i}):v[S]=i;var Ft=(v,S,i)=>(ee(v,typeof S!="symbol"?S+"":S,i),i);(self.webpackChunk_automattic_jetpack_storybook=self.webpackChunk_automattic_jetpack_storybook||[]).push([[6944],{"../connection/components/use-connection/index.jsx":(v,S,i)=>{i.d(S,{Z:()=>T});var m=i("../api/index.jsx"),l=i("../../../node_modules/.pnpm/@wordpress+data@9.11.0_react@18.2.0/node_modules/@wordpress/data/build-module/components/use-dispatch/use-dispatch.js"),C=i("../../../node_modules/.pnpm/@wordpress+data@9.11.0_react@18.2.0/node_modules/@wordpress/data/build-module/components/use-select/index.js"),I=i("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),c=i("../connection/state/store.jsx");const d=window!=null&&window.JP_CONNECTION_INITIAL_STATE?window.JP_CONNECTION_INITIAL_STATE:{},T=function(){let{registrationNonce:O=d.registrationNonce,apiRoot:L=d.apiRoot,apiNonce:f=d.apiNonce,redirectUri:g,autoTrigger:N,from:j,skipUserConnection:P}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{registerSite:J,connectUser:D,refreshConnectedPlugins:Z}=(0,l.Z)(c.t),b=(0,C.Z)(_=>_(c.t).getRegistrationError()),{siteIsRegistering:k,userIsConnecting:H,userConnectionData:U,connectedPlugins:V,connectionErrors:z,isRegistered:y,isUserConnected:F,hasConnectedOwner:x,isOfflineMode:B}=(0,C.Z)(_=>({siteIsRegistering:_(c.t).getSiteIsRegistering(),userIsConnecting:_(c.t).getUserIsConnecting(),userConnectionData:_(c.t).getUserConnectionData(),connectedPlugins:_(c.t).getConnectedPlugins(),connectionErrors:_(c.t).getConnectionErrors(),isOfflineMode:_(c.t).getIsOfflineMode(),..._(c.t).getConnectionStatus()})),p=()=>{if(P){if(g)return window.location=g,Promise.resolve(g)}else return D({from:j,redirectUri:g});return Promise.resolve()},w=_=>(_&&_.preventDefault(),y?p():J({registrationNonce:O,redirectUri:g}).then(()=>p()));return(0,I.useEffect)(()=>{m.ZP.setApiRoot(L),m.ZP.setApiNonce(f)},[L,f]),(0,I.useEffect)(()=>{N&&!k&&!H&&w()},[]),{handleRegisterSite:w,handleConnectUser:p,refreshConnectedPlugins:Z,isRegistered:y,isUserConnected:F,siteIsRegistering:k,userIsConnecting:H,registrationError:b,userConnectionData:U,hasConnectedOwner:x,connectedPlugins:V,connectionErrors:z,isOfflineMode:B}}},"../connection/state/store.jsx":(v,S,i)=>{i.d(S,{t:()=>Y});var m=i("../api/index.jsx");const l="SET_CONNECTION_STATUS",C="SET_CONNECTION_STATUS_IS_FETCHING",I="FETCH_CONNECTION_STATUS",c="SET_SITE_IS_REGISTERING",d="SET_USER_IS_CONNECTING",T="SET_REGISTRATION_ERROR",O="CLEAR_REGISTRATION_ERROR",L="REGISTER_SITE",f="SET_AUTHORIZATION_URL",g="CONNECT_USER",N="DISCONNECT_USER_SUCCESS",j="FETCH_AUTHORIZATION_URL",P="SET_CONNECTED_PLUGINS",J="REFRESH_CONNECTED_PLUGINS",D="SET_CONNECTION_ERRORS",Z="SET_IS_OFFLINE_MODE",b=n=>({type:l,connectionStatus:n}),k=n=>({type:C,isFetching:n}),H=()=>({type:I}),U=n=>({type:c,isRegistering:n}),V=n=>({type:d,isConnecting:n}),z=()=>({type:N}),y=n=>({type:T,registrationError:n}),F=()=>({type:O}),x=n=>({type:f,authorizationUrl:n}),B=n=>({type:j,redirectUri:n}),p=n=>({type:P,connectedPlugins:n}),w=n=>({type:D,connectionErrors:n}),_=n=>({type:Z,isOfflineMode:n});function W(){let{from:n,redirectFunc:o,redirectUri:u}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function*(){yield V(!0),yield{type:g,from:n,redirectFunc:o,redirectUri:u}}()}function Et(n){let{registrationNonce:o,redirectUri:u}=n;return function*(){yield F(),yield U(!0);try{const A=yield{type:L,registrationNonce:o,redirectUri:u};return yield b({isRegistered:!0}),yield x(A.authorizeUrl),yield U(!1),Promise.resolve(A)}catch(A){return yield y(A),yield U(!1),Promise.reject(A)}}()}const rt={setConnectionStatus:b,setConnectionStatusIsFetching:k,fetchConnectionStatus:H,fetchAuthorizationUrl:B,setSiteIsRegistering:U,setUserIsConnecting:V,setRegistrationError:y,clearRegistrationError:F,setAuthorizationUrl:x,registerSite:Et,connectUser:W,disconnectUserSuccess:z,setConnectedPlugins:p,refreshConnectedPlugins:()=>async n=>{let{dispatch:o}=n;return await new Promise(u=>m.ZP.fetchConnectedPlugins().then(A=>{o(p(A)),u(A)}))},setConnectionErrors:w,setIsOfflineMode:_};var ht=i("../../../node_modules/.pnpm/@wordpress+data@9.11.0_react@18.2.0/node_modules/@wordpress/data/build-module/factory.js");const Y="jetpack-connection",mt=n=>{let{registrationNonce:o,redirectUri:u}=n;return m.ZP.registerSite(o,u)},Tt=(0,ht.R)(n=>{let{resolveSelect:o}=n;return function(){let{from:u,redirectFunc:A,redirectUri:$}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new Promise((ut,Nt)=>{o(Y).getAuthorizationUrl($).then(ot=>{const Vt=A||(yt=>window.location.assign(yt)),Ut=new URL(ot);u&&Ut.searchParams.set("from",encodeURIComponent(u));const lt=Ut.toString();Vt(lt),ut(lt)}).catch(ot=>{Nt(ot)})})}}),pt={FETCH_AUTHORIZATION_URL:n=>{let{redirectUri:o}=n;return m.ZP.fetchAuthorizationUrl(o)},REGISTER_SITE:mt,CONNECT_USER:Tt};var tt=i("../../../node_modules/.pnpm/@wordpress+data@9.11.0_react@18.2.0/node_modules/@wordpress/data/build-module/index.js");const Q=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0;switch(o.type){case l:return{...n,...o.connectionStatus};case N:return{...n,isUserConnected:!1}}return n},St=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0;switch(o.type){case P:return o.connectedPlugins}return n},X=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,o=arguments.length>1?arguments[1]:void 0;switch(o.type){case C:return o.isFetching}return n},Ct=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,o=arguments.length>1?arguments[1]:void 0;switch(o.type){case c:return o.isRegistering}return n},G=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,o=arguments.length>1?arguments[1]:void 0;switch(o.type){case d:return o.isConnecting}return n},at=(n,o)=>{switch(o.type){case O:return!1;case T:return o.registrationError;default:return n}},wt=(n,o)=>{switch(o.type){case f:return o.authorizationUrl;default:return n}},Dt=(n,o)=>{switch(o.type){default:return n}},bt=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0;switch(o.type){case D:return o.connectionErrors}return n},kt=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,o=arguments.length>1?arguments[1]:void 0;switch(o.type){case Z:return o.isConnecting}return n},Ht=(0,tt.UY)({connectionStatus:Q,connectionStatusIsFetching:X,siteIsRegistering:Ct,userIsConnecting:G,registrationError:at,authorizationUrl:wt,userConnectionData:Dt,connectedPlugins:St,connectionErrors:bt,isOfflineMode:kt});var xt=i("../../../node_modules/.pnpm/@wordpress+data@9.11.0_react@18.2.0/node_modules/@wordpress/data/build-module/select.js"),At=i("../../../node_modules/.pnpm/@wordpress+data@9.11.0_react@18.2.0/node_modules/@wordpress/data/build-module/dispatch.js");const It={...{getAuthorizationUrl:{isFulfilled:function(n){const o=!!n.authorizationUrl;for(var u=arguments.length,A=new Array(u>1?u-1:0),$=1;$<u;$++)A[$-1]=arguments[$];const ut=(0,xt.Y)(Y).hasFinishedResolution("getAuthorizationUrl",A);return o&&!ut&&(0,At.W)(Y).finishResolution("getAuthorizationUrl",A),o},*fulfill(n){const o=yield rt.fetchAuthorizationUrl(n);yield rt.setAuthorizationUrl(o.authorizeUrl)}}}},Pt={...{getConnectionStatus:n=>n.connectionStatus||{},getConnectionStatusIsFetching:()=>!1,getSiteIsRegistering:n=>n.siteIsRegistering||!1,getUserIsConnecting:n=>n.userIsConnecting||!1,getRegistrationError:n=>n.registrationError||!1,getAuthorizationUrl:n=>n.authorizationUrl||!1,getUserConnectionData:n=>n.userConnectionData||!1,getConnectedPlugins:n=>n.connectedPlugins||[],getConnectionErrors:n=>n.connectionErrors||[],getIsOfflineMode:n=>n.isOfflineMode||!1,getWpcomUser:n=>{var o,u;return(u=(o=n==null?void 0:n.userConnectionData)==null?void 0:o.currentUser)==null?void 0:u.wpcomUser},getBlogId:n=>{var o,u;return(u=(o=n==null?void 0:n.userConnectionData)==null?void 0:o.currentUser)==null?void 0:u.blogId}}};var Rt=i("../../../node_modules/.pnpm/@wordpress+data@9.11.0_react@18.2.0/node_modules/@wordpress/data/build-module/redux-store/index.js");const st=class{static mayBeInit(o,u){st.store===null&&(st.store=(0,Rt.Z)(o,u),(0,tt.z2)(st.store))}};let et=st;Ft(et,"store",null);const Ot=et,ct=window.JP_CONNECTION_INITIAL_STATE;ct||console.error("Jetpack Connection package: Initial state is missing. Check documentation to see how to use the Connection composer package to set up the initial state."),Ot.mayBeInit(Y,{__experimentalUseThunks:!0,reducer:Ht,actions:rt,selectors:Pt,resolvers:It,controls:pt,initialState:ct||{}})},"../../packages/my-jetpack/_inc/components/product-card/action-button.jsx":(v,S,i)=>{i.d(S,{N:()=>T,Z:()=>L});var m=i("../components/components/button/index.tsx"),l=i("../../../node_modules/.pnpm/@wordpress+i18n@4.41.0/node_modules/@wordpress/i18n/build-module/index.js"),C=i("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),I=i("../../packages/my-jetpack/_inc/hooks/use-product/index.js"),c=i("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");const d=l.__,T={ACTIVE:"active",INACTIVE:"inactive",ERROR:"error",ABSENT:"plugin_absent",ABSENT_WITH_PLAN:"plugin_absent_with_plan",NEEDS_PURCHASE:"needs_purchase",NEEDS_PURCHASE_OR_FREE:"needs_purchase_or_free"},O=f=>{let{status:g,admin:N,name:j,slug:P,onActivate:J,onManage:D,onFixConnection:Z,isFetching:b,isInstallingStandalone:k,isDeactivatingStandalone:H,className:U,onAdd:V}=f;const{detail:z}=(0,I.i)(P),{manageUrl:y,purchaseUrl:F}=z,x=!y,B=b||k||H,p={variant:B?void 0:"primary",disabled:B,className:U};if(!N)return(0,c.jsx)(m.Z,{...p,size:"small",variant:"link",weight:"regular",children:(0,l.gB)(d("Learn about %s","jetpack-my-jetpack"),j)});switch(g){case T.ABSENT:case T.ABSENT_WITH_PLAN:return(0,c.jsxs)(m.Z,{...p,href:`#/add-${P}`,size:"small",variant:"link",weight:"regular",children:[g===T.ABSENT&&(0,l.gB)(d("Get %s","jetpack-my-jetpack"),j),g===T.ABSENT_WITH_PLAN&&(0,l.gB)(d("Install %s","jetpack-my-jetpack"),j)]});case T.NEEDS_PURCHASE:{const w=d("Upgrade","jetpack-my-jetpack"),_=d("Purchase","jetpack-my-jetpack"),W=F?w:_;return(0,c.jsx)(m.Z,{...p,href:F||`#/add-${P}`,size:"small",weight:"regular",onClick:V,children:W})}case T.NEEDS_PURCHASE_OR_FREE:return(0,c.jsx)(m.Z,{...p,href:`#/add-${P}`,size:"small",weight:"regular",onClick:V,children:d("Start for free","jetpack-my-jetpack")});case T.ACTIVE:{const w=d("View","jetpack-my-jetpack"),_=d("Manage","jetpack-my-jetpack"),W=F?w:_;return(0,c.jsx)(m.Z,{...p,disabled:x||(p==null?void 0:p.disabled),size:"small",weight:"regular",variant:"secondary",href:y,onClick:D,children:W})}case T.ERROR:return(0,c.jsx)(m.Z,{...p,href:"#/connection",size:"small",weight:"regular",onClick:Z,children:d("Fix connection","jetpack-my-jetpack")});case T.INACTIVE:return(0,c.jsx)(m.Z,{...p,size:"small",weight:"regular",variant:"secondary",onClick:J,children:d("Activate","jetpack-my-jetpack")});default:return null}};O.__docgenInfo={description:"",methods:[],displayName:"ActionButton"};const L=O},"../../packages/my-jetpack/_inc/hooks/use-product/index.js":(v,S,i)=>{i.d(S,{i:()=>I});var m=i("../../../node_modules/.pnpm/@wordpress+data@9.11.0_react@18.2.0/node_modules/@wordpress/data/build-module/components/use-dispatch/use-dispatch.js"),l=i("../../../node_modules/.pnpm/@wordpress+data@9.11.0_react@18.2.0/node_modules/@wordpress/data/build-module/components/use-select/index.js"),C=i("../../packages/my-jetpack/_inc/state/store.js");function I(c){const{activateProduct:d,deactivateProduct:T,installStandalonePluginForProduct:O,deactivateStandalonePluginForProduct:L}=(0,m.Z)(C.t),f=(0,l.Z)(g=>g(C.t).getProduct(c));return{activate:()=>d(c),deactivate:()=>T(c),deactivateStandalonePlugin:()=>L(c),installStandalonePlugin:()=>O(c),productsList:(0,l.Z)(g=>g(C.t).getProducts()),detail:f,isActive:f.status==="active",isFetching:(0,l.Z)(g=>g(C.t).isFetching(c)),stats:(0,l.Z)(g=>g(C.t).getProductStats(c))}}},"../../packages/my-jetpack/_inc/state/store.js":(v,S,i)=>{i.d(S,{t:()=>Wt,N:()=>Xt});var m=i("../connection/state/store.jsx"),l=i("../../../node_modules/.pnpm/@wordpress+api-fetch@6.38.0/node_modules/@wordpress/api-fetch/build-module/index.js"),C=i("../../../node_modules/.pnpm/@wordpress+i18n@4.41.0/node_modules/@wordpress/i18n/build-module/index.js");const I="my-jetpack/v1",c=`${I}/site/purchases`,d=`${I}/site/products`,T=`${I}/chat/availability`,O=`${I}/chat/authentication`,L=["scan"],f="videopress",g="videopress/v1/stats/featured",N=C.__,j="SET_PURCHASES_IS_FETCHING",P="FETCH_PURCHASES",J="SET_PURCHASES",D="SET_AVAILABLE_LICENSES_IS_FETCHING",Z="FETCH_AVAILABLE_LICENSES",b="SET_AVAILABLE_LICENSES",k="SET_IS_FETCHING_PRODUCT",H="SET_PRODUCT",U="SET_PRODUCT_REQUEST_ERROR",V="ACTIVATE_PRODUCT",z="SET_PRODUCT_STATUS",y="SET_CHAT_AVAILABILITY_IS_FETCHING",F="SET_CHAT_AVAILABILITY",x="SET_CHAT_AUTHENTICATION_IS_FETCHING",B="SET_CHAT_AUTHENTICATION",p="SET_GLOBAL_NOTICE",w="CLEAN_GLOBAL_NOTICE",_="SET_PRODUCT_STATS",W="SET_IS_FETCHING_PRODUCT_STATS",Et=t=>({type:j,isFetching:t}),vt=t=>({type:y,isFetching:t}),rt=t=>({type:x,isFetching:t}),ht=()=>({type:P}),Lt=t=>({type:J,purchases:t}),Y=t=>({type:F,chatAvailability:t}),mt=t=>({type:B,chatAuthentication:t}),Tt=t=>({type:D,isFetching:t}),jt=()=>({type:Z}),pt=t=>({type:b,availableLicenses:t}),tt=t=>({type:H,product:t}),Q=(t,e)=>({type:U,productId:t,error:e}),St=(t,e)=>({type:z,productId:t,status:e}),X=(t,e)=>({type:"SET_GLOBAL_NOTICE",message:t,options:e}),Ct=()=>({type:"CLEAN_GLOBAL_NOTICE"});function G(t,e){return{type:k,productId:t,isFetching:e}}function at(t,e,r){let{select:s,dispatch:a,registry:E}=r;return new Promise((M,K)=>{if(!s.isValidProduct(t)){const R=N("Invalid product name","jetpack-my-jetpack"),_t=new Error(R);a(Q(t,_t)),a(X(R,{status:"error",isDismissible:!0})),K(_t);return}const nt=e.activate?"POST":"DELETE";return a(G(t,!0)),(0,l.Z)({path:`${d}/${t}`,method:nt}).then(R=>{a(G(t,!1)),a(tt(R)),E.dispatch(m.t).refreshConnectedPlugins(),M(R==null?void 0:R.status)}).catch(R=>{const{name:_t}=s.getProduct(t),qt=(0,C.gB)(N("Failed to activate %1$s. Please try again","jetpack-my-jetpack"),_t);a(G(t,!1)),a(Q(t,R)),a(X(qt,{status:"error",isDismissible:!0})),K(R)})})}const At={setPurchasesIsFetching:Et,setChatAvailabilityIsFetching:vt,setChatAuthenticationIsFetching:rt,fetchPurchases:ht,setPurchases:Lt,setChatAvailability:Y,setChatAuthentication:mt,setAvailableLicensesIsFetching:Tt,fetchAvailableLicenses:jt,setAvailableLicenses:pt,setProductStats:(t,e)=>({type:_,productId:t,stats:e}),setIsFetchingProductStats:(t,e)=>({type:W,productId:t,isFetching:e}),...{setGlobalNotice:X,cleanGlobalNotice:Ct},...{setProduct:tt,activateProduct:t=>async e=>await at(t,{activate:!0},e),deactivateStandalonePluginForProduct:t=>async e=>await at(t,{activate:!1},e),installStandalonePluginForProduct:t=>async e=>{const{select:r,dispatch:s,registry:a}=e;return await new Promise((E,M)=>{if(!r.isValidProduct(t)){const h=N("Invalid product name","jetpack-my-jetpack"),nt=new Error(h);s(Q(t,nt)),s(X(h,{status:"error",isDismissible:!0})),M(nt);return}return s(G(t,!0)),(0,l.Z)({path:`${d}/${t}/install-standalone`,method:"POST"}).then(h=>{s(G(t,!1)),s(tt(h)),a.dispatch(m.t).refreshConnectedPlugins(),E(h==null?void 0:h.standalone_plugin_info)}).catch(h=>{const{name:nt}=r.getProduct(t),R=(0,C.gB)(N("Failed to install standalone plugin for %1$s: %2$s. Please try again","jetpack-my-jetpack"),nt,h.message);s(G(t,!1)),s(Q(t,h)),s(X(R,{status:"error",isDismissible:!0})),M(h)})})},setIsFetchingProduct:G,setRequestProductError:Q,setProductStatus:St}};function Bt(){return new Promise((t,e)=>{(0,l.Z)({path:c}).then(t).catch(e)})}const It={[P]:Bt};var ft=i("../../../node_modules/.pnpm/@wordpress+data@9.11.0_react@18.2.0/node_modules/@wordpress/data/build-module/index.js");const Gt=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case k:{const{productId:r,isFetching:s}=e;return{...t,isFetching:{...t.isFetching,[r]:s},errors:{...t.errors,[r]:s?void 0:t.errors[r]}}}case z:{const{productId:r,status:s}=e;return{...t,items:{...t.items,[r]:{...t.items[r],status:s}}}}case H:{const{product:r}=e,{slug:s}=r;return{...t,items:{...t.items,[s]:r}}}case U:{const{productId:r,error:s}=e;return{...t,errors:{...t.errors,[r]:s}}}default:return t}},Mt=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case j:return{...t,isFetching:e.isFetching};case J:return{...t,items:(e==null?void 0:e.purchases)||[]};default:return t}},Zt=function(){var r;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{isFetching:!1,isAvailable:!1},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case y:return{...t,isFetching:e.isFetching};case F:return{...t,isAvailable:(r=e==null?void 0:e.chatAvailability)==null?void 0:r.is_available};default:return t}},Pt=function(){var r,s;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{isFetching:!1,jwt:!1},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case x:return{...t,isFetching:e.isFetching};case B:return{...t,jwt:(s=(r=e==null?void 0:e.chatAuthentication)==null?void 0:r.user)==null?void 0:s.jwt};default:return t}},Rt=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case D:return{...t,isFetching:e.isFetching};case b:return{...t,items:(e==null?void 0:e.availableLicenses)||[]};default:return t}},et=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{global:{}},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case p:{const{message:r,options:s}=e;return{...t,global:{message:r,options:s}}}case w:return{...t,global:{}};default:return t}},Ot=function(){return arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}},ct=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case W:{const{productId:r,isFetching:s}=e;return{...t,isFetching:{...t.isFetching,[r]:s}}}case _:{const{productId:r,stats:s}=e;return{...t,items:{...t.items,[r]:s}}}default:return t}},n=(0,ft.UY)({products:Gt,purchases:Mt,chatAvailability:Zt,chatAuthentication:Pt,availableLicenses:Rt,notices:et,plugins:Ot,stats:ct});var o=i("../api/index.jsx"),u=i("../../packages/my-jetpack/_inc/components/product-card/action-button.jsx");const $=async()=>(0,l.Z)({path:g}),Nt=async t=>t===f?$():null,ot=C.__,lt={...{getProduct:{isFulfilled:(t,e)=>{var s;return(((s=t==null?void 0:t.products)==null?void 0:s.items)||{}).hasOwnProperty(e)&&!L.includes(e)},fulfill:t=>async e=>{let{dispatch:r}=e;try{r.setIsFetchingProduct(t,!0);const s=await(0,l.Z)({path:`${d}/${t}`});return r.setProduct(s),r.setIsFetchingProduct(t,!1),Promise.resolve()}catch(s){if(r.setIsFetchingProduct(t,!1),s!=null&&s.code&&(s!=null&&s.message))return r.setRequestProductError(t,s),Promise.reject(s);throw new Error(s)}}},getPurchases:()=>async t=>{let{dispatch:e}=t;e.setPurchasesIsFetching(!0);try{e.setPurchases(await(0,l.Z)({path:c})),e.setPurchasesIsFetching(!1)}catch(r){e.setPurchasesIsFetching(!1),r.code!=="not_connected"&&e.setGlobalNotice(ot("There was an error fetching your purchases information. Check your site connectivity and try again.","jetpack-my-jetpack"),{status:"error"})}},getChatAvailability:()=>async t=>{let{dispatch:e}=t;e.setChatAvailabilityIsFetching(!0);try{e.setChatAvailability(await(0,l.Z)({path:T})),e.setChatAvailabilityIsFetching(!1)}catch(r){e.setChatAvailabilityIsFetching(!1)}},getChatAuthentication:()=>async t=>{let{dispatch:e}=t;e.setChatAuthenticationIsFetching(!0);try{e.setChatAuthentication(await(0,l.Z)({path:O})),e.setChatAuthenticationIsFetching(!1)}catch(r){e.setChatAuthenticationIsFetching(!1)}},getAvailableLicenses:()=>async t=>{let{dispatch:e}=t;e.setAvailableLicensesIsFetching(!0);try{const{apiRoot:r,apiNonce:s}=(window==null?void 0:window.myJetpackRest)||{};o.ZP.setApiRoot(r),o.ZP.setApiNonce(s);const a=await o.ZP.getUserLicenses();a&&a.items?e.setAvailableLicenses(a.items.filter(E=>{let{attached_at:M,revoked_at:K}=E;return M===null&&K===null})):e.setAvailableLicenses([])}catch(r){e.setAvailableLicenses([])}finally{e.setAvailableLicensesIsFetching(!1)}}},getProductStats:{isFulfilled:(t,e)=>{var r,s;return((s=(r=t.stats)==null?void 0:r.items)==null?void 0:s.hasOwnProperty(e))||!1},fulfill:t=>async e=>{let{dispatch:r,select:s}=e;const{status:a}=s.getProduct(t);if(a!==u.N.ACTIVE)return r.setProductStats(t,null),Promise.resolve();try{r.setIsFetchingProductStats(t,!0);const E=await Nt(t);return r.setProductStats(t,E),r.setIsFetchingProductStats(t,!1),Promise.resolve()}catch(E){if(r.setProductStats(t,null),r.setIsFetchingProductStats(t,!1),E!=null&&E.code&&(E!=null&&E.message))return Promise.reject(E);throw new Error(E)}}}};function yt(t){return t.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace("_",""))}function Kt(t){return t.indexOf("_")!==-1}function q(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=Object.assign({},t);for(const s in r)r.hasOwnProperty(s)&&Kt(s)&&(r[yt(s)]=r[s],e&&delete r[s]);return r}const dt=t=>{var e;return((e=t.products)==null?void 0:e.items)||{}},zt=t=>Object.keys(dt(t)),Jt={...{getProducts:dt,getProductNames:zt,getProduct:(t,e)=>{var a,E;const r=((a=dt(t))==null?void 0:a[e])||{},s=q(r,!0);return s.standalonePluginInfo=q(s.standalonePluginInfo||{},!0),s.pricingForUi=q(s.pricingForUi||{},!0),s.pricingForUi.introductoryOffer=s.pricingForUi.isIntroductoryOffer?q(s.pricingForUi.introductoryOffer,!0):null,(E=s.pricingForUi)!=null&&E.tiers&&(s.pricingForUi.tiers=q(s.pricingForUi.tiers,!0),s.pricingForUi.tiers=Object.keys(s.pricingForUi.tiers).reduce((M,K)=>{const h=q(s.pricingForUi.tiers[K],!0)||{};return M[K]={...h,introductoryOffer:h!=null&&h.isIntroductoryOffer?q(h==null?void 0:h.introductoryOffer,!0):null},M},{})),s.features=s.features||[],s.supportedProducts=s.supportedProducts||[],s.pricingForUi.fullPricePerMonth=s.pricingForUi.productTerm==="year"?Math.ceil(s.pricingForUi.fullPrice/12*100)/100:s.pricingForUi.fullPrice,s.pricingForUi.discountPricePerMonth=s.pricingForUi.productTerm==="year"?Math.ceil(s.pricingForUi.discountPrice/12*100)/100:s.pricingForUi.discountPrice,s},isValidProduct:(t,e)=>zt(t).includes(e),isFetching:(t,e)=>{var r,s;return((s=(r=t.products)==null?void 0:r.isFetching)==null?void 0:s[e])||!1},getProductsThatRequiresUserConnection:t=>{const e=dt(t);return Object.keys(e).reduce((r,s)=>{const a=e[s];return(a==null?void 0:a.requires_user_connection)&&((a==null?void 0:a.status)===u.N.ACTIVE||(a==null?void 0:a.status)===u.N.ERROR)&&r.push(a==null?void 0:a.name),r},[])}},...{getPurchases:t=>{var e;return((e=t.purchases)==null?void 0:e.items)||[]},isRequestingPurchases:t=>{var e;return((e=t.purchases)==null?void 0:e.isFetching)||!1}},...{getChatAvailability:t=>t.chatAvailability.isAvailable,isRequestingChatAvailability:t=>t.chatAvailability.isFetching},...{getChatAuthentication:t=>t.chatAuthentication.jwt,isRequestingChatAuthentication:t=>t.chatAuthentication.isFetching},...{getAvailableLicenses:t=>{var e;return((e=t.availableLicenses)==null?void 0:e.items)||[]},isFetchingAvailableLicenses:t=>{var e;return((e=t.availableLicenses)==null?void 0:e.isFetching)||!1}},...{getGlobalNotice:t=>{var e;return(e=t.notices)==null?void 0:e.global}},...{hasStandalonePluginInstalled:t=>Object.values(t.plugins).filter(e=>["jetpack-backup","jetpack-boost","jetpack-protect","jetpack-search","jetpack-social","jetpack-videopress"].indexOf(e.TextDomain)>=0).length>0},...{getProductStats:(t,e)=>{var r,s;return(s=(r=t.stats)==null?void 0:r.items)==null?void 0:s[e]},isFetchingProductStats:(t,e)=>{var r,s;return((s=(r=t.stats)==null?void 0:r.isFetching)==null?void 0:s[e])||!1}}};var Yt=i("../../../node_modules/.pnpm/@wordpress+data@9.11.0_react@18.2.0/node_modules/@wordpress/data/build-module/redux-store/index.js");const it=class{static mayBeInit(e,r){it.store===null&&(it.store=(0,Yt.Z)(e,r),(0,ft.z2)(it.store))}};let gt=it;Ft(gt,"store",null);const Qt=gt,Wt="my-jetpack";function Xt(){Qt.mayBeInit(Wt,{__experimentalUseThunks:!0,reducer:n,actions:At,selectors:Jt,resolvers:lt,controls:It,initialState:window.myJetpackInitialState||{}})}}}]);})();
