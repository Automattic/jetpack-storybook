"use strict";(()=>{(self.webpackChunk_automattic_jetpack_storybook=self.webpackChunk_automattic_jetpack_storybook||[]).push([[1682],{"../../../node_modules/.pnpm/@wordpress+data@9.7.0_react@18.2.0/node_modules/@wordpress/data/build-module/dispatch.js":(P,T,o)=>{o.d(T,{W:()=>m});var E=o("../../../node_modules/.pnpm/@wordpress+data@9.7.0_react@18.2.0/node_modules/@wordpress/data/build-module/default-registry.js");function m(c){return E.Z.dispatch(c)}},"../../../node_modules/.pnpm/@wordpress+data@9.7.0_react@18.2.0/node_modules/@wordpress/data/build-module/select.js":(P,T,o)=>{o.d(T,{Y:()=>m});var E=o("../../../node_modules/.pnpm/@wordpress+data@9.7.0_react@18.2.0/node_modules/@wordpress/data/build-module/default-registry.js");function m(c){return E.Z.select(c)}},"../analytics/index.jsx":(P,T,o)=>{o.d(T,{Z:()=>R});var E=o("../../../node_modules/.pnpm/debug@4.3.4/node_modules/debug/src/browser.js"),m=o.n(E);const c=m()("dops:analytics");let f,l;window._tkq=window._tkq||[],window.ga=window.ga||function(){(window.ga.q=window.ga.q||[]).push(arguments)},window.ga.l=+new Date;function r(t,s){let i="";if(typeof t=="object"){for(const d in t)i+="&x_"+encodeURIComponent(d)+"="+encodeURIComponent(t[d]);c("Bumping stats %o",t)}else i="&x_"+encodeURIComponent(t)+"="+encodeURIComponent(s),c('Bumping stat "%s" in group "%s"',s,t);return i}function S(t,s){let i="";if(typeof t=="object"){for(const d in t)i+="&"+encodeURIComponent(d)+"="+encodeURIComponent(t[d]);c("Built stats %o",t)}else i="&"+encodeURIComponent(t)+"="+encodeURIComponent(s),c('Built stat "%s" in group "%s"',s,t);return i}const u={initialize:function(t,s,i){u.setUser(t,s),u.setSuperProps(i),u.identifyUser()},setGoogleAnalyticsEnabled:function(t){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.googleAnalyticsEnabled=t,this.googleAnalyticsKey=s},setMcAnalyticsEnabled:function(t){this.mcAnalyticsEnabled=t},setUser:function(t,s){l={ID:t,username:s}},setSuperProps:function(t){f=t},assignSuperProps:function(t){f=Object.assign(f||{},t)},mc:{bumpStat:function(t,s){const i=r(t,s);u.mcAnalyticsEnabled&&(new Image().src=document.location.protocol+"//pixel.wp.com/g.gif?v=wpcom-no-pv"+i+"&t="+Math.random())},bumpStatWithPageView:function(t,s){const i=S(t,s);u.mcAnalyticsEnabled&&(new Image().src=document.location.protocol+"//pixel.wp.com/g.gif?v=wpcom"+i+"&t="+Math.random())}},pageView:{record:function(t,s){u.tracks.recordPageView(t),u.ga.recordPageView(t,s)}},purchase:{record:function(t,s,i,d,_,U,a){u.ga.recordPurchase(t,s,i,d,_,U,a)}},tracks:{recordEvent:function(t,s){if(s=s||{},t.indexOf("akismet_")!==0&&t.indexOf("jetpack_")!==0){c('- Event name must be prefixed by "akismet_" or "jetpack_"');return}f&&(c("- Super Props: %o",f),s=Object.assign(s,f)),c('Record event "%s" called with props %s',t,JSON.stringify(s)),window._tkq.push(["recordEvent",t,s])},recordJetpackClick:function(t){const s=typeof t=="object"?t:{target:t};u.tracks.recordEvent("jetpack_wpa_click",s)},recordPageView:function(t){u.tracks.recordEvent("akismet_page_view",{path:t})},setOptOut:function(t){c("Pushing setOptOut: %o",t),window._tkq.push(["setOptOut",t])}},ga:{initialized:!1,initialize:function(){let t={};u.ga.initialized||(l&&(t={userId:"u-"+l.ID}),window.ga("create",this.googleAnalyticsKey,"auto",t),u.ga.initialized=!0)},recordPageView:function(t,s){u.ga.initialize(),c("Recording Page View ~ [URL: "+t+"] [Title: "+s+"]"),this.googleAnalyticsEnabled&&(window.ga("set","page",t),window.ga("send",{hitType:"pageview",page:t,title:s}))},recordEvent:function(t,s,i,d){u.ga.initialize();let _="Recording Event ~ [Category: "+t+"] [Action: "+s+"]";typeof i!="undefined"&&(_+=" [Option Label: "+i+"]"),typeof d!="undefined"&&(_+=" [Option Value: "+d+"]"),c(_),this.googleAnalyticsEnabled&&window.ga("send","event",t,s,i,d)},recordPurchase:function(t,s,i,d,_,U,a){window.ga("require","ecommerce"),window.ga("ecommerce:addTransaction",{id:t,revenue:d,currency:a}),window.ga("ecommerce:addItem",{id:t,name:s,sku:i,price:_,quantity:U}),window.ga("ecommerce:send")}},identifyUser:function(){l&&window._tkq.push(["identifyUser",l.ID,l.username])},setProperties:function(t){window._tkq.push(["setProperties",t])},clearedIdentity:function(){window._tkq.push(["clearIdentity"])}},R=u},"../connection/components/use-connection/index.jsx":(P,T,o)=>{o.d(T,{Z:()=>S});var E=o("../api/index.jsx"),m=o("../../../node_modules/.pnpm/@wordpress+data@9.7.0_react@18.2.0/node_modules/@wordpress/data/build-module/components/use-dispatch/use-dispatch.js"),c=o("../../../node_modules/.pnpm/@wordpress+data@9.7.0_react@18.2.0/node_modules/@wordpress/data/build-module/components/use-select/index.js"),f=o("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),l=o("../connection/state/store.jsx");const r=window!=null&&window.JP_CONNECTION_INITIAL_STATE?window.JP_CONNECTION_INITIAL_STATE:{},S=function(){let{registrationNonce:u=r.registrationNonce,apiRoot:R=r.apiRoot,apiNonce:t=r.apiNonce,redirectUri:s,autoTrigger:i,from:d,skipUserConnection:_}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{registerSite:U,connectUser:a,refreshConnectedPlugins:p}=(0,m.Z)(l.t),A=(0,c.Z)(h=>h(l.t).getRegistrationError()),{siteIsRegistering:w,userIsConnecting:y,userConnectionData:O,connectedPlugins:I,connectionErrors:N,isRegistered:v,isUserConnected:k,hasConnectedOwner:L,isOfflineMode:F}=(0,c.Z)(h=>({siteIsRegistering:h(l.t).getSiteIsRegistering(),userIsConnecting:h(l.t).getUserIsConnecting(),userConnectionData:h(l.t).getUserConnectionData(),connectedPlugins:h(l.t).getConnectedPlugins(),connectionErrors:h(l.t).getConnectionErrors(),isOfflineMode:h(l.t).getIsOfflineMode(),...h(l.t).getConnectionStatus()})),D=()=>{if(_){if(s)return window.location=s,Promise.resolve(s)}else return a({from:d,redirectUri:s});return Promise.resolve()},x=h=>(h&&h.preventDefault(),v?D():U({registrationNonce:u,redirectUri:s}).then(()=>D()));return(0,f.useEffect)(()=>{E.ZP.setApiRoot(R),E.ZP.setApiNonce(t)},[R,t]),(0,f.useEffect)(()=>{i&&!w&&!y&&x()},[]),{handleRegisterSite:x,handleConnectUser:D,refreshConnectedPlugins:p,isRegistered:v,isUserConnected:k,siteIsRegistering:w,userIsConnecting:y,registrationError:A,userConnectionData:O,hasConnectedOwner:L,connectedPlugins:I,connectionErrors:N,isOfflineMode:F}}},"../connection/state/store.jsx":(P,T,o)=>{o.d(T,{t:()=>b});var E=o("../api/index.jsx");const m="SET_CONNECTION_STATUS",c="SET_CONNECTION_STATUS_IS_FETCHING",f="FETCH_CONNECTION_STATUS",l="SET_SITE_IS_REGISTERING",r="SET_USER_IS_CONNECTING",S="SET_REGISTRATION_ERROR",u="CLEAR_REGISTRATION_ERROR",R="REGISTER_SITE",t="SET_AUTHORIZATION_URL",s="CONNECT_USER",i="DISCONNECT_USER_SUCCESS",d="FETCH_AUTHORIZATION_URL",_="SET_CONNECTED_PLUGINS",U="REFRESH_CONNECTED_PLUGINS",a="SET_CONNECTION_ERRORS",p="SET_IS_OFFLINE_MODE",A=e=>({type:m,connectionStatus:e}),w=e=>({type:c,isFetching:e}),y=()=>({type:f}),O=e=>({type:l,isRegistering:e}),I=e=>({type:r,isConnecting:e}),N=()=>({type:i}),v=e=>({type:S,registrationError:e}),k=()=>({type:u}),L=e=>({type:t,authorizationUrl:e}),F=e=>({type:d,redirectUri:e}),D=e=>({type:_,connectedPlugins:e}),x=e=>({type:a,connectionErrors:e}),h=e=>({type:p,isOfflineMode:e});function V(){let{from:e,redirectFunc:n,redirectUri:g}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function*(){yield I(!0),yield{type:s,from:e,redirectFunc:n,redirectUri:g}}()}function J(e){let{registrationNonce:n,redirectUri:g}=e;return function*(){yield k(),yield O(!0);try{const C=yield{type:R,registrationNonce:n,redirectUri:g};return yield A({isRegistered:!0}),yield L(C.authorizeUrl),yield O(!1),Promise.resolve(C)}catch(C){return yield v(C),yield O(!1),Promise.reject(C)}}()}const B={setConnectionStatus:A,setConnectionStatusIsFetching:w,fetchConnectionStatus:y,fetchAuthorizationUrl:F,setSiteIsRegistering:O,setUserIsConnecting:I,setRegistrationError:v,clearRegistrationError:k,setAuthorizationUrl:L,registerSite:J,connectUser:V,disconnectUserSuccess:N,setConnectedPlugins:D,refreshConnectedPlugins:()=>async e=>{let{dispatch:n}=e;return await new Promise(g=>E.ZP.fetchConnectedPlugins().then(C=>{n(D(C)),g(C)}))},setConnectionErrors:x,setIsOfflineMode:h};var X=o("../../../node_modules/.pnpm/@wordpress+data@9.7.0_react@18.2.0/node_modules/@wordpress/data/build-module/factory.js");const b="jetpack-connection",Y=e=>{let{registrationNonce:n,redirectUri:g}=e;return E.ZP.registerSite(n,g)},$=(0,X.R)(e=>{let{resolveSelect:n}=e;return function(){let{from:g,redirectFunc:C,redirectUri:M}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new Promise((z,he)=>{n(b).getAuthorizationUrl(M).then(Z=>{const Ce=C||(Te=>window.location.assign(Te)),K=new URL(Z);g&&K.searchParams.set("from",encodeURIComponent(g));const H=K.toString();Ce(H),z(H)}).catch(Z=>{he(Z)})})}}),Q={FETCH_AUTHORIZATION_URL:e=>{let{redirectUri:n}=e;return E.ZP.fetchAuthorizationUrl(n)},REGISTER_SITE:Y,CONNECT_USER:$};var W=o("../../../node_modules/.pnpm/@wordpress+data@9.7.0_react@18.2.0/node_modules/@wordpress/data/build-module/index.js");const q=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;switch(n.type){case m:return{...e,...n.connectionStatus};case i:return{...e,isUserConnected:!1}}return e},ee=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;switch(n.type){case _:return n.connectedPlugins}return e},te=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case c:return n.isFetching}return e},ne=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case l:return n.isRegistering}return e},se=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case r:return n.isConnecting}return e},oe=(e,n)=>{switch(n.type){case u:return!1;case S:return n.registrationError;default:return e}},re=(e,n)=>{switch(n.type){case t:return n.authorizationUrl;default:return e}},ie=(e,n)=>{switch(n.type){default:return e}},ce=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;switch(n.type){case a:return n.connectionErrors}return e},ae=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case p:return n.isConnecting}return e},ue=(0,W.UY)({connectionStatus:q,connectionStatusIsFetching:te,siteIsRegistering:ne,userIsConnecting:se,registrationError:oe,authorizationUrl:re,userConnectionData:ie,connectedPlugins:ee,connectionErrors:ce,isOfflineMode:ae});var de=o("../../../node_modules/.pnpm/@wordpress+data@9.7.0_react@18.2.0/node_modules/@wordpress/data/build-module/select.js"),le=o("../../../node_modules/.pnpm/@wordpress+data@9.7.0_react@18.2.0/node_modules/@wordpress/data/build-module/dispatch.js");const ge={...{getAuthorizationUrl:{isFulfilled:function(e){const n=!!e.authorizationUrl;for(var g=arguments.length,C=new Array(g>1?g-1:0),M=1;M<g;M++)C[M-1]=arguments[M];const z=(0,de.Y)(b).hasFinishedResolution("getAuthorizationUrl",C);return n&&!z&&(0,le.W)(b).finishResolution("getAuthorizationUrl",C),n},*fulfill(e){const n=yield B.fetchAuthorizationUrl(e);yield B.setAuthorizationUrl(n.authorizeUrl)}}}},_e={...{getConnectionStatus:e=>e.connectionStatus||{},getConnectionStatusIsFetching:()=>!1,getSiteIsRegistering:e=>e.siteIsRegistering||!1,getUserIsConnecting:e=>e.userIsConnecting||!1,getRegistrationError:e=>e.registrationError||!1,getAuthorizationUrl:e=>e.authorizationUrl||!1,getUserConnectionData:e=>e.userConnectionData||!1,getConnectedPlugins:e=>e.connectedPlugins||[],getConnectionErrors:e=>e.connectionErrors||[],getIsOfflineMode:e=>e.isOfflineMode||!1,getWpcomUser:e=>{var n,g;return(g=(n=e==null?void 0:e.userConnectionData)==null?void 0:n.currentUser)==null?void 0:g.wpcomUser},getBlogId:e=>{var n,g;return(g=(n=e==null?void 0:e.userConnectionData)==null?void 0:n.currentUser)==null?void 0:g.blogId}}};var me=o("../../../node_modules/.pnpm/@babel+runtime@7.22.6/node_modules/@babel/runtime/helpers/defineProperty.js"),Ee=o.n(me),pe=o("../../../node_modules/.pnpm/@wordpress+data@9.7.0_react@18.2.0/node_modules/@wordpress/data/build-module/redux-store/index.js");class j{static mayBeInit(n,g){j.store===null&&(j.store=(0,pe.Z)(n,g),(0,W.z2)(j.store))}}Ee()(j,"store",null);const fe=j,G=window.JP_CONNECTION_INITIAL_STATE;G||console.error("Jetpack Connection package: Initial state is missing. Check documentation to see how to use the Connection composer package to set up the initial state."),fe.mayBeInit(b,{__experimentalUseThunks:!0,reducer:ue,actions:B,selectors:_e,resolvers:ge,controls:Q,initialState:G||{}})},"../../plugins/protect/src/js/hooks/use-analytics-tracks/index.js":(P,T,o)=>{o.d(T,{Z:()=>l});var E=o("../analytics/index.jsx"),m=o("../connection/components/use-connection/index.jsx"),c=o("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js");const l=function(){var y;let{pageViewEventName:r,pageViewNamespace:S="jetpack",pageViewSuffix:u="page_view",pageViewEventProperties:R={}}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{isUserConnected:t,isRegistered:s,userConnectionData:i}=(0,m.Z)(),{login:d,ID:_}=((y=i.currentUser)==null?void 0:y.wpcomUser)||{},{tracks:U}=E.Z,{recordEvent:a}=U,p=(0,c.useCallback)(async(O,I)=>{a(O,I)},[a]),A=(0,c.useCallback)(function(O,I){let N=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>{};return N=typeof I=="function"?I:N,I=typeof I=="function"?{}:I,()=>p(O,I).then(N)},[p]);(0,c.useEffect)(()=>{t&&_&&d&&E.Z.initialize(_,d)},[t,_,d]);const w=r?`${S}_${r}_${u}`:null;return(0,c.useEffect)(()=>{s&&w&&a(w,R)},[]),{recordEvent:p,recordEventHandler:A}}},"../../plugins/protect/src/js/hooks/use-protect-data/index.js":(P,T,o)=>{o.d(T,{Z:()=>f});var E=o("../../../node_modules/.pnpm/@wordpress+data@9.7.0_react@18.2.0/node_modules/@wordpress/data/build-module/components/use-select/index.js"),m=o("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),c=o("../../plugins/protect/src/js/state/store.js");function f(){const{statusIsFetching:l,status:r,jetpackScan:S,hasRequiredPlan:u}=(0,E.Z)(a=>({statusIsFetching:a(c.t).getStatusIsFetching(),status:a(c.t).getStatus(),jetpackScan:a(c.t).getJetpackScan(),hasRequiredPlan:a(c.t).hasRequiredPlan()}));let R="error";l===!0?R="loading":r.status&&(R=r.status);const t=(0,m.useMemo)(()=>{var a,p;return((p=(a=r.core)==null?void 0:a.threats)==null?void 0:p.length)||0},[r.core]),s=(0,m.useMemo)(()=>(r.plugins||[]).reduce((a,p)=>a+p.threats.length,0),[r.plugins]),i=(0,m.useMemo)(()=>(r.themes||[]).reduce((a,p)=>a+p.threats.length,0),[r.themes]),d=(0,m.useMemo)(()=>{var a;return((a=r.files)==null?void 0:a.length)||0},[r.files]),_=(0,m.useMemo)(()=>{var a;return((a=r.database)==null?void 0:a.length)||0},[r.database]);return{numThreats:t+s+i+d+_,numCoreThreats:t,numPluginsThreats:s,numThemesThreats:i,numFilesThreats:d,numDatabaseThreats:_,lastChecked:r.lastChecked||null,errorCode:r.errorCode||null,errorMessage:r.errorMessage||null,core:r.core||{},plugins:r.plugins||[],themes:r.themes||[],files:{threats:r.files||[]},database:{threats:r.database||[]},currentStatus:R,hasUncheckedItems:r.hasUncheckedItems,jetpackScan:S,hasRequiredPlan:u}}}}]);})();
