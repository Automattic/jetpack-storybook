(()=>{(self.webpackChunk_automattic_jetpack_storybook=self.webpackChunk_automattic_jetpack_storybook||[]).push([[8404],{"../../../node_modules/.pnpm/@wordpress+compose@7.8.3_react@18.3.1/node_modules/@wordpress/compose/build-module/hooks/use-focusable-iframe/index.js":(Vt,St,H)=>{"use strict";H.d(St,{A:()=>it});var et=H("../../../node_modules/.pnpm/@wordpress+compose@7.8.3_react@18.3.1/node_modules/@wordpress/compose/build-module/hooks/use-ref-effect/index.js");function it(){return(0,et.A)(Z=>{const{ownerDocument:x}=Z;if(!x)return;const{defaultView:C}=x;if(!C)return;function m(){x&&x.activeElement===Z&&Z.focus()}return C.addEventListener("blur",m),()=>{C.removeEventListener("blur",m)}},[])}},"../../../node_modules/.pnpm/@wordpress+element@6.8.1/node_modules/@wordpress/element/build-module/create-interpolate-element.js":(Vt,St,H)=>{"use strict";H.d(St,{A:()=>k});var et=H("../../../node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");let it,Z,x,C;const m=/<(\/)?(\w+)\s*(\/)?>/g;function h(_,I,a,E,g){return{element:_,tokenStart:I,tokenLength:a,prevOffset:E,leadingTextStart:g,children:[]}}const O=(_,I)=>{if(it=_,Z=0,x=[],C=[],m.lastIndex=0,!M(I))throw new TypeError("The conversionMap provided is not valid. It must be an object with values that are React Elements");do;while(u(I));return(0,et.createElement)(et.Fragment,null,...x)},M=_=>{const I=typeof _=="object",a=I&&Object.values(_);return I&&a.length&&a.every(E=>(0,et.isValidElement)(E))};function u(_){const I=y(),[a,E,g,T]=I,w=C.length,A=g>Z?Z:null;if(!_[E])return p(),!1;switch(a){case"no-more-tokens":if(w!==0){const{leadingTextStart:Q,tokenStart:lt}=C.pop();x.push(it.substr(Q,lt))}return p(),!1;case"self-closed":return w===0?(A!==null&&x.push(it.substr(A,g-A)),x.push(_[E]),Z=g+T,!0):(d(h(_[E],g,T)),Z=g+T,!0);case"opener":return C.push(h(_[E],g,T,g+T,A)),Z=g+T,!0;case"closer":if(w===1)return j(g),Z=g+T,!0;const z=C.pop(),L=it.substr(z.prevOffset,g-z.prevOffset);z.children.push(L),z.prevOffset=g+T;const P=h(z.element,z.tokenStart,z.tokenLength,g+T);return P.children=z.children,d(P),Z=g+T,!0;default:return p(),!1}}function y(){const _=m.exec(it);if(_===null)return["no-more-tokens"];const I=_.index,[a,E,g,T]=_,w=a.length;return T?["self-closed",g,I,w]:E?["closer",g,I,w]:["opener",g,I,w]}function p(){const _=it.length-Z;_!==0&&x.push(it.substr(Z,_))}function d(_){const{element:I,tokenStart:a,tokenLength:E,prevOffset:g,children:T}=_,w=C[C.length-1],A=it.substr(w.prevOffset,a-w.prevOffset);A&&w.children.push(A),w.children.push((0,et.cloneElement)(I,null,...T)),w.prevOffset=g||a+E}function j(_){const{element:I,leadingTextStart:a,prevOffset:E,tokenStart:g,children:T}=C.pop(),w=_?it.substr(E,_-E):it.substr(E);w&&T.push(w),a!==null&&x.push(it.substr(a,g-a)),x.push((0,et.cloneElement)(I,null,...T))}const k=O},"../../../node_modules/.pnpm/@wordpress+sync@1.9.0/node_modules/@wordpress/sync/build-module/connect-indexdb.js":(Vt,St,H)=>{"use strict";H.d(St,{d:()=>qt});var et=H("../../../node_modules/.pnpm/yjs@13.6.19/node_modules/yjs/dist/yjs.mjs"),it=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/promise.js"),Z=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/error.js");const x=ut=>it.vt((st,dt)=>{ut.onerror=mt=>dt(new Error(mt.target.error)),ut.onsuccess=mt=>st(mt.target.result)}),C=(ut,st)=>it.vt((dt,mt)=>{const Tt=indexedDB.open(ut);Tt.onupgradeneeded=Dt=>st(Dt.target.result),Tt.onerror=Dt=>mt(Z.vt(Dt.target.error)),Tt.onsuccess=Dt=>{const Ht=Dt.target.result;Ht.onversionchange=()=>{Ht.close()},dt(Ht)}}),m=ut=>x(indexedDB.deleteDatabase(ut)),h=(ut,st)=>st.forEach(dt=>ut.createObjectStore.apply(ut,dt)),O=(ut,st,dt="readwrite")=>{const mt=ut.transaction(st,dt);return st.map(Tt=>z(mt,Tt))},M=(ut,st)=>x(ut.count(st)),u=(ut,st)=>x(ut.get(st)),y=(ut,st)=>x(ut.delete(st)),p=(ut,st,dt)=>x(ut.put(st,dt)),d=(ut,st,dt)=>x(ut.add(st,dt)),j=(ut,st)=>x(ut.add(st)),k=(ut,st,dt)=>x(ut.getAll(st,dt)),_=(ut,st,dt)=>x(ut.getAllKeys(st,dt)),I=(ut,st,dt)=>{let mt=null;return A(ut,st,Tt=>(mt=Tt,!1),dt).then(()=>mt)},a=(ut,st=null)=>I(ut,st,"prev"),E=(ut,st=null)=>I(ut,st,"next"),g=(ut,st,dt)=>promise.all([_(ut,st,dt),k(ut,st,dt)]).then(([mt,Tt])=>mt.map((Dt,Ht)=>({k:Dt,v:Tt[Ht]}))),T=(ut,st)=>it.vt((dt,mt)=>{ut.onerror=mt,ut.onsuccess=async Tt=>{const Dt=Tt.target.result;if(Dt===null||await st(Dt)===!1)return dt();Dt.continue()}}),w=(ut,st,dt,mt="next")=>T(ut.openCursor(st,mt),Tt=>dt(Tt.value,Tt.key)),A=(ut,st,dt,mt="next")=>T(ut.openKeyCursor(st,mt),Tt=>dt(Tt.key)),z=(ut,st)=>ut.objectStore(st),L=(ut,st,dt,mt)=>IDBKeyRange.bound(ut,st,dt,mt),P=(ut,st)=>IDBKeyRange.upperBound(ut,st),Q=(ut,st)=>IDBKeyRange.lowerBound(ut,st);var lt=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/observable.js");const wt="custom",Ct="updates",kt=500,Nt=(ut,st=()=>{},dt=()=>{})=>{const[mt]=O(ut.db,[Ct]);return k(mt,Q(ut._dbref,!1)).then(Tt=>{ut._destroyed||(st(mt),et.hL(ut.doc,()=>{Tt.forEach(Dt=>et.QE(ut.doc,Dt))},ut,!1),dt(mt))}).then(()=>a(mt).then(Tt=>{ut._dbref=Tt+1})).then(()=>M(mt).then(Tt=>{ut._dbsize=Tt})).then(()=>mt)},xt=(ut,st=!0)=>Nt(ut).then(dt=>{(st||ut._dbsize>=kt)&&j(dt,et.PR(ut.doc)).then(()=>y(dt,P(ut._dbref,!0))).then(()=>M(dt).then(mt=>{ut._dbsize=mt}))}),_t=ut=>idb.deleteDB(ut);class ee extends lt.c{constructor(st,dt){super(),this.doc=dt,this.name=st,this._dbref=0,this._dbsize=0,this._destroyed=!1,this.db=null,this.synced=!1,this._db=C(st,mt=>h(mt,[["updates",{autoIncrement:!0}],["custom"]])),this.whenSynced=it.vt(mt=>this.on("synced",()=>mt(this))),this._db.then(mt=>{this.db=mt,Nt(this,Ht=>j(Ht,et.PR(dt)),()=>{if(this._destroyed)return this;this.synced=!0,this.emit("synced",[this])})}),this._storeTimeout=1e3,this._storeTimeoutId=null,this._storeUpdate=(mt,Tt)=>{if(this.db&&Tt!==this){const[Dt]=O(this.db,[Ct]);j(Dt,mt),++this._dbsize>=kt&&(this._storeTimeoutId!==null&&clearTimeout(this._storeTimeoutId),this._storeTimeoutId=setTimeout(()=>{xt(this,!1),this._storeTimeoutId=null},this._storeTimeout))}},dt.on("update",this._storeUpdate),this.destroy=this.destroy.bind(this),dt.on("destroy",this.destroy)}destroy(){return this._storeTimeoutId&&clearTimeout(this._storeTimeoutId),this.doc.off("update",this._storeUpdate),this.doc.off("destroy",this.destroy),this._destroyed=!0,this._db.then(st=>{st.close()})}clearData(){return this.destroy().then(()=>{m(this.name)})}get(st){return this._db.then(dt=>{const[mt]=O(dt,[wt],"readonly");return u(mt,st)})}set(st,dt){return this._db.then(mt=>{const[Tt]=O(mt,[wt]);return p(Tt,dt,st)})}del(st){return this._db.then(dt=>{const[mt]=O(dt,[wt]);return y(mt,st)})}}function qt(ut,st,dt){const mt=`${st}-${ut}`,Tt=new ee(mt,dt);return new Promise(Dt=>{Tt.on("synced",()=>{Dt(()=>Tt.destroy())})})}},"../../../node_modules/.pnpm/@wordpress+sync@1.9.0/node_modules/@wordpress/sync/build-module/create-webrtc-connection.js":(Vt,St,H)=>{"use strict";H.d(St,{q:()=>tn});var et=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/observable.js"),it=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/time.js"),Z=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/math.js");const x=1200,C=2500,m=3e4,h=N=>{if(N.shouldConnect&&N.ws===null){const K=new WebSocket(N.url),$=N.binaryType;let ct=null;$&&(K.binaryType=$),N.ws=K,N.connecting=!0,N.connected=!1,K.onmessage=ft=>{N.lastMessageReceived=it._g();const At=ft.data,It=typeof At=="string"?JSON.parse(At):At;It&&It.type==="pong"&&(clearTimeout(ct),ct=setTimeout(Et,m/2)),N.emit("message",[It,N])};const rt=ft=>{N.ws!==null&&(N.ws=null,N.connecting=!1,N.connected?(N.connected=!1,N.emit("disconnect",[{type:"disconnect",error:ft},N])):N.unsuccessfulReconnects++,setTimeout(h,Z.jk(Z.YL(N.unsuccessfulReconnects+1)*x,C),N)),clearTimeout(ct)},Et=()=>{N.ws===K&&N.send({type:"ping"})};K.onclose=()=>rt(null),K.onerror=ft=>rt(ft),K.onopen=()=>{N.lastMessageReceived=it._g(),N.connecting=!1,N.connected=!0,N.unsuccessfulReconnects=0,N.emit("connect",[{type:"connect"},N]),ct=setTimeout(Et,m/2)}}};class O extends et.c{constructor(K,{binaryType:$}={}){super(),this.url=K,this.ws=null,this.binaryType=$||null,this.connected=!1,this.connecting=!1,this.unsuccessfulReconnects=0,this.lastMessageReceived=0,this.shouldConnect=!0,this._checkInterval=setInterval(()=>{this.connected&&m<it._g()-this.lastMessageReceived&&this.ws.close()},m/2),h(this)}send(K){this.ws&&this.ws.send(JSON.stringify(K))}destroy(){clearInterval(this._checkInterval),this.disconnect(),super.destroy()}disconnect(){this.shouldConnect=!1,this.ws!==null&&this.ws.close()}connect(){this.shouldConnect=!0,!this.connected&&this.ws===null&&h(this)}}var M=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/map.js"),u=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/error.js"),y=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/random.js"),p=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/encoding.js"),d=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/decoding.js"),j=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/logging.js"),k=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/logging.common.js"),_=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/promise.js"),I=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/set.js"),a=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/buffer.js"),E=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/storage.js");const g=new Map;class T{constructor(K){this.room=K,this.onmessage=null,this._onChange=$=>$.key===K&&this.onmessage!==null&&this.onmessage({data:a.Ey($.newValue||"")}),E.k9(this._onChange)}postMessage(K){E.JT.setItem(this.room,a.nk(a.zS(K)))}close(){E.o6(this._onChange)}}const w=typeof BroadcastChannel=="undefined"?T:BroadcastChannel,A=N=>M._4(g,N,()=>{const K=I.vt(),$=new w(N);return $.onmessage=ct=>K.forEach(rt=>rt(ct.data,"broadcastchannel")),{bc:$,subs:K}}),z=(N,K)=>(A(N).subs.add(K),K),L=(N,K)=>{const $=A(N),ct=$.subs.delete(K);return ct&&$.subs.size===0&&($.bc.close(),g.delete(N)),ct},P=(N,K,$=null)=>{const ct=A(N);ct.bc.postMessage(K),ct.subs.forEach(rt=>rt(K,$))},Q=()=>{let N=!0;return(K,$)=>{if(N){N=!1;try{K()}finally{N=!0}}else $!==void 0&&$()}};var lt=H("../../../node_modules/.pnpm/simple-peer@9.11.1/node_modules/simple-peer/simplepeer.min.js"),wt=H.n(lt),Ct=H("../../../node_modules/.pnpm/yjs@13.6.19/node_modules/yjs/dist/yjs.mjs");const kt=0,Nt=1,xt=2,_t=(N,K)=>{p.zd(N,kt);const $=Ct.FX(K);p.Gu(N,$)},ee=(N,K,$)=>{p.zd(N,Nt),p.Gu(N,Ct.PR(K,$))},qt=(N,K,$)=>ee(K,$,d.bo(N)),ut=(N,K,$)=>{try{Ct.QE(K,d.bo(N),$)}catch(ct){console.error("Caught error while handling a Yjs update",ct)}},st=(N,K)=>{p.zd(N,xt),p.Gu(N,K)},dt=ut,mt=(N,K,$,ct)=>{const rt=d.cw(N);switch(rt){case kt:qt(N,K,$);break;case Nt:ut(N,$,ct);break;case xt:dt(N,$,ct);break;default:throw new Error("Unknown message type")}return rt};var Tt=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/function.js");const Dt=3e4;class Ht extends et.c{constructor(K){super(),this.doc=K,this.clientID=K.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{const $=it._g();this.getLocalState()!==null&&Dt/2<=$-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const ct=[];this.meta.forEach((rt,Et)=>{Et!==this.clientID&&Dt<=$-rt.lastUpdated&&this.states.has(Et)&&ct.push(Et)}),ct.length>0&&Qt(this,ct,"timeout")},Z.RI(Dt/10)),K.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(K){const $=this.clientID,ct=this.meta.get($),rt=ct===void 0?0:ct.clock+1,Et=this.states.get($);K===null?this.states.delete($):this.states.set($,K),this.meta.set($,{clock:rt,lastUpdated:it._g()});const ft=[],At=[],It=[],Pt=[];K===null?Pt.push($):Et==null?K!=null&&ft.push($):(At.push($),Tt.vo(Et,K)||It.push($)),(ft.length>0||It.length>0||Pt.length>0)&&this.emit("change",[{added:ft,updated:It,removed:Pt},"local"]),this.emit("update",[{added:ft,updated:At,removed:Pt},"local"])}setLocalStateField(K,$){const ct=this.getLocalState();ct!==null&&this.setLocalState({...ct,[K]:$})}getStates(){return this.states}}const Qt=(N,K,$)=>{const ct=[];for(let rt=0;rt<K.length;rt++){const Et=K[rt];if(N.states.has(Et)){if(N.states.delete(Et),Et===N.clientID){const ft=N.meta.get(Et);N.meta.set(Et,{clock:ft.clock+1,lastUpdated:it._g()})}ct.push(Et)}}ct.length>0&&(N.emit("change",[{added:[],updated:[],removed:ct},$]),N.emit("update",[{added:[],updated:[],removed:ct},$]))},Kt=(N,K,$=N.states)=>{const ct=K.length,rt=p.xv();p.zd(rt,ct);for(let Et=0;Et<ct;Et++){const ft=K[Et],At=$.get(ft)||null,It=N.meta.get(ft).clock;p.zd(rt,ft),p.zd(rt,It),p.Qj(rt,JSON.stringify(At))}return p.Fo(rt)},Jt=(N,K)=>{const $=decoding.createDecoder(N),ct=encoding.createEncoder(),rt=decoding.readVarUint($);encoding.writeVarUint(ct,rt);for(let Et=0;Et<rt;Et++){const ft=decoding.readVarUint($),At=decoding.readVarUint($),It=JSON.parse(decoding.readVarString($)),Pt=K(It);encoding.writeVarUint(ct,ft),encoding.writeVarUint(ct,At),encoding.writeVarString(ct,JSON.stringify(Pt))}return encoding.toUint8Array(ct)},G=(N,K,$)=>{const ct=d.$C(K),rt=it._g(),Et=[],ft=[],At=[],It=[],Pt=d.cw(ct);for(let Bt=0;Bt<Pt;Bt++){const te=d.cw(ct);let oe=d.cw(ct);const ge=JSON.parse(d.t3(ct)),Se=N.meta.get(te),bn=N.states.get(te),en=Se===void 0?0:Se.clock;(en<oe||en===oe&&ge===null&&N.states.has(te))&&(ge===null?te===N.clientID&&N.getLocalState()!=null?oe++:N.states.delete(te):N.states.set(te,ge),N.meta.set(te,{clock:oe,lastUpdated:rt}),Se===void 0&&ge!==null?Et.push(te):Se!==void 0&&ge===null?It.push(te):ge!==null&&(Tt.vo(ge,bn)||At.push(te),ft.push(te)))}(Et.length>0||At.length>0||It.length>0)&&N.emit("change",[{added:Et,updated:At,removed:It},$]),(Et.length>0||ft.length>0||It.length>0)&&N.emit("update",[{added:Et,updated:ft,removed:It},$])};var nt=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/string.js");const vt=(N,K)=>{const $=nt.Af(N).buffer,ct=nt.Af(K).buffer;return crypto.subtle.importKey("raw",$,"PBKDF2",!1,["deriveKey"]).then(rt=>crypto.subtle.deriveKey({name:"PBKDF2",salt:ct,iterations:1e5,hash:"SHA-256"},rt,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]))},V=(N,K)=>{if(!K)return _.hd(N);const $=crypto.getRandomValues(new Uint8Array(12));return crypto.subtle.encrypt({name:"AES-GCM",iv:$},K,N).then(ct=>{const rt=p.xv();return p.Qj(rt,"AES-GCM"),p.Gu(rt,$),p.Gu(rt,new Uint8Array(ct)),p.Fo(rt)})},v=(N,K)=>{const $=p.xv();return p.IO($,N),V(p.Fo($),K)},D=(N,K)=>{if(!K)return _.hd(N);const $=d.$C(N);d.t3($)!=="AES-GCM"&&_.ku(u.vt("Unknown encryption algorithm"));const rt=d.bo($),Et=d.bo($);return crypto.subtle.decrypt({name:"AES-GCM",iv:rt},K,Et).then(ft=>new Uint8Array(ft))},tt=(N,K)=>D(N,K).then($=>d.Jg(d.$C(new Uint8Array($))));var pt=H("../../../node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js");const n=j.Xv("y-webrtc"),s=0,l=3,R=1,Y=4,J=new Map,at=new Map,Rt=N=>{let K=!0;N.webrtcConns.forEach($=>{$.synced||(K=!1)}),(!K&&N.synced||K&&!N.synced)&&(N.synced=K,N.provider.emit("synced",[{synced:K}]),n("synced ",k.Y,N.name,k.Ny," with all peers"))},zt=(N,K,$)=>{const ct=d.$C(K),rt=p.xv(),Et=d.cw(ct);if(N===void 0)return null;const ft=N.awareness,At=N.doc;let It=!1;switch(Et){case s:{p.zd(rt,s);const Pt=mt(ct,rt,At,N);Pt===Nt&&!N.synced&&$(),Pt===kt&&(It=!0);break}case l:p.zd(rt,R),p.Gu(rt,Kt(ft,Array.from(ft.getStates().keys()))),It=!0;break;case R:G(ft,d.bo(ct),N);break;case Y:{const Pt=d.xh(ct)===1,Bt=d.t3(ct);if(Bt!==N.peerId&&(N.bcConns.has(Bt)&&!Pt||!N.bcConns.has(Bt)&&Pt)){const te=[],oe=[];Pt?(N.bcConns.add(Bt),oe.push(Bt)):(N.bcConns.delete(Bt),te.push(Bt)),N.provider.emit("peers",[{added:oe,removed:te,webrtcPeers:Array.from(N.webrtcConns.keys()),bcPeers:Array.from(N.bcConns)}]),Mt(N)}break}default:return console.error("Unable to compute message"),rt}return It?rt:null},Ut=(N,K)=>{const $=N.room;return n("received message from ",k.Y,N.remotePeerId,k.Qu," (",$.name,")",k.Ny,k.Tx),zt($,K,()=>{N.synced=!0,n("synced ",k.Y,$.name,k.Ny," with ",k.Y,N.remotePeerId),Rt($)})},Lt=(N,K)=>{n("send message to ",k.Y,N.remotePeerId,k.Ny,k.Qu," (",N.room.name,")",k.Tx);try{N.peer.send(p.Fo(K))}catch($){}},jt=(N,K)=>{n("broadcast message in ",k.Y,N.name,k.Ny),N.webrtcConns.forEach($=>{try{$.peer.send(K)}catch(ct){}})};class ie{constructor(K,$,ct,rt){n("establishing connection to ",k.Y,ct),this.room=rt,this.remotePeerId=ct,this.glareToken=void 0,this.closed=!1,this.connected=!1,this.synced=!1,this.peer=new(wt())({initiator:$,...rt.provider.peerOpts}),this.peer.on("signal",Et=>{this.glareToken===void 0&&(this.glareToken=Date.now()+Math.random()),ne(K,rt,{to:ct,from:rt.peerId,type:"signal",token:this.glareToken,signal:Et})}),this.peer.on("connect",()=>{n("connected to ",k.Y,ct),this.connected=!0;const ft=rt.provider.doc,At=rt.awareness,It=p.xv();p.zd(It,s),_t(It,ft),Lt(this,It);const Pt=At.getStates();if(Pt.size>0){const Bt=p.xv();p.zd(Bt,R),p.Gu(Bt,Kt(At,Array.from(Pt.keys()))),Lt(this,Bt)}}),this.peer.on("close",()=>{this.connected=!1,this.closed=!0,rt.webrtcConns.has(this.remotePeerId)&&(rt.webrtcConns.delete(this.remotePeerId),rt.provider.emit("peers",[{removed:[this.remotePeerId],added:[],webrtcPeers:Array.from(rt.webrtcConns.keys()),bcPeers:Array.from(rt.bcConns)}])),Rt(rt),this.peer.destroy(),n("closed connection to ",k.Y,ct),bt(rt)}),this.peer.on("error",Et=>{n("Error in connection to ",k.Y,ct,": ",Et),bt(rt)}),this.peer.on("data",Et=>{const ft=Ut(this,Et);ft!==null&&Lt(this,ft)})}destroy(){this.peer.destroy()}}const q=(N,K)=>V(K,N.key).then($=>N.mux(()=>P(N.name,$))),ot=(N,K)=>{N.bcconnected&&q(N,K),jt(N,K)},bt=N=>{J.forEach(K=>{K.connected&&(K.send({type:"subscribe",topics:[N.name]}),N.webrtcConns.size<N.provider.maxConns&&ne(K,N,{type:"announce",from:N.peerId}))})},Mt=N=>{if(N.provider.filterBcConns){const K=p.xv();p.zd(K,Y),p.QJ(K,1),p.Qj(K,N.peerId),q(N,p.Fo(K))}};class yt{constructor(K,$,ct,rt){this.peerId=y.gZ(),this.doc=K,this.awareness=$.awareness,this.provider=$,this.synced=!1,this.name=ct,this.key=rt,this.webrtcConns=new Map,this.bcConns=new Set,this.mux=Q(),this.bcconnected=!1,this._bcSubscriber=Et=>D(new Uint8Array(Et),rt).then(ft=>this.mux(()=>{const At=zt(this,ft,()=>{});At&&q(this,p.Fo(At))})),this._docUpdateHandler=(Et,ft)=>{const At=p.xv();p.zd(At,s),st(At,Et),ot(this,p.Fo(At))},this._awarenessUpdateHandler=({added:Et,updated:ft,removed:At},It)=>{const Pt=Et.concat(ft).concat(At),Bt=p.xv();p.zd(Bt,R),p.Gu(Bt,Kt(this.awareness,Pt)),ot(this,p.Fo(Bt))},this._beforeUnloadHandler=()=>{Qt(this.awareness,[K.clientID],"window unload"),at.forEach(Et=>{Et.disconnect()})},typeof window!="undefined"?window.addEventListener("beforeunload",this._beforeUnloadHandler):typeof pt!="undefined"&&pt.on("exit",this._beforeUnloadHandler)}connect(){this.doc.on("update",this._docUpdateHandler),this.awareness.on("update",this._awarenessUpdateHandler),bt(this);const K=this.name;z(K,this._bcSubscriber),this.bcconnected=!0,Mt(this);const $=p.xv();p.zd($,s),_t($,this.doc),q(this,p.Fo($));const ct=p.xv();p.zd(ct,s),ee(ct,this.doc),q(this,p.Fo(ct));const rt=p.xv();p.zd(rt,l),q(this,p.Fo(rt));const Et=p.xv();p.zd(Et,R),p.Gu(Et,Kt(this.awareness,[this.doc.clientID])),q(this,p.Fo(Et))}disconnect(){J.forEach($=>{$.connected&&$.send({type:"unsubscribe",topics:[this.name]})}),Qt(this.awareness,[this.doc.clientID],"disconnect");const K=p.xv();p.zd(K,Y),p.QJ(K,0),p.Qj(K,this.peerId),q(this,p.Fo(K)),L(this.name,this._bcSubscriber),this.bcconnected=!1,this.doc.off("update",this._docUpdateHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.webrtcConns.forEach($=>$.destroy())}destroy(){this.disconnect(),typeof window!="undefined"?window.removeEventListener("beforeunload",this._beforeUnloadHandler):typeof pt!="undefined"&&pt.off("exit",this._beforeUnloadHandler)}}const Xt=(N,K,$,ct)=>{if(at.has($))throw u.vt(`A Yjs Doc connected to room "${$}" already exists!`);const rt=new yt(N,K,$,ct);return at.set($,rt),rt},ne=(N,K,$)=>{K.key?v($,K.key).then(ct=>{N.send({type:"publish",topic:K.name,data:a.nk(ct)})}):N.send({type:"publish",topic:K.name,data:$})};class se extends O{constructor(K){super(K),this.providers=new Set,this.on("connect",()=>{n(`connected (${K})`);const $=Array.from(at.keys());this.send({type:"subscribe",topics:$}),at.forEach(ct=>ne(this,ct,{type:"announce",from:ct.peerId}))}),this.on("message",$=>{switch($.type){case"publish":{const ct=$.topic,rt=at.get(ct);if(rt==null||typeof ct!="string")return;const Et=ft=>{const At=rt.webrtcConns,It=rt.peerId;if(ft==null||ft.from===It||ft.to!==void 0&&ft.to!==It||rt.bcConns.has(ft.from))return;const Pt=At.has(ft.from)?()=>{}:()=>rt.provider.emit("peers",[{removed:[],added:[ft.from],webrtcPeers:Array.from(rt.webrtcConns.keys()),bcPeers:Array.from(rt.bcConns)}]);switch(ft.type){case"announce":At.size<rt.provider.maxConns&&(M._4(At,ft.from,()=>new ie(this,!0,ft.from,rt)),Pt());break;case"signal":if(ft.signal.type==="offer"){const Bt=At.get(ft.from);if(Bt){const te=ft.token,oe=Bt.glareToken;if(oe&&oe>te){n("offer rejected: ",ft.from);return}Bt.glareToken=void 0}}if(ft.signal.type==="answer"){n("offer answered by: ",ft.from);const Bt=At.get(ft.from);Bt.glareToken=void 0}ft.to===It&&(M._4(At,ft.from,()=>new ie(this,!1,ft.from,rt)).peer.signal(ft.signal),Pt());break}};rt.key?typeof $.data=="string"&&tt(a.Ey($.data),rt.key).then(Et):Et($.data)}}}),this.on("disconnect",()=>n(`disconnect (${K})`))}}class de extends et.c{constructor(K,$,{signaling:ct=["wss://y-webrtc-eu.fly.dev"],password:rt=null,awareness:Et=new Ht($),maxConns:ft=20+Z.RI(y._9()*15),filterBcConns:At=!0,peerOpts:It={}}={}){super(),this.roomName=K,this.doc=$,this.filterBcConns=At,this.awareness=Et,this.shouldConnect=!1,this.signalingUrls=ct,this.signalingConns=[],this.maxConns=ft,this.peerOpts=It,this.key=rt?vt(rt,K):_.hd(null),this.room=null,this.key.then(Pt=>{this.room=Xt($,this,K,Pt),this.shouldConnect?this.room.connect():this.room.disconnect()}),this.connect(),this.destroy=this.destroy.bind(this),$.on("destroy",this.destroy)}get connected(){return this.room!==null&&this.shouldConnect}connect(){this.shouldConnect=!0,this.signalingUrls.forEach(K=>{const $=M._4(J,K,()=>new se(K));this.signalingConns.push($),$.providers.add(this)}),this.room&&this.room.connect()}disconnect(){this.shouldConnect=!1,this.signalingConns.forEach(K=>{K.providers.delete(this),K.providers.size===0&&(K.destroy(),J.delete(K.url))}),this.room&&this.room.disconnect()}destroy(){this.doc.off("destroy",this.destroy),this.key.then(()=>{this.room.destroy(),at.delete(this.roomName)}),super.destroy()}}var Ue=H("../../../node_modules/.pnpm/@wordpress+url@4.9.0/node_modules/@wordpress/url/build-module/add-query-args.js");function mn(N,K){N.on("connect",()=>{n(`connected (${K})`);const $=Array.from(at.keys());N.send({type:"subscribe",topics:$}),at.forEach(ct=>ne(N,ct,{type:"announce",from:ct.peerId}))}),N.on("message",$=>{switch($.type){case"publish":{const ct=$.topic,rt=at.get(ct);if(rt===null||typeof ct!="string"||rt===void 0)return;const Et=ft=>{const At=rt.webrtcConns,It=rt.peerId;if(ft===null||ft.from===It||ft.to!==void 0&&ft.to!==It||rt.bcConns.has(ft.from))return;const Pt=At.has(ft.from)?()=>{}:()=>rt.provider.emit("peers",[{removed:[],added:[ft.from],webrtcPeers:Array.from(rt.webrtcConns.keys()),bcPeers:Array.from(rt.bcConns)}]);switch(ft.type){case"announce":At.size<rt.provider.maxConns&&(M._4(At,ft.from,()=>new ie(N,!0,ft.from,rt)),Pt());break;case"signal":if(ft.signal.type==="offer"){const Bt=At.get(ft.from);if(Bt){const te=ft.token,oe=Bt.glareToken;if(oe&&oe>te){n("offer rejected: ",ft.from);return}Bt.glareToken=void 0}}if(ft.signal.type==="answer"){n("offer answered by: ",ft.from);const Bt=At.get(ft.from);Bt&&(Bt.glareToken=void 0)}ft.to===It&&(M._4(At,ft.from,()=>new ie(N,!1,ft.from,rt)).peer.signal(ft.signal),Pt());break}};rt.key?typeof $.data=="string"&&tt(a.Ey($.data),rt.key).then(Et):Et($.data)}}}),N.on("disconnect",()=>n(`disconnect (${K})`))}function Re(N){if(N.shouldConnect&&N.ws===null){const K=Math.floor(1e5+Math.random()*9e5),$=N.url,ct=new window.EventSource((0,Ue.F)($,{subscriber_id:K,action:"gutenberg_signaling_server"}));let rt=null;ct.onmessage=It=>{N.lastMessageReceived=Date.now();const Pt=It.data;if(Pt){const Bt=JSON.parse(Pt);Array.isArray(Bt)&&Bt.forEach(Et)}},N.ws=ct,N.connecting=!0,N.connected=!1;const Et=It=>{It&&It.type==="pong"&&(clearTimeout(rt),rt=setTimeout(At,Me/2)),N.emit("message",[It,N])},ft=It=>{N.ws!==null&&(N.ws.close(),N.ws=null,N.connecting=!1,N.connected?(N.connected=!1,N.emit("disconnect",[{type:"disconnect",error:It},N])):N.unsuccessfulReconnects++),clearTimeout(rt)},At=()=>{N.ws&&N.ws.readyState===window.EventSource.OPEN&&N.send({type:"ping"})};N.ws&&(N.ws.onclose=()=>{ft(null)},N.ws.send=function(Pt){window.fetch($,{body:new URLSearchParams({subscriber_id:K.toString(),action:"gutenberg_signaling_server",message:Pt}),method:"POST"}).catch(()=>{n("Error sending to server with message: "+Pt)})}),ct.onerror=()=>{},ct.onopen=()=>{N.connected||ct.readyState===window.EventSource.OPEN&&(N.lastMessageReceived=Date.now(),N.connecting=!1,N.connected=!0,N.unsuccessfulReconnects=0,N.emit("connect",[{type:"connect"},N]),rt=setTimeout(At,Me/2))}}}const Me=3e4;class yn extends et.c{constructor(K){super(),this.url=K,this.ws=null,this.binaryType=null,this.connected=!1,this.connecting=!1,this.unsuccessfulReconnects=0,this.lastMessageReceived=0,this.shouldConnect=!0,this._checkInterval=setInterval(()=>{this.connected&&Me<Date.now()-this.lastMessageReceived&&this.ws&&this.ws.close()},Me/2),Re(this),this.providers=new Set,mn(this,K)}send(K){this.ws&&this.ws.send(JSON.stringify(K))}destroy(){clearInterval(this._checkInterval),this.disconnect(),super.destroy()}disconnect(){this.shouldConnect=!1,this.ws!==null&&this.ws.close()}connect(){this.shouldConnect=!0,!this.connected&&this.ws===null&&Re(this)}}class Ze extends de{connect(){this.shouldConnect=!0,this.signalingUrls.forEach(K=>{const $=M._4(J,K,K.startsWith("ws://")||K.startsWith("wss://")?()=>new se(K):()=>new yn(K));this.signalingConns.push($),$.providers.add(this)}),this.room&&this.room.connect()}}function tn({signaling:N,password:K}){return function($,ct,rt){const Et=`${ct}-${$}`;return new Ze(Et,rt,{signaling:N,password:K}),Promise.resolve(()=>!0)}}},"../../../node_modules/.pnpm/@wordpress+sync@1.9.0/node_modules/@wordpress/sync/build-module/provider.js":(Vt,St,H)=>{"use strict";H.d(St,{f:()=>it});var et=H("../../../node_modules/.pnpm/yjs@13.6.19/node_modules/yjs/dist/yjs.mjs");const it=(Z,x)=>{const C={},m={},h={};function O(p,d){C[p]=d}async function M(p,d,j){const k=new et.JA;h[p]=h[p]||{},h[p][d]=k;const _=()=>{const E=C[p].fromCRDTDoc(k);j(E)};k.on("update",_);const I=await Z(d,p,k);x&&await x(d,p,k);const a=C[p].fetch;a&&a(d).then(E=>{k.transact(()=>{C[p].applyChangesToDoc(k,E)})}),m[p]=m[p]||{},m[p][d]=()=>{I(),k.off("update",_)}}async function u(p,d,j){const k=h[p][d];if(!k)throw"Error doc "+p+" "+d+" not found";k.transact(()=>{C[p].applyChangesToDoc(k,j)})}async function y(p,d){var j;(j=m==null?void 0:m[p])!=null&&j[d]&&m[p][d]()}return{register:O,bootstrap:M,update:u,discard:y}}},"../../../node_modules/.pnpm/@wordpress+undo-manager@1.9.0/node_modules/@wordpress/undo-manager/build-module/index.js":(Vt,St,H)=>{"use strict";H.d(St,{u:()=>x});var et=H("../../../node_modules/.pnpm/@wordpress+is-shallow-equal@5.9.0/node_modules/@wordpress/is-shallow-equal/build-module/index.js");function it(C,m){const h={...C};return Object.entries(m).forEach(([O,M])=>{h[O]?h[O]={...h[O],to:M.to}:h[O]=M}),h}const Z=(C,m)=>{const h=C==null?void 0:C.findIndex(({id:M})=>typeof M=="string"?M===m.id:(0,et.Ay)(M,m.id)),O=[...C];return h!==-1?O[h]={id:m.id,changes:it(O[h].changes,m.changes)}:O.push(m),O};function x(){let C=[],m=[],h=0;const O=()=>{C=C.slice(0,h||void 0),h=0},M=()=>{var y;const p=C.length===0?0:C.length-1;let d=(y=C[p])!==null&&y!==void 0?y:[];m.forEach(j=>{d=Z(d,j)}),m=[],C[p]=d},u=y=>!y.filter(({changes:d})=>Object.values(d).some(({from:j,to:k})=>typeof j!="function"&&typeof k!="function"&&!(0,et.Ay)(j,k))).length;return{addRecord(y,p=!1){const d=!y||u(y);if(p){if(d)return;y.forEach(j=>{m=Z(m,j)})}else{if(O(),m.length&&M(),d)return;C.push(y)}},undo(){m.length&&(O(),M());const y=C[C.length-1+h];if(y)return h-=1,y},redo(){const y=C[C.length+h];if(y)return h+=1,y},hasUndo(){return!!C[C.length-1+h]},hasRedo(){return!!C[C.length+h]}}}},"../../../node_modules/.pnpm/@wordpress+url@4.9.0/node_modules/@wordpress/url/build-module/add-query-args.js":(Vt,St,H)=>{"use strict";H.d(St,{F:()=>Z});var et=H("../../../node_modules/.pnpm/@wordpress+url@4.9.0/node_modules/@wordpress/url/build-module/get-query-args.js"),it=H("../../../node_modules/.pnpm/@wordpress+url@4.9.0/node_modules/@wordpress/url/build-module/build-query-string.js");function Z(x="",C){if(!C||!Object.keys(C).length)return x;let m=x;const h=x.indexOf("?");return h!==-1&&(C=Object.assign((0,et.u)(x),C),m=m.substr(0,h)),m+"?"+(0,it.G)(C)}},"../../../node_modules/.pnpm/@wordpress+url@4.9.0/node_modules/@wordpress/url/build-module/build-query-string.js":(Vt,St,H)=>{"use strict";H.d(St,{G:()=>et});function et(it){let Z="";const x=Object.entries(it);let C;for(;C=x.shift();){let[m,h]=C;if(Array.isArray(h)||h&&h.constructor===Object){const M=Object.entries(h).reverse();for(const[u,y]of M)x.unshift([`${m}[${u}]`,y])}else h!==void 0&&(h===null&&(h=""),Z+="&"+[m,h].map(encodeURIComponent).join("="))}return Z.substr(1)}},"../../../node_modules/.pnpm/@wordpress+url@4.9.0/node_modules/@wordpress/url/build-module/get-query-args.js":(Vt,St,H)=>{"use strict";H.d(St,{u:()=>x});function et(C){try{return decodeURIComponent(C)}catch(m){return C}}function it(C){let m;try{m=new URL(C,"http://example.com").search.substring(1)}catch(h){}if(m)return m}function Z(C,m,h){const O=m.length,M=O-1;for(let u=0;u<O;u++){let y=m[u];!y&&Array.isArray(C)&&(y=C.length.toString()),y=["__proto__","constructor","prototype"].includes(y)?y.toUpperCase():y;const p=!isNaN(Number(m[u+1]));C[y]=u===M?h:C[y]||(p?[]:{}),Array.isArray(C[y])&&!p&&(C[y]={...C[y]}),C=C[y]}}function x(C){return(it(C)||"").replace(/\+/g,"%20").split("&").reduce((m,h)=>{const[O,M=""]=h.split("=").filter(Boolean).map(et);if(O){const u=O.replace(/\]/g,"").split("[");Z(m,u,M)}return m},Object.create(null))}},"../../../node_modules/.pnpm/capital-case@1.0.4/node_modules/capital-case/dist.es2015/index.js":(Vt,St,H)=>{"use strict";H.d(St,{D:()=>C});var et=H("../../../node_modules/.pnpm/tslib@2.5.0/node_modules/tslib/tslib.es6.js"),it=H("../../../node_modules/.pnpm/no-case@3.0.4/node_modules/no-case/dist.es2015/index.js");function Z(m){return m.charAt(0).toUpperCase()+m.substr(1)}function x(m){return Z(m.toLowerCase())}function C(m,h){return h===void 0&&(h={}),(0,it.W)(m,(0,et.Cl)({delimiter:" ",transform:x},h))}},"../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/array.js":(Vt,St,H)=>{"use strict";H.d(St,{HT:()=>C,HV:()=>et,S2:()=>x,cy:()=>p,zN:()=>h});const et=_=>_[_.length-1],it=()=>[],Z=_=>_.slice(),x=(_,I)=>{for(let a=0;a<I.length;a++)_.push(I[a])},C=Array.from,m=(_,I)=>{for(let a=0;a<_.length;a++)if(!I(_[a],a,_))return!1;return!0},h=(_,I)=>{for(let a=0;a<_.length;a++)if(I(_[a],a,_))return!0;return!1},O=(_,I)=>_.length===I.length&&m(_,(a,E)=>a===I[E]),M=_=>y(_,[],(I,a)=>I.concat(a)),u=(_,I)=>{const a=new Array(_);for(let E=0;E<_;E++)a[E]=I(E,a);return a},y=(_,I,a)=>_.reduce(a,I),p=Array.isArray,d=_=>C(set.from(_)),j=(_,I)=>{const a=set.create(),E=[];for(let g=0;g<_.length;g++){const T=_[g],w=I(T);a.has(w)||(a.add(w),E.push(T))}return E},k=(_,I)=>{const a=Array(_.length);for(let E=0;E<_.length;E++)a[E]=I(_[E],E,_);return a}},"../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/binary.js":(Vt,St,H)=>{"use strict";H.d(St,{CW:()=>Lt,D1:()=>Z,D7:()=>h,Dk:()=>et,KD:()=>it,KJ:()=>m,P1:()=>dt,WD:()=>mt,WY:()=>st,vZ:()=>Ut,wn:()=>x,wt:()=>O});const et=1,it=2,Z=4,x=8,C=16,m=32,h=64,O=128,M=256,u=512,y=1024,p=2048,d=4096,j=8192,k=16384,_=32768,I=65536,a=1<<17,E=1<<18,g=1<<19,T=1<<20,w=1<<21,A=1<<22,z=1<<23,L=1<<24,P=1<<25,Q=1<<26,lt=1<<27,wt=1<<28,Ct=1<<29,kt=1<<30,Nt=null,xt=0,_t=1,ee=3,qt=7,ut=15,st=31,dt=63,mt=127,Tt=255,Dt=511,Ht=1023,Qt=2047,Kt=4095,Jt=8191,G=16383,nt=32767,vt=65535,V=a-1,v=E-1,D=g-1,tt=T-1,pt=w-1,n=A-1,s=z-1,l=L-1,R=P-1,Y=Q-1,J=lt-1,at=wt-1,Rt=Ct-1,zt=kt-1,Ut=2147483647,Lt=4294967295},"../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/buffer.js":(Vt,St,H)=>{"use strict";H.d(St,{Ey:()=>y,HR:()=>_,nk:()=>u,zS:()=>C});var et=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/string.js"),it=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/environment.js");const Z=g=>new Uint8Array(g),x=(g,T,w)=>new Uint8Array(g,T,w),C=g=>new Uint8Array(g),m=g=>{let T="";for(let w=0;w<g.byteLength;w++)T+=et.QV(g[w]);return btoa(T)},h=g=>Buffer.from(g.buffer,g.byteOffset,g.byteLength).toString("base64"),O=g=>{const T=atob(g),w=Z(T.length);for(let A=0;A<T.length;A++)w[A]=T.charCodeAt(A);return w},M=g=>{const T=Buffer.from(g,"base64");return x(T.buffer,T.byteOffset,T.byteLength)},u=it.Bd?m:h,y=it.Bd?O:M,p=g=>u(g).replaceAll("+","-").replaceAll("/","_").replaceAll("=",""),d=g=>y(g.replaceAll("-","+").replaceAll("_","/")),j=g=>array.map(g,T=>T.toString(16).padStart(2,"0")).join(""),k=g=>{const T=g.length,w=new Uint8Array(math.ceil(T/2));for(let A=0;A<T;A+=2)w[w.length-A/2-1]=Number.parseInt(g.slice(T-A-2,T-A),16);return w},_=g=>{const T=Z(g.byteLength);return T.set(g),T},I=g=>encoding.encode(T=>encoding.writeAny(T,g)),a=g=>decoding.readAny(decoding.createDecoder(g)),E=(g,T)=>{if(T===0)return g;g=new Uint8Array(g),g[0]<<=T;for(let w=1;w<g.length;w++)g[w-1]|=g[w]>>>8-T,g[w]<<=T;return g}},"../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/decoding.js":(Vt,St,H)=>{"use strict";H.d(St,{$C:()=>M,Ib:()=>Jt,Jg:()=>dt,VQ:()=>Ht,bo:()=>d,cQ:()=>mt,cw:()=>A,t3:()=>wt,xK:()=>Kt,xh:()=>_});var et=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/binary.js"),it=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/math.js"),Z=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/number.js"),x=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/string.js"),C=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/error.js");const m=C.vt("Unexpected end of array"),h=C.vt("Integer out of Range");class O{constructor(nt){this.arr=nt,this.pos=0}}const M=G=>new O(G),u=G=>G.pos!==G.arr.length,y=(G,nt=G.pos)=>{const vt=M(G.arr);return vt.pos=nt,vt},p=(G,nt)=>{const vt=new Uint8Array(G.arr.buffer,G.pos+G.arr.byteOffset,nt);return G.pos+=nt,vt},d=G=>p(G,A(G)),j=G=>p(G,G.arr.length-G.pos),k=G=>G.pos++,_=G=>G.arr[G.pos++],I=G=>{const nt=G.arr[G.pos]+(G.arr[G.pos+1]<<8);return G.pos+=2,nt},a=G=>{const nt=G.arr[G.pos]+(G.arr[G.pos+1]<<8)+(G.arr[G.pos+2]<<16)+(G.arr[G.pos+3]<<24)>>>0;return G.pos+=4,nt},E=G=>{const nt=G.arr[G.pos+3]+(G.arr[G.pos+2]<<8)+(G.arr[G.pos+1]<<16)+(G.arr[G.pos]<<24)>>>0;return G.pos+=4,nt},g=G=>G.arr[G.pos],T=G=>G.arr[G.pos]+(G.arr[G.pos+1]<<8),w=G=>G.arr[G.pos]+(G.arr[G.pos+1]<<8)+(G.arr[G.pos+2]<<16)+(G.arr[G.pos+3]<<24)>>>0,A=G=>{let nt=0,vt=1;const V=G.arr.length;for(;G.pos<V;){const v=G.arr[G.pos++];if(nt=nt+(v&et.WD)*vt,vt*=128,v<et.wt)return nt;if(nt>Z.Is)throw h}throw m},z=G=>{let nt=G.arr[G.pos++],vt=nt&et.P1,V=64;const v=(nt&et.D7)>0?-1:1;if(!(nt&et.wt))return v*vt;const D=G.arr.length;for(;G.pos<D;){if(nt=G.arr[G.pos++],vt=vt+(nt&et.WD)*V,V*=128,nt<et.wt)return v*vt;if(vt>Z.Is)throw h}throw m},L=G=>{const nt=G.pos,vt=A(G);return G.pos=nt,vt},P=G=>{const nt=G.pos,vt=z(G);return G.pos=nt,vt},Q=G=>{let nt=A(G);if(nt===0)return"";{let vt=String.fromCodePoint(_(G));if(--nt<100)for(;nt--;)vt+=String.fromCodePoint(_(G));else for(;nt>0;){const V=nt<1e4?nt:1e4,v=G.arr.subarray(G.pos,G.pos+V);G.pos+=V,vt+=String.fromCodePoint.apply(null,v),nt-=V}return decodeURIComponent(escape(vt))}},lt=G=>x.tv.decode(d(G)),wt=x.tv?lt:Q,Ct=G=>{const nt=encoding.createEncoder();let vt;for(;;){if(vt=_(G),vt===0)return encoding.toUint8Array(nt);vt===1&&(vt=_(G)),encoding.write(nt,vt)}},kt=G=>string.decodeUtf8(Ct(G)),Nt=G=>{const nt=G.pos,vt=wt(G);return G.pos=nt,vt},xt=(G,nt)=>{const vt=new DataView(G.arr.buffer,G.arr.byteOffset+G.pos,nt);return G.pos+=nt,vt},_t=G=>xt(G,4).getFloat32(0,!1),ee=G=>xt(G,8).getFloat64(0,!1),qt=G=>xt(G,8).getBigInt64(0,!1),ut=G=>xt(G,8).getBigUint64(0,!1),st=[G=>{},G=>null,z,_t,ee,qt,G=>!1,G=>!0,wt,G=>{const nt=A(G),vt={};for(let V=0;V<nt;V++){const v=wt(G);vt[v]=dt(G)}return vt},G=>{const nt=A(G),vt=[];for(let V=0;V<nt;V++)vt.push(dt(G));return vt},d],dt=G=>st[127-_(G)](G);class mt extends O{constructor(nt,vt){super(nt),this.reader=vt,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),u(this)?this.count=A(this)+1:this.count=-1),this.count--,this.s}}class Tt extends O{constructor(nt,vt){super(nt),this.s=vt}read(){return this.s+=z(this),this.s}}class Dt extends O{constructor(nt,vt){super(nt),this.s=vt,this.count=0}read(){return this.count===0&&(this.s+=z(this),u(this)?this.count=A(this)+1:this.count=-1),this.count--,this.s}}class Ht extends O{constructor(nt){super(nt),this.s=0,this.count=0}read(){if(this.count===0){this.s=z(this);const nt=it.sj(this.s);this.count=1,nt&&(this.s=-this.s,this.count=A(this)+2)}return this.count--,this.s}}class Qt extends O{constructor(nt){super(nt),this.s=0,this.count=0}read(){if(this.count===0){this.s=z(this);const nt=it.sj(this.s);this.count=1,nt&&(this.s=-this.s,this.count=A(this)+2)}return this.count--,this.s++}}class Kt extends O{constructor(nt){super(nt),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const nt=z(this),vt=nt&1;this.diff=it.RI(nt/2),this.count=1,vt&&(this.count=A(this)+2)}return this.s+=this.diff,this.count--,this.s}}class Jt{constructor(nt){this.decoder=new Ht(nt),this.str=wt(this.decoder),this.spos=0}read(){const nt=this.spos+this.decoder.read(),vt=this.str.slice(this.spos,nt);return this.spos=nt,vt}}},"../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/encoding.js":(Vt,St,H)=>{"use strict";H.d(St,{D$:()=>Jt,FA:()=>vt,Fo:()=>y,Gu:()=>xt,IO:()=>Tt,LH:()=>Nt,QJ:()=>k,Qj:()=>lt,Sw:()=>V,cq:()=>Dt,xv:()=>h,zd:()=>w});var et=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/math.js"),it=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/number.js"),Z=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/binary.js"),x=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/string.js"),C=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/array.js");class m{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const h=()=>new m,O=v=>{const D=h();return v(D),y(D)},M=v=>{let D=v.cpos;for(let tt=0;tt<v.bufs.length;tt++)D+=v.bufs[tt].length;return D},u=v=>v.cpos>0||v.bufs.length>0,y=v=>{const D=new Uint8Array(M(v));let tt=0;for(let pt=0;pt<v.bufs.length;pt++){const n=v.bufs[pt];D.set(n,tt),tt+=n.length}return D.set(new Uint8Array(v.cbuf.buffer,0,v.cpos),tt),D},p=(v,D)=>{const tt=v.cbuf.length;tt-v.cpos<D&&(v.bufs.push(new Uint8Array(v.cbuf.buffer,0,v.cpos)),v.cbuf=new Uint8Array(et.T9(tt,D)*2),v.cpos=0)},d=(v,D)=>{const tt=v.cbuf.length;v.cpos===tt&&(v.bufs.push(v.cbuf),v.cbuf=new Uint8Array(tt*2),v.cpos=0),v.cbuf[v.cpos++]=D},j=(v,D,tt)=>{let pt=null;for(let n=0;n<v.bufs.length&&pt===null;n++){const s=v.bufs[n];D<s.length?pt=s:D-=s.length}pt===null&&(pt=v.cbuf),pt[D]=tt},k=d,_=null,I=(v,D)=>{d(v,D&binary.BITS8),d(v,D>>>8&binary.BITS8)},a=(v,D,tt)=>{j(v,D,tt&binary.BITS8),j(v,D+1,tt>>>8&binary.BITS8)},E=(v,D)=>{for(let tt=0;tt<4;tt++)d(v,D&binary.BITS8),D>>>=8},g=(v,D)=>{for(let tt=3;tt>=0;tt--)d(v,D>>>8*tt&binary.BITS8)},T=(v,D,tt)=>{for(let pt=0;pt<4;pt++)j(v,D+pt,tt&binary.BITS8),tt>>>=8},w=(v,D)=>{for(;D>Z.WD;)d(v,Z.wt|Z.WD&D),D=et.RI(D/128);d(v,Z.WD&D)},A=(v,D)=>{const tt=et.sj(D);for(tt&&(D=-D),d(v,(D>Z.P1?Z.wt:0)|(tt?Z.D7:0)|Z.P1&D),D=et.RI(D/64);D>0;)d(v,(D>Z.WD?Z.wt:0)|Z.WD&D),D=et.RI(D/128)},z=new Uint8Array(3e4),L=z.length/3,P=(v,D)=>{if(D.length<L){const tt=x.db.encodeInto(D,z).written||0;w(v,tt);for(let pt=0;pt<tt;pt++)d(v,z[pt])}else xt(v,x.Af(D))},Q=(v,D)=>{const tt=unescape(encodeURIComponent(D)),pt=tt.length;w(v,pt);for(let n=0;n<pt;n++)d(v,tt.codePointAt(n))},lt=x.db&&x.db.encodeInto?P:Q,wt=(v,D)=>Ct(v,string.encodeUtf8(D)),Ct=(v,D)=>{for(let tt=0;tt<D.length;tt++){const pt=D[tt];(pt===0||pt===1)&&d(v,1),d(v,D[tt])}d(v,0)},kt=(v,D)=>Nt(v,y(D)),Nt=(v,D)=>{const tt=v.cbuf.length,pt=v.cpos,n=et.jk(tt-pt,D.length),s=D.length-n;v.cbuf.set(D.subarray(0,n),pt),v.cpos+=n,s>0&&(v.bufs.push(v.cbuf),v.cbuf=new Uint8Array(et.T9(tt*2,s)),v.cbuf.set(D.subarray(n)),v.cpos=s)},xt=(v,D)=>{w(v,D.byteLength),Nt(v,D)},_t=(v,D)=>{p(v,D);const tt=new DataView(v.cbuf.buffer,v.cpos,D);return v.cpos+=D,tt},ee=(v,D)=>_t(v,4).setFloat32(0,D,!1),qt=(v,D)=>_t(v,8).setFloat64(0,D,!1),ut=(v,D)=>_t(v,8).setBigInt64(0,D,!1),st=(v,D)=>_t(v,8).setBigUint64(0,D,!1),dt=new DataView(new ArrayBuffer(4)),mt=v=>(dt.setFloat32(0,v),dt.getFloat32(0)===v),Tt=(v,D)=>{switch(typeof D){case"string":d(v,119),lt(v,D);break;case"number":it.Fq(D)&&et.tn(D)<=Z.vZ?(d(v,125),A(v,D)):mt(D)?(d(v,124),ee(v,D)):(d(v,123),qt(v,D));break;case"bigint":d(v,122),ut(v,D);break;case"object":if(D===null)d(v,126);else if(C.cy(D)){d(v,117),w(v,D.length);for(let tt=0;tt<D.length;tt++)Tt(v,D[tt])}else if(D instanceof Uint8Array)d(v,116),xt(v,D);else{d(v,118);const tt=Object.keys(D);w(v,tt.length);for(let pt=0;pt<tt.length;pt++){const n=tt[pt];lt(v,n),Tt(v,D[n])}}break;case"boolean":d(v,D?120:121);break;default:d(v,127)}};class Dt extends m{constructor(D){super(),this.w=D,this.s=null,this.count=0}write(D){this.s===D?this.count++:(this.count>0&&w(this,this.count-1),this.count=1,this.w(this,D),this.s=D)}}class Ht extends m{constructor(D){super(),this.s=D}write(D){A(this,D-this.s),this.s=D}}class Qt extends m{constructor(D){super(),this.s=D,this.count=0}write(D){this.s===D&&this.count>0?this.count++:(this.count>0&&w(this,this.count-1),this.count=1,A(this,D-this.s),this.s=D)}}const Kt=v=>{v.count>0&&(A(v.encoder,v.count===1?v.s:-v.s),v.count>1&&w(v.encoder,v.count-2))};class Jt{constructor(){this.encoder=new m,this.s=0,this.count=0}write(D){this.s===D?this.count++:(Kt(this),this.count=1,this.s=D)}toUint8Array(){return Kt(this),y(this.encoder)}}class G{constructor(){this.encoder=new m,this.s=0,this.count=0}write(D){this.s+this.count===D?this.count++:(Kt(this),this.count=1,this.s=D)}toUint8Array(){return Kt(this),y(this.encoder)}}const nt=v=>{if(v.count>0){const D=v.diff*2+(v.count===1?0:1);A(v.encoder,D),v.count>1&&w(v.encoder,v.count-2)}};class vt{constructor(){this.encoder=new m,this.s=0,this.count=0,this.diff=0}write(D){this.diff===D-this.s?(this.s=D,this.count++):(nt(this),this.count=1,this.diff=D-this.s,this.s=D)}toUint8Array(){return nt(this),y(this.encoder)}}class V{constructor(){this.sarr=[],this.s="",this.lensE=new Jt}write(D){this.s+=D,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(D.length)}toUint8Array(){const D=new m;return this.sarr.push(this.s),this.s="",lt(D,this.sarr.join("")),Nt(D,this.lensE.toUint8Array()),y(D)}}},"../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/environment.js":(Vt,St,H)=>{"use strict";H.d(St,{dn:()=>k,Bd:()=>O,WI:()=>T});var et=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/map.js"),it=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/string.js");const Z=w=>w===void 0?null:w;var x=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/storage.js"),C=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/function.js"),m=H("../../../node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js");const h=typeof m!="undefined"&&m.release&&/node|io\.js/.test(m.release.name)&&Object.prototype.toString.call(typeof m!="undefined"?m:0)==="[object process]",O=typeof window!="undefined"&&typeof document!="undefined"&&!h,M=typeof navigator!="undefined"?/Mac/.test(navigator.platform):!1;let u;const y=[],p=()=>{if(u===void 0)if(h){u=et.vt();const w=m.argv;let A=null;for(let z=0;z<w.length;z++){const L=w[z];L[0]==="-"?(A!==null&&u.set(A,""),A=L):A!==null?(u.set(A,L),A=null):y.push(L)}A!==null&&u.set(A,"")}else typeof location=="object"?(u=et.vt(),(location.search||"?").slice(1).split("&").forEach(w=>{if(w.length!==0){const[A,z]=w.split("=");u.set(`--${it.jN(A,"-")}`,z),u.set(`-${it.jN(A,"-")}`,z)}})):u=et.vt();return u},d=w=>p().has(w),j=(w,A)=>p().get(w)||A,k=w=>Z(h?m.env[w.toUpperCase().replaceAll("-","_")]:x.JT.getItem(w)),_=w=>p().get("--"+w)||k(w),I=w=>{const A=_(w);if(A==null)throw new Error(`Expected configuration "${w.toUpperCase().replaceAll("-","_")}"`);return A},a=w=>d("--"+w)||k(w)!==null,E=a("production"),T=h&&C.EK(m.env.FORCE_COLOR,["true","1","2"])||!d("--no-colors")&&!a("no-color")&&(!h||m.stdout.isTTY)&&(!h||d("--color")||k("COLORTERM")!==null||(k("TERM")||"").includes("color"))},"../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/error.js":(Vt,St,H)=>{"use strict";H.d(St,{Mq:()=>Z,bD:()=>it,vt:()=>et});const et=x=>new Error(x),it=()=>{throw et("Method unimplemented")},Z=()=>{throw et("Unexpected case")}},"../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/function.js":(Vt,St,H)=>{"use strict";H.d(St,{EK:()=>u,OK:()=>Z,id:()=>m,mT:()=>x,vo:()=>M});var et=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/array.js"),it=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/object.js");const Z=(_,I,a=0)=>{try{for(;a<_.length;a++)_[a](...I)}finally{a<_.length&&Z(_,I,a+1)}},x=()=>{},C=_=>_(),m=_=>_,h=(_,I)=>_===I,O=(_,I)=>_===I||_!=null&&I!=null&&_.constructor===I.constructor&&(array.isArray(_)&&array.equalFlat(_,I)||typeof _=="object"&&object.equalFlat(_,I)),M=(_,I)=>{if(_==null||I==null)return h(_,I);if(_.constructor!==I.constructor)return!1;if(_===I)return!0;switch(_.constructor){case ArrayBuffer:_=new Uint8Array(_),I=new Uint8Array(I);case Uint8Array:{if(_.byteLength!==I.byteLength)return!1;for(let a=0;a<_.length;a++)if(_[a]!==I[a])return!1;break}case Set:{if(_.size!==I.size)return!1;for(const a of _)if(!I.has(a))return!1;break}case Map:{if(_.size!==I.size)return!1;for(const a of _.keys())if(!I.has(a)||!M(_.get(a),I.get(a)))return!1;break}case Object:if(it.Bw(_)!==it.Bw(I))return!1;for(const a in _)if(!it.i5(_,a)||!M(_[a],I[a]))return!1;break;case Array:if(_.length!==I.length)return!1;for(let a=0;a<_.length;a++)if(!M(_[a],I[a]))return!1;break;default:return!1}return!0},u=(_,I)=>I.includes(_),y=et.cy,p=_=>_&&_.constructor===String,d=_=>_!=null&&_.constructor===Number,j=(_,I)=>_&&_.constructor===I,k=_=>I=>I&&I.constructor===_},"../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/logging.common.js":(Vt,St,H)=>{"use strict";H.d(St,{ft:()=>u,Y:()=>O,AV:()=>p,Qu:()=>y,hN:()=>k,hr:()=>j,UH:()=>d,Ny:()=>M,Tx:()=>_,ET:()=>I,Xv:()=>T});const et=Symbol,it=w=>typeof w=="symbol";var Z=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/time.js"),x=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/environment.js"),C=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/function.js");const m=JSON.stringify,h=JSON.parse,O=et(),M=et(),u=et(),y=et(),p=et(),d=et(),j=et(),k=et(),_=et(),I=w=>{var P;w.length===1&&((P=w[0])==null?void 0:P.constructor)===Function&&(w=w[0]());const A=[],z=[];let L=0;for(;L<w.length;L++){const Q=w[L];if(Q===void 0)break;if(Q.constructor===String||Q.constructor===Number)A.push(Q);else if(Q.constructor===Object)break}for(L>0&&z.push(A.join(""));L<w.length;L++){const Q=w[L];Q instanceof Symbol||z.push(Q)}return z},a=[p,j,k,u];let E=0,g=Z._g();const T=(w,A)=>{const z=a[E],L=x.dn("log"),P=L!==null&&(L==="*"||L==="true"||new RegExp(L,"gi").test(A));return E=(E+1)%a.length,A+=": ",P?(...Q)=>{var Ct;Q.length===1&&((Ct=Q[0])==null?void 0:Ct.constructor)===Function&&(Q=Q[0]());const lt=Z._g(),wt=lt-g;g=lt,w(z,A,_,...Q.map(kt=>{switch(kt!=null&&kt.constructor===Uint8Array&&(kt=Array.from(kt)),typeof kt){case"string":case"symbol":return kt;default:return m(kt)}}),z," +"+wt+"ms")}:C.mT}},"../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/logging.js":(Vt,St,H)=>{"use strict";H.d(St,{Xv:()=>ie,yy:()=>D,R8:()=>tt});var et=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/environment.js"),it=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/set.js");class Z{constructor(ot,bt){this.left=ot,this.right=bt}}const x=(q,ot)=>new Z(q,ot),C=(q,ot)=>new Z(ot,q),m=(q,ot)=>q.forEach(bt=>ot(bt.left,bt.right)),h=(q,ot)=>q.map(bt=>ot(bt.left,bt.right));var O=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/map.js");const M=typeof document!="undefined"?document:{},u=q=>M.createElement(q),y=()=>M.createDocumentFragment(),p=q=>M.createTextNode(q),d=typeof DOMParser!="undefined"?new DOMParser:null,j=(q,ot,bt)=>q.dispatchEvent(new CustomEvent(ot,bt)),k=(q,ot)=>(pair.forEach(ot,(bt,Mt)=>{Mt===!1?q.removeAttribute(bt):Mt===!0?q.setAttribute(bt,""):q.setAttribute(bt,Mt)}),q),_=(q,ot)=>(ot.forEach((bt,Mt)=>{q.setAttribute(Mt,bt)}),q),I=q=>{const ot=y();for(let bt=0;bt<q.length;bt++)st(ot,q[bt]);return ot},a=(q,ot)=>(st(q,I(ot)),q),E=q=>q.remove(),g=(q,ot,bt)=>q.addEventListener(ot,bt),T=(q,ot,bt)=>q.removeEventListener(ot,bt),w=(q,ot)=>(pair.forEach(ot,(bt,Mt)=>g(q,bt,Mt)),q),A=(q,ot)=>(pair.forEach(ot,(bt,Mt)=>T(q,bt,Mt)),q),z=(q,ot=[],bt=[])=>a(k(u(q),ot),bt),L=(q,ot)=>{const bt=u("canvas");return bt.height=ot,bt.width=q,bt},P=null,Q=q=>`${q.left}:${q.right};`,lt=q=>q.map(Q).join(""),wt=q=>O.Tj(q,(ot,bt)=>`${bt}:${ot};`).join(""),Ct=(q,ot)=>q.querySelector(ot),kt=(q,ot)=>q.querySelectorAll(ot),Nt=q=>M.getElementById(q),xt=q=>d.parseFromString(`<html><body>${q}</body></html>`,"text/html").body,_t=q=>I(xt(q).childNodes),ee=q=>xt(q).firstElementChild,qt=(q,ot)=>q.replaceWith(ot),ut=(q,ot,bt)=>q.insertBefore(ot,bt),st=(q,ot)=>q.appendChild(ot),dt=M.ELEMENT_NODE,mt=M.TEXT_NODE,Tt=M.CDATA_SECTION_NODE,Dt=M.COMMENT_NODE,Ht=M.DOCUMENT_NODE,Qt=M.DOCUMENT_TYPE_NODE,Kt=M.DOCUMENT_FRAGMENT_NODE,Jt=(q,ot)=>q.nodeType===ot,G=(q,ot)=>{let bt=ot.parentNode;for(;bt&&bt!==q;)bt=bt.parentNode;return bt===q};var nt=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/logging.common.js");const vt={[nt.Y]:x("font-weight","bold"),[nt.Ny]:x("font-weight","normal"),[nt.ft]:x("color","blue"),[nt.AV]:x("color","green"),[nt.Qu]:x("color","grey"),[nt.UH]:x("color","red"),[nt.hr]:x("color","purple"),[nt.hN]:x("color","orange"),[nt.Tx]:x("color","black")},V=q=>{var ne;q.length===1&&((ne=q[0])==null?void 0:ne.constructor)===Function&&(q=q[0]());const ot=[],bt=[],Mt=O.vt();let yt=[],Xt=0;for(;Xt<q.length;Xt++){const se=q[Xt],de=vt[se];if(de!==void 0)Mt.set(de.left,de.right);else{if(se===void 0)break;if(se.constructor===String||se.constructor===Number){const Ue=wt(Mt);Xt>0||Ue.length>0?(ot.push("%c"+se),bt.push(Ue)):ot.push(se)}else break}}for(Xt>0&&(yt=bt,yt.unshift(ot.join("")));Xt<q.length;Xt++){const se=q[Xt];se instanceof Symbol||yt.push(se)}return yt},v=et.WI?V:nt.ET,D=(...q)=>{console.log(...v(q)),Rt.forEach(ot=>ot.print(q))},tt=(...q)=>{console.warn(...v(q)),q.unshift(nt.hN),Rt.forEach(ot=>ot.print(q))},pt=q=>{console.error(q),Rt.forEach(ot=>ot.printError(q))},n=(q,ot)=>{env.isBrowser&&console.log("%c                      ",`font-size: ${ot}px; background-size: contain; background-repeat: no-repeat; background-image: url(${q})`),Rt.forEach(bt=>bt.printImg(q,ot))},s=(q,ot)=>n(`data:image/gif;base64,${q}`,ot),l=(...q)=>{console.group(...v(q)),Rt.forEach(ot=>ot.group(q))},R=(...q)=>{console.groupCollapsed(...v(q)),Rt.forEach(ot=>ot.groupCollapsed(q))},Y=()=>{console.groupEnd(),Rt.forEach(q=>q.groupEnd())},J=q=>Rt.forEach(ot=>ot.printDom(q())),at=(q,ot)=>n(q.toDataURL(),ot),Rt=it.vt(),zt=q=>{const ot=[],bt=new Map;let Mt=0;for(;Mt<q.length;Mt++){let yt=q[Mt];const Xt=vt[yt];if(Xt!==void 0)bt.set(Xt.left,Xt.right);else if(yt===void 0&&(yt="undefined "),yt.constructor===String||yt.constructor===Number){const ne=dom.element("span",[pair.create("style",dom.mapToStyleString(bt))],[dom.text(yt.toString())]);ne.innerHTML===""&&(ne.innerHTML="&nbsp;"),ot.push(ne)}else break}for(;Mt<q.length;Mt++){let yt=q[Mt];yt instanceof Symbol||(yt.constructor!==String&&yt.constructor!==Number&&(yt=" "+json.stringify(yt)+" "),ot.push(dom.element("span",[],[dom.text(yt)])))}return ot},Ut="font-family:monospace;border-bottom:1px solid #e2e2e2;padding:2px;";class Lt{constructor(ot){this.dom=ot,this.ccontainer=this.dom,this.depth=0,Rt.add(this)}group(ot,bt=!1){eventloop.enqueue(()=>{const Mt=dom.element("span",[pair.create("hidden",bt),pair.create("style","color:grey;font-size:120%;")],[dom.text("\u25BC")]),yt=dom.element("span",[pair.create("hidden",!bt),pair.create("style","color:grey;font-size:125%;")],[dom.text("\u25B6")]),Xt=dom.element("div",[pair.create("style",`${Ut};padding-left:${this.depth*10}px`)],[Mt,yt,dom.text(" ")].concat(zt(ot))),ne=dom.element("div",[pair.create("hidden",bt)]),se=dom.element("div",[],[Xt,ne]);dom.append(this.ccontainer,[se]),this.ccontainer=ne,this.depth++,dom.addEventListener(Xt,"click",de=>{ne.toggleAttribute("hidden"),Mt.toggleAttribute("hidden"),yt.toggleAttribute("hidden")})})}groupCollapsed(ot){this.group(ot,!0)}groupEnd(){eventloop.enqueue(()=>{this.depth>0&&(this.depth--,this.ccontainer=this.ccontainer.parentElement.parentElement)})}print(ot){eventloop.enqueue(()=>{dom.append(this.ccontainer,[dom.element("div",[pair.create("style",`${Ut};padding-left:${this.depth*10}px`)],zt(ot))])})}printError(ot){this.print([common.RED,common.BOLD,ot.toString()])}printImg(ot,bt){eventloop.enqueue(()=>{dom.append(this.ccontainer,[dom.element("img",[pair.create("src",ot),pair.create("height",`${math.round(bt*1.5)}px`)])])})}printDom(ot){eventloop.enqueue(()=>{dom.append(this.ccontainer,[ot])})}destroy(){eventloop.enqueue(()=>{Rt.delete(this)})}}const jt=q=>new Lt(q),ie=q=>nt.Xv(D,q)},"../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/map.js":(Vt,St,H)=>{"use strict";H.d(St,{C:()=>it,Tj:()=>x,_4:()=>Z,bz:()=>C,vt:()=>et});const et=()=>new Map,it=h=>{const O=et();return h.forEach((M,u)=>{O.set(u,M)}),O},Z=(h,O,M)=>{let u=h.get(O);return u===void 0&&h.set(O,u=M()),u},x=(h,O)=>{const M=[];for(const[u,y]of h)M.push(O(y,u));return M},C=(h,O)=>{for(const[M,u]of h)if(O(u,M))return!0;return!1},m=(h,O)=>{for(const[M,u]of h)if(!O(u,M))return!1;return!0}},"../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/math.js":(Vt,St,H)=>{"use strict";H.d(St,{RI:()=>et,T9:()=>p,YL:()=>m,jk:()=>y,sj:()=>I,tn:()=>Z});const et=Math.floor,it=Math.ceil,Z=Math.abs,x=Math.imul,C=Math.round,m=Math.log10,h=Math.log2,O=Math.log,M=Math.sqrt,u=(a,E)=>a+E,y=(a,E)=>a<E?a:E,p=(a,E)=>a>E?a:E,d=Number.isNaN,j=Math.pow,k=a=>Math.pow(10,a),_=Math.sign,I=a=>a!==0?a<0:1/a<0},"../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/number.js":(Vt,St,H)=>{"use strict";H.d(St,{Fq:()=>O,Is:()=>Z});var et=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/math.js"),it=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/binary.js");const Z=Number.MAX_SAFE_INTEGER,x=Number.MIN_SAFE_INTEGER,C=null,m=it.vZ,h=it.CW,O=Number.isInteger||(p=>typeof p=="number"&&isFinite(p)&&et.RI(p)===p),M=Number.isNaN,u=Number.parseInt,y=p=>{p&=binary.BITS32;let d=0;for(;p;)p&=p-1,d++;return d}},"../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/object.js":(Vt,St,H)=>{"use strict";H.d(St,{Bw:()=>m,Im:()=>M,SQ:()=>p,i5:()=>y,jJ:()=>x,kp:()=>it});const et=()=>Object.create(null),it=Object.assign,Z=Object.keys,x=(k,_)=>{for(const I in k)_(k[I],I)},C=(k,_)=>{const I=[];for(const a in k)I.push(_(k[a],a));return I},m=k=>Z(k).length,h=k=>Z(k).length,O=(k,_)=>{for(const I in k)if(_(k[I],I))return!0;return!1},M=k=>{for(const _ in k)return!1;return!0},u=(k,_)=>{for(const I in k)if(!_(k[I],I))return!1;return!0},y=(k,_)=>Object.prototype.hasOwnProperty.call(k,_),p=(k,_)=>k===_||h(k)===h(_)&&u(k,(I,a)=>(I!==void 0||y(_,a))&&_[a]===I),d=Object.freeze,j=k=>{for(const _ in k){const I=k[_];(typeof I=="object"||typeof I=="function")&&j(k[_])}return d(k)}},"../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/observable.js":(Vt,St,H)=>{"use strict";H.d(St,{W:()=>x,c:()=>C});var et=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/map.js"),it=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/set.js"),Z=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/array.js");class x{constructor(){this._observers=et.vt()}on(h,O){return et._4(this._observers,h,it.vt).add(O),O}once(h,O){const M=(...u)=>{this.off(h,M),O(...u)};this.on(h,M)}off(h,O){const M=this._observers.get(h);M!==void 0&&(M.delete(O),M.size===0&&this._observers.delete(h))}emit(h,O){return Z.HT((this._observers.get(h)||et.vt()).values()).forEach(M=>M(...O))}destroy(){this._observers=et.vt()}}class C{constructor(){this._observers=et.vt()}on(h,O){et._4(this._observers,h,it.vt).add(O)}once(h,O){const M=(...u)=>{this.off(h,M),O(...u)};this.on(h,M)}off(h,O){const M=this._observers.get(h);M!==void 0&&(M.delete(O),M.size===0&&this._observers.delete(h))}emit(h,O){return Z.HT((this._observers.get(h)||et.vt()).values()).forEach(M=>M(...O))}destroy(){this._observers=et.vt()}}},"../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/promise.js":(Vt,St,H)=>{"use strict";H.d(St,{hd:()=>C,ku:()=>x,vt:()=>et});const et=y=>new Promise(y),it=y=>new Promise(y),Z=Promise.all.bind(Promise),x=y=>Promise.reject(y),C=y=>Promise.resolve(y),m=y=>Promise.resolve(y),h=(y,p,d=10)=>et((j,k)=>{const _=time.getUnixTime(),I=y>0,E=setInterval(()=>{p()?(clearInterval(E),j()):I&&time.getUnixTime()-_>y&&(clearInterval(E),k(new Error("Timeout")))},d)}),O=async(y,p=0,d=10)=>{const j=time.getUnixTime(),k=p<=0;for(;k||time.getUnixTime()-j<=p;){if(await y())return;await M(d)}throw new Error("Timeout")},M=y=>et((p,d)=>setTimeout(p,y)),u=y=>y instanceof Promise||y&&y.then&&y.catch&&y.finally},"../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/random.js":(Vt,St,H)=>{"use strict";H.d(St,{_9:()=>Z,S8:()=>x,gZ:()=>O});const et=crypto.subtle,it=crypto.getRandomValues.bind(crypto),Z=Math.random,x=()=>it(new Uint32Array(1))[0],C=()=>{const M=getRandomValues(new Uint32Array(8));return(M[0]&binary.BITS21)*(binary.BITS32+1)+(M[1]>>>0)},m=M=>M[math.floor(Z()*M.length)],h=[1e7]+-1e3+-4e3+-8e3+-1e11,O=()=>h.replace(/[018]/g,M=>(M^x()&15>>M/4).toString(16))},"../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/set.js":(Vt,St,H)=>{"use strict";H.d(St,{vt:()=>et});const et=()=>new Set,it=C=>Array.from(C),Z=C=>{var m;return(m=C.values().next().value)!=null?m:void 0},x=C=>new Set(C)},"../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/storage.js":(Vt,St,H)=>{"use strict";H.d(St,{JT:()=>x,k9:()=>C,o6:()=>m});class et{constructor(){this.map=new Map}setItem(O,M){this.map.set(O,M)}getItem(O){return this.map.get(O)}}let it=new et,Z=!0;try{typeof localStorage!="undefined"&&localStorage&&(it=localStorage,Z=!1)}catch(h){}const x=it,C=h=>Z||addEventListener("storage",h),m=h=>Z||removeEventListener("storage",h)},"../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/string.js":(Vt,St,H)=>{"use strict";H.d(St,{Af:()=>d,QV:()=>et,db:()=>y,jN:()=>O,tv:()=>k});const et=String.fromCharCode,it=String.fromCodePoint,Z=et(65535),x=g=>g.toLowerCase(),C=/^\s*/g,m=g=>g.replace(C,""),h=/([A-Z])/g,O=(g,T)=>m(g.replace(h,w=>`${T}${x(w)}`)),M=g=>unescape(encodeURIComponent(g)).length,u=g=>{const T=unescape(encodeURIComponent(g)),w=T.length,A=new Uint8Array(w);for(let z=0;z<w;z++)A[z]=T.codePointAt(z);return A},y=typeof TextEncoder!="undefined"?new TextEncoder:null,d=y?g=>y.encode(g):u,j=g=>{let T=g.length,w="",A=0;for(;T>0;){const z=T<1e4?T:1e4,L=g.subarray(A,A+z);A+=z,w+=String.fromCodePoint.apply(null,L),T-=z}return decodeURIComponent(escape(w))};let k=typeof TextDecoder=="undefined"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});k&&k.decode(new Uint8Array).length===1&&(k=null);const _=g=>k.decode(g),I=null,a=(g,T,w,A="")=>g.slice(0,T)+A+g.slice(T+w),E=(g,T)=>array.unfold(T,()=>g).join("")},"../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/time.js":(Vt,St,H)=>{"use strict";H.d(St,{_g:()=>it});const et=()=>new Date,it=Date.now,Z=x=>{if(x<6e4){const M=metric.prefix(x,-1);return math.round(M.n*100)/100+M.prefix+"s"}x=math.floor(x/1e3);const C=x%60,m=math.floor(x/60)%60,h=math.floor(x/3600)%24,O=math.floor(x/86400);return O>0?O+"d"+(h>0||m>30?" "+(m>30?h+1:h)+"h":""):h>0?h+"h"+(m>0||C>30?" "+(C>30?m+1:m)+"min":""):m+"min"+(C>0?" "+C+"s":"")}},"../../../node_modules/.pnpm/simple-peer@9.11.1/node_modules/simple-peer/simplepeer.min.js":(Vt,St,H)=>{(function(et){if(!0)Vt.exports=et();else var it})(function(){var et=Math.floor,it=Math.abs,Z=Math.pow;return function(){function x(C,m,h){function O(y,p){if(!m[y]){if(!C[y]){var d=void 0;if(!p&&H("../../../node_modules/.pnpm/simple-peer@9.11.1/node_modules/simple-peer sync recursive"))return require(y,!0);if(M)return M(y,!0);var j=new Error("Cannot find module '"+y+"'");throw j.code="MODULE_NOT_FOUND",j}var k=m[y]={exports:{}};C[y][0].call(k.exports,function(_){var I=C[y][1][_];return O(I||_)},k,k.exports,x,C,m,h)}return m[y].exports}for(var M=void 0,u=0;u<h.length;u++)O(h[u]);return O}return x}()({1:[function(x,C,m){"use strict";function h(E){var g=E.length;if(0<g%4)throw new Error("Invalid string. Length must be a multiple of 4");var T=E.indexOf("=");T===-1&&(T=g);var w=T===g?0:4-T%4;return[T,w]}function O(E,g,T){return 3*(g+T)/4-T}function M(E){var g,T,w=h(E),A=w[0],z=w[1],L=new k(O(E,A,z)),P=0,Q=0<z?A-4:A;for(T=0;T<Q;T+=4)g=j[E.charCodeAt(T)]<<18|j[E.charCodeAt(T+1)]<<12|j[E.charCodeAt(T+2)]<<6|j[E.charCodeAt(T+3)],L[P++]=255&g>>16,L[P++]=255&g>>8,L[P++]=255&g;return z===2&&(g=j[E.charCodeAt(T)]<<2|j[E.charCodeAt(T+1)]>>4,L[P++]=255&g),z===1&&(g=j[E.charCodeAt(T)]<<10|j[E.charCodeAt(T+1)]<<4|j[E.charCodeAt(T+2)]>>2,L[P++]=255&g>>8,L[P++]=255&g),L}function u(E){return d[63&E>>18]+d[63&E>>12]+d[63&E>>6]+d[63&E]}function y(E,g,T){for(var w,A=[],z=g;z<T;z+=3)w=(16711680&E[z]<<16)+(65280&E[z+1]<<8)+(255&E[z+2]),A.push(u(w));return A.join("")}function p(E){for(var g,T=E.length,w=T%3,A=[],z=16383,L=0,P=T-w;L<P;L+=z)A.push(y(E,L,L+z>P?P:L+z));return w===1?(g=E[T-1],A.push(d[g>>2]+d[63&g<<4]+"==")):w===2&&(g=(E[T-2]<<8)+E[T-1],A.push(d[g>>10]+d[63&g>>4]+d[63&g<<2]+"=")),A.join("")}m.byteLength=function(E){var g=h(E),T=g[0],w=g[1];return 3*(T+w)/4-w},m.toByteArray=M,m.fromByteArray=p;for(var d=[],j=[],k=typeof Uint8Array=="undefined"?Array:Uint8Array,_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",I=0,a=_.length;I<a;++I)d[I]=_[I],j[_.charCodeAt(I)]=I;j[45]=62,j[95]=63},{}],2:[function(){},{}],3:[function(x,C,m){(function(){(function(){/*!
* The buffer module from node.js, for the browser.
*
* @author   Feross Aboukhadijeh <https://feross.org>
* @license  MIT
*/"use strict";var h=String.fromCharCode,O=Math.min;function M(n){if(2147483647<n)throw new RangeError('The value "'+n+'" is invalid for option "size"');var s=new Uint8Array(n);return s.__proto__=u.prototype,s}function u(n,s,l){if(typeof n=="number"){if(typeof s=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return j(n)}return y(n,s,l)}function y(n,s,l){if(typeof n=="string")return k(n,s);if(ArrayBuffer.isView(n))return _(n);if(n==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof n);if(V(n,ArrayBuffer)||n&&V(n.buffer,ArrayBuffer))return I(n,s,l);if(typeof n=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var R=n.valueOf&&n.valueOf();if(R!=null&&R!==n)return u.from(R,s,l);var Y=a(n);if(Y)return Y;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof n[Symbol.toPrimitive]=="function")return u.from(n[Symbol.toPrimitive]("string"),s,l);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof n)}function p(n){if(typeof n!="number")throw new TypeError('"size" argument must be of type number');if(0>n)throw new RangeError('The value "'+n+'" is invalid for option "size"')}function d(n,s,l){return p(n),0>=n||s===void 0?M(n):typeof l=="string"?M(n).fill(s,l):M(n).fill(s)}function j(n){return p(n),M(0>n?0:0|E(n))}function k(n,s){if((typeof s!="string"||s==="")&&(s="utf8"),!u.isEncoding(s))throw new TypeError("Unknown encoding: "+s);var l=0|g(n,s),R=M(l),Y=R.write(n,s);return Y!==l&&(R=R.slice(0,Y)),R}function _(n){for(var s=0>n.length?0:0|E(n.length),l=M(s),R=0;R<s;R+=1)l[R]=255&n[R];return l}function I(n,s,l){if(0>s||n.byteLength<s)throw new RangeError('"offset" is outside of buffer bounds');if(n.byteLength<s+(l||0))throw new RangeError('"length" is outside of buffer bounds');var R;return R=s===void 0&&l===void 0?new Uint8Array(n):l===void 0?new Uint8Array(n,s):new Uint8Array(n,s,l),R.__proto__=u.prototype,R}function a(n){if(u.isBuffer(n)){var s=0|E(n.length),l=M(s);return l.length===0||n.copy(l,0,0,s),l}return n.length===void 0?n.type==="Buffer"&&Array.isArray(n.data)?_(n.data):void 0:typeof n.length!="number"||v(n.length)?M(0):_(n)}function E(n){if(n>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|n}function g(n,s){if(u.isBuffer(n))return n.length;if(ArrayBuffer.isView(n)||V(n,ArrayBuffer))return n.byteLength;if(typeof n!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof n);var l=n.length,R=2<arguments.length&&arguments[2]===!0;if(!R&&l===0)return 0;for(var Y=!1;;)switch(s){case"ascii":case"latin1":case"binary":return l;case"utf8":case"utf-8":return Kt(n).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*l;case"hex":return l>>>1;case"base64":return nt(n).length;default:if(Y)return R?-1:Kt(n).length;s=(""+s).toLowerCase(),Y=!0}}function T(n,s,l){var R=!1;if((s===void 0||0>s)&&(s=0),s>this.length||((l===void 0||l>this.length)&&(l=this.length),0>=l)||(l>>>=0,s>>>=0,l<=s))return"";for(n||(n="utf8");;)switch(n){case"hex":return qt(this,s,l);case"utf8":case"utf-8":return Nt(this,s,l);case"ascii":return _t(this,s,l);case"latin1":case"binary":return ee(this,s,l);case"base64":return kt(this,s,l);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ut(this,s,l);default:if(R)throw new TypeError("Unknown encoding: "+n);n=(n+"").toLowerCase(),R=!0}}function w(n,s,l){var R=n[s];n[s]=n[l],n[l]=R}function A(n,s,l,R,Y){if(n.length===0)return-1;if(typeof l=="string"?(R=l,l=0):2147483647<l?l=2147483647:-2147483648>l&&(l=-2147483648),l=+l,v(l)&&(l=Y?0:n.length-1),0>l&&(l=n.length+l),l>=n.length){if(Y)return-1;l=n.length-1}else if(0>l)if(Y)l=0;else return-1;if(typeof s=="string"&&(s=u.from(s,R)),u.isBuffer(s))return s.length===0?-1:z(n,s,l,R,Y);if(typeof s=="number")return s&=255,typeof Uint8Array.prototype.indexOf=="function"?Y?Uint8Array.prototype.indexOf.call(n,s,l):Uint8Array.prototype.lastIndexOf.call(n,s,l):z(n,[s],l,R,Y);throw new TypeError("val must be string, number or Buffer")}function z(n,s,l,R,Y){function J(q,ot){return at===1?q[ot]:q.readUInt16BE(ot*at)}var at=1,Rt=n.length,zt=s.length;if(R!==void 0&&(R=(R+"").toLowerCase(),R==="ucs2"||R==="ucs-2"||R==="utf16le"||R==="utf-16le")){if(2>n.length||2>s.length)return-1;at=2,Rt/=2,zt/=2,l/=2}var Ut;if(Y){var Lt=-1;for(Ut=l;Ut<Rt;Ut++)if(J(n,Ut)!==J(s,Lt===-1?0:Ut-Lt))Lt!==-1&&(Ut-=Ut-Lt),Lt=-1;else if(Lt===-1&&(Lt=Ut),Ut-Lt+1===zt)return Lt*at}else for(l+zt>Rt&&(l=Rt-zt),Ut=l;0<=Ut;Ut--){for(var jt=!0,ie=0;ie<zt;ie++)if(J(n,Ut+ie)!==J(s,ie)){jt=!1;break}if(jt)return Ut}return-1}function L(n,s,l,R){l=+l||0;var Y=n.length-l;R?(R=+R,R>Y&&(R=Y)):R=Y;var J=s.length;R>J/2&&(R=J/2);for(var at,Rt=0;Rt<R;++Rt){if(at=parseInt(s.substr(2*Rt,2),16),v(at))return Rt;n[l+Rt]=at}return Rt}function P(n,s,l,R){return vt(Kt(s,n.length-l),n,l,R)}function Q(n,s,l,R){return vt(Jt(s),n,l,R)}function lt(n,s,l,R){return Q(n,s,l,R)}function wt(n,s,l,R){return vt(nt(s),n,l,R)}function Ct(n,s,l,R){return vt(G(s,n.length-l),n,l,R)}function kt(n,s,l){return s===0&&l===n.length?D.fromByteArray(n):D.fromByteArray(n.slice(s,l))}function Nt(n,s,l){l=O(n.length,l);for(var R=[],Y=s;Y<l;){var J=n[Y],at=null,Rt=239<J?4:223<J?3:191<J?2:1;if(Y+Rt<=l){var zt,Ut,Lt,jt;Rt===1?128>J&&(at=J):Rt===2?(zt=n[Y+1],(192&zt)==128&&(jt=(31&J)<<6|63&zt,127<jt&&(at=jt))):Rt===3?(zt=n[Y+1],Ut=n[Y+2],(192&zt)==128&&(192&Ut)==128&&(jt=(15&J)<<12|(63&zt)<<6|63&Ut,2047<jt&&(55296>jt||57343<jt)&&(at=jt))):Rt===4&&(zt=n[Y+1],Ut=n[Y+2],Lt=n[Y+3],(192&zt)==128&&(192&Ut)==128&&(192&Lt)==128&&(jt=(15&J)<<18|(63&zt)<<12|(63&Ut)<<6|63&Lt,65535<jt&&1114112>jt&&(at=jt)))}at===null?(at=65533,Rt=1):65535<at&&(at-=65536,R.push(55296|1023&at>>>10),at=56320|1023&at),R.push(at),Y+=Rt}return xt(R)}function xt(n){var s=n.length;if(s<=4096)return h.apply(String,n);for(var l="",R=0;R<s;)l+=h.apply(String,n.slice(R,R+=4096));return l}function _t(n,s,l){var R="";l=O(n.length,l);for(var Y=s;Y<l;++Y)R+=h(127&n[Y]);return R}function ee(n,s,l){var R="";l=O(n.length,l);for(var Y=s;Y<l;++Y)R+=h(n[Y]);return R}function qt(n,s,l){var R=n.length;(!s||0>s)&&(s=0),(!l||0>l||l>R)&&(l=R);for(var Y="",J=s;J<l;++J)Y+=Qt(n[J]);return Y}function ut(n,s,l){for(var R=n.slice(s,l),Y="",J=0;J<R.length;J+=2)Y+=h(R[J]+256*R[J+1]);return Y}function st(n,s,l){if(n%1!=0||0>n)throw new RangeError("offset is not uint");if(n+s>l)throw new RangeError("Trying to access beyond buffer length")}function dt(n,s,l,R,Y,J){if(!u.isBuffer(n))throw new TypeError('"buffer" argument must be a Buffer instance');if(s>Y||s<J)throw new RangeError('"value" argument is out of bounds');if(l+R>n.length)throw new RangeError("Index out of range")}function mt(n,s,l,R){if(l+R>n.length)throw new RangeError("Index out of range");if(0>l)throw new RangeError("Index out of range")}function Tt(n,s,l,R,Y){return s=+s,l>>>=0,Y||mt(n,s,l,4,34028234663852886e22,-34028234663852886e22),tt.write(n,s,l,R,23,4),l+4}function Dt(n,s,l,R,Y){return s=+s,l>>>=0,Y||mt(n,s,l,8,17976931348623157e292,-17976931348623157e292),tt.write(n,s,l,R,52,8),l+8}function Ht(n){if(n=n.split("=")[0],n=n.trim().replace(pt,""),2>n.length)return"";for(;n.length%4!=0;)n+="=";return n}function Qt(n){return 16>n?"0"+n.toString(16):n.toString(16)}function Kt(n,s){s=s||1/0;for(var l,R=n.length,Y=null,J=[],at=0;at<R;++at){if(l=n.charCodeAt(at),55295<l&&57344>l){if(!Y){if(56319<l){-1<(s-=3)&&J.push(239,191,189);continue}else if(at+1===R){-1<(s-=3)&&J.push(239,191,189);continue}Y=l;continue}if(56320>l){-1<(s-=3)&&J.push(239,191,189),Y=l;continue}l=(Y-55296<<10|l-56320)+65536}else Y&&-1<(s-=3)&&J.push(239,191,189);if(Y=null,128>l){if(0>(s-=1))break;J.push(l)}else if(2048>l){if(0>(s-=2))break;J.push(192|l>>6,128|63&l)}else if(65536>l){if(0>(s-=3))break;J.push(224|l>>12,128|63&l>>6,128|63&l)}else if(1114112>l){if(0>(s-=4))break;J.push(240|l>>18,128|63&l>>12,128|63&l>>6,128|63&l)}else throw new Error("Invalid code point")}return J}function Jt(n){for(var s=[],l=0;l<n.length;++l)s.push(255&n.charCodeAt(l));return s}function G(n,s){for(var l,R,Y,J=[],at=0;at<n.length&&!(0>(s-=2));++at)l=n.charCodeAt(at),R=l>>8,Y=l%256,J.push(Y),J.push(R);return J}function nt(n){return D.toByteArray(Ht(n))}function vt(n,s,l,R){for(var Y=0;Y<R&&!(Y+l>=s.length||Y>=n.length);++Y)s[Y+l]=n[Y];return Y}function V(n,s){return n instanceof s||n!=null&&n.constructor!=null&&n.constructor.name!=null&&n.constructor.name===s.name}function v(n){return n!==n}var D=x("base64-js"),tt=x("ieee754");m.Buffer=u,m.SlowBuffer=function(n){return+n!=n&&(n=0),u.alloc(+n)},m.INSPECT_MAX_BYTES=50,m.kMaxLength=2147483647,u.TYPED_ARRAY_SUPPORT=function(){try{var n=new Uint8Array(1);return n.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},n.foo()===42}catch(s){return!1}}(),u.TYPED_ARRAY_SUPPORT||typeof console=="undefined"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){return u.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){return u.isBuffer(this)?this.byteOffset:void 0}}),typeof Symbol!="undefined"&&Symbol.species!=null&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),u.poolSize=8192,u.from=function(n,s,l){return y(n,s,l)},u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,u.alloc=function(n,s,l){return d(n,s,l)},u.allocUnsafe=function(n){return j(n)},u.allocUnsafeSlow=function(n){return j(n)},u.isBuffer=function(n){return n!=null&&n._isBuffer===!0&&n!==u.prototype},u.compare=function(n,s){if(V(n,Uint8Array)&&(n=u.from(n,n.offset,n.byteLength)),V(s,Uint8Array)&&(s=u.from(s,s.offset,s.byteLength)),!u.isBuffer(n)||!u.isBuffer(s))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(n===s)return 0;for(var l=n.length,R=s.length,Y=0,J=O(l,R);Y<J;++Y)if(n[Y]!==s[Y]){l=n[Y],R=s[Y];break}return l<R?-1:R<l?1:0},u.isEncoding=function(n){switch((n+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(n,s){if(!Array.isArray(n))throw new TypeError('"list" argument must be an Array of Buffers');if(n.length===0)return u.alloc(0);var l;if(s===void 0)for(s=0,l=0;l<n.length;++l)s+=n[l].length;var R=u.allocUnsafe(s),Y=0;for(l=0;l<n.length;++l){var J=n[l];if(V(J,Uint8Array)&&(J=u.from(J)),!u.isBuffer(J))throw new TypeError('"list" argument must be an Array of Buffers');J.copy(R,Y),Y+=J.length}return R},u.byteLength=g,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var n=this.length;if(n%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var s=0;s<n;s+=2)w(this,s,s+1);return this},u.prototype.swap32=function(){var n=this.length;if(n%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var s=0;s<n;s+=4)w(this,s,s+3),w(this,s+1,s+2);return this},u.prototype.swap64=function(){var n=this.length;if(n%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var s=0;s<n;s+=8)w(this,s,s+7),w(this,s+1,s+6),w(this,s+2,s+5),w(this,s+3,s+4);return this},u.prototype.toString=function(){var n=this.length;return n===0?"":arguments.length===0?Nt(this,0,n):T.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(n){if(!u.isBuffer(n))throw new TypeError("Argument must be a Buffer");return this===n||u.compare(this,n)===0},u.prototype.inspect=function(){var n="",s=m.INSPECT_MAX_BYTES;return n=this.toString("hex",0,s).replace(/(.{2})/g,"$1 ").trim(),this.length>s&&(n+=" ... "),"<Buffer "+n+">"},u.prototype.compare=function(n,s,l,R,Y){if(V(n,Uint8Array)&&(n=u.from(n,n.offset,n.byteLength)),!u.isBuffer(n))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof n);if(s===void 0&&(s=0),l===void 0&&(l=n?n.length:0),R===void 0&&(R=0),Y===void 0&&(Y=this.length),0>s||l>n.length||0>R||Y>this.length)throw new RangeError("out of range index");if(R>=Y&&s>=l)return 0;if(R>=Y)return-1;if(s>=l)return 1;if(s>>>=0,l>>>=0,R>>>=0,Y>>>=0,this===n)return 0;for(var J=Y-R,at=l-s,Rt=O(J,at),zt=this.slice(R,Y),Ut=n.slice(s,l),Lt=0;Lt<Rt;++Lt)if(zt[Lt]!==Ut[Lt]){J=zt[Lt],at=Ut[Lt];break}return J<at?-1:at<J?1:0},u.prototype.includes=function(n,s,l){return this.indexOf(n,s,l)!==-1},u.prototype.indexOf=function(n,s,l){return A(this,n,s,l,!0)},u.prototype.lastIndexOf=function(n,s,l){return A(this,n,s,l,!1)},u.prototype.write=function(n,s,l,R){if(s===void 0)R="utf8",l=this.length,s=0;else if(l===void 0&&typeof s=="string")R=s,l=this.length,s=0;else if(isFinite(s))s>>>=0,isFinite(l)?(l>>>=0,R===void 0&&(R="utf8")):(R=l,l=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var Y=this.length-s;if((l===void 0||l>Y)&&(l=Y),0<n.length&&(0>l||0>s)||s>this.length)throw new RangeError("Attempt to write outside buffer bounds");R||(R="utf8");for(var J=!1;;)switch(R){case"hex":return L(this,n,s,l);case"utf8":case"utf-8":return P(this,n,s,l);case"ascii":return Q(this,n,s,l);case"latin1":case"binary":return lt(this,n,s,l);case"base64":return wt(this,n,s,l);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ct(this,n,s,l);default:if(J)throw new TypeError("Unknown encoding: "+R);R=(""+R).toLowerCase(),J=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},u.prototype.slice=function(n,s){var l=this.length;n=~~n,s=s===void 0?l:~~s,0>n?(n+=l,0>n&&(n=0)):n>l&&(n=l),0>s?(s+=l,0>s&&(s=0)):s>l&&(s=l),s<n&&(s=n);var R=this.subarray(n,s);return R.__proto__=u.prototype,R},u.prototype.readUIntLE=function(n,s,l){n>>>=0,s>>>=0,l||st(n,s,this.length);for(var R=this[n],Y=1,J=0;++J<s&&(Y*=256);)R+=this[n+J]*Y;return R},u.prototype.readUIntBE=function(n,s,l){n>>>=0,s>>>=0,l||st(n,s,this.length);for(var R=this[n+--s],Y=1;0<s&&(Y*=256);)R+=this[n+--s]*Y;return R},u.prototype.readUInt8=function(n,s){return n>>>=0,s||st(n,1,this.length),this[n]},u.prototype.readUInt16LE=function(n,s){return n>>>=0,s||st(n,2,this.length),this[n]|this[n+1]<<8},u.prototype.readUInt16BE=function(n,s){return n>>>=0,s||st(n,2,this.length),this[n]<<8|this[n+1]},u.prototype.readUInt32LE=function(n,s){return n>>>=0,s||st(n,4,this.length),(this[n]|this[n+1]<<8|this[n+2]<<16)+16777216*this[n+3]},u.prototype.readUInt32BE=function(n,s){return n>>>=0,s||st(n,4,this.length),16777216*this[n]+(this[n+1]<<16|this[n+2]<<8|this[n+3])},u.prototype.readIntLE=function(n,s,l){n>>>=0,s>>>=0,l||st(n,s,this.length);for(var R=this[n],Y=1,J=0;++J<s&&(Y*=256);)R+=this[n+J]*Y;return Y*=128,R>=Y&&(R-=Z(2,8*s)),R},u.prototype.readIntBE=function(n,s,l){n>>>=0,s>>>=0,l||st(n,s,this.length);for(var R=s,Y=1,J=this[n+--R];0<R&&(Y*=256);)J+=this[n+--R]*Y;return Y*=128,J>=Y&&(J-=Z(2,8*s)),J},u.prototype.readInt8=function(n,s){return n>>>=0,s||st(n,1,this.length),128&this[n]?-1*(255-this[n]+1):this[n]},u.prototype.readInt16LE=function(n,s){n>>>=0,s||st(n,2,this.length);var l=this[n]|this[n+1]<<8;return 32768&l?4294901760|l:l},u.prototype.readInt16BE=function(n,s){n>>>=0,s||st(n,2,this.length);var l=this[n+1]|this[n]<<8;return 32768&l?4294901760|l:l},u.prototype.readInt32LE=function(n,s){return n>>>=0,s||st(n,4,this.length),this[n]|this[n+1]<<8|this[n+2]<<16|this[n+3]<<24},u.prototype.readInt32BE=function(n,s){return n>>>=0,s||st(n,4,this.length),this[n]<<24|this[n+1]<<16|this[n+2]<<8|this[n+3]},u.prototype.readFloatLE=function(n,s){return n>>>=0,s||st(n,4,this.length),tt.read(this,n,!0,23,4)},u.prototype.readFloatBE=function(n,s){return n>>>=0,s||st(n,4,this.length),tt.read(this,n,!1,23,4)},u.prototype.readDoubleLE=function(n,s){return n>>>=0,s||st(n,8,this.length),tt.read(this,n,!0,52,8)},u.prototype.readDoubleBE=function(n,s){return n>>>=0,s||st(n,8,this.length),tt.read(this,n,!1,52,8)},u.prototype.writeUIntLE=function(n,s,l,R){if(n=+n,s>>>=0,l>>>=0,!R){var Y=Z(2,8*l)-1;dt(this,n,s,l,Y,0)}var J=1,at=0;for(this[s]=255&n;++at<l&&(J*=256);)this[s+at]=255&n/J;return s+l},u.prototype.writeUIntBE=function(n,s,l,R){if(n=+n,s>>>=0,l>>>=0,!R){var Y=Z(2,8*l)-1;dt(this,n,s,l,Y,0)}var J=l-1,at=1;for(this[s+J]=255&n;0<=--J&&(at*=256);)this[s+J]=255&n/at;return s+l},u.prototype.writeUInt8=function(n,s,l){return n=+n,s>>>=0,l||dt(this,n,s,1,255,0),this[s]=255&n,s+1},u.prototype.writeUInt16LE=function(n,s,l){return n=+n,s>>>=0,l||dt(this,n,s,2,65535,0),this[s]=255&n,this[s+1]=n>>>8,s+2},u.prototype.writeUInt16BE=function(n,s,l){return n=+n,s>>>=0,l||dt(this,n,s,2,65535,0),this[s]=n>>>8,this[s+1]=255&n,s+2},u.prototype.writeUInt32LE=function(n,s,l){return n=+n,s>>>=0,l||dt(this,n,s,4,4294967295,0),this[s+3]=n>>>24,this[s+2]=n>>>16,this[s+1]=n>>>8,this[s]=255&n,s+4},u.prototype.writeUInt32BE=function(n,s,l){return n=+n,s>>>=0,l||dt(this,n,s,4,4294967295,0),this[s]=n>>>24,this[s+1]=n>>>16,this[s+2]=n>>>8,this[s+3]=255&n,s+4},u.prototype.writeIntLE=function(n,s,l,R){if(n=+n,s>>>=0,!R){var Y=Z(2,8*l-1);dt(this,n,s,l,Y-1,-Y)}var J=0,at=1,Rt=0;for(this[s]=255&n;++J<l&&(at*=256);)0>n&&Rt===0&&this[s+J-1]!==0&&(Rt=1),this[s+J]=255&(n/at>>0)-Rt;return s+l},u.prototype.writeIntBE=function(n,s,l,R){if(n=+n,s>>>=0,!R){var Y=Z(2,8*l-1);dt(this,n,s,l,Y-1,-Y)}var J=l-1,at=1,Rt=0;for(this[s+J]=255&n;0<=--J&&(at*=256);)0>n&&Rt===0&&this[s+J+1]!==0&&(Rt=1),this[s+J]=255&(n/at>>0)-Rt;return s+l},u.prototype.writeInt8=function(n,s,l){return n=+n,s>>>=0,l||dt(this,n,s,1,127,-128),0>n&&(n=255+n+1),this[s]=255&n,s+1},u.prototype.writeInt16LE=function(n,s,l){return n=+n,s>>>=0,l||dt(this,n,s,2,32767,-32768),this[s]=255&n,this[s+1]=n>>>8,s+2},u.prototype.writeInt16BE=function(n,s,l){return n=+n,s>>>=0,l||dt(this,n,s,2,32767,-32768),this[s]=n>>>8,this[s+1]=255&n,s+2},u.prototype.writeInt32LE=function(n,s,l){return n=+n,s>>>=0,l||dt(this,n,s,4,2147483647,-2147483648),this[s]=255&n,this[s+1]=n>>>8,this[s+2]=n>>>16,this[s+3]=n>>>24,s+4},u.prototype.writeInt32BE=function(n,s,l){return n=+n,s>>>=0,l||dt(this,n,s,4,2147483647,-2147483648),0>n&&(n=4294967295+n+1),this[s]=n>>>24,this[s+1]=n>>>16,this[s+2]=n>>>8,this[s+3]=255&n,s+4},u.prototype.writeFloatLE=function(n,s,l){return Tt(this,n,s,!0,l)},u.prototype.writeFloatBE=function(n,s,l){return Tt(this,n,s,!1,l)},u.prototype.writeDoubleLE=function(n,s,l){return Dt(this,n,s,!0,l)},u.prototype.writeDoubleBE=function(n,s,l){return Dt(this,n,s,!1,l)},u.prototype.copy=function(n,s,l,R){if(!u.isBuffer(n))throw new TypeError("argument should be a Buffer");if(l||(l=0),R||R===0||(R=this.length),s>=n.length&&(s=n.length),s||(s=0),0<R&&R<l&&(R=l),R===l||n.length===0||this.length===0)return 0;if(0>s)throw new RangeError("targetStart out of bounds");if(0>l||l>=this.length)throw new RangeError("Index out of range");if(0>R)throw new RangeError("sourceEnd out of bounds");R>this.length&&(R=this.length),n.length-s<R-l&&(R=n.length-s+l);var Y=R-l;if(this===n&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(s,l,R);else if(this===n&&l<s&&s<R)for(var J=Y-1;0<=J;--J)n[J+s]=this[J+l];else Uint8Array.prototype.set.call(n,this.subarray(l,R),s);return Y},u.prototype.fill=function(n,s,l,R){if(typeof n=="string"){if(typeof s=="string"?(R=s,s=0,l=this.length):typeof l=="string"&&(R=l,l=this.length),R!==void 0&&typeof R!="string")throw new TypeError("encoding must be a string");if(typeof R=="string"&&!u.isEncoding(R))throw new TypeError("Unknown encoding: "+R);if(n.length===1){var Y=n.charCodeAt(0);(R==="utf8"&&128>Y||R==="latin1")&&(n=Y)}}else typeof n=="number"&&(n&=255);if(0>s||this.length<s||this.length<l)throw new RangeError("Out of range index");if(l<=s)return this;s>>>=0,l=l===void 0?this.length:l>>>0,n||(n=0);var J;if(typeof n=="number")for(J=s;J<l;++J)this[J]=n;else{var at=u.isBuffer(n)?n:u.from(n,R),Rt=at.length;if(Rt===0)throw new TypeError('The value "'+n+'" is invalid for argument "value"');for(J=0;J<l-s;++J)this[J+s]=at[J%Rt]}return this};var pt=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,x("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:9}],4:[function(x,C,m){(function(h){(function(){function O(){let u;try{u=m.storage.getItem("debug")}catch(y){}return!u&&typeof h!="undefined"&&"env"in h&&(u=h.env.DEBUG),u}m.formatArgs=function(u){if(u[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+u[0]+(this.useColors?"%c ":" ")+"+"+C.exports.humanize(this.diff),!this.useColors)return;const y="color: "+this.color;u.splice(1,0,y,"color: inherit");let p=0,d=0;u[0].replace(/%[a-zA-Z%]/g,j=>{j==="%%"||(p++,j==="%c"&&(d=p))}),u.splice(d,0,y)},m.save=function(u){try{u?m.storage.setItem("debug",u):m.storage.removeItem("debug")}catch(y){}},m.load=O,m.useColors=function(){return!!(typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))||!(typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},m.storage=function(){try{return localStorage}catch(u){}}(),m.destroy=(()=>{let u=!1;return()=>{u||(u=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),m.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],m.log=console.debug||console.log||(()=>{}),C.exports=x("./common")(m);const{formatters:M}=C.exports;M.j=function(u){try{return JSON.stringify(u)}catch(y){return"[UnexpectedJSONParseError]: "+y.message}}}).call(this)}).call(this,x("_process"))},{"./common":5,_process:12}],5:[function(x,C){C.exports=function(m){function h(u){function y(...j){if(!y.enabled)return;const k=y,_=+new Date,I=_-(p||_);k.diff=I,k.prev=p,k.curr=_,p=_,j[0]=h.coerce(j[0]),typeof j[0]!="string"&&j.unshift("%O");let a=0;j[0]=j[0].replace(/%([a-zA-Z%])/g,(g,T)=>{if(g==="%%")return"%";a++;const w=h.formatters[T];if(typeof w=="function"){const A=j[a];g=w.call(k,A),j.splice(a,1),a--}return g}),h.formatArgs.call(k,j),(k.log||h.log).apply(k,j)}let p,d=null;return y.namespace=u,y.useColors=h.useColors(),y.color=h.selectColor(u),y.extend=O,y.destroy=h.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:()=>d===null?h.enabled(u):d,set:j=>{d=j}}),typeof h.init=="function"&&h.init(y),y}function O(u,y){const p=h(this.namespace+(typeof y=="undefined"?":":y)+u);return p.log=this.log,p}function M(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}return h.debug=h,h.default=h,h.coerce=function(u){return u instanceof Error?u.stack||u.message:u},h.disable=function(){const u=[...h.names.map(M),...h.skips.map(M).map(y=>"-"+y)].join(",");return h.enable(""),u},h.enable=function(u){h.save(u),h.names=[],h.skips=[];let y;const p=(typeof u=="string"?u:"").split(/[\s,]+/),d=p.length;for(y=0;y<d;y++)p[y]&&(u=p[y].replace(/\*/g,".*?"),u[0]==="-"?h.skips.push(new RegExp("^"+u.substr(1)+"$")):h.names.push(new RegExp("^"+u+"$")))},h.enabled=function(u){if(u[u.length-1]==="*")return!0;let y,p;for(y=0,p=h.skips.length;y<p;y++)if(h.skips[y].test(u))return!1;for(y=0,p=h.names.length;y<p;y++)if(h.names[y].test(u))return!0;return!1},h.humanize=x("ms"),h.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(m).forEach(u=>{h[u]=m[u]}),h.names=[],h.skips=[],h.formatters={},h.selectColor=function(u){let y=0;for(let p=0;p<u.length;p++)y=(y<<5)-y+u.charCodeAt(p),y|=0;return h.colors[it(y)%h.colors.length]},h.enable(h.load()),h}},{ms:11}],6:[function(x,C){"use strict";function m(h,O){for(const M in O)Object.defineProperty(h,M,{value:O[M],enumerable:!0,configurable:!0});return h}C.exports=function(h,O,M){if(!h||typeof h=="string")throw new TypeError("Please pass an Error to err-code");M||(M={}),typeof O=="object"&&(M=O,O=""),O&&(M.code=O);try{return m(h,M)}catch(u){M.message=h.message,M.stack=h.stack;const y=function(){};return y.prototype=Object.create(Object.getPrototypeOf(h)),m(new y,M)}}},{}],7:[function(x,C){"use strict";function m(L){console&&console.warn&&console.warn(L)}function h(){h.init.call(this)}function O(L){if(typeof L!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof L)}function M(L){return L._maxListeners===void 0?h.defaultMaxListeners:L._maxListeners}function u(L,P,Q,lt){var wt,Ct,kt;if(O(Q),Ct=L._events,Ct===void 0?(Ct=L._events=Object.create(null),L._eventsCount=0):(Ct.newListener!==void 0&&(L.emit("newListener",P,Q.listener?Q.listener:Q),Ct=L._events),kt=Ct[P]),kt===void 0)kt=Ct[P]=Q,++L._eventsCount;else if(typeof kt=="function"?kt=Ct[P]=lt?[Q,kt]:[kt,Q]:lt?kt.unshift(Q):kt.push(Q),wt=M(L),0<wt&&kt.length>wt&&!kt.warned){kt.warned=!0;var Nt=new Error("Possible EventEmitter memory leak detected. "+kt.length+" "+(P+" listeners added. Use emitter.setMaxListeners() to increase limit"));Nt.name="MaxListenersExceededWarning",Nt.emitter=L,Nt.type=P,Nt.count=kt.length,m(Nt)}return L}function y(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(L,P,Q){var lt={fired:!1,wrapFn:void 0,target:L,type:P,listener:Q},wt=y.bind(lt);return wt.listener=Q,lt.wrapFn=wt,wt}function d(L,P,Q){var lt=L._events;if(lt===void 0)return[];var wt=lt[P];return wt===void 0?[]:typeof wt=="function"?Q?[wt.listener||wt]:[wt]:Q?I(wt):k(wt,wt.length)}function j(L){var P=this._events;if(P!==void 0){var Q=P[L];if(typeof Q=="function")return 1;if(Q!==void 0)return Q.length}return 0}function k(L,P){for(var Q=Array(P),lt=0;lt<P;++lt)Q[lt]=L[lt];return Q}function _(L,P){for(;P+1<L.length;P++)L[P]=L[P+1];L.pop()}function I(L){for(var P=Array(L.length),Q=0;Q<P.length;++Q)P[Q]=L[Q].listener||L[Q];return P}function a(L,P,Q){typeof L.on=="function"&&E(L,"error",P,Q)}function E(L,P,Q,lt){if(typeof L.on=="function")lt.once?L.once(P,Q):L.on(P,Q);else if(typeof L.addEventListener=="function")L.addEventListener(P,function wt(Ct){lt.once&&L.removeEventListener(P,wt),Q(Ct)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof L)}var g,T=typeof Reflect=="object"?Reflect:null,w=T&&typeof T.apply=="function"?T.apply:function(L,P,Q){return Function.prototype.apply.call(L,P,Q)};g=T&&typeof T.ownKeys=="function"?T.ownKeys:Object.getOwnPropertySymbols?function(L){return Object.getOwnPropertyNames(L).concat(Object.getOwnPropertySymbols(L))}:function(L){return Object.getOwnPropertyNames(L)};var A=Number.isNaN||function(L){return L!==L};C.exports=h,C.exports.once=function(L,P){return new Promise(function(Q,lt){function wt(kt){L.removeListener(P,Ct),lt(kt)}function Ct(){typeof L.removeListener=="function"&&L.removeListener("error",wt),Q([].slice.call(arguments))}E(L,P,Ct,{once:!0}),P!=="error"&&a(L,wt,{once:!0})})},h.EventEmitter=h,h.prototype._events=void 0,h.prototype._eventsCount=0,h.prototype._maxListeners=void 0;var z=10;Object.defineProperty(h,"defaultMaxListeners",{enumerable:!0,get:function(){return z},set:function(L){if(typeof L!="number"||0>L||A(L))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+L+".");z=L}}),h.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},h.prototype.setMaxListeners=function(L){if(typeof L!="number"||0>L||A(L))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+L+".");return this._maxListeners=L,this},h.prototype.getMaxListeners=function(){return M(this)},h.prototype.emit=function(L){for(var P=[],Q=1;Q<arguments.length;Q++)P.push(arguments[Q]);var lt=L==="error",wt=this._events;if(wt!==void 0)lt=lt&&wt.error===void 0;else if(!lt)return!1;if(lt){var Ct;if(0<P.length&&(Ct=P[0]),Ct instanceof Error)throw Ct;var kt=new Error("Unhandled error."+(Ct?" ("+Ct.message+")":""));throw kt.context=Ct,kt}var Nt=wt[L];if(Nt===void 0)return!1;if(typeof Nt=="function")w(Nt,this,P);else for(var xt=Nt.length,_t=k(Nt,xt),Q=0;Q<xt;++Q)w(_t[Q],this,P);return!0},h.prototype.addListener=function(L,P){return u(this,L,P,!1)},h.prototype.on=h.prototype.addListener,h.prototype.prependListener=function(L,P){return u(this,L,P,!0)},h.prototype.once=function(L,P){return O(P),this.on(L,p(this,L,P)),this},h.prototype.prependOnceListener=function(L,P){return O(P),this.prependListener(L,p(this,L,P)),this},h.prototype.removeListener=function(L,P){var Q,lt,wt,Ct,kt;if(O(P),lt=this._events,lt===void 0)return this;if(Q=lt[L],Q===void 0)return this;if(Q===P||Q.listener===P)--this._eventsCount==0?this._events=Object.create(null):(delete lt[L],lt.removeListener&&this.emit("removeListener",L,Q.listener||P));else if(typeof Q!="function"){for(wt=-1,Ct=Q.length-1;0<=Ct;Ct--)if(Q[Ct]===P||Q[Ct].listener===P){kt=Q[Ct].listener,wt=Ct;break}if(0>wt)return this;wt===0?Q.shift():_(Q,wt),Q.length===1&&(lt[L]=Q[0]),lt.removeListener!==void 0&&this.emit("removeListener",L,kt||P)}return this},h.prototype.off=h.prototype.removeListener,h.prototype.removeAllListeners=function(L){var P,Q,lt;if(Q=this._events,Q===void 0)return this;if(Q.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):Q[L]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete Q[L]),this;if(arguments.length===0){var wt,Ct=Object.keys(Q);for(lt=0;lt<Ct.length;++lt)wt=Ct[lt],wt!=="removeListener"&&this.removeAllListeners(wt);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(P=Q[L],typeof P=="function")this.removeListener(L,P);else if(P!==void 0)for(lt=P.length-1;0<=lt;lt--)this.removeListener(L,P[lt]);return this},h.prototype.listeners=function(L){return d(this,L,!0)},h.prototype.rawListeners=function(L){return d(this,L,!1)},h.listenerCount=function(L,P){return typeof L.listenerCount=="function"?L.listenerCount(P):j.call(L,P)},h.prototype.listenerCount=j,h.prototype.eventNames=function(){return 0<this._eventsCount?g(this._events):[]}},{}],8:[function(x,C){C.exports=function(){if(typeof globalThis=="undefined")return null;var m={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return m.RTCPeerConnection?m:null}},{}],9:[function(x,C,m){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */m.read=function(h,O,M,u,y){var p,d,j=8*y-u-1,k=(1<<j)-1,_=k>>1,I=-7,a=M?y-1:0,E=M?-1:1,g=h[O+a];for(a+=E,p=g&(1<<-I)-1,g>>=-I,I+=j;0<I;p=256*p+h[O+a],a+=E,I-=8);for(d=p&(1<<-I)-1,p>>=-I,I+=u;0<I;d=256*d+h[O+a],a+=E,I-=8);if(p===0)p=1-_;else{if(p===k)return d?NaN:(g?-1:1)*(1/0);d+=Z(2,u),p-=_}return(g?-1:1)*d*Z(2,p-u)},m.write=function(h,O,M,u,y,p){var d,j,k,_=Math.LN2,I=Math.log,a=8*p-y-1,E=(1<<a)-1,g=E>>1,T=y===23?Z(2,-24)-Z(2,-77):0,w=u?0:p-1,A=u?1:-1,z=0>O||O===0&&0>1/O?1:0;for(O=it(O),isNaN(O)||O===1/0?(j=isNaN(O)?1:0,d=E):(d=et(I(O)/_),1>O*(k=Z(2,-d))&&(d--,k*=2),O+=1<=d+g?T/k:T*Z(2,1-g),2<=O*k&&(d++,k/=2),d+g>=E?(j=0,d=E):1<=d+g?(j=(O*k-1)*Z(2,y),d+=g):(j=O*Z(2,g-1)*Z(2,y),d=0));8<=y;h[M+w]=255&j,w+=A,j/=256,y-=8);for(d=d<<y|j,a+=y;0<a;h[M+w]=255&d,w+=A,d/=256,a-=8);h[M+w-A]|=128*z}},{}],10:[function(x,C){C.exports=typeof Object.create=="function"?function(m,h){h&&(m.super_=h,m.prototype=Object.create(h.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}))}:function(m,h){if(h){m.super_=h;var O=function(){};O.prototype=h.prototype,m.prototype=new O,m.prototype.constructor=m}}},{}],11:[function(x,C){var m=Math.round;function h(p){if(p+="",!(100<p.length)){var d=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(p);if(d){var j=parseFloat(d[1]),k=(d[2]||"ms").toLowerCase();return k==="years"||k==="year"||k==="yrs"||k==="yr"||k==="y"?315576e5*j:k==="weeks"||k==="week"||k==="w"?6048e5*j:k==="days"||k==="day"||k==="d"?864e5*j:k==="hours"||k==="hour"||k==="hrs"||k==="hr"||k==="h"?36e5*j:k==="minutes"||k==="minute"||k==="mins"||k==="min"||k==="m"?6e4*j:k==="seconds"||k==="second"||k==="secs"||k==="sec"||k==="s"?1e3*j:k==="milliseconds"||k==="millisecond"||k==="msecs"||k==="msec"||k==="ms"?j:void 0}}}function O(p){var d=it(p);return 864e5<=d?m(p/864e5)+"d":36e5<=d?m(p/36e5)+"h":6e4<=d?m(p/6e4)+"m":1e3<=d?m(p/1e3)+"s":p+"ms"}function M(p){var d=it(p);return 864e5<=d?u(p,d,864e5,"day"):36e5<=d?u(p,d,36e5,"hour"):6e4<=d?u(p,d,6e4,"minute"):1e3<=d?u(p,d,1e3,"second"):p+" ms"}function u(p,d,j,k){return m(p/j)+" "+k+(d>=1.5*j?"s":"")}var y=24*(60*6e4);C.exports=function(p,d){d=d||{};var j=typeof p;if(j=="string"&&0<p.length)return h(p);if(j==="number"&&isFinite(p))return d.long?M(p):O(p);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(p))}},{}],12:[function(x,C){function m(){throw new Error("setTimeout has not been defined")}function h(){throw new Error("clearTimeout has not been defined")}function O(T){if(j===setTimeout)return setTimeout(T,0);if((j===m||!j)&&setTimeout)return j=setTimeout,setTimeout(T,0);try{return j(T,0)}catch(w){try{return j.call(null,T,0)}catch(A){return j.call(this,T,0)}}}function M(T){if(k===clearTimeout)return clearTimeout(T);if((k===h||!k)&&clearTimeout)return k=clearTimeout,clearTimeout(T);try{return k(T)}catch(w){try{return k.call(null,T)}catch(A){return k.call(this,T)}}}function u(){E&&I&&(E=!1,I.length?a=I.concat(a):g=-1,a.length&&y())}function y(){if(!E){var T=O(u);E=!0;for(var w=a.length;w;){for(I=a,a=[];++g<w;)I&&I[g].run();g=-1,w=a.length}I=null,E=!1,M(T)}}function p(T,w){this.fun=T,this.array=w}function d(){}var j,k,_=C.exports={};(function(){try{j=typeof setTimeout=="function"?setTimeout:m}catch(T){j=m}try{k=typeof clearTimeout=="function"?clearTimeout:h}catch(T){k=h}})();var I,a=[],E=!1,g=-1;_.nextTick=function(T){var w=Array(arguments.length-1);if(1<arguments.length)for(var A=1;A<arguments.length;A++)w[A-1]=arguments[A];a.push(new p(T,w)),a.length!==1||E||O(y)},p.prototype.run=function(){this.fun.apply(null,this.array)},_.title="browser",_.browser=!0,_.env={},_.argv=[],_.version="",_.versions={},_.on=d,_.addListener=d,_.once=d,_.off=d,_.removeListener=d,_.removeAllListeners=d,_.emit=d,_.prependListener=d,_.prependOnceListener=d,_.listeners=function(){return[]},_.binding=function(){throw new Error("process.binding is not supported")},_.cwd=function(){return"/"},_.chdir=function(){throw new Error("process.chdir is not supported")},_.umask=function(){return 0}},{}],13:[function(x,C){(function(m){(function(){/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let h;C.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window=="undefined"?m:window):O=>(h||(h=Promise.resolve())).then(O).catch(M=>setTimeout(()=>{throw M},0))}).call(this)}).call(this,typeof H.g=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:H.g)},{}],14:[function(x,C){(function(m,h){(function(){"use strict";var O=x("safe-buffer").Buffer,M=h.crypto||h.msCrypto;C.exports=M&&M.getRandomValues?function(u,y){if(u>4294967295)throw new RangeError("requested too many random bytes");var p=O.allocUnsafe(u);if(0<u)if(65536<u)for(var d=0;d<u;d+=65536)M.getRandomValues(p.slice(d,d+65536));else M.getRandomValues(p);return typeof y=="function"?m.nextTick(function(){y(null,p)}):p}:function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,x("_process"),typeof H.g=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:H.g)},{_process:12,"safe-buffer":30}],15:[function(x,C){"use strict";function m(d,j){d.prototype=Object.create(j.prototype),d.prototype.constructor=d,d.__proto__=j}function h(d,j,k){function _(a,E,g){return typeof j=="string"?j:j(a,E,g)}k||(k=Error);var I=function(a){function E(g,T,w){return a.call(this,_(g,T,w))||this}return m(E,a),E}(k);I.prototype.name=k.name,I.prototype.code=d,p[d]=I}function O(d,j){if(Array.isArray(d)){var k=d.length;return d=d.map(function(_){return _+""}),2<k?"one of ".concat(j," ").concat(d.slice(0,k-1).join(", "),", or ")+d[k-1]:k===2?"one of ".concat(j," ").concat(d[0]," or ").concat(d[1]):"of ".concat(j," ").concat(d[0])}return"of ".concat(j," ").concat(d+"")}function M(d,j,k){return d.substr(!k||0>k?0:+k,j.length)===j}function u(d,j,k){return(k===void 0||k>d.length)&&(k=d.length),d.substring(k-j.length,k)===j}function y(d,j,k){return typeof k!="number"&&(k=0),!(k+j.length>d.length)&&d.indexOf(j,k)!==-1}var p={};h("ERR_INVALID_OPT_VALUE",function(d,j){return'The value "'+j+'" is invalid for option "'+d+'"'},TypeError),h("ERR_INVALID_ARG_TYPE",function(d,j,k){var _;typeof j=="string"&&M(j,"not ")?(_="must not be",j=j.replace(/^not /,"")):_="must be";var I;if(u(d," argument"))I="The ".concat(d," ").concat(_," ").concat(O(j,"type"));else{var a=y(d,".")?"property":"argument";I='The "'.concat(d,'" ').concat(a," ").concat(_," ").concat(O(j,"type"))}return I+=". Received type ".concat(typeof k),I},TypeError),h("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),h("ERR_METHOD_NOT_IMPLEMENTED",function(d){return"The "+d+" method is not implemented"}),h("ERR_STREAM_PREMATURE_CLOSE","Premature close"),h("ERR_STREAM_DESTROYED",function(d){return"Cannot call "+d+" after a stream was destroyed"}),h("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),h("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),h("ERR_STREAM_WRITE_AFTER_END","write after end"),h("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),h("ERR_UNKNOWN_ENCODING",function(d){return"Unknown encoding: "+d},TypeError),h("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),C.exports.codes=p},{}],16:[function(x,C){(function(m){(function(){"use strict";function h(_){return this instanceof h?(y.call(this,_),p.call(this,_),this.allowHalfOpen=!0,void(_&&(_.readable===!1&&(this.readable=!1),_.writable===!1&&(this.writable=!1),_.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",O))))):new h(_)}function O(){this._writableState.ended||m.nextTick(M,this)}function M(_){_.end()}var u=Object.keys||function(_){var I=[];for(var a in _)I.push(a);return I};C.exports=h;var y=x("./_stream_readable"),p=x("./_stream_writable");x("inherits")(h,y);for(var d,j=u(p.prototype),k=0;k<j.length;k++)d=j[k],h.prototype[d]||(h.prototype[d]=p.prototype[d]);Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(h.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(h.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(_){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=_,this._writableState.destroyed=_)}})}).call(this)}).call(this,x("_process"))},{"./_stream_readable":18,"./_stream_writable":20,_process:12,inherits:10}],17:[function(x,C){"use strict";function m(O){return this instanceof m?void h.call(this,O):new m(O)}C.exports=m;var h=x("./_stream_transform");x("inherits")(m,h),m.prototype._transform=function(O,M,u){u(null,O)}},{"./_stream_transform":19,inherits:10}],18:[function(x,C){(function(m,h){(function(){"use strict";function O(n){return st.from(n)}function M(n){return st.isBuffer(n)||n instanceof dt}function u(n,s,l){return typeof n.prependListener=="function"?n.prependListener(s,l):void(n._events&&n._events[s]?Array.isArray(n._events[s])?n._events[s].unshift(l):n._events[s]=[l,n._events[s]]:n.on(s,l))}function y(n,s,l){xt=xt||x("./_stream_duplex"),n=n||{},typeof l!="boolean"&&(l=s instanceof xt),this.objectMode=!!n.objectMode,l&&(this.objectMode=this.objectMode||!!n.readableObjectMode),this.highWaterMark=G(this,n,"readableHighWaterMark",l),this.buffer=new Qt,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=n.emitClose!==!1,this.autoDestroy=!!n.autoDestroy,this.destroyed=!1,this.defaultEncoding=n.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,n.encoding&&(!Tt&&(Tt=x("string_decoder/").StringDecoder),this.decoder=new Tt(n.encoding),this.encoding=n.encoding)}function p(n){if(xt=xt||x("./_stream_duplex"),!(this instanceof p))return new p(n);var s=this instanceof xt;this._readableState=new y(n,this,s),this.readable=!0,n&&(typeof n.read=="function"&&(this._read=n.read),typeof n.destroy=="function"&&(this._destroy=n.destroy)),ut.call(this)}function d(n,s,l,R,Y){_t("readableAddChunk",s);var J=n._readableState;if(s===null)J.reading=!1,a(n,J);else{var at;if(Y||(at=k(J,s)),at)tt(n,at);else if(!(J.objectMode||s&&0<s.length))R||(J.reading=!1,T(n,J));else if(typeof s=="string"||J.objectMode||Object.getPrototypeOf(s)===st.prototype||(s=O(s)),R)J.endEmitted?tt(n,new D):j(n,J,s,!0);else if(J.ended)tt(n,new V);else{if(J.destroyed)return!1;J.reading=!1,J.decoder&&!l?(s=J.decoder.write(s),J.objectMode||s.length!==0?j(n,J,s,!1):T(n,J)):j(n,J,s,!1)}}return!J.ended&&(J.length<J.highWaterMark||J.length===0)}function j(n,s,l,R){s.flowing&&s.length===0&&!s.sync?(s.awaitDrain=0,n.emit("data",l)):(s.length+=s.objectMode?1:l.length,R?s.buffer.unshift(l):s.buffer.push(l),s.needReadable&&E(n)),T(n,s)}function k(n,s){var l;return M(s)||typeof s=="string"||s===void 0||n.objectMode||(l=new vt("chunk",["string","Buffer","Uint8Array"],s)),l}function _(n){return 1073741824<=n?n=1073741824:(n--,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n++),n}function I(n,s){return 0>=n||s.length===0&&s.ended?0:s.objectMode?1:n===n?(n>s.highWaterMark&&(s.highWaterMark=_(n)),n<=s.length?n:s.ended?s.length:(s.needReadable=!0,0)):s.flowing&&s.length?s.buffer.head.data.length:s.length}function a(n,s){if(_t("onEofChunk"),!s.ended){if(s.decoder){var l=s.decoder.end();l&&l.length&&(s.buffer.push(l),s.length+=s.objectMode?1:l.length)}s.ended=!0,s.sync?E(n):(s.needReadable=!1,!s.emittedReadable&&(s.emittedReadable=!0,g(n)))}}function E(n){var s=n._readableState;_t("emitReadable",s.needReadable,s.emittedReadable),s.needReadable=!1,s.emittedReadable||(_t("emitReadable",s.flowing),s.emittedReadable=!0,m.nextTick(g,n))}function g(n){var s=n._readableState;_t("emitReadable_",s.destroyed,s.length,s.ended),!s.destroyed&&(s.length||s.ended)&&(n.emit("readable"),s.emittedReadable=!1),s.needReadable=!s.flowing&&!s.ended&&s.length<=s.highWaterMark,lt(n)}function T(n,s){s.readingMore||(s.readingMore=!0,m.nextTick(w,n,s))}function w(n,s){for(;!s.reading&&!s.ended&&(s.length<s.highWaterMark||s.flowing&&s.length===0);){var l=s.length;if(_t("maybeReadMore read 0"),n.read(0),l===s.length)break}s.readingMore=!1}function A(n){return function(){var s=n._readableState;_t("pipeOnDrain",s.awaitDrain),s.awaitDrain&&s.awaitDrain--,s.awaitDrain===0&&qt(n,"data")&&(s.flowing=!0,lt(n))}}function z(n){var s=n._readableState;s.readableListening=0<n.listenerCount("readable"),s.resumeScheduled&&!s.paused?s.flowing=!0:0<n.listenerCount("data")&&n.resume()}function L(n){_t("readable nexttick read 0"),n.read(0)}function P(n,s){s.resumeScheduled||(s.resumeScheduled=!0,m.nextTick(Q,n,s))}function Q(n,s){_t("resume",s.reading),s.reading||n.read(0),s.resumeScheduled=!1,n.emit("resume"),lt(n),s.flowing&&!s.reading&&n.read(0)}function lt(n){var s=n._readableState;for(_t("flow",s.flowing);s.flowing&&n.read()!==null;);}function wt(n,s){if(s.length===0)return null;var l;return s.objectMode?l=s.buffer.shift():!n||n>=s.length?(l=s.decoder?s.buffer.join(""):s.buffer.length===1?s.buffer.first():s.buffer.concat(s.length),s.buffer.clear()):l=s.buffer.consume(n,s.decoder),l}function Ct(n){var s=n._readableState;_t("endReadable",s.endEmitted),s.endEmitted||(s.ended=!0,m.nextTick(kt,s,n))}function kt(n,s){if(_t("endReadableNT",n.endEmitted,n.length),!n.endEmitted&&n.length===0&&(n.endEmitted=!0,s.readable=!1,s.emit("end"),n.autoDestroy)){var l=s._writableState;(!l||l.autoDestroy&&l.finished)&&s.destroy()}}function Nt(n,s){for(var l=0,R=n.length;l<R;l++)if(n[l]===s)return l;return-1}C.exports=p;var xt;p.ReadableState=y;var _t,ee=x("events").EventEmitter,qt=function(n,s){return n.listeners(s).length},ut=x("./internal/streams/stream"),st=x("buffer").Buffer,dt=h.Uint8Array||function(){},mt=x("util");_t=mt&&mt.debuglog?mt.debuglog("stream"):function(){};var Tt,Dt,Ht,Qt=x("./internal/streams/buffer_list"),Kt=x("./internal/streams/destroy"),Jt=x("./internal/streams/state"),G=Jt.getHighWaterMark,nt=x("../errors").codes,vt=nt.ERR_INVALID_ARG_TYPE,V=nt.ERR_STREAM_PUSH_AFTER_EOF,v=nt.ERR_METHOD_NOT_IMPLEMENTED,D=nt.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;x("inherits")(p,ut);var tt=Kt.errorOrDestroy,pt=["error","close","destroy","pause","resume"];Object.defineProperty(p.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(n){this._readableState&&(this._readableState.destroyed=n)}}),p.prototype.destroy=Kt.destroy,p.prototype._undestroy=Kt.undestroy,p.prototype._destroy=function(n,s){s(n)},p.prototype.push=function(n,s){var l,R=this._readableState;return R.objectMode?l=!0:typeof n=="string"&&(s=s||R.defaultEncoding,s!==R.encoding&&(n=st.from(n,s),s=""),l=!0),d(this,n,s,!1,l)},p.prototype.unshift=function(n){return d(this,n,null,!0,!1)},p.prototype.isPaused=function(){return this._readableState.flowing===!1},p.prototype.setEncoding=function(n){Tt||(Tt=x("string_decoder/").StringDecoder);var s=new Tt(n);this._readableState.decoder=s,this._readableState.encoding=this._readableState.decoder.encoding;for(var l=this._readableState.buffer.head,R="";l!==null;)R+=s.write(l.data),l=l.next;return this._readableState.buffer.clear(),R!==""&&this._readableState.buffer.push(R),this._readableState.length=R.length,this},p.prototype.read=function(n){_t("read",n),n=parseInt(n,10);var s=this._readableState,l=n;if(n!==0&&(s.emittedReadable=!1),n===0&&s.needReadable&&((s.highWaterMark===0?0<s.length:s.length>=s.highWaterMark)||s.ended))return _t("read: emitReadable",s.length,s.ended),s.length===0&&s.ended?Ct(this):E(this),null;if(n=I(n,s),n===0&&s.ended)return s.length===0&&Ct(this),null;var R=s.needReadable;_t("need readable",R),(s.length===0||s.length-n<s.highWaterMark)&&(R=!0,_t("length less than watermark",R)),s.ended||s.reading?(R=!1,_t("reading or ended",R)):R&&(_t("do read"),s.reading=!0,s.sync=!0,s.length===0&&(s.needReadable=!0),this._read(s.highWaterMark),s.sync=!1,!s.reading&&(n=I(l,s)));var Y;return Y=0<n?wt(n,s):null,Y===null?(s.needReadable=s.length<=s.highWaterMark,n=0):(s.length-=n,s.awaitDrain=0),s.length===0&&(!s.ended&&(s.needReadable=!0),l!==n&&s.ended&&Ct(this)),Y!==null&&this.emit("data",Y),Y},p.prototype._read=function(){tt(this,new v("_read()"))},p.prototype.pipe=function(n,s){function l(Mt,yt){_t("onunpipe"),Mt===Lt&&yt&&yt.hasUnpiped===!1&&(yt.hasUnpiped=!0,Y())}function R(){_t("onend"),n.end()}function Y(){_t("cleanup"),n.removeListener("close",Rt),n.removeListener("finish",zt),n.removeListener("drain",ot),n.removeListener("error",at),n.removeListener("unpipe",l),Lt.removeListener("end",R),Lt.removeListener("end",Ut),Lt.removeListener("data",J),bt=!0,jt.awaitDrain&&(!n._writableState||n._writableState.needDrain)&&ot()}function J(Mt){_t("ondata");var yt=n.write(Mt);_t("dest.write",yt),yt===!1&&((jt.pipesCount===1&&jt.pipes===n||1<jt.pipesCount&&Nt(jt.pipes,n)!==-1)&&!bt&&(_t("false write response, pause",jt.awaitDrain),jt.awaitDrain++),Lt.pause())}function at(Mt){_t("onerror",Mt),Ut(),n.removeListener("error",at),qt(n,"error")===0&&tt(n,Mt)}function Rt(){n.removeListener("finish",zt),Ut()}function zt(){_t("onfinish"),n.removeListener("close",Rt),Ut()}function Ut(){_t("unpipe"),Lt.unpipe(n)}var Lt=this,jt=this._readableState;switch(jt.pipesCount){case 0:jt.pipes=n;break;case 1:jt.pipes=[jt.pipes,n];break;default:jt.pipes.push(n)}jt.pipesCount+=1,_t("pipe count=%d opts=%j",jt.pipesCount,s);var ie=(!s||s.end!==!1)&&n!==m.stdout&&n!==m.stderr,q=ie?R:Ut;jt.endEmitted?m.nextTick(q):Lt.once("end",q),n.on("unpipe",l);var ot=A(Lt);n.on("drain",ot);var bt=!1;return Lt.on("data",J),u(n,"error",at),n.once("close",Rt),n.once("finish",zt),n.emit("pipe",Lt),jt.flowing||(_t("pipe resume"),Lt.resume()),n},p.prototype.unpipe=function(n){var s=this._readableState,l={hasUnpiped:!1};if(s.pipesCount===0)return this;if(s.pipesCount===1)return n&&n!==s.pipes?this:(n||(n=s.pipes),s.pipes=null,s.pipesCount=0,s.flowing=!1,n&&n.emit("unpipe",this,l),this);if(!n){var R=s.pipes,Y=s.pipesCount;s.pipes=null,s.pipesCount=0,s.flowing=!1;for(var J=0;J<Y;J++)R[J].emit("unpipe",this,{hasUnpiped:!1});return this}var at=Nt(s.pipes,n);return at===-1?this:(s.pipes.splice(at,1),s.pipesCount-=1,s.pipesCount===1&&(s.pipes=s.pipes[0]),n.emit("unpipe",this,l),this)},p.prototype.on=function(n,s){var l=ut.prototype.on.call(this,n,s),R=this._readableState;return n==="data"?(R.readableListening=0<this.listenerCount("readable"),R.flowing!==!1&&this.resume()):n=="readable"&&!R.endEmitted&&!R.readableListening&&(R.readableListening=R.needReadable=!0,R.flowing=!1,R.emittedReadable=!1,_t("on readable",R.length,R.reading),R.length?E(this):!R.reading&&m.nextTick(L,this)),l},p.prototype.addListener=p.prototype.on,p.prototype.removeListener=function(n,s){var l=ut.prototype.removeListener.call(this,n,s);return n==="readable"&&m.nextTick(z,this),l},p.prototype.removeAllListeners=function(n){var s=ut.prototype.removeAllListeners.apply(this,arguments);return(n==="readable"||n===void 0)&&m.nextTick(z,this),s},p.prototype.resume=function(){var n=this._readableState;return n.flowing||(_t("resume"),n.flowing=!n.readableListening,P(this,n)),n.paused=!1,this},p.prototype.pause=function(){return _t("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(_t("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},p.prototype.wrap=function(n){var s=this,l=this._readableState,R=!1;for(var Y in n.on("end",function(){if(_t("wrapped end"),l.decoder&&!l.ended){var at=l.decoder.end();at&&at.length&&s.push(at)}s.push(null)}),n.on("data",function(at){if(_t("wrapped data"),l.decoder&&(at=l.decoder.write(at)),!(l.objectMode&&at==null)&&(l.objectMode||at&&at.length)){var Rt=s.push(at);Rt||(R=!0,n.pause())}}),n)this[Y]===void 0&&typeof n[Y]=="function"&&(this[Y]=function(at){return function(){return n[at].apply(n,arguments)}}(Y));for(var J=0;J<pt.length;J++)n.on(pt[J],this.emit.bind(this,pt[J]));return this._read=function(at){_t("wrapped _read",at),R&&(R=!1,n.resume())},this},typeof Symbol=="function"&&(p.prototype[Symbol.asyncIterator]=function(){return Dt===void 0&&(Dt=x("./internal/streams/async_iterator")),Dt(this)}),Object.defineProperty(p.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(p.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(p.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(n){this._readableState&&(this._readableState.flowing=n)}}),p._fromList=wt,Object.defineProperty(p.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(p.from=function(n,s){return Ht===void 0&&(Ht=x("./internal/streams/from")),Ht(p,n,s)})}).call(this)}).call(this,x("_process"),typeof H.g=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:H.g)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,events:7,inherits:10,"string_decoder/":31,util:2}],19:[function(x,C){"use strict";function m(_,I){var a=this._transformState;a.transforming=!1;var E=a.writecb;if(E===null)return this.emit("error",new p);a.writechunk=null,a.writecb=null,I!=null&&this.push(I),E(_);var g=this._readableState;g.reading=!1,(g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}function h(_){return this instanceof h?(k.call(this,_),this._transformState={afterTransform:m.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,_&&(typeof _.transform=="function"&&(this._transform=_.transform),typeof _.flush=="function"&&(this._flush=_.flush)),void this.on("prefinish",O)):new h(_)}function O(){var _=this;typeof this._flush!="function"||this._readableState.destroyed?M(this,null,null):this._flush(function(I,a){M(_,I,a)})}function M(_,I,a){if(I)return _.emit("error",I);if(a!=null&&_.push(a),_._writableState.length)throw new j;if(_._transformState.transforming)throw new d;return _.push(null)}C.exports=h;var u=x("../errors").codes,y=u.ERR_METHOD_NOT_IMPLEMENTED,p=u.ERR_MULTIPLE_CALLBACK,d=u.ERR_TRANSFORM_ALREADY_TRANSFORMING,j=u.ERR_TRANSFORM_WITH_LENGTH_0,k=x("./_stream_duplex");x("inherits")(h,k),h.prototype.push=function(_,I){return this._transformState.needTransform=!1,k.prototype.push.call(this,_,I)},h.prototype._transform=function(_,I,a){a(new y("_transform()"))},h.prototype._write=function(_,I,a){var E=this._transformState;if(E.writecb=a,E.writechunk=_,E.writeencoding=I,!E.transforming){var g=this._readableState;(E.needTransform||g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}},h.prototype._read=function(){var _=this._transformState;_.writechunk===null||_.transforming?_.needTransform=!0:(_.transforming=!0,this._transform(_.writechunk,_.writeencoding,_.afterTransform))},h.prototype._destroy=function(_,I){k.prototype._destroy.call(this,_,function(a){I(a)})}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(x,C){(function(m,h){(function(){"use strict";function O(V){var v=this;this.next=null,this.entry=null,this.finish=function(){Ct(v,V)}}function M(V){return _t.from(V)}function u(V){return _t.isBuffer(V)||V instanceof ee}function y(){}function p(V,v,D){kt=kt||x("./_stream_duplex"),V=V||{},typeof D!="boolean"&&(D=v instanceof kt),this.objectMode=!!V.objectMode,D&&(this.objectMode=this.objectMode||!!V.writableObjectMode),this.highWaterMark=st(this,V,"writableHighWaterMark",D),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var tt=V.decodeStrings===!1;this.decodeStrings=!tt,this.defaultEncoding=V.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(pt){T(v,pt)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=V.emitClose!==!1,this.autoDestroy=!!V.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new O(this)}function d(V){kt=kt||x("./_stream_duplex");var v=this instanceof kt;return v||vt.call(d,this)?(this._writableState=new p(V,this,v),this.writable=!0,V&&(typeof V.write=="function"&&(this._write=V.write),typeof V.writev=="function"&&(this._writev=V.writev),typeof V.destroy=="function"&&(this._destroy=V.destroy),typeof V.final=="function"&&(this._final=V.final)),void xt.call(this)):new d(V)}function j(V,v){var D=new Jt;nt(V,D),m.nextTick(v,D)}function k(V,v,D,tt){var pt;return D===null?pt=new Kt:typeof D!="string"&&!v.objectMode&&(pt=new mt("chunk",["string","Buffer"],D)),!pt||(nt(V,pt),m.nextTick(tt,pt),!1)}function _(V,v,D){return V.objectMode||V.decodeStrings===!1||typeof v!="string"||(v=_t.from(v,D)),v}function I(V,v,D,tt,pt,n){if(!D){var s=_(v,tt,pt);tt!==s&&(D=!0,pt="buffer",tt=s)}var l=v.objectMode?1:tt.length;v.length+=l;var R=v.length<v.highWaterMark;if(R||(v.needDrain=!0),v.writing||v.corked){var Y=v.lastBufferedRequest;v.lastBufferedRequest={chunk:tt,encoding:pt,isBuf:D,callback:n,next:null},Y?Y.next=v.lastBufferedRequest:v.bufferedRequest=v.lastBufferedRequest,v.bufferedRequestCount+=1}else a(V,v,!1,l,tt,pt,n);return R}function a(V,v,D,tt,pt,n,s){v.writelen=tt,v.writecb=s,v.writing=!0,v.sync=!0,v.destroyed?v.onwrite(new Qt("write")):D?V._writev(pt,v.onwrite):V._write(pt,n,v.onwrite),v.sync=!1}function E(V,v,D,tt,pt){--v.pendingcb,D?(m.nextTick(pt,tt),m.nextTick(lt,V,v),V._writableState.errorEmitted=!0,nt(V,tt)):(pt(tt),V._writableState.errorEmitted=!0,nt(V,tt),lt(V,v))}function g(V){V.writing=!1,V.writecb=null,V.length-=V.writelen,V.writelen=0}function T(V,v){var D=V._writableState,tt=D.sync,pt=D.writecb;if(typeof pt!="function")throw new Dt;if(g(D),v)E(V,D,tt,v,pt);else{var n=L(D)||V.destroyed;n||D.corked||D.bufferProcessing||!D.bufferedRequest||z(V,D),tt?m.nextTick(w,V,D,n,pt):w(V,D,n,pt)}}function w(V,v,D,tt){D||A(V,v),v.pendingcb--,tt(),lt(V,v)}function A(V,v){v.length===0&&v.needDrain&&(v.needDrain=!1,V.emit("drain"))}function z(V,v){v.bufferProcessing=!0;var D=v.bufferedRequest;if(V._writev&&D&&D.next){var tt=v.bufferedRequestCount,pt=Array(tt),n=v.corkedRequestsFree;n.entry=D;for(var s=0,l=!0;D;)pt[s]=D,D.isBuf||(l=!1),D=D.next,s+=1;pt.allBuffers=l,a(V,v,!0,v.length,pt,"",n.finish),v.pendingcb++,v.lastBufferedRequest=null,n.next?(v.corkedRequestsFree=n.next,n.next=null):v.corkedRequestsFree=new O(v),v.bufferedRequestCount=0}else{for(;D;){var R=D.chunk,Y=D.encoding,J=D.callback,at=v.objectMode?1:R.length;if(a(V,v,!1,at,R,Y,J),D=D.next,v.bufferedRequestCount--,v.writing)break}D===null&&(v.lastBufferedRequest=null)}v.bufferedRequest=D,v.bufferProcessing=!1}function L(V){return V.ending&&V.length===0&&V.bufferedRequest===null&&!V.finished&&!V.writing}function P(V,v){V._final(function(D){v.pendingcb--,D&&nt(V,D),v.prefinished=!0,V.emit("prefinish"),lt(V,v)})}function Q(V,v){v.prefinished||v.finalCalled||(typeof V._final!="function"||v.destroyed?(v.prefinished=!0,V.emit("prefinish")):(v.pendingcb++,v.finalCalled=!0,m.nextTick(P,V,v)))}function lt(V,v){var D=L(v);if(D&&(Q(V,v),v.pendingcb===0&&(v.finished=!0,V.emit("finish"),v.autoDestroy))){var tt=V._readableState;(!tt||tt.autoDestroy&&tt.endEmitted)&&V.destroy()}return D}function wt(V,v,D){v.ending=!0,lt(V,v),D&&(v.finished?m.nextTick(D):V.once("finish",D)),v.ended=!0,V.writable=!1}function Ct(V,v,D){var tt=V.entry;for(V.entry=null;tt;){var pt=tt.callback;v.pendingcb--,pt(D),tt=tt.next}v.corkedRequestsFree.next=V}C.exports=d;var kt;d.WritableState=p;var Nt={deprecate:x("util-deprecate")},xt=x("./internal/streams/stream"),_t=x("buffer").Buffer,ee=h.Uint8Array||function(){},qt=x("./internal/streams/destroy"),ut=x("./internal/streams/state"),st=ut.getHighWaterMark,dt=x("../errors").codes,mt=dt.ERR_INVALID_ARG_TYPE,Tt=dt.ERR_METHOD_NOT_IMPLEMENTED,Dt=dt.ERR_MULTIPLE_CALLBACK,Ht=dt.ERR_STREAM_CANNOT_PIPE,Qt=dt.ERR_STREAM_DESTROYED,Kt=dt.ERR_STREAM_NULL_VALUES,Jt=dt.ERR_STREAM_WRITE_AFTER_END,G=dt.ERR_UNKNOWN_ENCODING,nt=qt.errorOrDestroy;x("inherits")(d,xt),p.prototype.getBuffer=function(){for(var V=this.bufferedRequest,v=[];V;)v.push(V),V=V.next;return v},function(){try{Object.defineProperty(p.prototype,"buffer",{get:Nt.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(V){}}();var vt;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(vt=Function.prototype[Symbol.hasInstance],Object.defineProperty(d,Symbol.hasInstance,{value:function(V){return!!vt.call(this,V)||this===d&&V&&V._writableState instanceof p}})):vt=function(V){return V instanceof this},d.prototype.pipe=function(){nt(this,new Ht)},d.prototype.write=function(V,v,D){var tt=this._writableState,pt=!1,n=!tt.objectMode&&u(V);return n&&!_t.isBuffer(V)&&(V=M(V)),typeof v=="function"&&(D=v,v=null),n?v="buffer":!v&&(v=tt.defaultEncoding),typeof D!="function"&&(D=y),tt.ending?j(this,D):(n||k(this,tt,V,D))&&(tt.pendingcb++,pt=I(this,tt,n,V,v,D)),pt},d.prototype.cork=function(){this._writableState.corked++},d.prototype.uncork=function(){var V=this._writableState;V.corked&&(V.corked--,!V.writing&&!V.corked&&!V.bufferProcessing&&V.bufferedRequest&&z(this,V))},d.prototype.setDefaultEncoding=function(V){if(typeof V=="string"&&(V=V.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((V+"").toLowerCase())))throw new G(V);return this._writableState.defaultEncoding=V,this},Object.defineProperty(d.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),d.prototype._write=function(V,v,D){D(new Tt("_write()"))},d.prototype._writev=null,d.prototype.end=function(V,v,D){var tt=this._writableState;return typeof V=="function"?(D=V,V=null,v=null):typeof v=="function"&&(D=v,v=null),V!=null&&this.write(V,v),tt.corked&&(tt.corked=1,this.uncork()),tt.ending||wt(this,tt,D),this},Object.defineProperty(d.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(d.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(V){this._writableState&&(this._writableState.destroyed=V)}}),d.prototype.destroy=qt.destroy,d.prototype._undestroy=qt.undestroy,d.prototype._destroy=function(V,v){v(V)}}).call(this)}).call(this,x("_process"),typeof H.g=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:H.g)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,inherits:10,"util-deprecate":32}],21:[function(x,C){(function(m){(function(){"use strict";function h(A,z,L){return z in A?Object.defineProperty(A,z,{value:L,enumerable:!0,configurable:!0,writable:!0}):A[z]=L,A}function O(A,z){return{value:A,done:z}}function M(A){var z=A[j];if(z!==null){var L=A[g].read();L!==null&&(A[a]=null,A[j]=null,A[k]=null,z(O(L,!1)))}}function u(A){m.nextTick(M,A)}function y(A,z){return function(L,P){A.then(function(){return z[I]?void L(O(void 0,!0)):void z[E](L,P)},P)}}var p,d=x("./end-of-stream"),j=Symbol("lastResolve"),k=Symbol("lastReject"),_=Symbol("error"),I=Symbol("ended"),a=Symbol("lastPromise"),E=Symbol("handlePromise"),g=Symbol("stream"),T=Object.getPrototypeOf(function(){}),w=Object.setPrototypeOf((p={get stream(){return this[g]},next:function(){var A=this,z=this[_];if(z!==null)return Promise.reject(z);if(this[I])return Promise.resolve(O(void 0,!0));if(this[g].destroyed)return new Promise(function(lt,wt){m.nextTick(function(){A[_]?wt(A[_]):lt(O(void 0,!0))})});var L,P=this[a];if(P)L=new Promise(y(P,this));else{var Q=this[g].read();if(Q!==null)return Promise.resolve(O(Q,!1));L=new Promise(this[E])}return this[a]=L,L}},h(p,Symbol.asyncIterator,function(){return this}),h(p,"return",function(){var A=this;return new Promise(function(z,L){A[g].destroy(null,function(P){return P?void L(P):void z(O(void 0,!0))})})}),p),T);C.exports=function(A){var z,L=Object.create(w,(z={},h(z,g,{value:A,writable:!0}),h(z,j,{value:null,writable:!0}),h(z,k,{value:null,writable:!0}),h(z,_,{value:null,writable:!0}),h(z,I,{value:A._readableState.endEmitted,writable:!0}),h(z,E,{value:function(P,Q){var lt=L[g].read();lt?(L[a]=null,L[j]=null,L[k]=null,P(O(lt,!1))):(L[j]=P,L[k]=Q)},writable:!0}),z));return L[a]=null,d(A,function(P){if(P&&P.code!=="ERR_STREAM_PREMATURE_CLOSE"){var Q=L[k];return Q!==null&&(L[a]=null,L[j]=null,L[k]=null,Q(P)),void(L[_]=P)}var lt=L[j];lt!==null&&(L[a]=null,L[j]=null,L[k]=null,lt(O(void 0,!0))),L[I]=!0}),A.on("readable",u.bind(null,L)),L}}).call(this)}).call(this,x("_process"))},{"./end-of-stream":24,_process:12}],22:[function(x,C){"use strict";function m(a,E){var g=Object.keys(a);if(Object.getOwnPropertySymbols){var T=Object.getOwnPropertySymbols(a);E&&(T=T.filter(function(w){return Object.getOwnPropertyDescriptor(a,w).enumerable})),g.push.apply(g,T)}return g}function h(a){for(var E,g=1;g<arguments.length;g++)E=arguments[g]==null?{}:arguments[g],g%2?m(Object(E),!0).forEach(function(T){O(a,T,E[T])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(E)):m(Object(E)).forEach(function(T){Object.defineProperty(a,T,Object.getOwnPropertyDescriptor(E,T))});return a}function O(a,E,g){return E in a?Object.defineProperty(a,E,{value:g,enumerable:!0,configurable:!0,writable:!0}):a[E]=g,a}function M(a,E){if(!(a instanceof E))throw new TypeError("Cannot call a class as a function")}function u(a,E){for(var g,T=0;T<E.length;T++)g=E[T],g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(a,g.key,g)}function y(a,E,g){return E&&u(a.prototype,E),g&&u(a,g),a}function p(a,E,g){j.prototype.copy.call(a,E,g)}var d=x("buffer"),j=d.Buffer,k=x("util"),_=k.inspect,I=_&&_.custom||"inspect";C.exports=function(){function a(){M(this,a),this.head=null,this.tail=null,this.length=0}return y(a,[{key:"push",value:function(E){var g={data:E,next:null};0<this.length?this.tail.next=g:this.head=g,this.tail=g,++this.length}},{key:"unshift",value:function(E){var g={data:E,next:this.head};this.length===0&&(this.tail=g),this.head=g,++this.length}},{key:"shift",value:function(){if(this.length!==0){var E=this.head.data;return this.head=this.length===1?this.tail=null:this.head.next,--this.length,E}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(E){if(this.length===0)return"";for(var g=this.head,T=""+g.data;g=g.next;)T+=E+g.data;return T}},{key:"concat",value:function(E){if(this.length===0)return j.alloc(0);for(var g=j.allocUnsafe(E>>>0),T=this.head,w=0;T;)p(T.data,g,w),w+=T.data.length,T=T.next;return g}},{key:"consume",value:function(E,g){var T;return E<this.head.data.length?(T=this.head.data.slice(0,E),this.head.data=this.head.data.slice(E)):E===this.head.data.length?T=this.shift():T=g?this._getString(E):this._getBuffer(E),T}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(E){var g=this.head,T=1,w=g.data;for(E-=w.length;g=g.next;){var A=g.data,z=E>A.length?A.length:E;if(w+=z===A.length?A:A.slice(0,E),E-=z,E===0){z===A.length?(++T,this.head=g.next?g.next:this.tail=null):(this.head=g,g.data=A.slice(z));break}++T}return this.length-=T,w}},{key:"_getBuffer",value:function(E){var g=j.allocUnsafe(E),T=this.head,w=1;for(T.data.copy(g),E-=T.data.length;T=T.next;){var A=T.data,z=E>A.length?A.length:E;if(A.copy(g,g.length-E,0,z),E-=z,E===0){z===A.length?(++w,this.head=T.next?T.next:this.tail=null):(this.head=T,T.data=A.slice(z));break}++w}return this.length-=w,g}},{key:I,value:function(E,g){return _(this,h({},g,{depth:0,customInspect:!1}))}}]),a}()},{buffer:3,util:2}],23:[function(x,C){(function(m){(function(){"use strict";function h(u,y){M(u,y),O(u)}function O(u){u._writableState&&!u._writableState.emitClose||u._readableState&&!u._readableState.emitClose||u.emit("close")}function M(u,y){u.emit("error",y)}C.exports={destroy:function(u,y){var p=this,d=this._readableState&&this._readableState.destroyed,j=this._writableState&&this._writableState.destroyed;return d||j?(y?y(u):u&&(this._writableState?!this._writableState.errorEmitted&&(this._writableState.errorEmitted=!0,m.nextTick(M,this,u)):m.nextTick(M,this,u)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(u||null,function(k){!y&&k?p._writableState?p._writableState.errorEmitted?m.nextTick(O,p):(p._writableState.errorEmitted=!0,m.nextTick(h,p,k)):m.nextTick(h,p,k):y?(m.nextTick(O,p),y(k)):m.nextTick(O,p)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(u,y){var p=u._readableState,d=u._writableState;p&&p.autoDestroy||d&&d.autoDestroy?u.destroy(y):u.emit("error",y)}}}).call(this)}).call(this,x("_process"))},{_process:12}],24:[function(x,C){"use strict";function m(y){var p=!1;return function(){if(!p){p=!0;for(var d=arguments.length,j=Array(d),k=0;k<d;k++)j[k]=arguments[k];y.apply(this,j)}}}function h(){}function O(y){return y.setHeader&&typeof y.abort=="function"}function M(y,p,d){if(typeof p=="function")return M(y,null,p);p||(p={}),d=m(d||h);var j=p.readable||p.readable!==!1&&y.readable,k=p.writable||p.writable!==!1&&y.writable,_=function(){y.writable||a()},I=y._writableState&&y._writableState.finished,a=function(){k=!1,I=!0,j||d.call(y)},E=y._readableState&&y._readableState.endEmitted,g=function(){j=!1,E=!0,k||d.call(y)},T=function(z){d.call(y,z)},w=function(){var z;return j&&!E?(y._readableState&&y._readableState.ended||(z=new u),d.call(y,z)):k&&!I?(y._writableState&&y._writableState.ended||(z=new u),d.call(y,z)):void 0},A=function(){y.req.on("finish",a)};return O(y)?(y.on("complete",a),y.on("abort",w),y.req?A():y.on("request",A)):k&&!y._writableState&&(y.on("end",_),y.on("close",_)),y.on("end",g),y.on("finish",a),p.error!==!1&&y.on("error",T),y.on("close",w),function(){y.removeListener("complete",a),y.removeListener("abort",w),y.removeListener("request",A),y.req&&y.req.removeListener("finish",a),y.removeListener("end",_),y.removeListener("close",_),y.removeListener("finish",a),y.removeListener("end",g),y.removeListener("error",T),y.removeListener("close",w)}}var u=x("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;C.exports=M},{"../../../errors":15}],25:[function(x,C){C.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],26:[function(x,C){"use strict";function m(I){var a=!1;return function(){a||(a=!0,I.apply(void 0,arguments))}}function h(I){if(I)throw I}function O(I){return I.setHeader&&typeof I.abort=="function"}function M(I,a,E,g){g=m(g);var T=!1;I.on("close",function(){T=!0}),d===void 0&&(d=x("./end-of-stream")),d(I,{readable:a,writable:E},function(A){return A?g(A):(T=!0,void g())});var w=!1;return function(A){if(!T)return w?void 0:(w=!0,O(I)?I.abort():typeof I.destroy=="function"?I.destroy():void g(A||new _("pipe")))}}function u(I){I()}function y(I,a){return I.pipe(a)}function p(I){return I.length&&typeof I[I.length-1]=="function"?I.pop():h}var d,j=x("../../../errors").codes,k=j.ERR_MISSING_ARGS,_=j.ERR_STREAM_DESTROYED;C.exports=function(){for(var I=arguments.length,a=Array(I),E=0;E<I;E++)a[E]=arguments[E];var g=p(a);if(Array.isArray(a[0])&&(a=a[0]),2>a.length)throw new k("streams");var T,w=a.map(function(A,z){var L=z<a.length-1;return M(A,L,0<z,function(P){T||(T=P),P&&w.forEach(u),L||(w.forEach(u),g(T))})});return a.reduce(y)}},{"../../../errors":15,"./end-of-stream":24}],27:[function(x,C){"use strict";function m(O,M,u){return O.highWaterMark==null?M?O[u]:null:O.highWaterMark}var h=x("../../../errors").codes.ERR_INVALID_OPT_VALUE;C.exports={getHighWaterMark:function(O,M,u,y){var p=m(M,y,u);if(p!=null){if(!(isFinite(p)&&et(p)===p)||0>p){var d=y?u:"highWaterMark";throw new h(d,p)}return et(p)}return O.objectMode?16:16384}}},{"../../../errors":15}],28:[function(x,C){C.exports=x("events").EventEmitter},{events:7}],29:[function(x,C,m){m=C.exports=x("./lib/_stream_readable.js"),m.Stream=m,m.Readable=m,m.Writable=x("./lib/_stream_writable.js"),m.Duplex=x("./lib/_stream_duplex.js"),m.Transform=x("./lib/_stream_transform.js"),m.PassThrough=x("./lib/_stream_passthrough.js"),m.finished=x("./lib/internal/streams/end-of-stream.js"),m.pipeline=x("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],30:[function(x,C,m){function h(y,p){for(var d in y)p[d]=y[d]}function O(y,p,d){return u(y,p,d)}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var M=x("buffer"),u=M.Buffer;u.from&&u.alloc&&u.allocUnsafe&&u.allocUnsafeSlow?C.exports=M:(h(M,m),m.Buffer=O),O.prototype=Object.create(u.prototype),h(u,O),O.from=function(y,p,d){if(typeof y=="number")throw new TypeError("Argument must not be a number");return u(y,p,d)},O.alloc=function(y,p,d){if(typeof y!="number")throw new TypeError("Argument must be a number");var j=u(y);return p===void 0?j.fill(0):typeof d=="string"?j.fill(p,d):j.fill(p),j},O.allocUnsafe=function(y){if(typeof y!="number")throw new TypeError("Argument must be a number");return u(y)},O.allocUnsafeSlow=function(y){if(typeof y!="number")throw new TypeError("Argument must be a number");return M.SlowBuffer(y)}},{buffer:3}],31:[function(x,C,m){"use strict";function h(w){if(!w)return"utf8";for(var A;;)switch(w){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return w;default:if(A)return;w=(""+w).toLowerCase(),A=!0}}function O(w){var A=h(w);if(typeof A!="string"&&(g.isEncoding===T||!T(w)))throw new Error("Unknown encoding: "+w);return A||w}function M(w){this.encoding=O(w);var A;switch(this.encoding){case"utf16le":this.text=j,this.end=k,A=4;break;case"utf8":this.fillLast=d,A=4;break;case"base64":this.text=_,this.end=I,A=3;break;default:return this.write=a,void(this.end=E)}this.lastNeed=0,this.lastTotal=0,this.lastChar=g.allocUnsafe(A)}function u(w){return 127>=w?0:w>>5==6?2:w>>4==14?3:w>>3==30?4:w>>6==2?-1:-2}function y(w,A,z){var L=A.length-1;if(L<z)return 0;var P=u(A[L]);return 0<=P?(0<P&&(w.lastNeed=P-1),P):--L<z||P===-2?0:(P=u(A[L]),0<=P?(0<P&&(w.lastNeed=P-2),P):--L<z||P===-2?0:(P=u(A[L]),0<=P?(0<P&&(P===2?P=0:w.lastNeed=P-3),P):0))}function p(w,A){if((192&A[0])!=128)return w.lastNeed=0,"\uFFFD";if(1<w.lastNeed&&1<A.length){if((192&A[1])!=128)return w.lastNeed=1,"\uFFFD";if(2<w.lastNeed&&2<A.length&&(192&A[2])!=128)return w.lastNeed=2,"\uFFFD"}}function d(w){var A=this.lastTotal-this.lastNeed,z=p(this,w,A);return z===void 0?this.lastNeed<=w.length?(w.copy(this.lastChar,A,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(w.copy(this.lastChar,A,0,w.length),void(this.lastNeed-=w.length)):z}function j(w,A){if((w.length-A)%2==0){var z=w.toString("utf16le",A);if(z){var L=z.charCodeAt(z.length-1);if(55296<=L&&56319>=L)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=w[w.length-2],this.lastChar[1]=w[w.length-1],z.slice(0,-1)}return z}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=w[w.length-1],w.toString("utf16le",A,w.length-1)}function k(w){var A=w&&w.length?this.write(w):"";if(this.lastNeed){var z=this.lastTotal-this.lastNeed;return A+this.lastChar.toString("utf16le",0,z)}return A}function _(w,A){var z=(w.length-A)%3;return z==0?w.toString("base64",A):(this.lastNeed=3-z,this.lastTotal=3,z==1?this.lastChar[0]=w[w.length-1]:(this.lastChar[0]=w[w.length-2],this.lastChar[1]=w[w.length-1]),w.toString("base64",A,w.length-z))}function I(w){var A=w&&w.length?this.write(w):"";return this.lastNeed?A+this.lastChar.toString("base64",0,3-this.lastNeed):A}function a(w){return w.toString(this.encoding)}function E(w){return w&&w.length?this.write(w):""}var g=x("safe-buffer").Buffer,T=g.isEncoding||function(w){switch(w=""+w,w&&w.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};m.StringDecoder=M,M.prototype.write=function(w){if(w.length===0)return"";var A,z;if(this.lastNeed){if(A=this.fillLast(w),A===void 0)return"";z=this.lastNeed,this.lastNeed=0}else z=0;return z<w.length?A?A+this.text(w,z):this.text(w,z):A||""},M.prototype.end=function(w){var A=w&&w.length?this.write(w):"";return this.lastNeed?A+"\uFFFD":A},M.prototype.text=function(w,A){var z=y(this,w,A);if(!this.lastNeed)return w.toString("utf8",A);this.lastTotal=z;var L=w.length-(z-this.lastNeed);return w.copy(this.lastChar,0,L),w.toString("utf8",A,L)},M.prototype.fillLast=function(w){return this.lastNeed<=w.length?(w.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(w.copy(this.lastChar,this.lastTotal-this.lastNeed,0,w.length),void(this.lastNeed-=w.length))}},{"safe-buffer":30}],32:[function(x,C){(function(m){(function(){function h(O){try{if(!m.localStorage)return!1}catch(u){return!1}var M=m.localStorage[O];return M!=null&&(M+"").toLowerCase()==="true"}C.exports=function(O,M){function u(){if(!y){if(h("throwDeprecation"))throw new Error(M);h("traceDeprecation")?console.trace(M):console.warn(M),y=!0}return O.apply(this,arguments)}if(h("noDeprecation"))return O;var y=!1;return u}}).call(this)}).call(this,typeof H.g=="undefined"?typeof self=="undefined"?typeof window=="undefined"?{}:window:self:H.g)},{}],"/":[function(x,C){function m(I){return I.replace(/a=ice-options:trickle\s\n/g,"")}function h(I){console.warn(I)}/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */const O=x("debug")("simple-peer"),M=x("get-browser-rtc"),u=x("randombytes"),y=x("readable-stream"),p=x("queue-microtask"),d=x("err-code"),{Buffer:j}=x("buffer"),k=65536;class _ extends y.Duplex{constructor(a){if(a=Object.assign({allowHalfOpen:!1},a),super(a),this._id=u(4).toString("hex").slice(0,7),this._debug("new peer %o",a),this.channelName=a.initiator?a.channelName||u(20).toString("hex"):null,this.initiator=a.initiator||!1,this.channelConfig=a.channelConfig||_.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},_.config,a.config),this.offerOptions=a.offerOptions||{},this.answerOptions=a.answerOptions||{},this.sdpTransform=a.sdpTransform||(E=>E),this.streams=a.streams||(a.stream?[a.stream]:[]),this.trickle=a.trickle===void 0||a.trickle,this.allowHalfTrickle=a.allowHalfTrickle!==void 0&&a.allowHalfTrickle,this.iceCompleteTimeout=a.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=a.wrtc&&typeof a.wrtc=="object"?a.wrtc:M(),!this._wrtc)throw d(typeof window=="undefined"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(E){return void this.destroy(d(E,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=E=>{this._onIceCandidate(E)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(E=>{this.destroy(d(E,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=E=>{this._setupData(E)},this.streams&&this.streams.forEach(E=>{this.addStream(E)}),this._pc.ontrack=E=>{this._onTrack(E)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(a){if(!this.destroying){if(this.destroyed)throw d(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof a=="string")try{a=JSON.parse(a)}catch(E){a={}}this._debug("signal()"),a.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),a.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(a.transceiverRequest.kind,a.transceiverRequest.init)),a.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(a.candidate):this._pendingCandidates.push(a.candidate)),a.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(a)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(E=>{this._addIceCandidate(E)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(E=>{this.destroy(d(E,"ERR_SET_REMOTE_DESCRIPTION"))}),a.sdp||a.candidate||a.renegotiate||a.transceiverRequest||this.destroy(d(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(a){const E=new this._wrtc.RTCIceCandidate(a);this._pc.addIceCandidate(E).catch(g=>{!E.address||E.address.endsWith(".local")?h("Ignoring unsupported ICE candidate."):this.destroy(d(g,"ERR_ADD_ICE_CANDIDATE"))})}send(a){if(!this.destroying){if(this.destroyed)throw d(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(a)}}addTransceiver(a,E){if(!this.destroying){if(this.destroyed)throw d(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(a,E),this._needsNegotiation()}catch(g){this.destroy(d(g,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:a,init:E}})}}addStream(a){if(!this.destroying){if(this.destroyed)throw d(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),a.getTracks().forEach(E=>{this.addTrack(E,a)})}}addTrack(a,E){if(this.destroying)return;if(this.destroyed)throw d(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const g=this._senderMap.get(a)||new Map;let T=g.get(E);if(!T)T=this._pc.addTrack(a,E),g.set(E,T),this._senderMap.set(a,g),this._needsNegotiation();else throw T.removed?d(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):d(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(a,E,g){if(this.destroying)return;if(this.destroyed)throw d(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const T=this._senderMap.get(a),w=T?T.get(g):null;if(!w)throw d(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");E&&this._senderMap.set(E,T),w.replaceTrack==null?this.destroy(d(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):w.replaceTrack(E)}removeTrack(a,E){if(this.destroying)return;if(this.destroyed)throw d(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const g=this._senderMap.get(a),T=g?g.get(E):null;if(!T)throw d(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{T.removed=!0,this._pc.removeTrack(T)}catch(w){w.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(T):this.destroy(d(w,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(a){if(!this.destroying){if(this.destroyed)throw d(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),a.getTracks().forEach(E=>{this.removeTrack(E,a)})}}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,p(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw d(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(a){this._destroy(a,()=>{})}_destroy(a,E){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",a&&(a.message||a)),p(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",a&&(a.message||a)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(g){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(g){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,a&&this.emit("error",a),this.emit("close"),E()}))}_setupData(a){if(!a.channel)return this.destroy(d(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=a.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=k),this.channelName=this._channel.label,this._channel.onmessage=g=>{this._onChannelMessage(g)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=g=>{const T=g.error instanceof Error?g.error:new Error(`Datachannel error: ${g.message} ${g.filename}:${g.lineno}:${g.colno}`);this.destroy(d(T,"ERR_DATA_CHANNEL"))};let E=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(E&&this._onChannelClose(),E=!0):E=!1},5e3)}_read(){}_write(a,E,g){if(this.destroyed)return g(d(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(a)}catch(T){return this.destroy(d(T,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>k?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=g):g(null)}else this._debug("write before connect"),this._chunk=a,this._cb=g}_onFinish(){if(!this.destroyed){const a=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?a():this.once("connect",a)}}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(a=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(a.sdp=m(a.sdp)),a.sdp=this.sdpTransform(a.sdp);const E=()=>{if(!this.destroyed){const g=this._pc.localDescription||a;this._debug("signal"),this.emit("signal",{type:g.type,sdp:g.sdp})}};this._pc.setLocalDescription(a).then(()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?E():this.once("_iceComplete",E))}).catch(g=>{this.destroy(d(g,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(a=>{this.destroy(d(a,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(a=>{a.mid||!a.sender.track||a.requested||(a.requested=!0,this.addTransceiver(a.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(a=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(a.sdp=m(a.sdp)),a.sdp=this.sdpTransform(a.sdp);const E=()=>{if(!this.destroyed){const g=this._pc.localDescription||a;this._debug("signal"),this.emit("signal",{type:g.type,sdp:g.sdp}),this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(a).then(()=>{this.destroyed||(this.trickle||this._iceComplete?E():this.once("_iceComplete",E))}).catch(g=>{this.destroy(d(g,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(a=>{this.destroy(d(a,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(d(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const a=this._pc.iceConnectionState,E=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",a,E),this.emit("iceStateChange",a,E),(a==="connected"||a==="completed")&&(this._pcReady=!0,this._maybeReady()),a==="failed"&&this.destroy(d(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),a==="closed"&&this.destroy(d(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(a){const E=g=>(Object.prototype.toString.call(g.values)==="[object Array]"&&g.values.forEach(T=>{Object.assign(g,T)}),g);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(g=>{const T=[];g.forEach(w=>{T.push(E(w))}),a(null,T)},g=>a(g)):0<this._pc.getStats.length?this._pc.getStats(g=>{if(this.destroyed)return;const T=[];g.result().forEach(w=>{const A={};w.names().forEach(z=>{A[z]=w.stat(z)}),A.id=w.id,A.type=w.type,A.timestamp=w.timestamp,T.push(E(A))}),a(null,T)},g=>a(g)):a(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const a=()=>{this.destroyed||this.getStats((E,g)=>{if(this.destroyed)return;E&&(g=[]);const T={},w={},A={};let z=!1;g.forEach(P=>{(P.type==="remotecandidate"||P.type==="remote-candidate")&&(T[P.id]=P),(P.type==="localcandidate"||P.type==="local-candidate")&&(w[P.id]=P),(P.type==="candidatepair"||P.type==="candidate-pair")&&(A[P.id]=P)});const L=P=>{z=!0;let Q=w[P.localCandidateId];Q&&(Q.ip||Q.address)?(this.localAddress=Q.ip||Q.address,this.localPort=+Q.port):Q&&Q.ipAddress?(this.localAddress=Q.ipAddress,this.localPort=+Q.portNumber):typeof P.googLocalAddress=="string"&&(Q=P.googLocalAddress.split(":"),this.localAddress=Q[0],this.localPort=+Q[1]),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let lt=T[P.remoteCandidateId];lt&&(lt.ip||lt.address)?(this.remoteAddress=lt.ip||lt.address,this.remotePort=+lt.port):lt&&lt.ipAddress?(this.remoteAddress=lt.ipAddress,this.remotePort=+lt.portNumber):typeof P.googRemoteAddress=="string"&&(lt=P.googRemoteAddress.split(":"),this.remoteAddress=lt[0],this.remotePort=+lt[1]),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(g.forEach(P=>{P.type==="transport"&&P.selectedCandidatePairId&&L(A[P.selectedCandidatePairId]),(P.type==="googCandidatePair"&&P.googActiveConnection==="true"||(P.type==="candidatepair"||P.type==="candidate-pair")&&P.selected)&&L(P)}),!z&&(!Object.keys(A).length||Object.keys(w).length))return void setTimeout(a,100);if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(Q){return this.destroy(d(Q,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const P=this._cb;this._cb=null,P(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};a()}_onInterval(){this._cb&&this._channel&&!(this._channel.bufferedAmount>k)&&this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(a=>{this._pc.removeTrack(a),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(a){this.destroyed||(a.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:a.candidate.candidate,sdpMLineIndex:a.candidate.sdpMLineIndex,sdpMid:a.candidate.sdpMid}}):!a.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),a.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(a){if(this.destroyed)return;let E=a.data;E instanceof ArrayBuffer&&(E=j.from(E)),this.push(E)}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const a=this._cb;this._cb=null,a(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(a){this.destroyed||a.streams.forEach(E=>{this._debug("on track"),this.emit("track",a.track,E),this._remoteTracks.push({track:a.track,stream:E}),this._remoteStreams.some(g=>g.id===E.id)||(this._remoteStreams.push(E),p(()=>{this._debug("on stream"),this.emit("stream",E)}))})}_debug(){const a=[].slice.call(arguments);a[0]="["+this._id+"] "+a[0],O.apply(null,a)}}_.WEBRTC_SUPPORT=!!M(),_.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},_.channelConfig={},C.exports=_},{buffer:3,debug:4,"err-code":6,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/")})},"../../../node_modules/.pnpm/yjs@13.6.19/node_modules/yjs/dist/yjs.mjs":(Vt,St,H)=>{"use strict";H.d(St,{JA:()=>st,QE:()=>n,PR:()=>R,FX:()=>Ut,hL:()=>Yt});var et=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/observable.js"),it=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/array.js"),Z=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/math.js"),x=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/map.js"),C=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/encoding.js"),m=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/decoding.js"),h=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/random.js"),O=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/promise.js"),M=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/buffer.js"),u=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/error.js"),y=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/binary.js"),p=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/function.js"),d=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/set.js"),j=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/logging.js"),k=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/logging.common.js"),_=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/time.js");const I=(r,t)=>({[Symbol.iterator](){return this},next(){const e=r.next();return{value:e.done?void 0:t(e.value),done:e.done}}}),a=r=>({[Symbol.iterator](){return this},next:r}),E=(r,t)=>a(()=>{let e;do e=r.next();while(!e.done&&!t(e.value));return e}),g=(r,t)=>a(()=>{const{done:e,value:i}=r.next();return{done:e,value:e?void 0:t(i)}});var T=H("../../../node_modules/.pnpm/lib0@0.2.98/node_modules/lib0/object.js");class w extends et.W{constructor(t,e){super(),this.doc=t,this.awareness=e}}class A{constructor(t,e){this.clock=t,this.len=e}}class z{constructor(){this.clients=new Map}}const L=(r,t,e)=>t.clients.forEach((i,o)=>{const c=r.doc.store.clients.get(o);for(let b=0;b<i.length;b++){const S=i[b];En(r,c,S.clock,S.len,e)}}),P=(r,t)=>{let e=0,i=r.length-1;for(;e<=i;){const o=Z.RI((e+i)/2),c=r[o],b=c.clock;if(b<=t){if(t<b+c.len)return o;e=o+1}else i=o-1}return null},Q=(r,t)=>{const e=r.clients.get(t.client);return e!==void 0&&P(e,t.clock)!==null},lt=r=>{r.clients.forEach(t=>{t.sort((o,c)=>o.clock-c.clock);let e,i;for(e=1,i=1;e<t.length;e++){const o=t[i-1],c=t[e];o.clock+o.len>=c.clock?o.len=Z.T9(o.len,c.clock+c.len-o.clock):(i<e&&(t[i]=c),i++)}t.length=i})},wt=r=>{const t=new z;for(let e=0;e<r.length;e++)r[e].clients.forEach((i,o)=>{if(!t.clients.has(o)){const c=i.slice();for(let b=e+1;b<r.length;b++)it.S2(c,r[b].clients.get(o)||[]);t.clients.set(o,c)}});return lt(t),t},Ct=(r,t,e,i)=>{x._4(r.clients,t,()=>[]).push(new A(e,i))},kt=()=>new z,Nt=r=>{const t=kt();return r.clients.forEach((e,i)=>{const o=[];for(let c=0;c<e.length;c++){const b=e[c];if(b.deleted){const S=b.id.clock;let U=b.length;if(c+1<e.length)for(let W=e[c+1];c+1<e.length&&W.deleted;W=e[++c+1])U+=W.length;o.push(new A(S,U))}}o.length>0&&t.clients.set(i,o)}),t},xt=(r,t)=>{C.zd(r.restEncoder,t.clients.size),it.HT(t.clients.entries()).sort((e,i)=>i[0]-e[0]).forEach(([e,i])=>{r.resetDsCurVal(),C.zd(r.restEncoder,e);const o=i.length;C.zd(r.restEncoder,o);for(let c=0;c<o;c++){const b=i[c];r.writeDsClock(b.clock),r.writeDsLen(b.len)}})},_t=r=>{const t=new z,e=m.cw(r.restDecoder);for(let i=0;i<e;i++){r.resetDsCurVal();const o=m.cw(r.restDecoder),c=m.cw(r.restDecoder);if(c>0){const b=x._4(t.clients,o,()=>[]);for(let S=0;S<c;S++)b.push(new A(r.readDsClock(),r.readDsLen()))}}return t},ee=(r,t,e)=>{const i=new z,o=m.cw(r.restDecoder);for(let c=0;c<o;c++){r.resetDsCurVal();const b=m.cw(r.restDecoder),S=m.cw(r.restDecoder),U=e.clients.get(b)||[],W=$t(e,b);for(let B=0;B<S;B++){const F=r.readDsClock(),X=F+r.readDsLen();if(F<W){W<X&&Ct(i,b,W,X-W);let ht=he(U,F),gt=U[ht];for(!gt.deleted&&gt.id.clock<F&&(U.splice(ht+1,0,Xe(t,gt,F-gt.id.clock)),ht++);ht<U.length&&(gt=U[ht++],gt.id.clock<X);)gt.deleted||(X<gt.id.clock+gt.length&&U.splice(ht,0,Xe(t,gt,X-gt.id.clock)),gt.delete(t))}else Ct(i,b,F,X-F)}}if(i.clients.size>0){const c=new Jt;return C.zd(c.restEncoder,0),xt(c,i),c.toUint8Array()}return null},qt=(r,t)=>{if(r.clients.size!==t.clients.size)return!1;for(const[e,i]of r.clients.entries()){const o=t.clients.get(e);if(o===void 0||i.length!==o.length)return!1;for(let c=0;c<i.length;c++){const b=i[c],S=o[c];if(b.clock!==S.clock||b.len!==S.len)return!1}}return!0},ut=h.S8;class st extends et.W{constructor({guid:t=h.gZ(),collectionid:e=null,gc:i=!0,gcFilter:o=()=>!0,meta:c=null,autoLoad:b=!1,shouldLoad:S=!0}={}){super(),this.gc=i,this.gcFilter=o,this.clientID=ut(),this.guid=t,this.collectionid=e,this.share=new Map,this.store=new wn,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=S,this.autoLoad=b,this.meta=c,this.isLoaded=!1,this.isSynced=!1,this.isDestroyed=!1,this.whenLoaded=O.vt(W=>{this.on("load",()=>{this.isLoaded=!0,W(this)})});const U=()=>O.vt(W=>{const B=F=>{(F===void 0||F===!0)&&(this.off("sync",B),W())};this.on("sync",B)});this.on("sync",W=>{W===!1&&this.isSynced&&(this.whenSynced=U()),this.isSynced=W===void 0||W===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=U()}load(){const t=this._item;t!==null&&!this.shouldLoad&&Yt(t.parent.doc,e=>{e.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(it.HT(this.subdocs).map(t=>t.guid))}transact(t,e=null){return Yt(this,t,e)}get(t,e=re){const i=x._4(this.share,t,()=>{const c=new e;return c._integrate(this,null),c}),o=i.constructor;if(e!==re&&o!==e)if(o===re){const c=new e;c._map=i._map,i._map.forEach(b=>{for(;b!==null;b=b.left)b.parent=c}),c._start=i._start;for(let b=c._start;b!==null;b=b.right)b.parent=c;return c._length=i._length,this.share.set(t,c),c._integrate(this,null),c}else throw new Error(`Type with the name ${t} has already been defined with a different constructor`);return i}getArray(t=""){return this.get(t,we)}getText(t=""){return this.get(t,Ie)}getMap(t=""){return this.get(t,Ce)}getXmlElement(t=""){return this.get(t,Te)}getXmlFragment(t=""){return this.get(t,ke)}toJSON(){const t={};return this.share.forEach((e,i)=>{t[i]=e.toJSON()}),t}destroy(){this.isDestroyed=!0,it.HT(this.subdocs).forEach(e=>e.destroy());const t=this._item;if(t!==null){this._item=null;const e=t.content;e.doc=new st({guid:this.guid,...e.opts,shouldLoad:!1}),e.doc._item=t,Yt(t.parent.doc,i=>{const o=e.doc;t.deleted||i.subdocsAdded.add(o),i.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class dt{constructor(t){this.restDecoder=t}resetDsCurVal(){}readDsClock(){return m.cw(this.restDecoder)}readDsLen(){return m.cw(this.restDecoder)}}class mt extends dt{readLeftID(){return yt(m.cw(this.restDecoder),m.cw(this.restDecoder))}readRightID(){return yt(m.cw(this.restDecoder),m.cw(this.restDecoder))}readClient(){return m.cw(this.restDecoder)}readInfo(){return m.xh(this.restDecoder)}readString(){return m.t3(this.restDecoder)}readParentInfo(){return m.cw(this.restDecoder)===1}readTypeRef(){return m.cw(this.restDecoder)}readLen(){return m.cw(this.restDecoder)}readAny(){return m.Jg(this.restDecoder)}readBuf(){return M.HR(m.bo(this.restDecoder))}readJSON(){return JSON.parse(m.t3(this.restDecoder))}readKey(){return m.t3(this.restDecoder)}}class Tt{constructor(t){this.dsCurrVal=0,this.restDecoder=t}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=m.cw(this.restDecoder),this.dsCurrVal}readDsLen(){const t=m.cw(this.restDecoder)+1;return this.dsCurrVal+=t,t}}class Dt extends Tt{constructor(t){super(t),this.keys=[],m.cw(t),this.keyClockDecoder=new m.xK(m.bo(t)),this.clientDecoder=new m.VQ(m.bo(t)),this.leftClockDecoder=new m.xK(m.bo(t)),this.rightClockDecoder=new m.xK(m.bo(t)),this.infoDecoder=new m.cQ(m.bo(t),m.xh),this.stringDecoder=new m.Ib(m.bo(t)),this.parentInfoDecoder=new m.cQ(m.bo(t),m.xh),this.typeRefDecoder=new m.VQ(m.bo(t)),this.lenDecoder=new m.VQ(m.bo(t))}readLeftID(){return new bt(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new bt(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return m.Jg(this.restDecoder)}readBuf(){return m.bo(this.restDecoder)}readJSON(){return m.Jg(this.restDecoder)}readKey(){const t=this.keyClockDecoder.read();if(t<this.keys.length)return this.keys[t];{const e=this.stringDecoder.read();return this.keys.push(e),e}}}class Ht{constructor(){this.restEncoder=C.xv()}toUint8Array(){return C.Fo(this.restEncoder)}resetDsCurVal(){}writeDsClock(t){C.zd(this.restEncoder,t)}writeDsLen(t){C.zd(this.restEncoder,t)}}class Qt extends Ht{writeLeftID(t){C.zd(this.restEncoder,t.client),C.zd(this.restEncoder,t.clock)}writeRightID(t){C.zd(this.restEncoder,t.client),C.zd(this.restEncoder,t.clock)}writeClient(t){C.zd(this.restEncoder,t)}writeInfo(t){C.QJ(this.restEncoder,t)}writeString(t){C.Qj(this.restEncoder,t)}writeParentInfo(t){C.zd(this.restEncoder,t?1:0)}writeTypeRef(t){C.zd(this.restEncoder,t)}writeLen(t){C.zd(this.restEncoder,t)}writeAny(t){C.IO(this.restEncoder,t)}writeBuf(t){C.Gu(this.restEncoder,t)}writeJSON(t){C.Qj(this.restEncoder,JSON.stringify(t))}writeKey(t){C.Qj(this.restEncoder,t)}}class Kt{constructor(){this.restEncoder=C.xv(),this.dsCurrVal=0}toUint8Array(){return C.Fo(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(t){const e=t-this.dsCurrVal;this.dsCurrVal=t,C.zd(this.restEncoder,e)}writeDsLen(t){t===0&&u.Mq(),C.zd(this.restEncoder,t-1),this.dsCurrVal+=t}}class Jt extends Kt{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new C.FA,this.clientEncoder=new C.D$,this.leftClockEncoder=new C.FA,this.rightClockEncoder=new C.FA,this.infoEncoder=new C.cq(C.QJ),this.stringEncoder=new C.Sw,this.parentInfoEncoder=new C.cq(C.QJ),this.typeRefEncoder=new C.D$,this.lenEncoder=new C.D$}toUint8Array(){const t=C.xv();return C.zd(t,0),C.Gu(t,this.keyClockEncoder.toUint8Array()),C.Gu(t,this.clientEncoder.toUint8Array()),C.Gu(t,this.leftClockEncoder.toUint8Array()),C.Gu(t,this.rightClockEncoder.toUint8Array()),C.Gu(t,C.Fo(this.infoEncoder)),C.Gu(t,this.stringEncoder.toUint8Array()),C.Gu(t,C.Fo(this.parentInfoEncoder)),C.Gu(t,this.typeRefEncoder.toUint8Array()),C.Gu(t,this.lenEncoder.toUint8Array()),C.LH(t,C.Fo(this.restEncoder)),C.Fo(t)}writeLeftID(t){this.clientEncoder.write(t.client),this.leftClockEncoder.write(t.clock)}writeRightID(t){this.clientEncoder.write(t.client),this.rightClockEncoder.write(t.clock)}writeClient(t){this.clientEncoder.write(t)}writeInfo(t){this.infoEncoder.write(t)}writeString(t){this.stringEncoder.write(t)}writeParentInfo(t){this.parentInfoEncoder.write(t?1:0)}writeTypeRef(t){this.typeRefEncoder.write(t)}writeLen(t){this.lenEncoder.write(t)}writeAny(t){C.IO(this.restEncoder,t)}writeBuf(t){C.Gu(this.restEncoder,t)}writeJSON(t){C.IO(this.restEncoder,t)}writeKey(t){const e=this.keyMap.get(t);e===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(t)):this.keyClockEncoder.write(e)}}const G=(r,t,e,i)=>{i=Z.T9(i,t[0].id.clock);const o=he(t,i);C.zd(r.restEncoder,t.length-o),r.writeClient(e),C.zd(r.restEncoder,i);const c=t[o];c.write(r,i-c.id.clock);for(let b=o+1;b<t.length;b++)t[b].write(r,0)},nt=(r,t,e)=>{const i=new Map;e.forEach((o,c)=>{$t(t,c)>o&&i.set(c,o)}),Ne(t).forEach((o,c)=>{e.has(c)||i.set(c,0)}),C.zd(r.restEncoder,i.size),it.HT(i.entries()).sort((o,c)=>c[0]-o[0]).forEach(([o,c])=>{G(r,t.clients.get(o),o,c)})},vt=(r,t)=>{const e=x.vt(),i=m.cw(r.restDecoder);for(let o=0;o<i;o++){const c=m.cw(r.restDecoder),b=new Array(c),S=r.readClient();let U=m.cw(r.restDecoder);e.set(S,{i:0,refs:b});for(let W=0;W<c;W++){const B=r.readInfo();switch(y.WY&B){case 0:{const F=r.readLen();b[W]=new ae(yt(S,U),F),U+=F;break}case 10:{const F=m.cw(r.restDecoder);b[W]=new le(yt(S,U),F),U+=F;break}default:{const F=(B&(y.D7|y.wt))===0,X=new Gt(yt(S,U),null,(B&y.wt)===y.wt?r.readLeftID():null,null,(B&y.D7)===y.D7?r.readRightID():null,F?r.readParentInfo()?t.get(r.readString()):r.readLeftID():null,F&&(B&y.KJ)===y.KJ?r.readString():null,es(r,B));b[W]=X,U+=X.length}}}}return e},V=(r,t,e)=>{const i=[];let o=it.HT(e.keys()).sort((ht,gt)=>ht-gt);if(o.length===0)return null;const c=()=>{if(o.length===0)return null;let ht=e.get(o[o.length-1]);for(;ht.refs.length===ht.i;)if(o.pop(),o.length>0)ht=e.get(o[o.length-1]);else return null;return ht};let b=c();if(b===null)return null;const S=new wn,U=new Map,W=(ht,gt)=>{const Wt=U.get(ht);(Wt==null||Wt>gt)&&U.set(ht,gt)};let B=b.refs[b.i++];const F=new Map,X=()=>{for(const ht of i){const gt=ht.id.client,Wt=e.get(gt);Wt?(Wt.i--,S.clients.set(gt,Wt.refs.slice(Wt.i)),e.delete(gt),Wt.i=0,Wt.refs=[]):S.clients.set(gt,[ht]),o=o.filter(Ot=>Ot!==gt)}i.length=0};for(;;){if(B.constructor!==le){const gt=x._4(F,B.id.client,()=>$t(t,B.id.client))-B.id.clock;if(gt<0)i.push(B),W(B.id.client,B.id.clock-1),X();else{const Wt=B.getMissing(r,t);if(Wt!==null){i.push(B);const Ot=e.get(Wt)||{refs:[],i:0};if(Ot.refs.length===Ot.i)W(Wt,$t(t,Wt)),X();else{B=Ot.refs[Ot.i++];continue}}else(gt===0||gt<B.length)&&(B.integrate(r,gt),F.set(B.id.client,B.id.clock+B.length))}}if(i.length>0)B=i.pop();else if(b!==null&&b.i<b.refs.length)B=b.refs[b.i++];else{if(b=c(),b===null)break;B=b.refs[b.i++]}}if(S.clients.size>0){const ht=new Jt;return nt(ht,S,new Map),C.zd(ht.restEncoder,0),{missing:U,update:ht.toUint8Array()}}return null},v=(r,t)=>nt(r,t.doc.store,t.beforeState),D=(r,t,e,i=new Dt(r))=>Yt(t,o=>{o.local=!1;let c=!1;const b=o.doc,S=b.store,U=vt(i,b),W=V(o,S,U),B=S.pendingStructs;if(B){for(const[X,ht]of B.missing)if(ht<$t(S,X)){c=!0;break}if(W){for(const[X,ht]of W.missing){const gt=B.missing.get(X);(gt==null||gt>ht)&&B.missing.set(X,ht)}B.update=We([B.update,W.update])}}else S.pendingStructs=W;const F=ee(i,o,S);if(S.pendingDs){const X=new Dt(m.$C(S.pendingDs));m.cw(X.restDecoder);const ht=ee(X,o,S);F&&ht?S.pendingDs=We([F,ht]):S.pendingDs=F||ht}else S.pendingDs=F;if(c){const X=S.pendingStructs.update;S.pendingStructs=null,pt(o.doc,X)}},e,!1),tt=(r,t,e)=>D(r,t,e,new mt(r)),pt=(r,t,e,i=Dt)=>{const o=m.$C(t);D(o,r,e,new i(o))},n=(r,t,e)=>pt(r,t,e,mt),s=(r,t,e=new Map)=>{nt(r,t.store,e),xt(r,Nt(t.store))},l=(r,t=new Uint8Array([0]),e=new Jt)=>{const i=J(t);s(e,r,i);const o=[e.toUint8Array()];if(r.store.pendingDs&&o.push(r.store.pendingDs),r.store.pendingStructs&&o.push(In(r.store.pendingStructs.update,t)),o.length>1){if(e.constructor===Qt)return hs(o.map((c,b)=>b===0?c:ms(c)));if(e.constructor===Jt)return We(o)}return o[0]},R=(r,t)=>l(r,t,new Qt),Y=r=>{const t=new Map,e=m.cw(r.restDecoder);for(let i=0;i<e;i++){const o=m.cw(r.restDecoder),c=m.cw(r.restDecoder);t.set(o,c)}return t},J=r=>Y(new dt(m.$C(r))),at=(r,t)=>(C.zd(r.restEncoder,t.size),it.HT(t.entries()).sort((e,i)=>i[0]-e[0]).forEach(([e,i])=>{C.zd(r.restEncoder,e),C.zd(r.restEncoder,i)}),r),Rt=(r,t)=>at(r,Ne(t.store)),zt=(r,t=new Kt)=>(r instanceof Map?at(t,r):Rt(t,r),t.toUint8Array()),Ut=r=>zt(r,new Ht);class Lt{constructor(){this.l=[]}}const jt=()=>new Lt,ie=(r,t)=>r.l.push(t),q=(r,t)=>{const e=r.l,i=e.length;r.l=e.filter(o=>t!==o),i===r.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},ot=(r,t,e)=>p.OK(r.l,[t,e]);class bt{constructor(t,e){this.client=t,this.clock=e}}const Mt=(r,t)=>r===t||r!==null&&t!==null&&r.client===t.client&&r.clock===t.clock,yt=(r,t)=>new bt(r,t),Xt=(r,t)=>{encoding.writeVarUint(r,t.client),encoding.writeVarUint(r,t.clock)},ne=r=>yt(decoding.readVarUint(r),decoding.readVarUint(r)),se=r=>{for(const[t,e]of r.doc.share.entries())if(e===r)return t;throw u.Mq()},de=(r,t)=>{for(;t!==null;){if(t.parent===r)return!0;t=t.parent._item}return!1},Ue=r=>{const t=[];let e=r._start;for(;e;)t.push(e),e=e.right;console.log("Children: ",t),console.log("Children content: ",t.filter(i=>!i.deleted).map(i=>i.content))};class mn{constructor(t,e=t.getMap("users")){const i=new Map;this.yusers=e,this.doc=t,this.clients=new Map,this.dss=i;const o=(c,b)=>{const S=c.get("ds"),U=c.get("ids"),W=B=>this.clients.set(B,b);S.observe(B=>{B.changes.added.forEach(F=>{F.content.getContent().forEach(X=>{X instanceof Uint8Array&&this.dss.set(b,wt([this.dss.get(b)||kt(),_t(new dt(decoding.createDecoder(X)))]))})})}),this.dss.set(b,wt(S.map(B=>_t(new dt(decoding.createDecoder(B)))))),U.observe(B=>B.changes.added.forEach(F=>F.content.getContent().forEach(W))),U.forEach(W)};e.observe(c=>{c.keysChanged.forEach(b=>o(e.get(b),b))}),e.forEach(o)}setUserMapping(t,e,i,{filter:o=()=>!0}={}){const c=this.yusers;let b=c.get(i);b||(b=new Ce,b.set("ids",new we),b.set("ds",new we),c.set(i,b)),b.get("ids").push([e]),c.observe(S=>{setTimeout(()=>{const U=c.get(i);if(U!==b){b=U,this.clients.forEach((F,X)=>{i===F&&b.get("ids").push([X])});const W=new Ht,B=this.dss.get(i);B&&(xt(W,B),b.get("ds").push([W.toUint8Array()]))}},0)}),t.on("afterTransaction",S=>{setTimeout(()=>{const U=b.get("ds"),W=S.deleteSet;if(S.local&&W.clients.size>0&&o(S,W)){const B=new Ht;xt(B,W),U.push([B.toUint8Array()])}})})}getUserByClientId(t){return this.clients.get(t)||null}getUserByDeletedId(t){for(const[e,i]of this.dss.entries())if(Q(i,t))return e;return null}}class Re{constructor(t,e,i,o=0){this.type=t,this.tname=e,this.item=i,this.assoc=o}}const Me=r=>{const t={};return r.type&&(t.type=r.type),r.tname&&(t.tname=r.tname),r.item&&(t.item=r.item),r.assoc!=null&&(t.assoc=r.assoc),t},yn=r=>{var t;return new Re(r.type==null?null:yt(r.type.client,r.type.clock),(t=r.tname)!=null?t:null,r.item==null?null:yt(r.item.client,r.item.clock),r.assoc==null?0:r.assoc)};class Ze{constructor(t,e,i=0){this.type=t,this.index=e,this.assoc=i}}const tn=(r,t,e=0)=>new Ze(r,t,e),N=(r,t,e)=>{let i=null,o=null;return r._item===null?o=se(r):i=yt(r._item.id.client,r._item.id.clock),new Re(i,o,t,e)},K=(r,t,e=0)=>{let i=r._start;if(e<0){if(t===0)return N(r,null,e);t--}for(;i!==null;){if(!i.deleted&&i.countable){if(i.length>t)return N(r,yt(i.id.client,i.id.clock+t),e);t-=i.length}if(i.right===null&&e<0)return N(r,i.lastId,e);i=i.right}return N(r,null,e)},$=(r,t)=>{const{type:e,tname:i,item:o,assoc:c}=t;if(o!==null)encoding.writeVarUint(r,0),Xt(r,o);else if(i!==null)encoding.writeUint8(r,1),encoding.writeVarString(r,i);else if(e!==null)encoding.writeUint8(r,2),Xt(r,e);else throw error.unexpectedCase();return encoding.writeVarInt(r,c),r},ct=r=>{const t=encoding.createEncoder();return $(t,r),encoding.toUint8Array(t)},rt=r=>{let t=null,e=null,i=null;switch(decoding.readVarUint(r)){case 0:i=ne(r);break;case 1:e=decoding.readVarString(r);break;case 2:t=ne(r)}const o=decoding.hasContent(r)?decoding.readVarInt(r):0;return new Re(t,e,i,o)},Et=r=>rt(decoding.createDecoder(r)),ft=(r,t,e=!0)=>{const i=t.store,o=r.item,c=r.type,b=r.tname,S=r.assoc;let U=null,W=0;if(o!==null){if($t(i,o.client)<=o.clock)return null;const B=e?pn(i,o):{item:De(i,o),diff:0},F=B.item;if(!(F instanceof Gt))return null;if(U=F.parent,U._item===null||!U._item.deleted){W=F.deleted||!F.countable?0:B.diff+(S>=0?0:1);let X=F.left;for(;X!==null;)!X.deleted&&X.countable&&(W+=X.length),X=X.left}}else{if(b!==null)U=t.get(b);else if(c!==null){if($t(i,c.client)<=c.clock)return null;const{item:B}=e?pn(i,c):{item:De(i,c)};if(B instanceof Gt&&B.content instanceof pe)U=B.content.type;else return null}else throw error.unexpectedCase();S>=0?W=U._length:W=0}return tn(U,W,r.assoc)},At=(r,t)=>r===t||r!==null&&t!==null&&r.tname===t.tname&&Mt(r.item,t.item)&&Mt(r.type,t.type)&&r.assoc===t.assoc;class It{constructor(t,e){this.ds=t,this.sv=e}}const Pt=(r,t)=>{const e=r.ds.clients,i=t.ds.clients,o=r.sv,c=t.sv;if(o.size!==c.size||e.size!==i.size)return!1;for(const[b,S]of o.entries())if(c.get(b)!==S)return!1;for(const[b,S]of e.entries()){const U=i.get(b)||[];if(S.length!==U.length)return!1;for(let W=0;W<S.length;W++){const B=S[W],F=U[W];if(B.clock!==F.clock||B.len!==F.len)return!1}}return!0},Bt=(r,t=new Kt)=>(xt(t,r.ds),at(t,r.sv),t.toUint8Array()),te=r=>Bt(r,new Ht),oe=(r,t=new Tt(decoding.createDecoder(r)))=>new It(_t(t),Y(t)),ge=r=>oe(r,new dt(decoding.createDecoder(r))),Se=(r,t)=>new It(r,t),bn=Se(kt(),new Map),en=r=>Se(Nt(r.store),Ne(r.store)),me=(r,t)=>t===void 0?!r.deleted:t.sv.has(r.id.client)&&(t.sv.get(r.id.client)||0)>r.id.clock&&!Q(t.ds,r.id),nn=(r,t)=>{const e=x._4(r.meta,nn,d.vt),i=r.doc.store;e.has(t)||(t.sv.forEach((o,c)=>{o<$t(i,c)&&ce(r,yt(c,o))}),L(r,t.ds,o=>{}),e.add(t))},rr=(r,t,e=new st)=>{if(r.gc)throw new Error("Garbage-collection must be disabled in `originDoc`!");const{sv:i,ds:o}=t,c=new Jt;return r.transact(b=>{let S=0;i.forEach(U=>{U>0&&S++}),encoding.writeVarUint(c.restEncoder,S);for(const[U,W]of i){if(W===0)continue;W<$t(r.store,U)&&ce(b,yt(U,W));const B=r.store.clients.get(U)||[],F=he(B,W-1);encoding.writeVarUint(c.restEncoder,F+1),c.writeClient(U),encoding.writeVarUint(c.restEncoder,0);for(let X=0;X<=F;X++)B[X].write(c,0)}xt(c,o)}),pt(e,c.toUint8Array(),"snapshot"),e},is=(r,t,e=Dt)=>{const i=new e(decoding.createDecoder(t)),o=new ye(i,!1);for(let b=o.curr;b!==null;b=o.next())if((r.sv.get(b.id.client)||0)<b.id.clock+b.length)return!1;const c=wt([r.ds,_t(i)]);return qt(r.ds,c)},ir=(r,t)=>is(r,t,mt);class wn{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const Ne=r=>{const t=new Map;return r.clients.forEach((e,i)=>{const o=e[e.length-1];t.set(i,o.id.clock+o.length)}),t},$t=(r,t)=>{const e=r.clients.get(t);if(e===void 0)return 0;const i=e[e.length-1];return i.id.clock+i.length},_n=(r,t)=>{let e=r.clients.get(t.id.client);if(e===void 0)e=[],r.clients.set(t.id.client,e);else{const i=e[e.length-1];if(i.id.clock+i.length!==t.id.clock)throw u.Mq()}e.push(t)},he=(r,t)=>{let e=0,i=r.length-1,o=r[i],c=o.id.clock;if(c===t)return i;let b=Z.RI(t/(c+o.length-1)*i);for(;e<=i;){if(o=r[b],c=o.id.clock,c<=t){if(t<c+o.length)return b;e=b+1}else i=b-1;b=Z.RI((e+i)/2)}throw u.Mq()},De=(r,t)=>{const e=r.clients.get(t.client);return e[he(e,t.clock)]},sn=(r,t,e)=>{const i=he(t,e),o=t[i];return o.id.clock<e&&o instanceof Gt?(t.splice(i+1,0,Xe(r,o,e-o.id.clock)),i+1):i},ce=(r,t)=>{const e=r.doc.store.clients.get(t.client);return e[sn(r,e,t.clock)]},vn=(r,t,e)=>{const i=t.clients.get(e.client),o=he(i,e.clock),c=i[o];return e.clock!==c.id.clock+c.length-1&&c.constructor!==ae&&i.splice(o+1,0,Xe(r,c,e.clock-c.id.clock+1)),c},os=(r,t,e)=>{const i=r.clients.get(t.id.client);i[he(i,t.id.clock)]=e},En=(r,t,e,i,o)=>{if(i===0)return;const c=e+i;let b=sn(r,t,e),S;do S=t[b++],c<S.id.clock+S.length&&sn(r,t,c),o(S);while(b<t.length&&t[b].id.clock<c)};class cs{constructor(t,e,i){this.doc=t,this.deleteSet=new z,this.beforeState=Ne(t.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=e,this.meta=new Map,this.local=i,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const Sn=(r,t)=>t.deleteSet.clients.size===0&&!x.bz(t.afterState,(e,i)=>t.beforeState.get(i)!==e)?!1:(lt(t.deleteSet),v(r,t),xt(r,t.deleteSet),!0),Cn=(r,t,e)=>{const i=t._item;(i===null||i.id.clock<(r.beforeState.get(i.id.client)||0)&&!i.deleted)&&x._4(r.changed,t,d.vt).add(e)},Ve=(r,t)=>{let e=r[t],i=r[t-1],o=t;for(;o>0;e=i,i=r[--o-1]){if(i.deleted===e.deleted&&i.constructor===e.constructor&&i.mergeWith(e)){e instanceof Gt&&e.parentSub!==null&&e.parent._map.get(e.parentSub)===e&&e.parent._map.set(e.parentSub,i);continue}break}const c=t-o;return c&&r.splice(t+1-c,c),c},kn=(r,t,e)=>{for(const[i,o]of r.clients.entries()){const c=t.clients.get(i);for(let b=o.length-1;b>=0;b--){const S=o[b],U=S.clock+S.len;for(let W=he(c,S.clock),B=c[W];W<c.length&&B.id.clock<U;B=c[++W]){const F=c[W];if(S.clock+S.len<=F.id.clock)break;F instanceof Gt&&F.deleted&&!F.keep&&e(F)&&F.gc(t,!1)}}}},Tn=(r,t)=>{r.clients.forEach((e,i)=>{const o=t.clients.get(i);for(let c=e.length-1;c>=0;c--){const b=e[c],S=Z.jk(o.length-1,1+he(o,b.clock+b.len-1));for(let U=S,W=o[U];U>0&&W.id.clock>=b.clock;W=o[U])U-=1+Ve(o,U)}})},cr=(r,t,e)=>{kn(r,t,e),Tn(r,t)},Rn=(r,t)=>{if(t<r.length){const e=r[t],i=e.doc,o=i.store,c=e.deleteSet,b=e._mergeStructs;try{lt(c),e.afterState=Ne(e.doc.store),i.emit("beforeObserverCalls",[e,i]);const S=[];e.changed.forEach((U,W)=>S.push(()=>{(W._item===null||!W._item.deleted)&&W._callObserver(e,U)})),S.push(()=>{e.changedParentTypes.forEach((U,W)=>{W._dEH.l.length>0&&(W._item===null||!W._item.deleted)&&(U=U.filter(B=>B.target._item===null||!B.target._item.deleted),U.forEach(B=>{B.currentTarget=W,B._path=null}),U.sort((B,F)=>B.path.length-F.path.length),ot(W._dEH,U,e))})}),S.push(()=>i.emit("afterTransaction",[e,i])),(0,p.OK)(S,[]),e._needFormattingCleanup&&Is(e)}finally{i.gc&&kn(c,o,i.gcFilter),Tn(c,o),e.afterState.forEach((B,F)=>{const X=e.beforeState.get(F)||0;if(X!==B){const ht=o.clients.get(F),gt=Z.T9(he(ht,X),1);for(let Wt=ht.length-1;Wt>=gt;)Wt-=1+Ve(ht,Wt)}});for(let B=b.length-1;B>=0;B--){const{client:F,clock:X}=b[B].id,ht=o.clients.get(F),gt=he(ht,X);gt+1<ht.length&&Ve(ht,gt+1)>1||gt>0&&Ve(ht,gt)}if(!e.local&&e.afterState.get(i.clientID)!==e.beforeState.get(i.clientID)&&(j.yy(k.hN,k.Y,"[yjs] ",k.Ny,k.UH,"Changed the client-id because another client seems to be using it."),i.clientID=ut()),i.emit("afterTransactionCleanup",[e,i]),i._observers.has("update")){const B=new Qt;Sn(B,e)&&i.emit("update",[B.toUint8Array(),e.origin,i,e])}if(i._observers.has("updateV2")){const B=new Jt;Sn(B,e)&&i.emit("updateV2",[B.toUint8Array(),e.origin,i,e])}const{subdocsAdded:S,subdocsLoaded:U,subdocsRemoved:W}=e;(S.size>0||W.size>0||U.size>0)&&(S.forEach(B=>{B.clientID=i.clientID,B.collectionid==null&&(B.collectionid=i.collectionid),i.subdocs.add(B)}),W.forEach(B=>i.subdocs.delete(B)),i.emit("subdocs",[{loaded:U,added:S,removed:W},i,e]),W.forEach(B=>B.destroy())),r.length<=t+1?(i._transactionCleanups=[],i.emit("afterAllTransactions",[i,r])):Rn(r,t+1)}}},Yt=(r,t,e=null,i=!0)=>{const o=r._transactionCleanups;let c=!1,b=null;r._transaction===null&&(c=!0,r._transaction=new cs(r,e,i),o.push(r._transaction),o.length===1&&r.emit("beforeAllTransactions",[r]),r.emit("beforeTransaction",[r._transaction,r]));try{b=t(r._transaction)}finally{if(c){const S=r._transaction===o[0];r._transaction=null,S&&Rn(o,0)}}return b};class ls{constructor(t,e){this.insertions=e,this.deletions=t,this.meta=new Map}}const Dn=(r,t,e)=>{L(r,e.deletions,i=>{i instanceof Gt&&t.scope.some(o=>de(o,i))&&gn(i,!1)})},An=(r,t,e)=>{let i=null;const o=r.doc,c=r.scope;Yt(o,S=>{for(;t.length>0&&r.currStackItem===null;){const U=o.store,W=t.pop(),B=new Set,F=[];let X=!1;L(S,W.insertions,ht=>{if(ht instanceof Gt){if(ht.redone!==null){let{item:gt,diff:Wt}=pn(U,ht.id);Wt>0&&(gt=ce(S,yt(gt.id.client,gt.id.clock+Wt))),ht=gt}!ht.deleted&&c.some(gt=>de(gt,ht))&&F.push(ht)}}),L(S,W.deletions,ht=>{ht instanceof Gt&&c.some(gt=>de(gt,ht))&&!Q(W.insertions,ht.id)&&B.add(ht)}),B.forEach(ht=>{X=ts(S,ht,B,W.insertions,r.ignoreRemoteMapChanges,r)!==null||X});for(let ht=F.length-1;ht>=0;ht--){const gt=F[ht];r.deleteFilter(gt)&&(gt.delete(S),X=!0)}r.currStackItem=X?W:null}S.changed.forEach((U,W)=>{U.has(null)&&W._searchMarker&&(W._searchMarker.length=0)}),i=S},r);const b=r.currStackItem;if(b!=null){const S=i.changedParentTypes;r.emit("stack-item-popped",[{stackItem:b,type:e,changedParentTypes:S,origin:r},r]),r.currStackItem=null}return b};class lr extends et.W{constructor(t,{captureTimeout:e=500,captureTransaction:i=U=>!0,deleteFilter:o=()=>!0,trackedOrigins:c=new Set([null]),ignoreRemoteMapChanges:b=!1,doc:S=it.cy(t)?t[0].doc:t.doc}={}){super(),this.scope=[],this.doc=S,this.addToScope(t),this.deleteFilter=o,c.add(this),this.trackedOrigins=c,this.captureTransaction=i,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.currStackItem=null,this.lastChange=0,this.ignoreRemoteMapChanges=b,this.captureTimeout=e,this.afterTransactionHandler=U=>{if(!this.captureTransaction(U)||!this.scope.some(Ot=>U.changedParentTypes.has(Ot))||!this.trackedOrigins.has(U.origin)&&(!U.origin||!this.trackedOrigins.has(U.origin.constructor)))return;const W=this.undoing,B=this.redoing,F=W?this.redoStack:this.undoStack;W?this.stopCapturing():B||this.clear(!1,!0);const X=new z;U.afterState.forEach((Ot,Ft)=>{const ue=U.beforeState.get(Ft)||0,rs=Ot-ue;rs>0&&Ct(X,Ft,ue,rs)});const ht=_._g();let gt=!1;if(this.lastChange>0&&ht-this.lastChange<this.captureTimeout&&F.length>0&&!W&&!B){const Ot=F[F.length-1];Ot.deletions=wt([Ot.deletions,U.deleteSet]),Ot.insertions=wt([Ot.insertions,X])}else F.push(new ls(U.deleteSet,X)),gt=!0;!W&&!B&&(this.lastChange=ht),L(U,U.deleteSet,Ot=>{Ot instanceof Gt&&this.scope.some(Ft=>de(Ft,Ot))&&gn(Ot,!0)});const Wt=[{stackItem:F[F.length-1],origin:U.origin,type:W?"redo":"undo",changedParentTypes:U.changedParentTypes},this];gt?this.emit("stack-item-added",Wt):this.emit("stack-item-updated",Wt)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",()=>{this.destroy()})}addToScope(t){t=it.cy(t)?t:[t],t.forEach(e=>{this.scope.every(i=>i!==e)&&(e.doc!==this.doc&&j.R8("[yjs#509] Not same Y.Doc"),this.scope.push(e))})}addTrackedOrigin(t){this.trackedOrigins.add(t)}removeTrackedOrigin(t){this.trackedOrigins.delete(t)}clear(t=!0,e=!0){(t&&this.canUndo()||e&&this.canRedo())&&this.doc.transact(i=>{t&&(this.undoStack.forEach(o=>Dn(i,this,o)),this.undoStack=[]),e&&(this.redoStack.forEach(o=>Dn(i,this,o)),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:t,redoStackCleared:e}])})}stopCapturing(){this.lastChange=0}undo(){this.undoing=!0;let t;try{t=An(this,this.undoStack,"undo")}finally{this.undoing=!1}return t}redo(){this.redoing=!0;let t;try{t=An(this,this.redoStack,"redo")}finally{this.redoing=!1}return t}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}}function*as(r){const t=m.cw(r.restDecoder);for(let e=0;e<t;e++){const i=m.cw(r.restDecoder),o=r.readClient();let c=m.cw(r.restDecoder);for(let b=0;b<i;b++){const S=r.readInfo();if(S===10){const U=m.cw(r.restDecoder);yield new le(yt(o,c),U),c+=U}else if(y.WY&S){const U=(S&(y.D7|y.wt))===0,W=new Gt(yt(o,c),null,(S&y.wt)===y.wt?r.readLeftID():null,null,(S&y.D7)===y.D7?r.readRightID():null,U?r.readParentInfo()?r.readString():r.readLeftID():null,U&&(S&y.KJ)===y.KJ?r.readString():null,es(r,S));yield W,c+=W.length}else{const U=r.readLen();yield new ae(yt(o,c),U),c+=U}}}}class ye{constructor(t,e){this.gen=as(t),this.curr=null,this.done=!1,this.filterSkips=e,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===le);return this.curr}}const ar=r=>us(r,mt),us=(r,t=Dt)=>{const e=[],i=new t(decoding.createDecoder(r)),o=new ye(i,!1);for(let b=o.curr;b!==null;b=o.next())e.push(b);logging.print("Structs: ",e);const c=_t(i);logging.print("DeleteSet: ",c)},ur=r=>ds(r,mt),ds=(r,t=Dt)=>{const e=[],i=new t(decoding.createDecoder(r)),o=new ye(i,!1);for(let c=o.curr;c!==null;c=o.next())e.push(c);return{structs:e,ds:_t(i)}};class rn{constructor(t){this.currClient=0,this.startClock=0,this.written=0,this.encoder=t,this.clientStructs=[]}}const hs=r=>We(r,mt,Qt),fs=(r,t=Kt,e=Dt)=>{const i=new t,o=new ye(new e(decoding.createDecoder(r)),!1);let c=o.curr;if(c!==null){let b=0,S=c.id.client,U=c.id.clock!==0,W=U?0:c.id.clock+c.length;for(;c!==null;c=o.next())S!==c.id.client&&(W!==0&&(b++,encoding.writeVarUint(i.restEncoder,S),encoding.writeVarUint(i.restEncoder,W)),S=c.id.client,W=0,U=c.id.clock!==0),c.constructor===le&&(U=!0),U||(W=c.id.clock+c.length);W!==0&&(b++,encoding.writeVarUint(i.restEncoder,S),encoding.writeVarUint(i.restEncoder,W));const B=encoding.createEncoder();return encoding.writeVarUint(B,b),encoding.writeBinaryEncoder(B,i.restEncoder),i.restEncoder=B,i.toUint8Array()}else return encoding.writeVarUint(i.restEncoder,0),i.toUint8Array()},dr=r=>fs(r,Ht,mt),ps=(r,t=Dt)=>{const e=new Map,i=new Map,o=new ye(new t(decoding.createDecoder(r)),!1);let c=o.curr;if(c!==null){let b=c.id.client,S=c.id.clock;for(e.set(b,S);c!==null;c=o.next())b!==c.id.client&&(i.set(b,S),e.set(c.id.client,c.id.clock),b=c.id.client),S=c.id.clock+c.length;i.set(b,S)}return{from:e,to:i}},hr=r=>ps(r,mt),gs=(r,t)=>{if(r.constructor===ae){const{client:e,clock:i}=r.id;return new ae(yt(e,i+t),r.length-t)}else if(r.constructor===le){const{client:e,clock:i}=r.id;return new le(yt(e,i+t),r.length-t)}else{const e=r,{client:i,clock:o}=e.id;return new Gt(yt(i,o+t),null,yt(i,o+t-1),null,e.rightOrigin,e.parent,e.parentSub,e.content.splice(t))}},We=(r,t=Dt,e=Jt)=>{if(r.length===1)return r[0];const i=r.map(B=>new t(m.$C(B)));let o=i.map(B=>new ye(B,!0)),c=null;const b=new e,S=new rn(b);for(;o=o.filter(X=>X.curr!==null),o.sort((X,ht)=>{if(X.curr.id.client===ht.curr.id.client){const gt=X.curr.id.clock-ht.curr.id.clock;return gt===0?X.curr.constructor===ht.curr.constructor?0:X.curr.constructor===le?1:-1:gt}else return ht.curr.id.client-X.curr.id.client}),o.length!==0;){const B=o[0],F=B.curr.id.client;if(c!==null){let X=B.curr,ht=!1;for(;X!==null&&X.id.clock+X.length<=c.struct.id.clock+c.struct.length&&X.id.client>=c.struct.id.client;)X=B.next(),ht=!0;if(X===null||X.id.client!==F||ht&&X.id.clock>c.struct.id.clock+c.struct.length)continue;if(F!==c.struct.id.client)be(S,c.struct,c.offset),c={struct:X,offset:0},B.next();else if(c.struct.id.clock+c.struct.length<X.id.clock)if(c.struct.constructor===le)c.struct.length=X.id.clock+X.length-c.struct.id.clock;else{be(S,c.struct,c.offset);const gt=X.id.clock-c.struct.id.clock-c.struct.length;c={struct:new le(yt(F,c.struct.id.clock+c.struct.length),gt),offset:0}}else{const gt=c.struct.id.clock+c.struct.length-X.id.clock;gt>0&&(c.struct.constructor===le?c.struct.length-=gt:X=gs(X,gt)),c.struct.mergeWith(X)||(be(S,c.struct,c.offset),c={struct:X,offset:0},B.next())}}else c={struct:B.curr,offset:0},B.next();for(let X=B.curr;X!==null&&X.id.client===F&&X.id.clock===c.struct.id.clock+c.struct.length&&X.constructor!==le;X=B.next())be(S,c.struct,c.offset),c={struct:X,offset:0}}c!==null&&(be(S,c.struct,c.offset),c=null),on(S);const U=i.map(B=>_t(B)),W=wt(U);return xt(b,W),b.toUint8Array()},In=(r,t,e=Dt,i=Jt)=>{const o=J(t),c=new i,b=new rn(c),S=new e(m.$C(r)),U=new ye(S,!1);for(;U.curr;){const B=U.curr,F=B.id.client,X=o.get(F)||0;if(U.curr.constructor===le){U.next();continue}if(B.id.clock+B.length>X)for(be(b,B,Z.T9(X-B.id.clock,0)),U.next();U.curr&&U.curr.id.client===F;)be(b,U.curr,0),U.next();else for(;U.curr&&U.curr.id.client===F&&U.curr.id.clock+U.curr.length<=X;)U.next()}on(b);const W=_t(S);return xt(c,W),c.toUint8Array()},fr=(r,t)=>In(r,t,mt,Qt),On=r=>{r.written>0&&(r.clientStructs.push({written:r.written,restEncoder:C.Fo(r.encoder.restEncoder)}),r.encoder.restEncoder=C.xv(),r.written=0)},be=(r,t,e)=>{r.written>0&&r.currClient!==t.id.client&&On(r),r.written===0&&(r.currClient=t.id.client,r.encoder.writeClient(t.id.client),C.zd(r.encoder.restEncoder,t.id.clock+e)),t.write(r.encoder,e),r.written++},on=r=>{On(r);const t=r.encoder.restEncoder;C.zd(t,r.clientStructs.length);for(let e=0;e<r.clientStructs.length;e++){const i=r.clientStructs[e];C.zd(t,i.written),C.LH(t,i.restEncoder)}},ze=(r,t,e,i)=>{const o=new e(m.$C(r)),c=new ye(o,!1),b=new i,S=new rn(b);for(let W=c.curr;W!==null;W=c.next())be(S,t(W),0);on(S);const U=_t(o);return xt(b,U),b.toUint8Array()},xn=({formatting:r=!0,subdocs:t=!0,yxml:e=!0}={})=>{let i=0;const o=map.create(),c=map.create(),b=map.create(),S=map.create();return S.set(null,null),U=>{switch(U.constructor){case ae:case le:return U;case Gt:{const W=U,B=W.content;switch(B.constructor){case xe:break;case pe:{if(e){const F=B.type;F instanceof Te&&(F.nodeName=map.setIfUndefined(c,F.nodeName,()=>"node-"+i)),F instanceof Fe&&(F.hookName=map.setIfUndefined(c,F.hookName,()=>"hook-"+i))}break}case Ee:{const F=B;F.arr=F.arr.map(()=>i);break}case Oe:{const F=B;F.content=new Uint8Array([i]);break}case Le:{const F=B;t&&(F.opts={},F.doc.guid=i+"");break}case ve:{const F=B;F.embed={};break}case Zt:{const F=B;r&&(F.key=map.setIfUndefined(b,F.key,()=>i+""),F.value=map.setIfUndefined(S,F.value,()=>({i})));break}case Pe:{const F=B;F.arr=F.arr.map(()=>i);break}case fe:{const F=B;F.str=string.repeat(i%10+"",F.str.length);break}default:error.unexpectedCase()}return W.parentSub&&(W.parentSub=map.setIfUndefined(o,W.parentSub,()=>i+"")),i++,U}default:error.unexpectedCase()}}},pr=(r,t)=>ze(r,xn(t),mt,Qt),gr=(r,t)=>ze(r,xn(t),Dt,Jt),mr=r=>ze(r,f.id,mt,Jt),ms=r=>ze(r,p.id,Dt,Qt),Ln="You must not compute changes after the event-handler fired.";class He{constructor(t,e){this.target=t,this.currentTarget=t,this.transaction=e,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=ys(this.currentTarget,this.target))}deletes(t){return Q(this.transaction.deleteSet,t.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw u.vt(Ln);const t=new Map,e=this.target;this.transaction.changed.get(e).forEach(o=>{if(o!==null){const c=e._map.get(o);let b,S;if(this.adds(c)){let U=c.left;for(;U!==null&&this.adds(U);)U=U.left;if(this.deletes(c))if(U!==null&&this.deletes(U))b="delete",S=it.HV(U.content.getContent());else return;else U!==null&&this.deletes(U)?(b="update",S=it.HV(U.content.getContent())):(b="add",S=void 0)}else if(this.deletes(c))b="delete",S=it.HV(c.content.getContent());else return;t.set(o,{action:b,oldValue:S})}}),this._keys=t}return this._keys}get delta(){return this.changes.delta}adds(t){return t.id.clock>=(this.transaction.beforeState.get(t.id.client)||0)}get changes(){let t=this._changes;if(t===null){if(this.transaction.doc._transactionCleanups.length===0)throw u.vt(Ln);const e=this.target,i=d.vt(),o=d.vt(),c=[];if(t={added:i,deleted:o,delta:c,keys:this.keys},this.transaction.changed.get(e).has(null)){let S=null;const U=()=>{S&&c.push(S)};for(let W=e._start;W!==null;W=W.right)W.deleted?this.deletes(W)&&!this.adds(W)&&((S===null||S.delete===void 0)&&(U(),S={delete:0}),S.delete+=W.length,o.add(W)):this.adds(W)?((S===null||S.insert===void 0)&&(U(),S={insert:[]}),S.insert=S.insert.concat(W.content.getContent()),i.add(W)):((S===null||S.retain===void 0)&&(U(),S={retain:0}),S.retain+=W.length);S!==null&&S.retain===void 0&&U()}this._changes=t}return t}}const ys=(r,t)=>{const e=[];for(;t._item!==null&&t!==r;){if(t._item.parentSub!==null)e.unshift(t._item.parentSub);else{let i=0,o=t._item.parent._start;for(;o!==t._item&&o!==null;)!o.deleted&&o.countable&&(i+=o.length),o=o.right;e.unshift(i)}t=t._item.parent}return e},Un=80;let cn=0;class bs{constructor(t,e){t.marker=!0,this.p=t,this.index=e,this.timestamp=cn++}}const ws=r=>{r.timestamp=cn++},Mn=(r,t,e)=>{r.p.marker=!1,r.p=t,t.marker=!0,r.index=e,r.timestamp=cn++},_s=(r,t,e)=>{if(r.length>=Un){const i=r.reduce((o,c)=>o.timestamp<c.timestamp?o:c);return Mn(i,t,e),i}else{const i=new bs(t,e);return r.push(i),i}},Ke=(r,t)=>{if(r._start===null||t===0||r._searchMarker===null)return null;const e=r._searchMarker.length===0?null:r._searchMarker.reduce((c,b)=>Z.tn(t-c.index)<Z.tn(t-b.index)?c:b);let i=r._start,o=0;for(e!==null&&(i=e.p,o=e.index,ws(e));i.right!==null&&o<t;){if(!i.deleted&&i.countable){if(t<o+i.length)break;o+=i.length}i=i.right}for(;i.left!==null&&o>t;)i=i.left,!i.deleted&&i.countable&&(o-=i.length);for(;i.left!==null&&i.left.id.client===i.id.client&&i.left.id.clock+i.left.length===i.id.clock;)i=i.left,!i.deleted&&i.countable&&(o-=i.length);return e!==null&&Z.tn(e.index-o)<i.parent.length/Un?(Mn(e,i,o),e):_s(r._searchMarker,i,o)},je=(r,t,e)=>{for(let i=r.length-1;i>=0;i--){const o=r[i];if(e>0){let c=o.p;for(c.marker=!1;c&&(c.deleted||!c.countable);)c=c.left,c&&!c.deleted&&c.countable&&(o.index-=c.length);if(c===null||c.marker===!0){r.splice(i,1);continue}o.p=c,c.marker=!0}(t<o.index||e>0&&t===o.index)&&(o.index=Z.T9(t,o.index+e))}},yr=r=>{let t=r._start;const e=[];for(;t;)e.push(t),t=t.right;return e},Ye=(r,t,e)=>{const i=r,o=t.changedParentTypes;for(;x._4(o,r,()=>[]).push(e),r._item!==null;)r=r._item.parent;ot(i._eH,e,t)};class re{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=jt(),this._dEH=jt(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(t,e){this.doc=t,this._item=e}_copy(){throw u.bD()}clone(){throw u.bD()}_write(t){}get _first(){let t=this._start;for(;t!==null&&t.deleted;)t=t.right;return t}_callObserver(t,e){!t.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(t){ie(this._eH,t)}observeDeep(t){ie(this._dEH,t)}unobserve(t){q(this._eH,t)}unobserveDeep(t){q(this._dEH,t)}toJSON(){}}const Nn=(r,t,e)=>{t<0&&(t=r._length+t),e<0&&(e=r._length+e);let i=e-t;const o=[];let c=r._start;for(;c!==null&&i>0;){if(c.countable&&!c.deleted){const b=c.content.getContent();if(b.length<=t)t-=b.length;else{for(let S=t;S<b.length&&i>0;S++)o.push(b[S]),i--;t=0}}c=c.right}return o},jn=r=>{const t=[];let e=r._start;for(;e!==null;){if(e.countable&&!e.deleted){const i=e.content.getContent();for(let o=0;o<i.length;o++)t.push(i[o])}e=e.right}return t},br=(r,t)=>{const e=[];let i=r._start;for(;i!==null;){if(i.countable&&me(i,t)){const o=i.content.getContent();for(let c=0;c<o.length;c++)e.push(o[c])}i=i.right}return e},Be=(r,t)=>{let e=0,i=r._start;for(;i!==null;){if(i.countable&&!i.deleted){const o=i.content.getContent();for(let c=0;c<o.length;c++)t(o[c],e++,r)}i=i.right}},Bn=(r,t)=>{const e=[];return Be(r,(i,o)=>{e.push(t(i,o,r))}),e},vs=r=>{let t=r._start,e=null,i=0;return{[Symbol.iterator](){return this},next:()=>{if(e===null){for(;t!==null&&t.deleted;)t=t.right;if(t===null)return{done:!0,value:void 0};e=t.content.getContent(),i=0,t=t.right}const o=e[i++];return e.length<=i&&(e=null),{done:!1,value:o}}}},Fn=(r,t)=>{const e=Ke(r,t);let i=r._start;for(e!==null&&(i=e.p,t-=e.index);i!==null;i=i.right)if(!i.deleted&&i.countable){if(t<i.length)return i.content.getContent()[t];t-=i.length}},Ge=(r,t,e,i)=>{let o=e;const c=r.doc,b=c.clientID,S=c.store,U=e===null?t._start:e.right;let W=[];const B=()=>{W.length>0&&(o=new Gt(yt(b,$t(S,b)),o,o&&o.lastId,U,U&&U.id,t,null,new Ee(W)),o.integrate(r,0),W=[])};i.forEach(F=>{if(F===null)W.push(F);else switch(F.constructor){case Number:case Object:case Boolean:case Array:case String:W.push(F);break;default:switch(B(),F.constructor){case Uint8Array:case ArrayBuffer:o=new Gt(yt(b,$t(S,b)),o,o&&o.lastId,U,U&&U.id,t,null,new Oe(new Uint8Array(F))),o.integrate(r,0);break;case st:o=new Gt(yt(b,$t(S,b)),o,o&&o.lastId,U,U&&U.id,t,null,new Le(F)),o.integrate(r,0);break;default:if(F instanceof re)o=new Gt(yt(b,$t(S,b)),o,o&&o.lastId,U,U&&U.id,t,null,new pe(F)),o.integrate(r,0);else throw new Error("Unexpected content type in insert operation")}}}),B()},Pn=()=>u.vt("Length exceeded!"),Vn=(r,t,e,i)=>{if(e>t._length)throw Pn();if(e===0)return t._searchMarker&&je(t._searchMarker,e,i.length),Ge(r,t,null,i);const o=e,c=Ke(t,e);let b=t._start;for(c!==null&&(b=c.p,e-=c.index,e===0&&(b=b.prev,e+=b&&b.countable&&!b.deleted?b.length:0));b!==null;b=b.right)if(!b.deleted&&b.countable){if(e<=b.length){e<b.length&&ce(r,yt(b.id.client,b.id.clock+e));break}e-=b.length}return t._searchMarker&&je(t._searchMarker,o,i.length),Ge(r,t,b,i)},Es=(r,t,e)=>{let o=(t._searchMarker||[]).reduce((c,b)=>b.index>c.index?b:c,{index:0,p:t._start}).p;if(o)for(;o.right;)o=o.right;return Ge(r,t,o,e)},Wn=(r,t,e,i)=>{if(i===0)return;const o=e,c=i,b=Ke(t,e);let S=t._start;for(b!==null&&(S=b.p,e-=b.index);S!==null&&e>0;S=S.right)!S.deleted&&S.countable&&(e<S.length&&ce(r,yt(S.id.client,S.id.clock+e)),e-=S.length);for(;i>0&&S!==null;)S.deleted||(i<S.length&&ce(r,yt(S.id.client,S.id.clock+i)),S.delete(r),i-=S.length),S=S.right;if(i>0)throw Pn();t._searchMarker&&je(t._searchMarker,o,-c+i)},Je=(r,t,e)=>{const i=t._map.get(e);i!==void 0&&i.delete(r)},ln=(r,t,e,i)=>{const o=t._map.get(e)||null,c=r.doc,b=c.clientID;let S;if(i==null)S=new Ee([i]);else switch(i.constructor){case Number:case Object:case Boolean:case Array:case String:S=new Ee([i]);break;case Uint8Array:S=new Oe(i);break;case st:S=new Le(i);break;default:if(i instanceof re)S=new pe(i);else throw new Error("Unexpected content type")}new Gt(yt(b,$t(c.store,b)),o,o&&o.lastId,null,null,t,e,S).integrate(r,0)},an=(r,t)=>{const e=r._map.get(t);return e!==void 0&&!e.deleted?e.content.getContent()[e.length-1]:void 0},zn=r=>{const t={};return r._map.forEach((e,i)=>{e.deleted||(t[i]=e.content.getContent()[e.length-1])}),t},Hn=(r,t)=>{const e=r._map.get(t);return e!==void 0&&!e.deleted},wr=(r,t,e)=>{let i=r._map.get(t)||null;for(;i!==null&&(!e.sv.has(i.id.client)||i.id.clock>=(e.sv.get(i.id.client)||0));)i=i.left;return i!==null&&me(i,e)?i.content.getContent()[i.length-1]:void 0},Ss=(r,t)=>{const e={};return r._map.forEach((i,o)=>{let c=i;for(;c!==null&&(!t.sv.has(c.id.client)||c.id.clock>=(t.sv.get(c.id.client)||0));)c=c.left;c!==null&&me(c,t)&&(e[o]=c.content.getContent()[c.length-1])}),e},$e=r=>E(r.entries(),t=>!t[1].deleted);class Cs extends He{}class we extends re{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(t){const e=new we;return e.push(t),e}_integrate(t,e){super._integrate(t,e),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new we}clone(){const t=new we;return t.insert(0,this.toArray().map(e=>e instanceof re?e.clone():e)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}_callObserver(t,e){super._callObserver(t,e),Ye(this,t,new Cs(this,t))}insert(t,e){this.doc!==null?Yt(this.doc,i=>{Vn(i,this,t,e)}):this._prelimContent.splice(t,0,...e)}push(t){this.doc!==null?Yt(this.doc,e=>{Es(e,this,t)}):this._prelimContent.push(...t)}unshift(t){this.insert(0,t)}delete(t,e=1){this.doc!==null?Yt(this.doc,i=>{Wn(i,this,t,e)}):this._prelimContent.splice(t,e)}get(t){return Fn(this,t)}toArray(){return jn(this)}slice(t=0,e=this.length){return Nn(this,t,e)}toJSON(){return this.map(t=>t instanceof re?t.toJSON():t)}map(t){return Bn(this,t)}forEach(t){Be(this,t)}[Symbol.iterator](){return vs(this)}_write(t){t.writeTypeRef(Js)}}const ks=r=>new we;class Ts extends He{constructor(t,e,i){super(t,e),this.keysChanged=i}}class Ce extends re{constructor(t){super(),this._prelimContent=null,t===void 0?this._prelimContent=new Map:this._prelimContent=new Map(t)}_integrate(t,e){super._integrate(t,e),this._prelimContent.forEach((i,o)=>{this.set(o,i)}),this._prelimContent=null}_copy(){return new Ce}clone(){const t=new Ce;return this.forEach((e,i)=>{t.set(i,e instanceof re?e.clone():e)}),t}_callObserver(t,e){Ye(this,t,new Ts(this,t,e))}toJSON(){const t={};return this._map.forEach((e,i)=>{if(!e.deleted){const o=e.content.getContent()[e.length-1];t[i]=o instanceof re?o.toJSON():o}}),t}get size(){return[...$e(this._map)].length}keys(){return g($e(this._map),t=>t[0])}values(){return g($e(this._map),t=>t[1].content.getContent()[t[1].length-1])}entries(){return g($e(this._map),t=>[t[0],t[1].content.getContent()[t[1].length-1]])}forEach(t){this._map.forEach((e,i)=>{e.deleted||t(e.content.getContent()[e.length-1],i,this)})}[Symbol.iterator](){return this.entries()}delete(t){this.doc!==null?Yt(this.doc,e=>{Je(e,this,t)}):this._prelimContent.delete(t)}set(t,e){return this.doc!==null?Yt(this.doc,i=>{ln(i,this,t,e)}):this._prelimContent.set(t,e),e}get(t){return an(this,t)}has(t){return Hn(this,t)}clear(){this.doc!==null?Yt(this.doc,t=>{this.forEach(function(e,i,o){Je(t,o,i)})}):this._prelimContent.clear()}_write(t){t.writeTypeRef($s)}}const Rs=r=>new Ce,_e=(r,t)=>r===t||typeof r=="object"&&typeof t=="object"&&r&&t&&T.SQ(r,t);class un{constructor(t,e,i,o){this.left=t,this.right=e,this.index=i,this.currentAttributes=o}forward(){switch(this.right===null&&u.Mq(),this.right.content.constructor){case Zt:this.right.deleted||Ae(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const Kn=(r,t,e)=>{for(;t.right!==null&&e>0;){switch(t.right.content.constructor){case Zt:t.right.deleted||Ae(t.currentAttributes,t.right.content);break;default:t.right.deleted||(e<t.right.length&&ce(r,yt(t.right.id.client,t.right.id.clock+e)),t.index+=t.right.length,e-=t.right.length);break}t.left=t.right,t.right=t.right.right}return t},Qe=(r,t,e,i)=>{const o=new Map,c=i?Ke(t,e):null;if(c){const b=new un(c.p.left,c.p,c.index,o);return Kn(r,b,e-c.index)}else{const b=new un(null,t._start,0,o);return Kn(r,b,e)}},Yn=(r,t,e,i)=>{for(;e.right!==null&&(e.right.deleted===!0||e.right.content.constructor===Zt&&_e(i.get(e.right.content.key),e.right.content.value));)e.right.deleted||i.delete(e.right.content.key),e.forward();const o=r.doc,c=o.clientID;i.forEach((b,S)=>{const U=e.left,W=e.right,B=new Gt(yt(c,$t(o.store,c)),U,U&&U.lastId,W,W&&W.id,t,null,new Zt(S,b));B.integrate(r,0),e.right=B,e.forward()})},Ae=(r,t)=>{const{key:e,value:i}=t;i===null?r.delete(e):r.set(e,i)},Gn=(r,t)=>{var e;for(;r.right!==null;){if(!(r.right.deleted||r.right.content.constructor===Zt&&_e((e=t[r.right.content.key])!=null?e:null,r.right.content.value)))break;r.forward()}},Jn=(r,t,e,i)=>{var S;const o=r.doc,c=o.clientID,b=new Map;for(const U in i){const W=i[U],B=(S=e.currentAttributes.get(U))!=null?S:null;if(!_e(B,W)){b.set(U,B);const{left:F,right:X}=e;e.right=new Gt(yt(c,$t(o.store,c)),F,F&&F.lastId,X,X&&X.id,t,null,new Zt(U,W)),e.right.integrate(r,0),e.forward()}}return b},dn=(r,t,e,i,o)=>{e.currentAttributes.forEach((X,ht)=>{o[ht]===void 0&&(o[ht]=null)});const c=r.doc,b=c.clientID;Gn(e,o);const S=Jn(r,t,e,o),U=i.constructor===String?new fe(i):i instanceof re?new pe(i):new ve(i);let{left:W,right:B,index:F}=e;t._searchMarker&&je(t._searchMarker,e.index,U.getLength()),B=new Gt(yt(b,$t(c.store,b)),W,W&&W.lastId,B,B&&B.id,t,null,U),B.integrate(r,0),e.right=B,e.index=F,e.forward(),Yn(r,t,e,S)},$n=(r,t,e,i,o)=>{const c=r.doc,b=c.clientID;Gn(e,o);const S=Jn(r,t,e,o);t:for(;e.right!==null&&(i>0||S.size>0&&(e.right.deleted||e.right.content.constructor===Zt));){if(!e.right.deleted)switch(e.right.content.constructor){case Zt:{const{key:U,value:W}=e.right.content,B=o[U];if(B!==void 0){if(_e(B,W))S.delete(U);else{if(i===0)break t;S.set(U,W)}e.right.delete(r)}else e.currentAttributes.set(U,W);break}default:i<e.right.length&&ce(r,yt(e.right.id.client,e.right.id.clock+i)),i-=e.right.length;break}e.forward()}if(i>0){let U="";for(;i>0;i--)U+=`
`;e.right=new Gt(yt(b,$t(c.store,b)),e.left,e.left&&e.left.lastId,e.right,e.right&&e.right.id,t,null,new fe(U)),e.right.integrate(r,0),e.forward()}Yn(r,t,e,S)},Qn=(r,t,e,i,o)=>{var W,B;let c=t;const b=x.vt();for(;c&&(!c.countable||c.deleted);){if(!c.deleted&&c.content.constructor===Zt){const F=c.content;b.set(F.key,F)}c=c.right}let S=0,U=!1;for(;t!==c;){if(e===t&&(U=!0),!t.deleted){const F=t.content;switch(F.constructor){case Zt:{const{key:X,value:ht}=F,gt=(W=i.get(X))!=null?W:null;(b.get(X)!==F||gt===ht)&&(t.delete(r),S++,!U&&((B=o.get(X))!=null?B:null)===ht&&gt!==ht&&(gt===null?o.delete(X):o.set(X,gt))),!U&&!t.deleted&&Ae(o,F);break}}}t=t.right}return S},Ds=(r,t)=>{for(;t&&t.right&&(t.right.deleted||!t.right.countable);)t=t.right;const e=new Set;for(;t&&(t.deleted||!t.countable);){if(!t.deleted&&t.content.constructor===Zt){const i=t.content.key;e.has(i)?t.delete(r):e.add(i)}t=t.left}},As=r=>{let t=0;return Yt(r.doc,e=>{let i=r._start,o=r._start,c=x.vt();const b=x.C(c);for(;o;){if(o.deleted===!1)switch(o.content.constructor){case Zt:Ae(b,o.content);break;default:t+=Qn(e,i,o,c,b),c=x.C(b),i=o;break}o=o.right}}),t},Is=r=>{const t=new Set,e=r.doc;for(const[i,o]of r.afterState.entries()){const c=r.beforeState.get(i)||0;o!==c&&En(r,e.store.clients.get(i),c,o,b=>{!b.deleted&&b.content.constructor===Zt&&b.constructor!==ae&&t.add(b.parent)})}Yt(e,i=>{L(r,r.deleteSet,o=>{if(o instanceof ae||!o.parent._hasFormatting||t.has(o.parent))return;const c=o.parent;o.content.constructor===Zt?t.add(c):Ds(i,o)});for(const o of t)As(o)})},qn=(r,t,e)=>{const i=e,o=x.C(t.currentAttributes),c=t.right;for(;e>0&&t.right!==null;){if(t.right.deleted===!1)switch(t.right.content.constructor){case pe:case ve:case fe:e<t.right.length&&ce(r,yt(t.right.id.client,t.right.id.clock+e)),e-=t.right.length,t.right.delete(r);break}t.forward()}c&&Qn(r,c,t.right,o,t.currentAttributes);const b=(t.left||t.right).parent;return b._searchMarker&&je(b._searchMarker,t.index,-i+e),t};class Os extends He{constructor(t,e,i){super(t,e),this.childListChanged=!1,this.keysChanged=new Set,i.forEach(o=>{o===null?this.childListChanged=!0:this.keysChanged.add(o)})}get changes(){if(this._changes===null){const t={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=t}return this._changes}get delta(){if(this._delta===null){const t=this.target.doc,e=[];Yt(t,i=>{var ht,gt,Wt;const o=new Map,c=new Map;let b=this.target._start,S=null;const U={};let W="",B=0,F=0;const X=()=>{if(S!==null){let Ot=null;switch(S){case"delete":F>0&&(Ot={delete:F}),F=0;break;case"insert":(typeof W=="object"||W.length>0)&&(Ot={insert:W},o.size>0&&(Ot.attributes={},o.forEach((Ft,ue)=>{Ft!==null&&(Ot.attributes[ue]=Ft)}))),W="";break;case"retain":B>0&&(Ot={retain:B},T.Im(U)||(Ot.attributes=T.kp({},U))),B=0;break}Ot&&e.push(Ot),S=null}};for(;b!==null;){switch(b.content.constructor){case pe:case ve:this.adds(b)?this.deletes(b)||(X(),S="insert",W=b.content.getContent()[0],X()):this.deletes(b)?(S!=="delete"&&(X(),S="delete"),F+=1):b.deleted||(S!=="retain"&&(X(),S="retain"),B+=1);break;case fe:this.adds(b)?this.deletes(b)||(S!=="insert"&&(X(),S="insert"),W+=b.content.str):this.deletes(b)?(S!=="delete"&&(X(),S="delete"),F+=b.length):b.deleted||(S!=="retain"&&(X(),S="retain"),B+=b.length);break;case Zt:{const{key:Ot,value:Ft}=b.content;if(this.adds(b)){if(!this.deletes(b)){const ue=(ht=o.get(Ot))!=null?ht:null;_e(ue,Ft)?Ft!==null&&b.delete(i):(S==="retain"&&X(),_e(Ft,(gt=c.get(Ot))!=null?gt:null)?delete U[Ot]:U[Ot]=Ft)}}else if(this.deletes(b)){c.set(Ot,Ft);const ue=(Wt=o.get(Ot))!=null?Wt:null;_e(ue,Ft)||(S==="retain"&&X(),U[Ot]=ue)}else if(!b.deleted){c.set(Ot,Ft);const ue=U[Ot];ue!==void 0&&(_e(ue,Ft)?ue!==null&&b.delete(i):(S==="retain"&&X(),Ft===null?delete U[Ot]:U[Ot]=Ft))}b.deleted||(S==="insert"&&X(),Ae(o,b.content));break}}b=b.right}for(X();e.length>0;){const Ot=e[e.length-1];if(Ot.retain!==void 0&&Ot.attributes===void 0)e.pop();else break}}),this._delta=e}return this._delta}}class Ie extends re{constructor(t){super(),this._pending=t!==void 0?[()=>this.insert(0,t)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this._length}_integrate(t,e){super._integrate(t,e);try{this._pending.forEach(i=>i())}catch(i){console.error(i)}this._pending=null}_copy(){return new Ie}clone(){const t=new Ie;return t.applyDelta(this.toDelta()),t}_callObserver(t,e){super._callObserver(t,e);const i=new Os(this,t,e);Ye(this,t,i),!t.local&&this._hasFormatting&&(t._needFormattingCleanup=!0)}toString(){let t="",e=this._start;for(;e!==null;)!e.deleted&&e.countable&&e.content.constructor===fe&&(t+=e.content.str),e=e.right;return t}toJSON(){return this.toString()}applyDelta(t,{sanitize:e=!0}={}){this.doc!==null?Yt(this.doc,i=>{const o=new un(null,this._start,0,new Map);for(let c=0;c<t.length;c++){const b=t[c];if(b.insert!==void 0){const S=!e&&typeof b.insert=="string"&&c===t.length-1&&o.right===null&&b.insert.slice(-1)===`
`?b.insert.slice(0,-1):b.insert;(typeof S!="string"||S.length>0)&&dn(i,this,o,S,b.attributes||{})}else b.retain!==void 0?$n(i,this,o,b.retain,b.attributes||{}):b.delete!==void 0&&qn(i,o,b.delete)}}):this._pending.push(()=>this.applyDelta(t))}toDelta(t,e,i){const o=[],c=new Map,b=this.doc;let S="",U=this._start;function W(){if(S.length>0){const F={};let X=!1;c.forEach((gt,Wt)=>{X=!0,F[Wt]=gt});const ht={insert:S};X&&(ht.attributes=F),o.push(ht),S=""}}const B=()=>{for(;U!==null;){if(me(U,t)||e!==void 0&&me(U,e))switch(U.content.constructor){case fe:{const F=c.get("ychange");t!==void 0&&!me(U,t)?(F===void 0||F.user!==U.id.client||F.type!=="removed")&&(W(),c.set("ychange",i?i("removed",U.id):{type:"removed"})):e!==void 0&&!me(U,e)?(F===void 0||F.user!==U.id.client||F.type!=="added")&&(W(),c.set("ychange",i?i("added",U.id):{type:"added"})):F!==void 0&&(W(),c.delete("ychange")),S+=U.content.str;break}case pe:case ve:{W();const F={insert:U.content.getContent()[0]};if(c.size>0){const X={};F.attributes=X,c.forEach((ht,gt)=>{X[gt]=ht})}o.push(F);break}case Zt:me(U,t)&&(W(),Ae(c,U.content));break}U=U.right}W()};return t||e?Yt(b,F=>{t&&nn(F,t),e&&nn(F,e),B()},"cleanup"):B(),o}insert(t,e,i){if(e.length<=0)return;const o=this.doc;o!==null?Yt(o,c=>{const b=Qe(c,this,t,!i);i||(i={},b.currentAttributes.forEach((S,U)=>{i[U]=S})),dn(c,this,b,e,i)}):this._pending.push(()=>this.insert(t,e,i))}insertEmbed(t,e,i){const o=this.doc;o!==null?Yt(o,c=>{const b=Qe(c,this,t,!i);dn(c,this,b,e,i||{})}):this._pending.push(()=>this.insertEmbed(t,e,i||{}))}delete(t,e){if(e===0)return;const i=this.doc;i!==null?Yt(i,o=>{qn(o,Qe(o,this,t,!0),e)}):this._pending.push(()=>this.delete(t,e))}format(t,e,i){if(e===0)return;const o=this.doc;o!==null?Yt(o,c=>{const b=Qe(c,this,t,!1);b.right!==null&&$n(c,this,b,e,i)}):this._pending.push(()=>this.format(t,e,i))}removeAttribute(t){this.doc!==null?Yt(this.doc,e=>{Je(e,this,t)}):this._pending.push(()=>this.removeAttribute(t))}setAttribute(t,e){this.doc!==null?Yt(this.doc,i=>{ln(i,this,t,e)}):this._pending.push(()=>this.setAttribute(t,e))}getAttribute(t){return an(this,t)}getAttributes(){return zn(this)}_write(t){t.writeTypeRef(Qs)}}const xs=r=>new Ie;class hn{constructor(t,e=()=>!0){this._filter=e,this._root=t,this._currentNode=t._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let t=this._currentNode,e=t&&t.content&&t.content.type;if(t!==null&&(!this._firstCall||t.deleted||!this._filter(e)))do if(e=t.content.type,!t.deleted&&(e.constructor===Te||e.constructor===ke)&&e._start!==null)t=e._start;else for(;t!==null;)if(t.right!==null){t=t.right;break}else t.parent===this._root?t=null:t=t.parent._item;while(t!==null&&(t.deleted||!this._filter(t.content.type)));return this._firstCall=!1,t===null?{value:void 0,done:!0}:(this._currentNode=t,{value:t.content.type,done:!1})}}class ke extends re{constructor(){super(),this._prelimContent=[]}get firstChild(){const t=this._first;return t?t.content.getContent()[0]:null}_integrate(t,e){super._integrate(t,e),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new ke}clone(){const t=new ke;return t.insert(0,this.toArray().map(e=>e instanceof re?e.clone():e)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(t){return new hn(this,t)}querySelector(t){t=t.toUpperCase();const i=new hn(this,o=>o.nodeName&&o.nodeName.toUpperCase()===t).next();return i.done?null:i.value}querySelectorAll(t){return t=t.toUpperCase(),it.HT(new hn(this,e=>e.nodeName&&e.nodeName.toUpperCase()===t))}_callObserver(t,e){Ye(this,t,new Ms(this,e,t))}toString(){return Bn(this,t=>t.toString()).join("")}toJSON(){return this.toString()}toDOM(t=document,e={},i){const o=t.createDocumentFragment();return i!==void 0&&i._createAssociation(o,this),Be(this,c=>{o.insertBefore(c.toDOM(t,e,i),null)}),o}insert(t,e){this.doc!==null?Yt(this.doc,i=>{Vn(i,this,t,e)}):this._prelimContent.splice(t,0,...e)}insertAfter(t,e){if(this.doc!==null)Yt(this.doc,i=>{const o=t&&t instanceof re?t._item:t;Ge(i,this,o,e)});else{const i=this._prelimContent,o=t===null?0:i.findIndex(c=>c===t)+1;if(o===0&&t!==null)throw u.vt("Reference item not found");i.splice(o,0,...e)}}delete(t,e=1){this.doc!==null?Yt(this.doc,i=>{Wn(i,this,t,e)}):this._prelimContent.splice(t,e)}toArray(){return jn(this)}push(t){this.insert(this.length,t)}unshift(t){this.insert(0,t)}get(t){return Fn(this,t)}slice(t=0,e=this.length){return Nn(this,t,e)}forEach(t){Be(this,t)}_write(t){t.writeTypeRef(Xs)}}const Ls=r=>new ke;class Te extends ke{constructor(t="UNDEFINED"){super(),this.nodeName=t,this._prelimAttrs=new Map}get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_integrate(t,e){super._integrate(t,e),this._prelimAttrs.forEach((i,o)=>{this.setAttribute(o,i)}),this._prelimAttrs=null}_copy(){return new Te(this.nodeName)}clone(){const t=new Te(this.nodeName),e=this.getAttributes();return T.jJ(e,(i,o)=>{typeof i=="string"&&t.setAttribute(o,i)}),t.insert(0,this.toArray().map(i=>i instanceof re?i.clone():i)),t}toString(){const t=this.getAttributes(),e=[],i=[];for(const S in t)i.push(S);i.sort();const o=i.length;for(let S=0;S<o;S++){const U=i[S];e.push(U+'="'+t[U]+'"')}const c=this.nodeName.toLocaleLowerCase(),b=e.length>0?" "+e.join(" "):"";return`<${c}${b}>${super.toString()}</${c}>`}removeAttribute(t){this.doc!==null?Yt(this.doc,e=>{Je(e,this,t)}):this._prelimAttrs.delete(t)}setAttribute(t,e){this.doc!==null?Yt(this.doc,i=>{ln(i,this,t,e)}):this._prelimAttrs.set(t,e)}getAttribute(t){return an(this,t)}hasAttribute(t){return Hn(this,t)}getAttributes(t){return t?Ss(this,t):zn(this)}toDOM(t=document,e={},i){const o=t.createElement(this.nodeName),c=this.getAttributes();for(const b in c){const S=c[b];typeof S=="string"&&o.setAttribute(b,S)}return Be(this,b=>{o.appendChild(b.toDOM(t,e,i))}),i!==void 0&&i._createAssociation(o,this),o}_write(t){t.writeTypeRef(qs),t.writeKey(this.nodeName)}}const Us=r=>new Te(r.readKey());class Ms extends He{constructor(t,e,i){super(t,i),this.childListChanged=!1,this.attributesChanged=new Set,e.forEach(o=>{o===null?this.childListChanged=!0:this.attributesChanged.add(o)})}}class Fe extends Ce{constructor(t){super(),this.hookName=t}_copy(){return new Fe(this.hookName)}clone(){const t=new Fe(this.hookName);return this.forEach((e,i)=>{t.set(i,e)}),t}toDOM(t=document,e={},i){const o=e[this.hookName];let c;return o!==void 0?c=o.createDom(this):c=document.createElement(this.hookName),c.setAttribute("data-yjs-hook",this.hookName),i!==void 0&&i._createAssociation(c,this),c}_write(t){t.writeTypeRef(Zs),t.writeKey(this.hookName)}}const Ns=r=>new Fe(r.readKey());class qe extends Ie{get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_copy(){return new qe}clone(){const t=new qe;return t.applyDelta(this.toDelta()),t}toDOM(t=document,e,i){const o=t.createTextNode(this.toString());return i!==void 0&&i._createAssociation(o,this),o}toString(){return this.toDelta().map(t=>{const e=[];for(const o in t.attributes){const c=[];for(const b in t.attributes[o])c.push({key:b,value:t.attributes[o][b]});c.sort((b,S)=>b.key<S.key?-1:1),e.push({nodeName:o,attrs:c})}e.sort((o,c)=>o.nodeName<c.nodeName?-1:1);let i="";for(let o=0;o<e.length;o++){const c=e[o];i+=`<${c.nodeName}`;for(let b=0;b<c.attrs.length;b++){const S=c.attrs[b];i+=` ${S.key}="${S.value}"`}i+=">"}i+=t.insert;for(let o=e.length-1;o>=0;o--)i+=`</${e[o].nodeName}>`;return i}).join("")}toJSON(){return this.toString()}_write(t){t.writeTypeRef(tr)}}const js=r=>new qe;class fn{constructor(t,e){this.id=t,this.length=e}get deleted(){throw u.bD()}mergeWith(t){return!1}write(t,e,i){throw u.bD()}integrate(t,e){throw u.bD()}}const Bs=0;class ae extends fn{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,e){e>0&&(this.id.clock+=e,this.length-=e),_n(t.doc.store,this)}write(t,e){t.writeInfo(Bs),t.writeLen(this.length-e)}getMissing(t,e){return null}}class Oe{constructor(t){this.content=t}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new Oe(this.content)}splice(t){throw u.bD()}mergeWith(t){return!1}integrate(t,e){}delete(t){}gc(t){}write(t,e){t.writeBuf(this.content)}getRef(){return 3}}const Fs=r=>new Oe(r.readBuf());class xe{constructor(t){this.len=t}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new xe(this.len)}splice(t){const e=new xe(this.len-t);return this.len=t,e}mergeWith(t){return this.len+=t.len,!0}integrate(t,e){Ct(t.deleteSet,e.id.client,e.id.clock,this.len),e.markDeleted()}delete(t){}gc(t){}write(t,e){t.writeLen(this.len-e)}getRef(){return 1}}const Ps=r=>new xe(r.readLen()),Xn=(r,t)=>new st({guid:r,...t,shouldLoad:t.shouldLoad||t.autoLoad||!1});class Le{constructor(t){t._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=t;const e={};this.opts=e,t.gc||(e.gc=!1),t.autoLoad&&(e.autoLoad=!0),t.meta!==null&&(e.meta=t.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new Le(Xn(this.doc.guid,this.opts))}splice(t){throw u.bD()}mergeWith(t){return!1}integrate(t,e){this.doc._item=e,t.subdocsAdded.add(this.doc),this.doc.shouldLoad&&t.subdocsLoaded.add(this.doc)}delete(t){t.subdocsAdded.has(this.doc)?t.subdocsAdded.delete(this.doc):t.subdocsRemoved.add(this.doc)}gc(t){}write(t,e){t.writeString(this.doc.guid),t.writeAny(this.opts)}getRef(){return 9}}const Vs=r=>new Le(Xn(r.readString(),r.readAny()));class ve{constructor(t){this.embed=t}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new ve(this.embed)}splice(t){throw u.bD()}mergeWith(t){return!1}integrate(t,e){}delete(t){}gc(t){}write(t,e){t.writeJSON(this.embed)}getRef(){return 5}}const Ws=r=>new ve(r.readJSON());class Zt{constructor(t,e){this.key=t,this.value=e}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new Zt(this.key,this.value)}splice(t){throw u.bD()}mergeWith(t){return!1}integrate(t,e){const i=e.parent;i._searchMarker=null,i._hasFormatting=!0}delete(t){}gc(t){}write(t,e){t.writeKey(this.key),t.writeJSON(this.value)}getRef(){return 6}}const zs=r=>new Zt(r.readKey(),r.readJSON());class Pe{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Pe(this.arr)}splice(t){const e=new Pe(this.arr.slice(t));return this.arr=this.arr.slice(0,t),e}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){const i=this.arr.length;t.writeLen(i-e);for(let o=e;o<i;o++){const c=this.arr[o];t.writeString(c===void 0?"undefined":JSON.stringify(c))}}getRef(){return 2}}const Hs=r=>{const t=r.readLen(),e=[];for(let i=0;i<t;i++){const o=r.readString();o==="undefined"?e.push(void 0):e.push(JSON.parse(o))}return new Pe(e)};class Ee{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Ee(this.arr)}splice(t){const e=new Ee(this.arr.slice(t));return this.arr=this.arr.slice(0,t),e}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){const i=this.arr.length;t.writeLen(i-e);for(let o=e;o<i;o++){const c=this.arr[o];t.writeAny(c)}}getRef(){return 8}}const Ks=r=>{const t=r.readLen(),e=[];for(let i=0;i<t;i++)e.push(r.readAny());return new Ee(e)};class fe{constructor(t){this.str=t}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new fe(this.str)}splice(t){const e=new fe(this.str.slice(t));this.str=this.str.slice(0,t);const i=this.str.charCodeAt(t-1);return i>=55296&&i<=56319&&(this.str=this.str.slice(0,t-1)+"\uFFFD",e.str="\uFFFD"+e.str.slice(1)),e}mergeWith(t){return this.str+=t.str,!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){t.writeString(e===0?this.str:this.str.slice(e))}getRef(){return 4}}const Ys=r=>new fe(r.readString()),Gs=[ks,Rs,xs,Us,Ls,Ns,js],Js=0,$s=1,Qs=2,qs=3,Xs=4,Zs=5,tr=6;class pe{constructor(t){this.type=t}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new pe(this.type._copy())}splice(t){throw u.bD()}mergeWith(t){return!1}integrate(t,e){this.type._integrate(t.doc,e)}delete(t){let e=this.type._start;for(;e!==null;)e.deleted?e.id.clock<(t.beforeState.get(e.id.client)||0)&&t._mergeStructs.push(e):e.delete(t),e=e.right;this.type._map.forEach(i=>{i.deleted?i.id.clock<(t.beforeState.get(i.id.client)||0)&&t._mergeStructs.push(i):i.delete(t)}),t.changed.delete(this.type)}gc(t){let e=this.type._start;for(;e!==null;)e.gc(t,!0),e=e.right;this.type._start=null,this.type._map.forEach(i=>{for(;i!==null;)i.gc(t,!0),i=i.left}),this.type._map=new Map}write(t,e){this.type._write(t)}getRef(){return 7}}const er=r=>new pe(Gs[r.readTypeRef()](r)),pn=(r,t)=>{let e=t,i=0,o;do i>0&&(e=yt(e.client,e.clock+i)),o=De(r,e),i=e.clock-o.id.clock,e=o.redone;while(e!==null&&o instanceof Gt);return{item:o,diff:i}},gn=(r,t)=>{for(;r!==null&&r.keep!==t;)r.keep=t,r=r.parent._item},Xe=(r,t,e)=>{const{client:i,clock:o}=t.id,c=new Gt(yt(i,o+e),t,yt(i,o+e-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(e));return t.deleted&&c.markDeleted(),t.keep&&(c.keep=!0),t.redone!==null&&(c.redone=yt(t.redone.client,t.redone.clock+e)),t.right=c,c.right!==null&&(c.right.left=c),r._mergeStructs.push(c),c.parentSub!==null&&c.right===null&&c.parent._map.set(c.parentSub,c),t.length=e,c},Zn=(r,t)=>it.zN(r,e=>Q(e.deletions,t)),ts=(r,t,e,i,o,c)=>{const b=r.doc,S=b.store,U=b.clientID,W=t.redone;if(W!==null)return ce(r,W);let B=t.parent._item,F=null,X;if(B!==null&&B.deleted===!0){if(B.redone===null&&(!e.has(B)||ts(r,B,e,i,o,c)===null))return null;for(;B.redone!==null;)B=ce(r,B.redone)}const ht=B===null?t.parent:B.content.type;if(t.parentSub===null){for(F=t.left,X=t;F!==null;){let Ft=F;for(;Ft!==null&&Ft.parent._item!==B;)Ft=Ft.redone===null?null:ce(r,Ft.redone);if(Ft!==null&&Ft.parent._item===B){F=Ft;break}F=F.left}for(;X!==null;){let Ft=X;for(;Ft!==null&&Ft.parent._item!==B;)Ft=Ft.redone===null?null:ce(r,Ft.redone);if(Ft!==null&&Ft.parent._item===B){X=Ft;break}X=X.right}}else if(X=null,t.right&&!o){for(F=t;F!==null&&F.right!==null&&(F.right.redone||Q(i,F.right.id)||Zn(c.undoStack,F.right.id)||Zn(c.redoStack,F.right.id));)for(F=F.right;F.redone;)F=ce(r,F.redone);if(F&&F.right!==null)return null}else F=ht._map.get(t.parentSub)||null;const gt=$t(S,U),Wt=yt(U,gt),Ot=new Gt(Wt,F,F&&F.lastId,X,X&&X.id,ht,t.parentSub,t.content.copy());return t.redone=Wt,gn(Ot,!0),Ot.integrate(r,0),Ot};class Gt extends fn{constructor(t,e,i,o,c,b,S,U){super(t,U.getLength()),this.origin=i,this.left=e,this.right=o,this.rightOrigin=c,this.parent=b,this.parentSub=S,this.redone=null,this.content=U,this.info=this.content.isCountable()?y.KD:0}set marker(t){(this.info&y.wn)>0!==t&&(this.info^=y.wn)}get marker(){return(this.info&y.wn)>0}get keep(){return(this.info&y.Dk)>0}set keep(t){this.keep!==t&&(this.info^=y.Dk)}get countable(){return(this.info&y.KD)>0}get deleted(){return(this.info&y.D1)>0}set deleted(t){this.deleted!==t&&(this.info^=y.D1)}markDeleted(){this.info|=y.D1}getMissing(t,e){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=$t(e,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=$t(e,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===bt&&this.id.client!==this.parent.client&&this.parent.clock>=$t(e,this.parent.client))return this.parent.client;if(this.origin&&(this.left=vn(t,e,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=ce(t,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===ae||this.right&&this.right.constructor===ae)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===Gt&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===Gt&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===bt){const i=De(e,this.parent);i.constructor===ae?this.parent=null:this.parent=i.content.type}return null}integrate(t,e){if(e>0&&(this.id.clock+=e,this.left=vn(t,t.doc.store,yt(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(e),this.length-=e),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let i=this.left,o;if(i!==null)o=i.right;else if(this.parentSub!==null)for(o=this.parent._map.get(this.parentSub)||null;o!==null&&o.left!==null;)o=o.left;else o=this.parent._start;const c=new Set,b=new Set;for(;o!==null&&o!==this.right;){if(b.add(o),c.add(o),Mt(this.origin,o.origin)){if(o.id.client<this.id.client)i=o,c.clear();else if(Mt(this.rightOrigin,o.rightOrigin))break}else if(o.origin!==null&&b.has(De(t.doc.store,o.origin)))c.has(De(t.doc.store,o.origin))||(i=o,c.clear());else break;o=o.right}this.left=i}if(this.left!==null){const i=this.left.right;this.right=i,this.left.right=this}else{let i;if(this.parentSub!==null)for(i=this.parent._map.get(this.parentSub)||null;i!==null&&i.left!==null;)i=i.left;else i=this.parent._start,this.parent._start=this;this.right=i}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(t)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),_n(t.doc.store,this),this.content.integrate(t,this),Cn(t,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(t)}else new ae(this.id,this.length).integrate(t,0)}get next(){let t=this.right;for(;t!==null&&t.deleted;)t=t.right;return t}get prev(){let t=this.left;for(;t!==null&&t.deleted;)t=t.left;return t}get lastId(){return this.length===1?this.id:yt(this.id.client,this.id.clock+this.length-1)}mergeWith(t){if(this.constructor===t.constructor&&Mt(t.origin,this.lastId)&&this.right===t&&Mt(this.rightOrigin,t.rightOrigin)&&this.id.client===t.id.client&&this.id.clock+this.length===t.id.clock&&this.deleted===t.deleted&&this.redone===null&&t.redone===null&&this.content.constructor===t.content.constructor&&this.content.mergeWith(t.content)){const e=this.parent._searchMarker;return e&&e.forEach(i=>{i.p===t&&(i.p=this,!this.deleted&&this.countable&&(i.index-=this.length))}),t.keep&&(this.keep=!0),this.right=t.right,this.right!==null&&(this.right.left=this),this.length+=t.length,!0}return!1}delete(t){if(!this.deleted){const e=this.parent;this.countable&&this.parentSub===null&&(e._length-=this.length),this.markDeleted(),Ct(t.deleteSet,this.id.client,this.id.clock,this.length),Cn(t,e,this.parentSub),this.content.delete(t)}}gc(t,e){if(!this.deleted)throw u.Mq();this.content.gc(t),e?os(t,this,new ae(this.id,this.length)):this.content=new xe(this.length)}write(t,e){const i=e>0?yt(this.id.client,this.id.clock+e-1):this.origin,o=this.rightOrigin,c=this.parentSub,b=this.content.getRef()&y.WY|(i===null?0:y.wt)|(o===null?0:y.D7)|(c===null?0:y.KJ);if(t.writeInfo(b),i!==null&&t.writeLeftID(i),o!==null&&t.writeRightID(o),i===null&&o===null){const S=this.parent;if(S._item!==void 0){const U=S._item;if(U===null){const W=se(S);t.writeParentInfo(!0),t.writeString(W)}else t.writeParentInfo(!1),t.writeLeftID(U.id)}else S.constructor===String?(t.writeParentInfo(!0),t.writeString(S)):S.constructor===bt?(t.writeParentInfo(!1),t.writeLeftID(S)):u.Mq();c!==null&&t.writeString(c)}this.content.write(t,e)}}const es=(r,t)=>nr[t&y.WY](r),nr=[()=>{u.Mq()},Ps,Hs,Fs,Ys,Ws,zs,er,Ks,Vs,()=>{u.Mq()}],sr=10;class le extends fn{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,e){u.Mq()}write(t,e){t.writeInfo(sr),C.zd(t.restEncoder,this.length-e)}getMissing(t,e){return null}}const ns=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof H.g!="undefined"?H.g:{},ss="__ $YJS$ __";ns[ss]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438"),ns[ss]=!0}}]);})();
